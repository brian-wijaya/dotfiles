# Sensor Heads-Up Display (HUD) Overlay Server E2E Tests

vocabularies: [sensor, services]

metadata:
  feature: sensor
  component: core-hud
  tags: [sensor, core]
  estimated_duration_ms: 5000

stories:
  - name: hud-service-running
    description: HUD overlay server is active
    steps:
      - service_active: sensor-hud
      - sensor_get_status
    verify:
      - Contains: "hud"

  - name: text-flash-display
    description: Text can be flashed on HUD
    steps:
      - sensor_flash_text
      - bash: "sleep 0.2"
      - bash: "sensor-cli hud --query --json | jq -r '.active'"
    verify:
      - Equals: "true"

  - name: icon-flash-display
    description: Icons can be flashed on HUD
    steps:
      - sensor_flash_icon
      - bash: "sleep 0.2"
      - bash: "sensor-cli hud --query --json | jq -r '.icon_visible'"
    verify:
      - Equals: "true"

  - name: hud-message-queuing
    description: HUD messages are queued
    steps:
      - sensor_flash_text
      - sensor_flash_text
      - bash: "sensor-cli hud --queue --json | jq 'length'"
    verify:
      - Greater: 0

  - name: hud-dismiss
    description: HUD messages can be dismissed
    steps:
      - sensor_flash_text
      - sensor_dismiss
      - bash: "sensor-cli hud --query --json | jq -r '.active'"
    verify:
      - Equals: "false"

  - name: hud-dismiss-all
    description: All HUD messages can be dismissed
    steps:
      - sensor_flash_text
      - sensor_flash_icon
      - sensor_dismiss_all
      - bash: "sensor-cli hud --queue --json | jq 'length'"
    verify:
      - Equals: 0
