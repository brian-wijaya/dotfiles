# Services vocabulary for e2e tests
# Usage: vocabularies: [services] in story file

service_active:
  tool: bash
  cmd: "systemctl --user is-active \"$1\""

service_enabled:
  tool: bash
  cmd: "systemctl --user is-enabled \"$1\""

service_status:
  tool: bash
  cmd: "systemctl --user status \"$1\" --no-pager"

service_logs:
  tool: bash
  cmd: "journalctl --user -u \"$1\" -n 10 --no-pager"

service_restart:
  tool: bash
  cmd: "systemctl --user restart \"$1\""

daemon_running:
  tool: bash
  cmd: "pgrep -f \"$1\" > /dev/null && echo 'running' || echo 'stopped'"

process_count:
  tool: bash
  cmd: "pgrep -f \"$1\" | wc -l"

socket_listening:
  tool: bash
  cmd: "lsof -i :\"$1\" | grep LISTEN"

unix_socket_exists:
  tool: bash
  cmd: "test -S \"$1\" && echo 'exists' || echo 'missing'"

systemd_timer_next:
  tool: bash
  cmd: "systemctl --user list-timers \"$1\" --no-pager | awk 'NR==2 {print $1, $2}'"
