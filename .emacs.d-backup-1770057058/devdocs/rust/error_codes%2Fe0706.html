<h1 id="error-code-e0706">Error code E0706</h1> <h4 id="note-this-error-code-is-no-longer-emitted-by-the-compiler">Note: this error code is no longer emitted by the compiler.</h4> <p><code>async fn</code>s are not yet supported in traits in Rust.</p> <p>Erroneous code example:</p> <pre data-language="rust">trait T {
    // Neither case is currently supported.
    async fn foo() {}
    async fn bar(&amp;self) {}
}</pre> <p><code>async fn</code>s return an <code>impl Future</code>, making the following two examples equivalent:</p> <pre data-language="rust">async fn foo() -&gt; User {
    unimplemented!()
}
// The async fn above gets desugared as follows:
fn foo(&amp;self) -&gt; impl Future&lt;Output = User&gt; + '_ {
    unimplemented!()
}</pre> <p>But when it comes to supporting this in traits, there are <a href="https://smallcultfollowing.com/babysteps/blog/2019/10/26/async-fn-in-traits-are-hard/">a few implementation issues</a>. One of them is returning <code>impl Trait</code> in traits is not supported, as it would require <a href="https://github.com/rust-lang/rust/issues/44265">Generic Associated Types</a> to be supported:</p> <pre data-language="rust">impl MyDatabase {
    async fn get_user(&amp;self) -&gt; User {
        unimplemented!()
    }
}

impl MyDatabase {
    fn get_user(&amp;self) -&gt; impl Future&lt;Output = User&gt; + '_ {
        unimplemented!()
    }
}</pre> <p>Until these issues are resolved, you can use the <a href="https://crates.io/crates/async-trait"><code>async-trait</code> crate</a>, allowing you to use <code>async fn</code> in traits by desugaring to "boxed futures" (<code>Pin&lt;Box&lt;dyn Future + Send + 'async&gt;&gt;</code>).</p> <p>Note that using these trait methods will result in a heap allocation per-function-call. This is not a significant cost for the vast majority of applications, but should be considered when deciding whether to use this functionality in the public API of a low-level function that is expected to be called millions of times a second.</p> <p>You might be interested in visiting the <a href="https://rust-lang.github.io/async-book/07_workarounds/05_async_in_traits.html">async book</a> for further information.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010 The Rust Project Developers<br>Licensed under the Apache License, Version 2.0 or the MIT license, at your option.<br>
    <a href="https://doc.rust-lang.org/error_codes/E0706.html" class="_attribution-link">https://doc.rust-lang.org/error_codes/E0706.html</a>
  </p>
</div>
