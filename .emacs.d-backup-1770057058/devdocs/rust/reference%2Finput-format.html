 <h1 id="input-format">Input format</h1>  <div class="grammar-container">
<p><strong><sup>Lexer</sup></strong>
<br>
<span class="grammar-text grammar-production" id="grammar-CHAR"><a href="input-format#railroad-CHAR">CHAR</a></span> → <span class="grammar-text">&lt;a Unicode scalar value&gt;</span></p>
<p><span class="grammar-text grammar-production" id="grammar-NUL"><a href="input-format#railroad-NUL">NUL</a></span> → U+0000</p>
<p><span class="grammar-text grammar-production" id="grammar-TAB"><a href="input-format#railroad-TAB">TAB</a></span> → U+0009</p>
<p><span class="grammar-text grammar-production" id="grammar-LF"><a href="input-format#railroad-LF">LF</a></span> → U+000A</p>
<p><span class="grammar-text grammar-production" id="grammar-CR"><a href="input-format#railroad-CR">CR</a></span> → U+000D</p>

<details class="grammar-railroad grammar-hidden"><summary>Syntax diagram</summary> <div style="width: 274px; height: auto; max-width: 100%; max-height: 100%" class="railroad-production" id="railroad-CHAR">
<svg class="railroad" viewbox="0 0 274 74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <rect class="railroad_canvas" height="100%" width="100%"></rect> <g class="verticalgrid"> <a class="link" xlink:href="input-format#grammar-CHAR"> <text class="comment" x="29" y="25"> CHAR</text> </a> <g class="sequence"> <path d=" M 10 53 a 5 5 0 0 1 5 -5 a 5 5 0 0 1 5 5 a 5 5 0 0 1 -5 5 a 5 5 0 0 1 -5 -5 m 10 0 h 5"></path> <g class="terminal"> <rect height="22" rx="10" ry="10" width="204" x="35" y="42"></rect> <text x="137" y="58"> a Unicode scalar value</text> </g> <path d=" M 249 53 h 5 a 5 5 0 0 1 5 -5 a 5 5 0 0 1 5 5 a 5 5 0 0 1 -5 5 a 5 5 0 0 1 -5 -5"></path> <path d=" M 25 53 h 10"></path> <path d=" M 239 53 h 10"></path> </g> </g> </svg> </div> <div style="width: 138px; height: auto; max-width: 100%; max-height: 100%" class="railroad-production" id="railroad-NUL">
<svg class="railroad" viewbox="0 0 138 74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <rect class="railroad_canvas" height="100%" width="100%"></rect> <g class="verticalgrid"> <a class="link" xlink:href="input-format#grammar-NUL"> <text class="comment" x="25" y="25"> NUL</text> </a> <g class="sequence"> <path d=" M 10 53 a 5 5 0 0 1 5 -5 a 5 5 0 0 1 5 5 a 5 5 0 0 1 -5 5 a 5 5 0 0 1 -5 -5 m 10 0 h 5"></path> <g class="terminal"> <rect height="22" rx="10" ry="10" width="68" x="35" y="42"></rect> <text x="69" y="58"> U+0000</text> </g> <path d=" M 113 53 h 5 a 5 5 0 0 1 5 -5 a 5 5 0 0 1 5 5 a 5 5 0 0 1 -5 5 a 5 5 0 0 1 -5 -5"></path> <path d=" M 25 53 h 10"></path> <path d=" M 103 53 h 10"></path> </g> </g> </svg> </div> <div style="width: 138px; height: auto; max-width: 100%; max-height: 100%" class="railroad-production" id="railroad-TAB">
<svg class="railroad" viewbox="0 0 138 74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <rect class="railroad_canvas" height="100%" width="100%"></rect> <g class="verticalgrid"> <a class="link" xlink:href="input-format#grammar-TAB"> <text class="comment" x="25" y="25"> TAB</text> </a> <g class="sequence"> <path d=" M 10 53 a 5 5 0 0 1 5 -5 a 5 5 0 0 1 5 5 a 5 5 0 0 1 -5 5 a 5 5 0 0 1 -5 -5 m 10 0 h 5"></path> <g class="terminal"> <rect height="22" rx="10" ry="10" width="68" x="35" y="42"></rect> <text x="69" y="58"> U+0009</text> </g> <path d=" M 113 53 h 5 a 5 5 0 0 1 5 -5 a 5 5 0 0 1 5 5 a 5 5 0 0 1 -5 5 a 5 5 0 0 1 -5 -5"></path> <path d=" M 25 53 h 10"></path> <path d=" M 103 53 h 10"></path> </g> </g> </svg> </div> <div style="width: 138px; height: auto; max-width: 100%; max-height: 100%" class="railroad-production" id="railroad-LF">
<svg class="railroad" viewbox="0 0 138 74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <rect class="railroad_canvas" height="100%" width="100%"></rect> <g class="verticalgrid"> <a class="link" xlink:href="input-format#grammar-LF"> <text class="comment" x="22" y="25"> LF</text> </a> <g class="sequence"> <path d=" M 10 53 a 5 5 0 0 1 5 -5 a 5 5 0 0 1 5 5 a 5 5 0 0 1 -5 5 a 5 5 0 0 1 -5 -5 m 10 0 h 5"></path> <g class="terminal"> <rect height="22" rx="10" ry="10" width="68" x="35" y="42"></rect> <text x="69" y="58"> U+000A</text> </g> <path d=" M 113 53 h 5 a 5 5 0 0 1 5 -5 a 5 5 0 0 1 5 5 a 5 5 0 0 1 -5 5 a 5 5 0 0 1 -5 -5"></path> <path d=" M 25 53 h 10"></path> <path d=" M 103 53 h 10"></path> </g> </g> </svg> </div> <div style="width: 138px; height: auto; max-width: 100%; max-height: 100%" class="railroad-production" id="railroad-CR">
<svg class="railroad" viewbox="0 0 138 74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <rect class="railroad_canvas" height="100%" width="100%"></rect> <g class="verticalgrid"> <a class="link" xlink:href="input-format#grammar-CR"> <text class="comment" x="22" y="25"> CR</text> </a> <g class="sequence"> <path d=" M 10 53 a 5 5 0 0 1 5 -5 a 5 5 0 0 1 5 5 a 5 5 0 0 1 -5 5 a 5 5 0 0 1 -5 -5 m 10 0 h 5"></path> <g class="terminal"> <rect height="22" rx="10" ry="10" width="68" x="35" y="42"></rect> <text x="69" y="58"> U+000D</text> </g> <path d=" M 113 53 h 5 a 5 5 0 0 1 5 -5 a 5 5 0 0 1 5 5 a 5 5 0 0 1 -5 5 a 5 5 0 0 1 -5 -5"></path> <path d=" M 25 53 h 10"></path> <path d=" M 103 53 h 10"></path> </g> </g> </svg> </div> </details>
</div>   <p>This chapter describes how a source file is interpreted as a sequence of tokens.</p> <p>See <a href="crates-and-source-files">Crates and source files</a> for a description of how programs are organised into files.</p>  <h2 id="source-encoding">Source encoding</h2> <div class="rule" id="r-input.encoding.utf8"> <br><div class="test-link"> <a href="javascript:void(0)" onclick="spec_toggle_tests('input.encoding.utf8');"><span>Tests</span></a>
</div> </div> <div id="tests-input.encoding.utf8" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/macros/not-utf8.rs">tests/ui/macros/not-utf8.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/utf16-be-without-bom.rs">tests/ui/parser/utf16-be-without-bom.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/utf16-le-without-bom.rs">tests/ui/parser/utf16-le-without-bom.rs</a></li> </ul>
</div> <p>Each source file is interpreted as a sequence of Unicode characters encoded in UTF-8.</p> <div class="rule" id="r-input.encoding.invalid"> <br><div class="test-link"> <a href="javascript:void(0)" onclick="spec_toggle_tests('input.encoding.invalid');"><span>Tests</span></a>
</div> </div> <div id="tests-input.encoding.invalid" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/macros/not-utf8.rs">tests/ui/macros/not-utf8.rs</a></li> </ul>
</div> <p>It is an error if the file is not valid UTF-8.</p> <div class="rule" id="r-input.byte-order-mark"> <br><div class="test-link"> <a href="javascript:void(0)" onclick="spec_toggle_tests('input.byte-order-mark');"><span>Tests</span></a>
</div> </div> <div id="tests-input.byte-order-mark" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/codemap_tests/utf8-bom.rs">tests/ui/codemap_tests/utf8-bom.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/json/json-bom-plus-crlf-multifile.rs">tests/ui/json/json-bom-plus-crlf-multifile.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/json/json-bom-plus-crlf.rs">tests/ui/json/json-bom-plus-crlf.rs</a></li> </ul>
</div> <h2 id="byte-order-mark-removal">Byte order mark removal</h2> <p>If the first character in the sequence is <code>U+FEFF</code> (<a href="https://en.wikipedia.org/wiki/Byte_order_mark#UTF-8">BYTE ORDER MARK</a>), it is removed.</p> <div class="rule" id="r-input.crlf"> <br><div class="test-link"> <a href="javascript:void(0)" onclick="spec_toggle_tests('input.crlf');"><span>Tests</span></a>
</div> </div> <div id="tests-input.crlf" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/json/json-bom-plus-crlf-multifile.rs">tests/ui/json/json-bom-plus-crlf-multifile.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/json/json-bom-plus-crlf.rs">tests/ui/json/json-bom-plus-crlf.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/lexer/lexer-crlf-line-endings-string-literal-doc-comment.rs">tests/ui/lexer/lexer-crlf-line-endings-string-literal-doc-comment.rs</a></li> </ul>
</div> <h2 id="crlf-normalization">CRLF normalization</h2> <p>Each pair of characters <code>U+000D</code> (CR) immediately followed by <code>U+000A</code> (LF) is replaced by a single <code>U+000A</code> (LF). This happens once, not repeatedly, so after the normalization, there can still exist <code>U+000D</code> (CR) immediately followed by <code>U+000A</code> (LF) in the input (e.g. if the raw input contained “CR CR LF LF”).</p> <p>Other occurrences of the character <code>U+000D</code> (CR) are left in place (they are treated as <a href="whitespace">whitespace</a>).</p> <div class="rule" id="r-input.shebang"> <br><div class="test-link"> <a href="javascript:void(0)" onclick="spec_toggle_tests('input.shebang');"><span>Tests</span></a>
</div> </div> <div id="tests-input.shebang" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/issue-71471-ignore-tidy.rs">tests/ui/parser/shebang/issue-71471-ignore-tidy.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/shebang-comment.rs">tests/ui/parser/shebang/shebang-comment.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/shebang-empty.rs">tests/ui/parser/shebang/shebang-empty.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/shebang-must-start-file.rs">tests/ui/parser/shebang/shebang-must-start-file.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/shebang-space.rs">tests/ui/parser/shebang/shebang-space.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/valid-shebang.rs">tests/ui/parser/shebang/valid-shebang.rs</a></li> </ul>
</div> <h2 id="shebang-removal">Shebang removal</h2>  <p>If the remaining sequence begins with the characters <code>#!</code>, the characters up to and including the first <code>U+000A</code> (LF) are removed from the sequence.</p> <p>For example, the first line of the following file would be ignored:</p>  <pre data-language="rust">#!/usr/bin/env rustx

fn main() {
    println!("Hello!");
}</pre> <div class="rule" id="r-input.shebang.inner-attribute"> <br><div class="test-link"> <a href="javascript:void(0)" onclick="spec_toggle_tests('input.shebang.inner-attribute');"><span>Tests</span></a>
</div> </div> <div id="tests-input.shebang.inner-attribute" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/multiline-attrib.rs">tests/ui/parser/shebang/multiline-attrib.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/regular-attrib.rs">tests/ui/parser/shebang/regular-attrib.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/shebang-and-attrib.rs">tests/ui/parser/shebang/shebang-and-attrib.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/shebang-doc-comment.rs">tests/ui/parser/shebang/shebang-doc-comment.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.91.1/tests/ui/parser/shebang/sneaky-attrib.rs">tests/ui/parser/shebang/sneaky-attrib.rs</a></li> </ul>
</div> <p>As an exception, if the <code>#!</code> characters are followed (ignoring intervening <a href="comments">comments</a> or <a href="whitespace">whitespace</a>) by a <code>[</code> token, nothing is removed. This prevents an <a href="attributes">inner attribute</a> at the start of a source file being removed.</p> <div class="alert alert-note"> <blockquote> <p class="alert-title"><svg viewbox="0 0 16 16" width="18" height="18"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p> <p>The standard library <a href="https://doc.rust-lang.org/core/macro.include.html"><code>include!</code></a> macro applies byte order mark removal, CRLF normalization, and shebang removal to the file it reads. The <a href="https://doc.rust-lang.org/core/macro.include_str.html"><code>include_str!</code></a> and <a href="https://doc.rust-lang.org/core/macro.include_bytes.html"><code>include_bytes!</code></a> macros do not.</p> </blockquote> </div>  <h2 id="tokenization">Tokenization</h2> <p>The resulting sequence of characters is then converted into tokens as described in the remainder of this chapter.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010 The Rust Project Developers<br>Licensed under the Apache License, Version 2.0 or the MIT license, at your option.<br>
    <a href="https://doc.rust-lang.org/reference/input-format.html" class="_attribution-link">https://doc.rust-lang.org/reference/input-format.html</a>
  </p>
</div>
