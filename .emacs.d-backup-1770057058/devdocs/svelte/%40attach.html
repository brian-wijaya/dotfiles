<header> <h1>{@attach ...}</h1></header> <aside class="on-this-page svelte-wtnkd6"><label class="svelte-wtnkd6"> <h3 class="svelte-wtnkd6">On this page</h3></label> <nav class="svelte-wtnkd6"><ul class="svelte-wtnkd6">
<li class="svelte-wtnkd6"><a href="@attach" class="svelte-wtnkd6 active">{@attach ...}</a></li> <li class="svelte-wtnkd6"><a href="#Attachment-factories" class="svelte-wtnkd6">Attachment factories</a></li>
<li class="svelte-wtnkd6"><a href="#Inline-attachments" class="svelte-wtnkd6">Inline attachments</a></li>
<li class="svelte-wtnkd6"><a href="#Passing-attachments-to-components" class="svelte-wtnkd6">Passing attachments to components</a></li>
<li class="svelte-wtnkd6"><a href="#Controlling-when-attachments-re-run" class="svelte-wtnkd6">Controlling when attachments re-run</a></li>
<li class="svelte-wtnkd6"><a href="#Creating-attachments-programmatically" class="svelte-wtnkd6">Creating attachments programmatically</a></li>
<li class="svelte-wtnkd6"><a href="#Converting-actions-to-attachments" class="svelte-wtnkd6">Converting actions to attachments</a></li>
</ul></nav></aside> <div class="text content"><div class="text svelte-zb31s9">
<p>Attachments are functions that run in an <a href="$effect">effect</a> when an element is mounted to the DOM or when <a href="$state">state</a> read inside the function updates.</p> <p>Optionally, they can return a function that is called before the attachment re-runs, or after the element is later removed from the DOM.</p> <blockquote class="note">
<p> Attachments are available in Svelte 5.29 and newer.</p> </blockquote>
<div class="code-block">
<div class="controls">
<span class="filename" data-ext=".svelte">App</span><input class="ts-toggle raised" checked title="Toggle language" type="checkbox" aria-label="Toggle JS/TS">
</div>
<pre data-language="typescript" class="shiki css-variables" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">&lt;script&gt;
	/** @type {import('svelte/attachments').Attachment} */
	function myAttachment(element) {
		console.log(element.nodeName); // 'DIV'

		return () =&gt; {
			console.log('cleaning up');
		};
	}
&lt;/script&gt;

&lt;div {@attach myAttachment}&gt;...&lt;/div&gt;</pre>
<pre data-language="typescript" class="shiki css-variables" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">&lt;script lang="ts"&gt;
	import type { Attachment } from 'svelte/attachments';

	const myAttachment: Attachment = (element) =&gt; {
		console.log(element.nodeName); // 'DIV'

		return () =&gt; {
			console.log('cleaning up');
		};
	};
&lt;/script&gt;

&lt;div {@attach myAttachment}&gt;...&lt;/div&gt;</pre>
</div>
<p>An element can have any number of attachments.</p> <h2 id="Attachment-factories">
<span>Attachment factories</span>
</h2>
<p>A useful pattern is for a function, such as <code>tooltip</code> in this example, to <em>return</em> an attachment (<a href="https://svelte.dev/playground/untitled#H4sIAAAAAAAAE3VT0XLaMBD8lavbDiaNCUlbHhTItG_5h5AH2T5ArdBppDOEMv73SkbGJGnH47F9t3un3TsfMyO3mInsh2SW1Sa7zlZKo8_E0zHjg42pGAjxBPxp7cTvUHOMldLjv-IVGUbDoUw295VTlh-WZslqa8kxsLL2ACtHWxh175NffnQfAAGikSGxYQGfPEvGfPSIWtOH0TiBVo2pWJEBJtKhQp4YYzjG9JIdcuMM5IZqHMPioY8vOSA997zQoevf4a7heO7cdp34olRiTGr07OhwH1IdoO2A7dLMbwahZq6MbRhKZWqxk7rBxTGVbuHmhCgb5qDgmIx_J6XtHHukHTrYYqx_YpzYng8aO4RYayql7hU-1ZJl0akqHBE_D9KLolwL-Dibzc7iSln9XjtqTF1UpMkJ2EmXR-BgQErsN4pxIJKr0RVO1qrxAqaTO4fbc9bKulZm3cfDY3aZDgvFGErWjmzhN7KmfX5rXyDeX8Pt1mU-hXjdBOrtuB97vK4GPUtmJ41XcRMEGDLD8do0nJ73zhUhSlyRw0t3vPqD8cjfLs-axiFgNBrkUd9Ulp50c-GLxlXAVlJX-ffpZyiSn7H0eLCUySZQcQdXlxj4El0Yv_FZvIKElqqGTruVLhzu7VRKCh22_5toOyxsWqLwwzK-cCbYNdg-hy-p9D7sbiZWUnts_wLUOF3CJgQAAA==">demo</a>):</p> <div class="code-block">
<div class="controls">
<span class="filename" data-ext=".svelte">App</span><input class="ts-toggle raised" checked title="Toggle language" type="checkbox" aria-label="Toggle JS/TS">
</div>
<pre data-language="typescript" class="shiki css-variables" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">&lt;script&gt;
	import tippy from 'tippy.js';

	let content = $state('Hello!');

	/**
	 * @param {string} content
	 * @returns {import('svelte/attachments').Attachment}
	 */
	function tooltip(content) {
		return (element) =&gt; {
			const tooltip = tippy(element, { content });
			return tooltip.destroy;
		};
	}
&lt;/script&gt;

&lt;input bind:value={content} /&gt;

&lt;button {@attach tooltip(content)}&gt;
	Hover me
&lt;/button&gt;</pre>
<pre data-language="typescript" class="shiki css-variables" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">&lt;script lang="ts"&gt;
	import tippy from 'tippy.js';
	import type { Attachment } from 'svelte/attachments';

	let content = $state('Hello!');

	function tooltip(content: string): Attachment {
		return (element) =&gt; {
			const tooltip = tippy(element, { content });
			return tooltip.destroy;
		};
	}
&lt;/script&gt;

&lt;input bind:value={content} /&gt;

&lt;button {@attach tooltip(content)}&gt;
	Hover me
&lt;/button&gt;</pre>
</div>
<p>Since the <code>tooltip(content)</code> expression runs inside an <a href="$effect">effect</a>, the attachment will be destroyed and recreated whenever <code>content</code> changes. The same thing would happen for any state read <em>inside</em> the attachment function when it first runs. (If this isn’t what you want, see <a href="#Controlling-when-attachments-re-run">Controlling when attachments re-run</a>.)</p> <h2 id="Inline-attachments">
<span>Inline attachments</span>
</h2>
<p>Attachments can also be created inline (<a href="https://svelte.dev/playground/untitled#H4sIAAAAAAAAE71Wf3OaWBT9KoyTTnW3MS-I3dYmnWXVtnRAazRJzbozRSQEApiRhwKO333vuY8m225m_9yZGOT9OPfcc84D943UTfxGr_G7K6Xr3TVeNW7D2M8avT_3DVk-YAoDNF4vNB8e2tnWjyXGlm7mPzfurVPpp5JgGmeZtwkf5PtFupCxLzVvHa832rl2lElX-s2Xm2DZFNqp_hs-rZetd4v07ORpT3qmQHu7MF2td0BZp8k6z_xkvfXP902_pZ2_1_aYWEiqm0kN8I4r79qbdZ6umnq3q_2iNf22F4dE6qt2oimwdpim_uY6XMm7Fuo-IQT_iTD_CeGTHwZ38ieIJUFQRxirR1Xf39Dw0X5z0I72Af4tD61vvPNwWKQnqmfPTbduhsEd2J3vO_oBd3dc6fF2X7umNdWGf0vBRhSS6qoV7cCXfTXWfKmvWG61_si_vfU92Wz-E4RhsLhNIYinsox9QKGVd8-tuACCeKXRX12P-T_eKf7fhTq0Hvt-f3ailtSeoxJHRo1-58NoPe1UiBc1hkL8Yeh45y_vQ3mcuNl9T8s3cXPRWLnS7YWJG_gn2Tb4tUjid8jua-PVl08j_ab8I14mH8Llx0s5Tz5Err4ql52r_GYg0mVy1bEGZuD0ze64b5TWYFiM-16wSuJ4JT5vfVpDcztrcG_YkRU4s6HxufzDWF4XuVeJ1P10IbzBemt3Vp1V2e04ZXfrJd7Wicyd039brRIv_RIVu_nXi7X1cfL2sy66ztToUp1TO7qJ7NlwZ0f30pld5qNSVE5o6PbMojFHjgZB7oSicPpGteyLclQap7SvY0dXtM_LR1NT2JFHey3aaxa0VxCeYJ7RMHemoiCcgPZV9pR7o7kgcOjeGliYk9hjDZx8FAq6enwlTPSZj_vYPw9Il64dXdIY8ZmapzwfEd8-1ZyaxWhqkIZOibXUd-6Upqi1pD4uMicCV1GA_7zi73UN8BaF4sC8peJtMjfmjbHZBFwq5ov50qRaE0l96NZggnW4KqypYRAW-uhSz9ADvklwJF2J-5W0Z5fQPBhDX92R6I_0IFxRgDftge4l4dP-gH1hjD7uqU6fsOEZ9UNrCdPB-nys6uXgY6O3ZMd9sy5T9PghqrWHdjo4jB51CgLiKJaDYYA-7WgYONf1FbjkI-mE3EAfUY_rijfuJ_CVPaR50oe9JF7Q0pI8Dw3osxxYHdYPGbp2CnwHF8KvwJv2wEv0Z3ilQI6U9uwbZxbYJXvEmjjQjjCHkvNLvNg3yhzXQd1olamsT4IRrZmX0MUDpwL7R8zzHj7pSh9hPHFSHjLezKqAST51uC5zmtQ87skDUaneLokT5RbXkPWSYz53Abgjc8_o4KFGUZ-Hgv2Z1l5OTYM9D-HfUD0L-EwxH5wRnIG61gS-khfgY1bq7IAP_DA4l5xRuh9xlm8yGjutc8t-wHtkhWv3hc7aqGwiK5KzgvM5xRkZYn193uEln-su55j1GaIv7oM4iPrsVHiG0Dx7TR9-1lBfqFdwfvSd5LNL5xyZVp5NoHFZ57FkfiF6vKs4k5zvIfrX5xX6MXmt0gM5MTu8DjnhukrHHzTRd3jm0dma0_f_x5cxP9f4jBdqHvmbq2fUjzqcKh2Cp-yWj9ntcHanXmBXxhu7Q--eyjhfNFpaV7zgz4nWEUb7zUOhpevjjf_gu_KZ99pxFlZ-T3sttkmYqrco_26q35v0Ewzv5EZPbnL_8BfduWGMnyyN3q0bZ_7hb_7KG_L4CQAA">demo</a>):</p> <div class="code-block">
<div class="controls">
<span class="filename" data-ext=".svelte">App</span>
</div>
<pre data-language="typescript" class="shiki css-variables" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">&lt;canvas
	width={32}
	height={32}
	{@attach (canvas) =&gt; {
		const context = canvas.getContext('2d');

		$effect(() =&gt; {
			context.fillStyle = color;
			context.fillRect(0, 0, canvas.width, canvas.height);
		});
	}}
&gt;&lt;/canvas&gt;</pre>
</div>
<blockquote class="note">
<p> The nested effect runs whenever <code>color</code> changes, while the outer effect (where <code>canvas.getContext(...)</code> is called) only runs once, since it doesn’t read any reactive state.</p> </blockquote>
<h2 id="Passing-attachments-to-components">
<span>Passing attachments to components</span>
</h2>
<p>When used on a component, <code>{@attach ...}</code> will create a prop whose key is a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol"><code>Symbol</code></a>. If the component then <a href="https://svelte.dev/tutorial/svelte/spread-props">spreads</a> props onto an element, the element will receive those attachments.</p> <p>This allows you to create <em>wrapper components</em> that augment elements (<a href="https://svelte.dev/playground/untitled#H4sIAAAAAAAAE3VUS3ObMBD-KxvajnFqsJM2PhA7TXrKob31FjITAbKtRkiMtDhJPfz3LiAMdpxhGJvdb1_fPnaeYjn3Iu-WIbJ04028lZDcetHDzsO3olbVApI74F1RhHbLJdayhFl-Sp5qhVwhufEWNjWiwJtYxSjyQhsEFEXxBiujcxg1_8O_dnQ9APwsEbVyiHDafjrvDZCgkiO4MLCEzxYZcn90z6XUZ6OxA61KlaIgV6i1pFC-sxjDrlbHaDiWRoGvdMbHsLzp5DES0mJnRxGaRBvcBHb7yFUTCQeunEWYcYtGv12TqgFUDbCK1WLaM6IWQhUlQiJUFm2ZLPly51xXMG0Rjoyd69C7UqqG2nu95QZyXvtvLVpri2-SN4hoLXXCZFfhQ8aQBU1VgdEaH_vSgyBZR_BpPp_vi0tY-rw2ulRZkGqpTQRbZvwa2BPgFC8bgbw31CbjJjAsE6WNYBZeGp7vtQXLMqHWnZx-5kM1TR5ycpkZXQR2wzL94l8Ur1C_3-g168SfQf1MyfRi3LW9fs77emJEw5QV9SREoLTq06tcczq7d6xEUcJX2vAhO1b843XK34e5unZEMBr15ekuKEusluWAF8lXhE2ZTP2r2RcIHJ-163FPKerCgYJLOB9i4GvNwviI5-gAQiFFBk3tBTOU3HFXEk0R8o86WvUD64aINhv5K3oRmpJXkw8uxMG6Hh6JY9X7OwGSqfUy9tDG3sHNoEi0d_d_fv9qndxRU0VClFqo3KVo3U655Hnt1PXB3Qra2Y2QGdEwgTAMCxopsoxOe6SD0gD8movDhT0LAnhqlE8gVCpLWnRoV7OJCkFAwEXitrYL1W7p7pbiE_P7XH6E_rihODm5s52XtiH9Ekaw0VgI9exadWL1uoEYjPtg2672k5szsxbKyWB2fdT0w5Y_0hcT8oXOlRetmLS8-g-6TLXXQgYAAA==">demo</a>):</p> <div class="code-block">
<div class="controls">
<span class="filename" data-ext=".svelte">Button</span><input class="ts-toggle raised" checked title="Toggle language" type="checkbox" aria-label="Toggle JS/TS">
</div>
<pre data-language="typescript" class="shiki css-variables" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">&lt;script&gt;
	/** @type {import('svelte/elements').HTMLButtonAttributes} */
	let { children, ...props } = $props();
&lt;/script&gt;

&lt;!-- `props` includes attachments --&gt;
&lt;button {...props}&gt;
	{@render children?.()}
&lt;/button&gt;</pre>
<pre data-language="typescript" class="shiki css-variables" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">&lt;script lang="ts"&gt;
	import type { HTMLButtonAttributes } from 'svelte/elements';

	let { children, ...props }: HTMLButtonAttributes = $props();
&lt;/script&gt;

&lt;!-- `props` includes attachments --&gt;
&lt;button {...props}&gt;
	{@render children?.()}
&lt;/button&gt;</pre>
</div>
<div class="code-block">
<div class="controls">
<span class="filename" data-ext=".svelte">App</span><input class="ts-toggle raised" checked title="Toggle language" type="checkbox" aria-label="Toggle JS/TS">
</div>
<pre data-language="typescript" class="shiki css-variables" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">&lt;script&gt;
	import tippy from 'tippy.js';
	import Button from './Button.svelte';

	let content = $state('Hello!');

	/**
	 * @param {string} content
	 * @returns {import('svelte/attachments').Attachment}
	 */
	function tooltip(content) {
		return (element) =&gt; {
			const tooltip = tippy(element, { content });
			return tooltip.destroy;
		};
	}
&lt;/script&gt;

&lt;input bind:value={content} /&gt;

&lt;Button {@attach tooltip(content)}&gt;
	Hover me
&lt;/Button&gt;</pre>
<pre data-language="typescript" class="shiki css-variables" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">&lt;script lang="ts"&gt;
	import tippy from 'tippy.js';
	import Button from './Button.svelte';
	import type { Attachment } from 'svelte/attachments';

	let content = $state('Hello!');

	function tooltip(content: string): Attachment {
		return (element) =&gt; {
			const tooltip = tippy(element, { content });
			return tooltip.destroy;
		};
	}
&lt;/script&gt;

&lt;input bind:value={content} /&gt;

&lt;Button {@attach tooltip(content)}&gt;
	Hover me
&lt;/Button&gt;</pre>
</div>
<h2 id="Controlling-when-attachments-re-run">
<span>Controlling when attachments re-run</span>
</h2>
<p>Attachments, unlike <a href="use">actions</a>, are fully reactive: <code>{@attach foo(bar)}</code> will re-run on changes to <code>foo</code> <em>or</em> <code>bar</code> (or any state read inside <code>foo</code>):</p> <div class="code-block">

<pre data-language="typescript" class="shiki css-variables twoslash lsp" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">function foo(bar) {
	return (node) =&gt; {
		veryExpensiveSetupWork(node);
		update(node, bar);
	};
}</pre>
</div>
<p>In the rare case that this is a problem (for example, if <code>foo</code> does expensive and unavoidable setup work) consider passing the data inside a function and reading it in a child effect:</p> <div class="code-block">

<pre data-language="typescript" class="shiki css-variables twoslash lsp" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">function foo(getBar) {
	return (node) =&gt; {
		veryExpensiveSetupWork(node);

		
namespace $effect
namespace $effect</pre>
<div class="twoslash-popup-docs">
<p>Runs code when a component is mounted to the DOM, and then whenever its dependencies change, i.e. <code>$state</code> or <code>$derived</code> values. <span class="highlight add">The timing of the execution is after the DOM has been updated.</span></p> <span class="highlight add"><p>Example:</p></span> <span class="highlight add"><div class="code-block">

<pre data-language="typescript" class="shiki css-variables" style="background-color:var(--shiki-background);color:var(--shiki-foreground)">$effect(() =&gt; console.log('The count is now ' + count));</pre>
</div>
<p>If you return a function from the effect, it will be called right before the effect is run again, or when the component is unmounted.</p></span> <span class="highlight add"><p>Does not run during server-side rendering.</p></span> <span class="highlight add"><p><a href="$effect">https://svelte.dev/docs/svelte/$effect</a></p></span> 
</div>
<div class="twoslash-popup-docs twoslash-popup-docs-tags"><div class="tags">
<span class="tag">@param</span><span class="value"><span class="param">fn</span> The function to execute</span>
</div></div>$effect<span style="color:var(--shiki-foreground)">(()</span> <span style="color:var(--shiki-token-keyword)">=&gt;</span> <span style="color:var(--shiki-foreground)">{</span> <span class="highlight add"><span class="line"> <span class="twoslash-error"><span style="color:var(--shiki-token-function)">update</span></span><span style="color:var(--shiki-foreground)">(</span><span style="color:var(--shiki-foreground)"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:var(--shiki-foreground)">node</span><span style="color:var(--shiki-token-punctuation)">:</span> <span style="color:var(--shiki-foreground)">any</span></code></span>node</span></span><span style="color:var(--shiki-token-punctuation)">,</span> <span style="color:var(--shiki-token-function)"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:var(--shiki-foreground)">getBar</span><span style="color:var(--shiki-token-punctuation)">:</span> <span style="color:var(--shiki-foreground)">any</span></code></span>getBar</span></span><span style="color:var(--shiki-foreground)">());</span></span></span> <span class="highlight add"><span class="line"> <span style="color:var(--shiki-foreground)">});</span></span></span> <span class="line"> <span style="color:var(--shiki-foreground)">}</span></span> <span class="line"><span style="color:var(--shiki-foreground)">}</span></span>
</div>
<h2 id="Creating-attachments-programmatically">
<span>Creating attachments programmatically</span>
</h2>
<p>To add attachments to an object that will be spread onto a component or element, use <a href="svelte-attachments#createAttachmentKey"><code>createAttachmentKey</code></a>.</p> <h2 id="Converting-actions-to-attachments">
<span>Converting actions to attachments</span>
</h2>
<p>If you’re using a library that only provides actions, you can convert them to attachments with <a href="svelte-attachments#fromAction"><code>fromAction</code></a>, allowing you to (for example) use them with components.</p> </div></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2016–2025 Rich Harris and contributors<br>Licensed under the MIT License.<br>
    <a href="https://svelte.dev/docs/svelte/@attach" class="_attribution-link">https://svelte.dev/docs/svelte/@attach</a>
  </p>
</div>
