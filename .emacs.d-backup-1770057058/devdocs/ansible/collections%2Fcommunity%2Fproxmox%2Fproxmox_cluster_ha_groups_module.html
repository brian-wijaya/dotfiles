<section id="community-proxmox-proxmox-cluster-ha-groups-module-management-of-ha-groups-in-proxmox-ve-cluster"> <h1>community.proxmox.proxmox_cluster_ha_groups module – Management of HA groups in Proxmox VE Cluster</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/proxmox/">community.proxmox collection</a> (version 1.3.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.proxmox</code>. You need further requirements to be able to use this module, see <a class="reference internal" href="#ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-requirements"><span class="std std-ref">Requirements</span></a> for details.</p> <p>To use it in a playbook, specify: <code>community.proxmox.proxmox_cluster_ha_groups</code>.</p> </div> <p class="ansible-version-added">New in community.proxmox 1.1.0</p>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#attributes" id="id4">Attributes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Configure HA groups via <code>/cluster/ha/groups</code>.</li> </ul> </section> <section id="requirements"> <h2 id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>proxmoxer &gt;= 2.0</li> <li>requests</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-api-host"><strong>api_host</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specify the target host of the Proxmox VE cluster.</p> <p>Uses the <code>PROXMOX_HOST</code> environment variable if not specified.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-api-password"><strong>api_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specify the password to authenticate with.</p> <p>Uses the <a class="reference internal" href="../../environment_variables#envvar-PROXMOX_PASSWORD"><code>PROXMOX_PASSWORD</code></a> environment variable if not specified.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-api-port"><strong>api_port</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specify the target port of the Proxmox VE cluster.</p> <p>Uses the <code>PROXMOX_PORT</code> environment variable if not specified.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-api-token-id"><strong>api_token_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specify the token ID.</p> <p>Uses the <a class="reference internal" href="../../environment_variables#envvar-PROXMOX_TOKEN_ID"><code>PROXMOX_TOKEN_ID</code></a> environment variable if not specified.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-api-token-secret"><strong>api_token_secret</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specify the token secret.</p> <p>Uses the <a class="reference internal" href="../../environment_variables#envvar-PROXMOX_TOKEN_SECRET"><code>PROXMOX_TOKEN_SECRET</code></a> environment variable if not specified.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-api-user"><strong>api_user</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specify the user to authenticate with.</p> <p>Uses the <a class="reference internal" href="../../environment_variables#envvar-PROXMOX_USER"><code>PROXMOX_USER</code></a> environment variable if not specified.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-comment"><strong>comment</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Description</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>group name</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-nodes"><strong>nodes</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of cluster node members, where a priority can be given to each node. A resource bound to a group will run on the available nodes with the highest priority. If there are more nodes in the highest priority class, the services will get distributed to those nodes. The priorities have a relative meaning only. The higher the number, the higher the priority. It can either be a string <code>node_name:priority,node_name:priority</code> or an actual list of strings.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-nofailback"><strong>nofailback</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The CRM tries to run services on the node with the highest priority. If a node with higher priority comes online, the CRM migrates the service to that node. Setting <code><a class="reference internal" href="#ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-nofailback"><span class="std std-ref">nofailback=true</span></a></code> prevents that behavior.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-restricted"><strong>restricted</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Resources bound to restricted groups may only run on nodes defined by the group. The resource will be placed in the stopped state if no group node member is online. Resources on unrestricted groups may run on any cluster node if all group members are offline, but they will migrate back as soon as a group member comes online. One can implement a ‘preferred node’ behavior using an unrestricted group with only one member.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the HA groups should be there (created if missing) or not (deleted if they exist).</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"present"</code></li> <li><code>"absent"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-parameter-validate-certs"><strong>validate_certs</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If <code>false</code>, SSL certificates will not be validated.</p> <p>This should only be used on personally controlled sites using self-signed certificates.</p> <p>Uses the <code>PROXMOX_VALIDATE_CERTS</code> environment variable if not specified.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr>  </table> </section> <section id="attributes"> <h2>Attributes</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Attribute</p></th> <th class="head"><p>Support</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-attribute-action-group"><strong>action_group</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-property">Action group:</strong> <strong class="ansible-attribute-support-full">community.proxmox.proxmox</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Use <code>group/community.proxmox.proxmox</code> in <code>module_defaults</code> to set defaults for this module.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-attribute-check-mode"><strong>check_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Can run in <code>check_mode</code> and return changed status prediction without modifying target.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-cluster-ha-groups-module-attribute-diff-mode"><strong>diff_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Will return details on what has changed (or possibly needs changing in <code>check_mode</code>), when in diff mode.</p> </div></td> </tr>  </table> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Create HA group
  community.proxmox.proxmox_cluster_ha_groups:
    api_host: "{{ ansible_host }}"
    api_password: "{{ proxmox_root_pw | default(lookup('ansible.builtin.env', 'PROXMOX_PASSWORD', default='')) }}"
    api_user: root@pam

    state: "present"
    name: ha0
    comment: yes
    nodes: node0:0,node1:1
    nofailback: true
    restricted: false

- name: Delete HA group
  community.proxmox.proxmox_cluster_ha_groups:
    api_host: "{{ ansible_host }}"
    api_password: "{{ proxmox_root_pw | default(lookup('ansible.builtin.env', 'PROXMOX_PASSWORD', default='')) }}"
    api_user: root@pam

    state: "absent"
    name: ha0
</pre> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Markus Kötter (@commonism)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.proxmox/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.proxmox" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.proxmox/issues/new/choose" rel="noopener external" target="_blank">Report an issue</a></span></li> <li><span><a class="reference internal" href="index#communication-for-community-proxmox"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2025 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/proxmox/proxmox_cluster_ha_groups_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/proxmox/proxmox_cluster_ha_groups_module.html</a>
  </p>
</div>
