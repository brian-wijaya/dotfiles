<section id="community-general-vdo-module-module-to-control-vdo"> <h1>community.general.vdo module – Module to control VDO</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/general/">community.general collection</a> (version 10.7.3).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.general</code>. You need further requirements to be able to use this module, see <a class="reference internal" href="#ansible-collections-community-general-vdo-module-requirements"><span class="std std-ref">Requirements</span></a> for details.</p> <p>To use it in a playbook, specify: <code>community.general.vdo</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#attributes" id="id4">Attributes</a></li> <li><a class="reference internal" href="#notes" id="id5">Notes</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>This module controls the VDO dedupe and compression device.</li> <li>VDO, or Virtual Data Optimizer, is a device-mapper target that provides inline block-level deduplication, compression, and thin provisioning capabilities to primary storage.</li> </ul> </section> <section id="requirements"> <h2 id="ansible-collections-community-general-vdo-module-requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>PyYAML</li> <li>kmod-kvdo</li> <li>vdo</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-ackthreads"><strong>ackthreads</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the number of threads to use for acknowledging completion of requested VDO I/O operations. Valid values are integer values from <code>1</code> to <code>100</code> (lower numbers are preferable due to overhead). The default is <code>1</code>. Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-activated"><strong>activated</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The <code>activate</code> status for a VDO volume. If this is set to <code>false</code>, the VDO volume cannot be started, and it does not start on system startup. However, on initial creation, a VDO volume with <code><a class="reference internal" href="#ansible-collections-community-general-vdo-module-parameter-activated"><span class="std std-ref">activated=false</span></a></code> is set to be running until stopped. This is the default behavior of the <code>vdo create</code> command; it provides the user an opportunity to write a base amount of metadata (filesystem, LVM headers, and so on) to the VDO volume prior to stopping the volume, and leaving it deactivated until ready to use.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-biothreads"><strong>biothreads</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the number of threads to use for submitting I/O operations to the storage device. Valid values are integer values from <code>1</code> to <code>100</code> (lower numbers are preferable due to overhead). The default is <code>4</code>. Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-blockmapcachesize"><strong>blockmapcachesize</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The amount of memory allocated for caching block map pages, in megabytes (or may be issued with an LVM-style suffix of K, M, G, or T). The default (and minimum) value is <code>128M</code>. The value specifies the size of the cache; there is a 15% memory usage overhead. Each 1.25G of block map covers 1T of logical blocks, therefore a small amount of block map cache memory can cache a significantly large amount of block map data.</p> <p>Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-compression"><strong>compression</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Configures whether compression is enabled. The default for a created volume is <code>enabled</code>. Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"disabled"</code></li> <li><code>"enabled"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-cputhreads"><strong>cputhreads</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the number of threads to use for CPU-intensive work such as hashing or compression. Valid values are integer values from <code>1</code> to <code>100</code> (lower numbers are preferable due to overhead). The default is <code>2</code>. Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-deduplication"><strong>deduplication</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Configures whether deduplication is enabled. The default for a created volume is <code>enabled</code>. Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"disabled"</code></li> <li><code>"enabled"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-device"><strong>device</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The full path of the device to use for VDO storage.</p> <p>This is required if <code><a class="reference internal" href="#ansible-collections-community-general-vdo-module-parameter-state"><span class="std std-ref">state=present</span></a></code>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-emulate512"><strong>emulate512</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Enables 512-byte emulation mode, allowing drivers or filesystems to access the VDO volume at 512-byte granularity, instead of the default 4096-byte granularity.</p> <p>Only recommended when a driver or filesystem requires 512-byte sector level access to a device.</p> <p>This option is only available when creating a new volume, and cannot be changed for an existing volume.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-force"><strong>force</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in community.general 2.4.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>When creating a volume, ignores any existing file system or VDO signature already present in the storage device. When stopping or removing a VDO volume, first unmounts the file system stored on the device if mounted.</p> <p><strong>Warning:</strong> Since this parameter removes all safety checks it is important to make sure that all parameters provided are accurate and intentional.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-growphysical"><strong>growphysical</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies whether to attempt to execute a <code>growphysical</code> operation, if there is enough unused space on the device. A <code>growphysical</code> operation is executed if there is at least 64 GB of free space, relative to the previous physical size of the affected VDO volume.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-indexmem"><strong>indexmem</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the amount of index memory in gigabytes. The default is <code>0.25</code>. The special decimal values <code>0.25</code>, <code>0.5</code>, and <code>0.75</code> can be used, as can any positive integer. This option is only available when creating a new volume, and cannot be changed for an existing volume.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-indexmode"><strong>indexmode</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the index mode of the Albireo index.</p> <p>The default is <code>dense</code>, which has a deduplication window of 1 GB of index memory per 1 TB of incoming data, requiring 10 GB of index data on persistent storage.</p> <p>The <code>sparse</code> mode has a deduplication window of 1 GB of index memory per 10 TB of incoming data, but requires 100 GB of index data on persistent storage.</p> <p>This option is only available when creating a new volume, and cannot be changed for an existing volume.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"dense"</code></li> <li><code>"sparse"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-logicalsize"><strong>logicalsize</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The logical size of the VDO volume (in megabytes, or LVM suffix format). If not specified for a new volume, this defaults to the same size as the underlying storage device, which is specified in the <code><strong><a class="reference internal" href="#ansible-collections-community-general-vdo-module-parameter-device"><span class="std std-ref">device</span></a></strong></code> parameter. Existing volumes maintain their size if the <code><strong><a class="reference internal" href="#ansible-collections-community-general-vdo-module-parameter-logicalsize"><span class="std std-ref">logicalsize</span></a></strong></code> parameter is not specified, or is smaller than or identical to the current size. If the specified size is larger than the current size, a <code>growlogical</code> operation is performed.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-logicalthreads"><strong>logicalthreads</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the number of threads across which to subdivide parts of the VDO processing based on logical block addresses. Valid values are integer values from <code>1</code> to <code>100</code> (lower numbers are preferable due to overhead). The default is <code>1</code>. Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The name of the VDO volume.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-physicalthreads"><strong>physicalthreads</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the number of threads across which to subdivide parts of the VDO processing based on physical block addresses. Valid values are integer values from <code>1</code> to <code>16</code> (lower numbers are preferable due to overhead). The physical space used by the VDO volume must be larger than (<code><strong><a class="reference internal" href="#ansible-collections-community-general-vdo-module-parameter-slabsize"><span class="std std-ref">slabsize</span></a></strong></code> * <code><strong><a class="reference internal" href="#ansible-collections-community-general-vdo-module-parameter-physicalthreads"><span class="std std-ref">physicalthreads</span></a></strong></code>). The default is <code>1</code>. Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-readcache"><strong>readcache</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Enables or disables the read cache. The default is <code>disabled</code>. Choosing <code>enabled</code> enables a read cache which may improve performance for workloads of high deduplication, read workloads with a high level of compression, or on hard disk storage. Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> <p>The read cache feature is available in VDO 6.1 and older.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"disabled"</code></li> <li><code>"enabled"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-readcachesize"><strong>readcachesize</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the extra VDO device read cache size in megabytes. This is in addition to a system-defined minimum. Using a value with a suffix of K, M, G, or T is optional. The default value is <code>0</code>. 1.125 MB of memory per bio thread is used per 1 MB of read cache specified (for example, a VDO volume configured with 4 bio threads has a read cache memory usage overhead of 4.5 MB per 1 MB of read cache specified). Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> <p>The read cache feature is available in VDO 6.1 and older.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-running"><strong>running</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether this VDO volume is running.</p> <p>A VDO volume must be activated in order to be started.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-slabsize"><strong>slabsize</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The size of the increment by which the physical size of a VDO volume is grown, in megabytes (or may be issued with an LVM-style suffix of K, M, G, or T). Must be a power of two between 128M and 32G. The default is <code>2G</code>, which supports volumes having a physical size up to 16T. The maximum, <code>32G</code>, supports a physical size of up to 256T. This option is only available when creating a new volume, and cannot be changed for an existing volume.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether this VDO volume should be <code>present</code> or <code>absent</code>. If a <code>present</code> VDO volume does not exist, it is created. If a <code>present</code> VDO volume already exists, it is modified by updating the configuration, which takes effect when the VDO volume is restarted. Not all parameters of an existing VDO volume can be modified; the <code>statusparamkeys</code> list in the code contains the parameters that can be modified after creation. If an <code>absent</code> VDO volume does not exist, it is not removed.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"absent"</code></li> <li>
<code><strong>"present"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-parameter-writepolicy"><strong>writepolicy</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the write policy of the VDO volume.</p> <p>The <code>sync</code> mode acknowledges writes only after data is on stable storage.</p> <p>The <code>async</code> mode acknowledges writes when data has been cached for writing to stable storage.</p> <p>The default (and highly recommended) <code>auto</code> mode checks the storage device to determine whether it supports flushes. Devices that support flushes result in a VDO volume in <code>async</code> mode, while devices that do not support flushes run in <code>sync</code> mode.</p> <p>Existing volumes maintain their previously configured setting unless a different value is specified in the playbook.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"async"</code></li> <li><code>"auto"</code></li> <li><code>"sync"</code></li> </ul> </div></td> </tr>  </table> </section> <section id="attributes"> <h2>Attributes</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Attribute</p></th> <th class="head"><p>Support</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-attribute-check-mode"><strong>check_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Can run in <code>check_mode</code> and return changed status prediction without modifying target.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-vdo-module-attribute-diff-mode"><strong>diff_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Will return details on what has changed (or possibly needs changing in <code>check_mode</code>), when in diff mode.</p> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>In general, the default thread configuration should be used.</li> </ul> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Create 2 TB VDO volume vdo1 on device /dev/md0
  community.general.vdo:
    name: vdo1
    state: present
    device: /dev/md0
    logicalsize: 2T

- name: Remove VDO volume vdo1
  community.general.vdo:
    name: vdo1
    state: absent
</pre> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Bryan Gurney (@bgurney-rh)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://forum.ansible.com/c/help/6/none" rel="noopener external" target="_blank">Ask for help</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues/new?assignees=&amp;labels=&amp;template=bug_report.yml" rel="noopener external" target="_blank">Submit a bug report</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues/new?assignees=&amp;labels=&amp;template=feature_request.yml" rel="noopener external" target="_blank">Request a feature</a></span></li> <li><span><a class="reference internal" href="index#communication-for-community-general"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2025 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/general/vdo_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/general/vdo_module.html</a>
  </p>
</div>
