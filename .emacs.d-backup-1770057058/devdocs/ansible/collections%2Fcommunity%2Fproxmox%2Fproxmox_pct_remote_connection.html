<section id="community-proxmox-proxmox-pct-remote-connection-run-tasks-in-proxmox-lxc-container-instances-using-pct-cli-via-ssh"> <h1>community.proxmox.proxmox_pct_remote connection – Run tasks in Proxmox LXC container instances using pct CLI via SSH</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This connection plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/proxmox/">community.proxmox collection</a> (version 1.3.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.proxmox</code>. You need further requirements to be able to use this connection plugin, see <a class="reference internal" href="#ansible-collections-community-proxmox-proxmox-pct-remote-connection-requirements"><span class="std std-ref">Requirements</span></a> for details.</p> <p>To use it in a playbook, specify: <code>community.proxmox.proxmox_pct_remote</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Run commands or put/fetch files to an existing Proxmox LXC container using pct CLI via SSH.</li> <li>Uses the Python SSH implementation (Paramiko) to connect to the Proxmox host.</li> </ul> </section> <section id="requirements"> <h2 id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-requirements">Requirements</h2> <p>The below requirements are needed on the local controller node that executes this connection.</p> <ul class="simple"> <li>paramiko</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-banner-timeout"><strong>banner_timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">float</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Configures, in seconds, the amount of time to wait for the SSH banner to be presented. This option is supported by paramiko version 1.15.0 or newer.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>30.0</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="ini">[paramiko_connection]
banner_timeout = 30.0
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_PARAMIKO_BANNER_TIMEOUT" id="index-0"><code>ANSIBLE_PARAMIKO_BANNER_TIMEOUT</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-forward-agent"><strong>forward_agent</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Enable SSH agent forwarding.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="ini">[paramiko_connection]
forward_agent = false
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_PARAMIKO_FORWARD_AGENT" id="index-1"><code>ANSIBLE_PARAMIKO_FORWARD_AGENT</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-host-key-auto-add"><strong>host_key_auto_add</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Automatically add host keys to <code>~/.ssh/known_hosts</code>.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="ini">[paramiko_connection]
host_key_auto_add = VALUE
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config#envvar-ANSIBLE_PARAMIKO_HOST_KEY_AUTO_ADD" id="index-2"><code>ANSIBLE_PARAMIKO_HOST_KEY_AUTO_ADD</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-host-key-checking"><strong>host_key_checking</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Set this to <code>false</code> if you want to avoid host key checking by the underlying tools Ansible uses to connect to the host.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="ini">[defaults]
host_key_checking = true
</pre> <pre data-language="ini">[paramiko_connection]
host_key_checking = true
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config#envvar-ANSIBLE_HOST_KEY_CHECKING" id="index-3"><code>ANSIBLE_HOST_KEY_CHECKING</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_SSH_HOST_KEY_CHECKING" id="index-4"><code>ANSIBLE_SSH_HOST_KEY_CHECKING</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_PARAMIKO_HOST_KEY_CHECKING" id="index-5"><code>ANSIBLE_PARAMIKO_HOST_KEY_CHECKING</code></a>
</li> <li>Variable: ansible_host_key_checking</li> <li>Variable: ansible_ssh_host_key_checking</li> <li>Variable: ansible_paramiko_host_key_checking</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-lock-file-timeout"><strong>lock_file_timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Number of seconds until the plugin gives up on trying to write a lock file when writing SSH known host keys.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>60</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_LOCK_FILE_TIMEOUT" id="index-6"><code>ANSIBLE_LOCK_FILE_TIMEOUT</code></a>
</li> <li>Variable: ansible_lock_file_timeout</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-look-for-keys"><strong>look_for_keys</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Set to <code>false</code> to disable searching for private key files in <code>~/.ssh/</code>.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="ini">[paramiko_connection]
look_for_keys = true
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config#envvar-ANSIBLE_PARAMIKO_LOOK_FOR_KEYS" id="index-7"><code>ANSIBLE_PARAMIKO_LOOK_FOR_KEYS</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-password"><strong>password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Secret used to either login the SSH server or as a passphrase for SSH keys that require it.</p> <p>Can be set from the CLI via the <code>--ask-pass</code> option.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_password</li> <li>Variable: ansible_ssh_pass</li> <li>Variable: ansible_ssh_password</li> <li>Variable: ansible_paramiko_pass</li> <li>Variable: ansible_paramiko_password</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-port"><strong>port</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Remote port to connect to.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>22</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="ini">[defaults]
remote_port = 22
</pre> <pre data-language="ini">[paramiko_connection]
remote_port = 22
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config#envvar-ANSIBLE_REMOTE_PORT" id="index-8"><code>ANSIBLE_REMOTE_PORT</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_REMOTE_PARAMIKO_PORT" id="index-9"><code>ANSIBLE_REMOTE_PARAMIKO_PORT</code></a>
</li> <li>Keyword: port</li> <li>Variable: ansible_port</li> <li>Variable: ansible_ssh_port</li> <li>Variable: ansible_paramiko_port</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-private-key-file"><strong>private_key_file</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Path to private key file to use for authentication.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="ini">[defaults]
private_key_file = VALUE
</pre> <pre data-language="ini">[paramiko_connection]
private_key_file = VALUE
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config#envvar-ANSIBLE_PRIVATE_KEY_FILE" id="index-10"><code>ANSIBLE_PRIVATE_KEY_FILE</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_PARAMIKO_PRIVATE_KEY_FILE" id="index-11"><code>ANSIBLE_PARAMIKO_PRIVATE_KEY_FILE</code></a>
</li> <li>CLI argument: –private-key</li> <li>Variable: ansible_private_key_file</li> <li>Variable: ansible_ssh_private_key_file</li> <li>Variable: ansible_paramiko_private_key_file</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-proxmox-become-method"><strong>proxmox_become_method</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Become command used in proxmox</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"sudo"</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: proxmox_become_method</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-proxy-command"><strong>proxy_command</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Proxy information for running the connection via a jumphost.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>""</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="ini">[paramiko_connection]
proxy_command = ""
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_PARAMIKO_PROXY_COMMAND" id="index-12"><code>ANSIBLE_PARAMIKO_PROXY_COMMAND</code></a>
</li> <li>Variable: ansible_paramiko_proxy_command</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-pty"><strong>pty</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p><code>sudo</code> usually requires a PTY, <code>true</code> to give a PTY and <code>false</code> to not give a PTY.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="ini">[paramiko_connection]
pty = true
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_PARAMIKO_PTY" id="index-13"><code>ANSIBLE_PARAMIKO_PTY</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-record-host-keys"><strong>record_host_keys</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Save the host keys to a file.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="ini">[paramiko_connection]
record_host_keys = true
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_PARAMIKO_RECORD_HOST_KEYS" id="index-14"><code>ANSIBLE_PARAMIKO_RECORD_HOST_KEYS</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-remote-addr"><strong>remote_addr</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Address of the remote target.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"inventory_hostname"</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: inventory_hostname</li> <li>Variable: ansible_host</li> <li>Variable: ansible_ssh_host</li> <li>Variable: ansible_paramiko_host</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-remote-user"><strong>remote_user</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>User to login/authenticate as.</p> <p>Can be set from the CLI via the <code>--user</code> or <code>-u</code> options.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="ini">[defaults]
remote_user = VALUE
</pre> <pre data-language="ini">[paramiko_connection]
remote_user = VALUE
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config#envvar-ANSIBLE_REMOTE_USER" id="index-15"><code>ANSIBLE_REMOTE_USER</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_PARAMIKO_REMOTE_USER" id="index-16"><code>ANSIBLE_PARAMIKO_REMOTE_USER</code></a>
</li> <li>Keyword: remote_user</li> <li>Variable: ansible_user</li> <li>Variable: ansible_ssh_user</li> <li>Variable: ansible_paramiko_user</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-timeout"><strong>timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Number of seconds until the plugin gives up on failing to establish a TCP connection.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>10</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="ini">[defaults]
timeout = 10
</pre> <pre data-language="ini">[ssh_connection]
timeout = 10
</pre> <pre data-language="ini">[paramiko_connection]
timeout = 10
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config#envvar-ANSIBLE_TIMEOUT" id="index-17"><code>ANSIBLE_TIMEOUT</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_SSH_TIMEOUT" id="index-18"><code>ANSIBLE_SSH_TIMEOUT</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_PARAMIKO_TIMEOUT" id="index-19"><code>ANSIBLE_PARAMIKO_TIMEOUT</code></a>
</li> <li>CLI argument: –timeout</li> <li>Variable: ansible_ssh_timeout</li> <li>Variable: ansible_paramiko_timeout</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-use-persistent-connections"><strong>use_persistent_connections</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Toggles the use of persistence for connections.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="ini">[defaults]
use_persistent_connections = false
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config#envvar-ANSIBLE_USE_PERSISTENT_CONNECTIONS" id="index-20"><code>ANSIBLE_USE_PERSISTENT_CONNECTIONS</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-use-rsa-sha2-algorithms"><strong>use_rsa_sha2_algorithms</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether or not to enable RSA SHA2 algorithms for pubkeys and hostkeys.</p> <p>On paramiko versions older than 2.9, this only affects hostkeys.</p> <p>For behavior matching paramiko&lt;2.9 set this to <code>false</code>.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="ini">[paramiko_connection]
use_rsa_sha2_algorithms = true
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables#envvar-ANSIBLE_PARAMIKO_USE_RSA_SHA2_ALGORITHMS" id="index-21"><code>ANSIBLE_PARAMIKO_USE_RSA_SHA2_ALGORITHMS</code></a>
</li> <li>Variable: ansible_paramiko_use_rsa_sha2_algorithms</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-proxmox-proxmox-pct-remote-connection-parameter-vmid"><strong>vmid</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>LXC Container ID</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: proxmox_vmid</li> </ul> </div></td> </tr>  </table> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Configuration entries listed above for each entry type (Ansible variable, environment variable, and so on) have a low to high priority order. For example, a variable that is lower in the list will override a variable that is higher up. The entry types are also ordered by precedence from low to high priority order. For example, an ansible.cfg entry (further up in the list) is overwritten by an Ansible variable (further down in the list).</p> </div> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>When NOT using this plugin as root, you need to have a become mechanism, e.g. <code>sudo</code>, installed on Proxmox and setup so we can run it without prompting for the password. Inside the container, we need a shell, for example <code>sh</code> and the <code>cat</code> command to be available in the <code>PATH</code> for this plugin to work.</li> </ul> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja"># --------------------------------------------------------------
# Setup sudo with password less access to pct for user 'ansible':
# --------------------------------------------------------------
#
# Open a Proxmox root shell and execute:
# $ useradd -d /opt/ansible-pct -r -m -s /bin/sh ansible
# $ mkdir -p /opt/ansible-pct/.ssh
# $ ssh-keygen -t ed25519 -C 'ansible' -N "" -f /opt/ansible-pct/.ssh/ansible &lt;&lt;&lt; y &gt; /dev/null
# $ cat /opt/ansible-pct/.ssh/ansible
# $ mv /opt/ansible-pct/.ssh/ansible.pub /opt/ansible-pct/.ssh/authorized-keys
# $ rm /opt/ansible-pct/.ssh/ansible*
# $ chown -R ansible:ansible /opt/ansible-pct/.ssh
# $ chmod 700 /opt/ansible-pct/.ssh
# $ chmod 600 /opt/ansible-pct/.ssh/authorized-keys
# $ echo 'ansible ALL = (root) NOPASSWD: /usr/sbin/pct' &gt; /etc/sudoers.d/ansible_pct
#
# Save the displayed private key and add it to your ssh-agent
#
# Or use ansible:
# ---
# - name: Setup ansible-pct user and configure environment on Proxmox host
#   hosts: proxmox
#   become: true
#   gather_facts: false
#
#   tasks:
#     - name: Create ansible user
#       ansible.builtin.user:
#         name: ansible
#         comment: Ansible User
#         home: /opt/ansible-pct
#         shell: /bin/sh
#         create_home: true
#         system: true
#
#     - name: Create .ssh directory
#       ansible.builtin.file:
#         path: /opt/ansible-pct/.ssh
#         state: directory
#         owner: ansible
#         group: ansible
#         mode: '0700'
#
#     - name: Generate SSH key for ansible user
#       community.crypto.openssh_keypair:
#         path: /opt/ansible-pct/.ssh/ansible
#         type: ed25519
#         comment: 'ansible'
#         force: true
#         mode: '0600'
#         owner: ansible
#         group: ansible
#
#     - name: Set public key as authorized key
#       ansible.builtin.copy:
#         src: /opt/ansible-pct/.ssh/ansible.pub
#         dest: /opt/ansible-pct/.ssh/authorized-keys
#         remote_src: yes
#         owner: ansible
#         group: ansible
#         mode: '0600'
#
#     - name: Add sudoers entry for ansible user
#       ansible.builtin.copy:
#         content: 'ansible ALL = (root) NOPASSWD: /usr/sbin/pct'
#         dest: /etc/sudoers.d/ansible_pct
#         owner: root
#         group: root
#         mode: '0440'
#
#     - name: Fetch private SSH key to localhost
#       ansible.builtin.fetch:
#         src: /opt/ansible-pct/.ssh/ansible
#         dest: ~/.ssh/proxmox_ansible_private_key
#         flat: yes
#         fail_on_missing: true
#
#     - name: Clean up generated SSH keys
#       ansible.builtin.file:
#         path: /opt/ansible-pct/.ssh/ansible*
#         state: absent
#
# - name: Configure private key permissions on localhost
#   hosts: localhost
#   tasks:
#     - name: Set permissions for fetched private key
#       ansible.builtin.file:
#         path: ~/.ssh/proxmox_ansible_private_key
#         mode: '0600'
#
# --------------------------------
# Static inventory file: hosts.yml
# --------------------------------
# all:
#   children:
#     lxc:
#       hosts:
#         container-1:
#           ansible_host: 10.0.0.10
#           proxmox_vmid: 100
#           ansible_connection: community.proxmox.proxmox_pct_remote
#           ansible_user: ansible
#         container-2:
#           ansible_host: 10.0.0.10
#           proxmox_vmid: 200
#           ansible_connection: community.proxmox.proxmox_pct_remote
#           ansible_user: ansible
#     proxmox:
#       hosts:
#         proxmox-1:
#           ansible_host: 10.0.0.10
#
#
# ---------------------------------------------
# Dynamic inventory file: inventory.proxmox.yml
# ---------------------------------------------
# plugin: community.proxmox.proxmox
# url: https://10.0.0.10:8006
# validate_certs: false
# user: ansible@pam
# token_id: ansible
# token_secret: !vault |
#           $ANSIBLE_VAULT;1.1;AES256
#           ...

# want_facts: true
# exclude_nodes: true
# filters:
#   - proxmox_vmtype == "lxc"
# want_proxmox_nodes_ansible_host: false
# compose:
#   ansible_host: "'10.0.0.10'"
#   ansible_connection: "'community.proxmox.proxmox_pct_remote'"
#   ansible_user: "'ansible'"
#
#
# ----------------------
# Playbook: playbook.yml
# ----------------------
---
- hosts: lxc
  # On nodes with many containers you might want to deactivate the devices facts
  # or set `gather_facts: false` if you don't need them.
  # More info on gathering fact subsets:
  # https://docs.ansible.com/ansible/latest/collections/ansible/builtin/setup_module.html
  #
  # gather_facts: true
  #   gather_subset:
  #     - "!devices"
  tasks:
    - name: Ping LXC container
      ansible.builtin.ping:
</pre> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Nils Stein (@mietzen)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.proxmox/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.proxmox" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.proxmox/issues/new/choose" rel="noopener external" target="_blank">Report an issue</a></span></li> <li><span><a class="reference internal" href="index#communication-for-community-proxmox"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2025 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/proxmox/proxmox_pct_remote_connection.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/proxmox/proxmox_pct_remote_connection.html</a>
  </p>
</div>
