<section id="vmware-vmware-esxi-host-module-manage-vmware-esxi-host-status-in-vcenter"> <h1>vmware.vmware.esxi_host module – Manage VMware ESXi host status in vCenter</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/vmware/vmware/">vmware.vmware collection</a> (version 1.11.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install vmware.vmware</code>.</p> <p>To use it in a playbook, specify: <code>vmware.vmware.esxi_host</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id4">See Also</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Manage VMware ESXi host status in vCenter, including cluster or folder membership.</li> <li>The host must be in maintenance mode to remove it or update its placement.</li> <li>This module does not manage the connection status of hosts in vCenter. That functionality is in vmware.vmware.esxi_connection</li> <li>The host must be in maintenance mode if it is already registered with vCenter but should be moved to a new cluster or folder.</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-cluster-name"><strong id="ansible-collections-vmware-vmware-esxi-host-module-parameter-cluster">cluster</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: cluster_name</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The name of the cluster to be managed.</p> <p>One of <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-cluster"><span class="std std-ref">cluster</span></a></strong></code> or <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-folder"><span class="std std-ref">folder</span></a></strong></code> is required when <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-state"><span class="std std-ref">state</span></a></strong></code> is <code>present</code>.</p> <p>Since ESXi names are unique in a datacenter, this option is not used when <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-state"><span class="std std-ref">state</span></a></strong></code> is <code>absent</code>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-datacenter-name"><strong id="ansible-collections-vmware-vmware-esxi-host-module-parameter-datacenter">datacenter</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: datacenter_name</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The name of the datacenter.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-esxi-host-name"><strong>esxi_host_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>ESXi hostname to manage.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-esxi-password"><strong>esxi_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The password to use when authenticating to the ESXi host.</p> <p>Required when <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-state"><span class="std std-ref">state</span></a></strong></code> is <code>present</code>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-esxi-port"><strong>esxi_port</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The port on which the ESXi host’s SSL certificate can be seen.</p> <p>This is used when fetching the SSL thumbprint, and is not used if <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-ssl-thumbprint"><span class="std std-ref">ssl_thumbprint</span></a></strong></code> is provided.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>443</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-esxi-username"><strong>esxi_username</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The username to use when authenticating to the ESXi host.</p> <p>Required when <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-state"><span class="std std-ref">state</span></a></strong></code> is <code>present</code>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-folder"><strong>folder</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of the folder under which host to add.</p> <p>One of <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-cluster"><span class="std std-ref">cluster</span></a></strong></code> or <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-folder"><span class="std std-ref">folder</span></a></strong></code> is required when <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-state"><span class="std std-ref">state</span></a></strong></code> is <code>present</code></p> <p>Since ESXi names are unique in a datacenter, this option is not used when <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-state"><span class="std std-ref">state</span></a></strong></code> is <code>absent</code>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-force-add"><strong>force_add</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Forces the ESXi host to be added to the vCenter server, even if it is already being managed by another server.</p> <p>The host must be in maintenance mode even if this option is enabled.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-hostname"><strong>hostname</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The hostname or IP address of the vSphere vCenter server.</p> <p>If the value is not specified in the task, the value of environment variable <a class="reference internal" href="../../environment_variables#envvar-VMWARE_HOST"><code>VMWARE_HOST</code></a> will be used instead.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">   
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-pwd"><strong id="ansible-collections-vmware-vmware-esxi-host-module-parameter-pass">password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: pass, pwd</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The password of the vSphere vCenter server.</p> <p>If the value is not specified in the task, the value of environment variable <a class="reference internal" href="../../environment_variables#envvar-VMWARE_PASSWORD"><code>VMWARE_PASSWORD</code></a> will be used instead.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-port"><strong>port</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The port number of the vSphere vCenter server.</p> <p>If the value is not specified in the task, the value of environment variable <a class="reference internal" href="../../environment_variables#envvar-VMWARE_PORT"><code>VMWARE_PORT</code></a> will be used instead.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>443</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-proxy-host"><strong>proxy_host</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The address of a proxy that will receive all HTTPS requests and relay them.</p> <p>The format is a hostname or a IP.</p> <p>If the value is not specified in the task, the value of environment variable <a class="reference internal" href="../../environment_variables#envvar-VMWARE_PROXY_HOST"><code>VMWARE_PROXY_HOST</code></a> will be used instead.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-proxy-port"><strong>proxy_port</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The port of the HTTP proxy that will receive all HTTPS requests and relay them.</p> <p>If the value is not specified in the task, the value of environment variable <a class="reference internal" href="../../environment_variables#envvar-VMWARE_PROXY_PORT"><code>VMWARE_PROXY_PORT</code></a> will be used instead.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-ssl-thumbprint"><strong>ssl_thumbprint</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specify the host system’s SSL certificate thumbprint.</p> <p>You can run the following command on the host to get the thumbprint - ‘openssl x509 -in /etc/vmware/ssl/rui.crt -fingerprint -sha1 -noout’</p> <p>If this is not set, the module will attempt to fetch the thumbprint from the host itself. This essentially skips the host certificate verification, since whatever host is presented will be trusted.</p> <p>This option is only used when state is present.</p> <p>If <code><strong><a class="reference internal" href="#ansible-collections-vmware-vmware-esxi-host-module-parameter-proxy-host"><span class="std std-ref">proxy_host</span></a></strong></code> is set, the proxy is used when fetching the SSL thumbprint.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If set to <code>present</code>, make sure the host is registered in vCenter in the desired folder or cluster.</p> <p>If set to <code>absent</code>, remove the host from vCenter if it exists.</p> <p>If set to <code>absent</code>, the host must either be disconnected or be in maintenance mode before it can be removed.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"present"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"absent"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">   
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-username"><strong id="ansible-collections-vmware-vmware-esxi-host-module-parameter-admin">username</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: admin, user</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The username of the vSphere vCenter server.</p> <p>If the value is not specified in the task, the value of environment variable <a class="reference internal" href="../../environment_variables#envvar-VMWARE_USER"><code>VMWARE_USER</code></a> will be used instead.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-parameter-validate-certs"><strong>validate_certs</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Allows connection when SSL certificates are not valid. Set to <code>false</code> when certificates are not trusted.</p> <p>If the value is not specified in the task, the value of environment variable <a class="reference internal" href="../../environment_variables#envvar-VMWARE_VALIDATE_CERTS"><code>VMWARE_VALIDATE_CERTS</code></a> will be used instead.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>All modules require API write access and hence are not supported on a free ESXi license.</li> <li>All variables and VMware object names are case sensitive.</li> <li>Modules may rely on the ‘requests’ python library, which does not use the system certificate store by default. You can specify the certificate store by setting the REQUESTS_CA_BUNDLE environment variable. Example: ‘export REQUESTS_CA_BUNDLE=/path/to/your/ca_bundle.pem’</li> </ul> </div> </section> <section id="see-also"> <h2>See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="esxi_connection_module#ansible-collections-vmware-vmware-esxi-connection-module"><span class="std std-ref">vmware.vmware.esxi_connection</span></a></dt>
<dd>
<p>Manage VMware ESXi host connection status in vCenter.</p> </dd> </dl> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Make Sure Host Is In A Cluster
  vmware.vmware.esxi_host:
    datacenter: DC01
    cluster: MyCluster
    esxi_host_name: 1.1.1.1
    esxi_username: root
    esxi_password: mypassword!
    state: present


- name: Make Sure Host Is In A Folder (Standalone Host)
  vmware.vmware.esxi_host:
    datacenter: DC01
    folder: my/host/folder   # or DC01/host/my/host/folder
    esxi_host_name: 1.1.1.1
    esxi_username: root
    esxi_password: mypassword!
    state: present


- name: Remove Host From Cluster
  vmware.vmware.esxi_host:
    datacenter: DC01
    esxi_host_name: 1.1.1.1
    state: absent
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-return-host"><strong>host</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Identifying information about the host</p> <p>If the state is absent and the host does not exist, only the name is returned</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> On success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>{"host": {"moid": "host-111111", "name": "10.10.10.10"}}</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vmware-vmware-esxi-host-module-return-result"><strong>result</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Information about the vCenter task, if something changed</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> On change</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>{"result": {"completion_time": "2024-07-29T15:27:37.041577+00:00", "entity_name": "test-5fb1_my_esxi_host", "error": null, "state": "success"}}</code></p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Ansible Cloud Team (@ansible-collections)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/vmware.vmware/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/vmware.vmware" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/vmware.vmware/issues/new/choose" rel="noopener external" target="_blank">Report an issue</a></span></li> <li><span><a class="reference internal" href="index#communication-for-vmware-vmware"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2025 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/vmware/vmware/esxi_host_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/vmware/vmware/esxi_host_module.html</a>
  </p>
</div>
