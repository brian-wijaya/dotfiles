<header><h1>Scripting</h1></header><h2 class="anchor anchorWithStickyNavbar_hhKX" id="environment-files">Environment files<a href="#environment-files" class="hash-link" aria-label="Direct link to Environment files" title="Direct link to Environment files">​</a>
</h2> <p>Yarn will automatically interpret the content of <code>.env.yarn</code> files, and inject them within all commands run by <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="path_tCL7"><span class="token_Ye2a" data-type="path">run</span></span></code></span>. This behavior can be configured through the use of the <a href="../configuration/yarnrc#injectEnvironmentFiles"><code data-tooltip-id="tooltip" data-tooltip-content="Array of .env files which will get injected into any subprocess spawned by Yarn."><span class="key_FEvO">injectEnvironmentFiles</span></code></a> setting.</p> <p>Note that you can also configure files that will be loaded but <em>only if present</em>; making it possible to write conditional imports such as:</p> <div class="language-yaml codeBlockContainer_iUqV theme-code-block"><div class="codeBlockContent_Xs1n">
<pre tabindex="0" class="prism-code language-yaml codeBlock_hDG7 thin-scrollbar" data-language="yaml">injectEnvironmentFiles:
  - .env.yarn
  - .env.local?</pre>
<div class="buttonGroup_ipu6"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FbbJ" aria-hidden="true"><svg viewbox="0 0 24 24" class="copyButtonIcon_Nh6j"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewbox="0 0 24 24" class="copyButtonSuccessIcon_wXPl"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div>
</div></div> <p>Where <code>.env.local</code> will take precedence only if present, and ignored otherwise.</p> <h2 class="anchor anchorWithStickyNavbar_hhKX" id="parallel-tasks">Parallel tasks<a href="#parallel-tasks" class="hash-link" aria-label="Direct link to Parallel tasks" title="Direct link to Parallel tasks">​</a>
</h2> <p>Yarn has a native integration for the background job syntax (<code>foo&amp;</code>) within scripts defined in the <code data-tooltip-id="tooltip" data-tooltip-content="Set of scripts to expose via `yarn run script-name`, or as lifecycle hooks."><a class="key_FEvO" href="../configuration/manifest#scripts">scripts</a></code> field. It will run them in parallel, and each line of the output will be prefixed by an identifier showing where they come from. For example, the following command will run linting and tests in parallel, and report once both are finished:</p>  <h2 class="anchor anchorWithStickyNavbar_hhKX" id="portable-shell">Portable shell<a href="#portable-shell" class="hash-link" aria-label="Direct link to Portable shell" title="Direct link to Portable shell">​</a>
</h2> <p>Windows portability can be troublesome with other package managers. Scripts can't expect a Posix shell to be available, so you have to rely on strange hacks to use semi-portable scripts - or drop them altogether and use Node.js scripts instead, defeating the point of small, non-intrusive scripts in the first place. That is, unless you use Yarn!</p> <p>Yarn implements and maintains a Posix-like shell interpreter that supports all of the syntax you typically find within scripts, along with a couple of simple builtins like <code>cd</code> / <code>echo</code>. For instance, the following command will work just fine on both Windows and Linux despite assigning environment variables:</p>  <div class="theme-admonition theme-admonition-info admonition_w2cE alert alert--info">
<div class="admonitionHeading_zjKb">
<span class="admonitionIcon_xnvX"><svg viewbox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div>
<div class="admonitionContent_SoUl"><p>We say it's a Posix-like interpreter rather than a Posix-compatible interpreter because it doesn't implement some of the most complex features that aren't useful in the context of the <code data-tooltip-id="tooltip" data-tooltip-content="Set of scripts to expose via `yarn run script-name`, or as lifecycle hooks."><a class="key_FEvO" href="../configuration/manifest#scripts">scripts</a></code> field. For instance, multi-line flow control structures such as <code>while</code> aren't supported.</p></div>
</div> <h2 class="anchor anchorWithStickyNavbar_hhKX" id="script-arguments">Script arguments<a href="#script-arguments" class="hash-link" aria-label="Direct link to Script arguments" title="Direct link to Script arguments">​</a>
</h2> <p>By default, any parameter following the name of the script in <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="path_tCL7"><span class="token_Ye2a" data-type="path">run</span></span></code></span> will be added to the evaluated command. It works well enough in simple cases, like this one where running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="token_Ye2a" data-type="positional">test</span> <span class="token_Ye2a" data-type="positional">packages/lib</span></code></span> will lead to <code>jest packages/lib</code> being evaluated:</p> <div class="language-json codeBlockContainer_iUqV theme-code-block"><div class="codeBlockContent_Xs1n">
<pre tabindex="0" class="prism-code language-json codeBlock_hDG7 thin-scrollbar" data-language="json">{
  "scripts": {
    "test": "jest"
  }
}</pre>
<div class="buttonGroup_ipu6"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FbbJ" aria-hidden="true"><svg viewbox="0 0 24 24" class="copyButtonIcon_Nh6j"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewbox="0 0 24 24" class="copyButtonSuccessIcon_wXPl"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div>
</div></div> <p>In more complex situations however, you may want to explicitly refer to those arguments. Yarn supports this by using the <code>$0</code>, <code>$1</code>, etc variables, which will be interpolated and will disable the automatic appending of the arguments:</p> <div class="language-json codeBlockContainer_iUqV theme-code-block"><div class="codeBlockContent_Xs1n">
<pre tabindex="0" class="prism-code language-json codeBlock_hDG7 thin-scrollbar" data-language="json">{
  "scripts": {
    "get-latest": "curl https://registry.yarnpkg.com/$0 | jq .['dist-tags'].latest"
  }
}</pre>
<div class="buttonGroup_ipu6"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FbbJ" aria-hidden="true"><svg viewbox="0 0 24 24" class="copyButtonIcon_Nh6j"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewbox="0 0 24 24" class="copyButtonSuccessIcon_wXPl"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div>
</div></div> <p>Of course, you can also use the <code>$@</code> array to retrieve the list of all arguments, which will let you reuse them in multiple commands:</p> <div class="language-json codeBlockContainer_iUqV theme-code-block"><div class="codeBlockContent_Xs1n">
<pre tabindex="0" class="prism-code language-json codeBlock_hDG7 thin-scrollbar" data-language="json">{
  "scripts": {
    "build-and-test": "yarn build \"$@\" &amp;&amp; yarn test \"$@\""
  }
}</pre>
<div class="buttonGroup_ipu6"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FbbJ" aria-hidden="true"><svg viewbox="0 0 24 24" class="copyButtonIcon_Nh6j"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewbox="0 0 24 24" class="copyButtonSuccessIcon_wXPl"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div>
</div></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2016&ndash;present Yarn Contributors<br>Licensed under the BSD License.<br>
    <a href="https://yarnpkg.com/features/scripting" class="_attribution-link">https://yarnpkg.com/features/scripting</a>
  </p>
</div>
