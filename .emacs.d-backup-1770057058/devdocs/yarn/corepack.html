<header><h1>Corepack</h1></header><p>You may notice by reading our <a href="getting-started/install">installation guide</a> that we don't tell you to run <code>npm install -g yarn</code> to install Yarn - we even recommend against it. The reason is simple: <strong>just like your project dependencies must be locked, so should be the package manager itself.</strong></p> <p>Installing Yarn as a global binary meant you always used whatever was the latest version published. Most of the time it worked fine, but every once in a while something was shipped that could impact the way your project was installed - be it a bugfix, new bug, or breaking change.</p> <p>To counter that, Yarn joined forces with the Node.js project to start the development of <a href="https://nodejs.org/api/corepack.html" target="_blank" rel="noopener noreferrer">Corepack</a>, an official Node.js tool letting you define which package manager version you want to use on a per-project basis, just like your lockfile does for your project dependencies.</p> <div class="theme-admonition theme-admonition-info admonition_w2cE alert alert--info">
<div class="admonitionHeading_zjKb">
<span class="admonitionIcon_xnvX"><svg viewbox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div>
<div class="admonitionContent_SoUl"><p>Corepack is marked experimental so we can iterate on its CLI faster, but it's already the preferred way to install package managers - both for Yarn and for pnpm.</p></div>
</div> <h2 class="anchor anchorWithStickyNavbar_hhKX" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation">​</a>
</h2> <p>Corepack is included with all official Node.js releases starting from Node.js 14.19 / 16.9. It's however opt-in for the duration of the experimental stage, so you'll need to run <code>corepack enable</code> before it's active.</p> <p>You can quickly check whether Corepack is enabled by running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Execute a shell script
" href="cli/exec"><span class="token_Ye2a" data-type="path">exec</span></a> <span class="token_Ye2a" data-type="positional">env</span></code></span>: if you get a path as output, Corepack is properly installed. If not, something may be messing with how the shims are installed. In that case check the <a href="corepack#troubleshooting">Troubleshooting</a> section for advices.</p> <div class="theme-admonition theme-admonition-danger admonition_w2cE alert alert--danger">
<div class="admonitionHeading_zjKb">
<span class="admonitionIcon_xnvX"><svg viewbox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div>
<div class="admonitionContent_SoUl"><p>Some third-party distributors may not include Corepack by default, in particular if you install Node.js from your system package manager. If that happens, running <code>npm install -g corepack</code> before <code>corepack enable</code> should do the trick.</p></div>
</div> <h2 class="anchor anchorWithStickyNavbar_hhKX" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a>
</h2> <h3 class="anchor anchorWithStickyNavbar_hhKX" id="offline-workflow">Offline workflow<a href="#offline-workflow" class="hash-link" aria-label="Direct link to Offline workflow" title="Direct link to Offline workflow">​</a>
</h3> <p>If you use an airgapped network, as is often the case in company CIs, you may hit problems where Corepack isn't able to download the Yarn binary for the active project. The Corepack documentation includes a <a href="https://github.com/nodejs/corepack?tab=readme-ov-file#offline-workflow" target="_blank" rel="noopener noreferrer">dedicated section</a> explaining how to avoid this problem.</p> <h3 class="anchor anchorWithStickyNavbar_hhKX" id="volta">Volta<a href="#volta" class="hash-link" aria-label="Direct link to Volta" title="Direct link to Volta">​</a>
</h3> <p>Volta doesn't currently integrate with Corepack, as it installs its own shims which prevent the Corepack ones from being applied. You will need to run the following two commands to force the integration:</p> <div class="language-bash codeBlockContainer_iUqV theme-code-block"><div class="codeBlockContent_Xs1n">
<pre tabindex="0" class="prism-code language-bash codeBlock_hDG7 thin-scrollbar" data-language="bash">npm install -g corepack

# Specifying an explicit install-directory makes corepack overwrite volta's yarn shims, which is what we want
corepack enable --install-directory ~/.volta/bin</pre>
<div class="buttonGroup_ipu6"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FbbJ" aria-hidden="true"><svg viewbox="0 0 24 24" class="copyButtonIcon_Nh6j"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewbox="0 0 24 24" class="copyButtonSuccessIcon_wXPl"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div>
</div></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2016&ndash;present Yarn Contributors<br>Licensed under the BSD License.<br>
    <a href="https://yarnpkg.com/corepack" class="_attribution-link">https://yarnpkg.com/corepack</a>
  </p>
</div>
