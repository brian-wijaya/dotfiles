<h1>ShadowRoot: setHTML() method</h1> <details class="baseline-indicator not" data-glean-toggle-open="baseline_toggle_open"> <summary>  <div class="status-title"> <span class="not-bold">Limited availability</span> </div>    </summary> <div class="extra"> <p>This feature is not Baseline because it does not work in some of the most widely-used browsers.</p>  <ul> <li> <a href="https://developer.mozilla.org/en-US/docs/Glossary/Baseline/Compatibility" data-glean-id="baseline_link_learn_more" target="_blank" class="learn-more"> Learn more </a> </li> <li> <a href="#browser_compatibility" data-glean-id="baseline_link_bcd_table"> See full compatibility </a> </li> <li> <a href="https://survey.alchemer.com/s3/7634825/MDN-baseline-feedback?page=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FShadowRoot%2FsetHTML&amp;level=not" data-glean-id="baseline_link_feedback" class="feedback-link" target="_blank" rel="noreferrer"> Report feedback </a> </li> </ul> </div> </details>   <p>The <code>setHTML()</code> method of the <a href="../shadowroot"><code>ShadowRoot</code></a> interface provides an XSS-safe method to parse and sanitize a string of HTML into a <a href="../documentfragment"><code>DocumentFragment</code></a>, which then replaces the existing tree in the Shadow DOM.</p>     <mdn-survey></mdn-survey>  <h2 id="syntax" class="heading">Syntax</h2> <div class="code-example"><pre data-language="js">setHTML(input)
setHTML(input, options)
</pre></div>  <h3 id="parameters" class="heading">Parameters</h3> <dl> <dt id="input"><a href="#input"><code>input</code></a></dt> <dd> <p>A string defining HTML to be sanitized and injected into the shadow root.</p> </dd> <dt id="options"><a href="#options"><code>options</code> <span class="badge inline optional">Optional</span></a></dt> <dd> <p>An options object with the following optional parameters:</p> <dl> <dt id="sanitizer"><a href="#sanitizer"><code>sanitizer</code></a></dt> <dd> <p>A <a href="../sanitizer"><code>Sanitizer</code></a> or <a href="../sanitizerconfig"><code>SanitizerConfig</code></a> object which defines what elements of the input will be allowed or removed, or the string <code>"default"</code> for the default sanitizer configuration. Note that generally a <code>"Sanitizer</code> is expected to be more efficient than a <code>SanitizerConfig</code> if the configuration is to reused. If not specified, the default sanitizer configuration is used.</p> </dd> </dl> </dd> </dl>  <h3 id="return_value" class="heading">Return value</h3> <p>None (<code>undefined</code>).</p>  <h3 id="exceptions" class="heading">Exceptions</h3> <dl> <dt id="typeerror"><a href="#typeerror"><code>TypeError</code></a></dt> <dd> <p>This is thrown if <code>options.sanitizer</code> is passed a:</p> <ul> <li>non-normalized <a href="../sanitizerconfig"><code>SanitizerConfig</code></a> (one that includes both "allowed" and "removed" configuration settings).</li> <li>string that does not have the value <code>"default"</code>.</li> <li>value that is not a <a href="../sanitizer"><code>Sanitizer</code></a>, <a href="../sanitizerconfig"><code>SanitizerConfig</code></a>, or string.</li> </ul> </dd> </dl>  <h2 id="description" class="heading">Description</h2> <p>The <code>setHTML()</code> method provides an XSS-safe method to parse and sanitize a string of HTML and use it to replace the existing tree in the Shadow DOM.</p> <p><code>setHTML()</code> removes any HTML entities that aren't allowed by the sanitizer configuration, and further removes any XSS-unsafe elements or attributes â€” whether or not they are allowed by the sanitizer configuration.</p> <p>If no sanitizer configuration is specified in the <code>options.sanitizer</code> parameter, <code>setHTML()</code> is used with the default <a href="../sanitizer"><code>Sanitizer</code></a> configuration. This configuration allows all elements and attributes that are considered XSS-safe, thereby disallowing entities that are considered unsafe. A custom sanitizer or sanitizer configuration can be specified to choose which elements, attributes, and comments are allowed or removed. Note that even if unsafe options are allowed by the sanitizer configuration, they will still be removed when using this method (which implicitly calls <a href="../sanitizer/removeunsafe"><code>Sanitizer.removeUnsafe()</code></a>).</p> <p><code>setHTML()</code> should be used instead of <a href="innerhtml"><code>ShadowRoot.innerHTML</code></a> for inserting untrusted strings of HTML into the shadow DOM. It should also be used instead of <a href="sethtmlunsafe"><code>ShadowRoot.setHTMLUnsafe()</code></a>, unless there is a specific need to allow unsafe elements and attributes.</p> <p>Note that since this method always sanitizes input strings of XSS-unsafe entities, it is not secured or validated using the <a href="../trusted_types_api">Trusted Types API</a>.</p>  <h2 id="examples" class="heading">Examples</h2> &gt;  <h3 id="basic_usage" class="heading">Basic usage</h3> <p>This example shows some of the ways you can use <code>setHTML()</code> to sanitize and inject a string of HTML.</p> <p>First we will create the <a href="../shadowroot"><code>ShadowRoot</code></a> we want to target. This could be created programmatically using <a href="../element/attachshadow"><code>Element.attachShadow()</code></a> but for this example we'll create the root declaratively.</p> <div class="code-example"><pre data-language="html">&lt;div id="host"&gt;
  &lt;template shadowrootmode="open"&gt;
    &lt;span&gt;A span element in the shadow DOM&lt;/span&gt;
  &lt;/template&gt;
&lt;/div&gt;
</pre></div> <p>We can get a handle to the shadow root from the <code>#host</code> element like this:</p> <div class="code-example"><pre data-language="js">const shadow = document.querySelector("#host").shadowRoot;
</pre></div> <p>The code below shows how we can call <code>setHTML()</code> with a string and different sanitizers in order to filter and inject the HTML into the shadow root.</p> <div class="code-example"><pre data-language="js">// Define unsanitized string of HTML
const unsanitizedString = "abc &lt;script&gt;alert(1)&lt;" + "/script&gt; def";

// setHTML() with default sanitizer
shadow.setHTML(unsanitizedString);

// Define custom Sanitizer and use in setHTML()
// This allows only elements: &lt;div&gt;, &lt;p&gt;, &lt;span&gt; (&lt;script&gt; is unsafe and will be removed)
const sanitizer1 = new Sanitizer({ elements: ["div", "p", "span", "script"] });
shadow.setHTML(unsanitizedString, { sanitizer: sanitizer1 });

// Define custom SanitizerConfig within setHTML()
// This removes elements &lt;div&gt;, &lt;p&gt;, &lt;span&gt;, &lt;script&gt;, and any other unsafe elements/attributes
shadow.setHTML(unsanitizedString, {
  sanitizer: { removeElements: ["div", "p", "span", "script"] },
});
</pre></div>  <h3 id="sethtml_live_example" class="heading">
<code>setHTML()</code> live example</h3> <p>This example provides a "live" demonstration of the method when called with different sanitizers. The code defines buttons that you can click to sanitize and inject a string of HTML using a default and a custom sanitizer, respectively. The original string and sanitized HTML are logged so you can inspect the results in each case.</p> <h4 id="html">HTML</h4> <p>The HTML defines two <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/button"><code>&lt;button&gt;</code></a> elements for applying different sanitizers, another button to reset the example, and a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/div"><code>&lt;div&gt;</code></a> that contains the declarative shadow root.</p> <div class="code-example"><pre data-language="html">&lt;button id="buttonDefault" type="button"&gt;Default&lt;/button&gt;
&lt;button id="buttonAllowScript" type="button"&gt;allowScript&lt;/button&gt;
&lt;button id="reload" type="button"&gt;Reload&lt;/button&gt;

&lt;div id="host"&gt;
  &lt;template shadowrootmode="open"&gt;
    &lt;span&gt;I am in the shadow DOM &lt;/span&gt;
  &lt;/template&gt;
&lt;/div&gt;
</pre></div>   <h4 id="javascript">JavaScript</h4>   <p>First we define the handler for the reload button.</p> <div class="code-example"><pre data-language="js">const reload = document.querySelector("#reload");
reload.addEventListener("click", () =&gt; document.location.reload());
</pre></div> <p>Then we define the string to sanitize, which will be the same for all cases. This contains the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/script"><code>&lt;script&gt;</code></a> element and the <code>onclick</code> handler, both of which are considered XSS-unsafe. We also get variable <code>shadow</code>, which is our handle to the shadow root.</p> <div class="code-example"><pre data-language="js">// Define unsafe string of HTML
const unsanitizedString = `
  &lt;div&gt;
    &lt;p&gt;Paragraph to inject into shadow DOM. &lt;button onclick="alert('You clicked the button!')"&gt;Click me&lt;/button&gt;&lt;/p&gt;
    &lt;script src="path/to/a/module.js" type="module"&gt;&lt;script&gt;
  &lt;/div&gt;
`;

const shadow = document.querySelector("#host").shadowRoot;
</pre></div> <p>Next we define the click handler for the button that sets the shadow root with the default sanitizer. This should strip out all unsafe entities before inserting the string of HTML. Note that you can see exactly which elements are removed in the <a href="../sanitizer/sanitizer#creating_the_default_sanitizer"><code>Sanitizer()</code> constructor examples</a>.</p> <div class="code-example"><pre data-language="js">const defaultSanitizerButton = document.querySelector("#buttonDefault");
defaultSanitizerButton.addEventListener("click", () =&gt; {
  // Set the content of the element using the default sanitizer
  shadow.setHTML(unsanitizedString);

  // Log HTML before sanitization and after being injected
  logElement.textContent =
    "Default sanitizer: remove &amp;lt;script&amp;gt; element and onclick attribute\n\n";
  log(`\nunsanitized: ${unsanitizedString}`);
  log(`\nsanitized: ${shadow.innerHTML}`);
});
</pre></div> <p>The next click handler sets the target HTML using a custom sanitizer that allows only <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/div"><code>&lt;div&gt;</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/p"><code>&lt;p&gt;</code></a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/script"><code>&lt;script&gt;</code></a> elements. Note that because we're using the <code>setHTML</code> method, <code>&lt;script&gt;</code> will also be removed!</p> <div class="code-example"><pre data-language="js">const allowScriptButton = document.querySelector("#buttonAllowScript");
allowScriptButton.addEventListener("click", () =&gt; {
  // Set the content of the element using a custom sanitizer
  const sanitizer1 = new Sanitizer({
    elements: ["div", "p", "script"],
  });
  shadow.setHTML(unsanitizedString, { sanitizer: sanitizer1 });

  // Log HTML before sanitization and after being injected
  logElement.textContent =
    "Sanitizer: {elements: ['div', 'p', 'script']}\n Script removed even though allowed\n";
  log(`\nunsanitized: ${unsanitizedString}`);
  log(`\nsanitized: ${shadow.innerHTML}`);
});
</pre></div>  <h4 id="results">Results</h4> <p>Click the "Default" and "allowScript" buttons to see the effects of the default and custom sanitizer, respectively. Note that because we are using a same sanitization method, in both cases the <code>&lt;script&gt;</code> element and <code>onclick</code> handler are removed, even if explicitly allowed by the sanitizer.</p> <div class="code-example"><iframe class="sample-code-frame" title="setHTML() live example sample" id="frame_sethtml_live_example" width="100" height="350px" src="about:blank" data-live-path="/en-US/docs/Web/API/ShadowRoot/setHTML/" data-live-id="sethtml_live_example" sandbox="allow-same-origin allow-scripts" loading="lazy"></iframe></div>  <h2 id="specifications" class="heading">Specifications</h2> <div class="_table"><table> <thead> <tr> <th scope="col">Specification</th> </tr> </thead> <tbody> <tr> <td><a href="https://wicg.github.io/sanitizer-api/#dom-shadowroot-sethtml" rel="noopener" target="_blank">HTML Sanitizer API&gt;<br># dom-shadowroot-sethtml&gt;</a></td> </tr> </tbody> </table></div>  <h2 id="browser_compatibility" class="heading">Browser compatibility</h2> <div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="5">Desktop</th>
<th colspan="7">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Opera</th>
<th>Safari</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
<th>WebView Android</th>
<th>WebView on iOS</th>
</tr>
</thead>
<tbody><tr>
<th><code>setHTML</code></th>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
</tr></tbody>
</table></div>  <h2 id="see_also" class="heading">See also</h2> <ul> <li><a href="sethtmlunsafe"><code>ShadowRoot.setHTMLUnsafe()</code></a></li> <li>
<a href="../element/sethtml"><code>Element.setHTML()</code></a> and <a href="../element/sethtmlunsafe"><code>Element.setHTMLUnsafe()</code></a>
</li> <li>
<a href="../document/parsehtml_static"><code>Document.parseHTML()</code></a> and <a href="../document/parsehtmlunsafe_static"><code>Document.parseHTMLUnsafe()</code></a>
</li> <li><a href="../html_sanitizer_api">HTML Sanitizer API</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2025 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/ShadowRoot/setHTML" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/ShadowRoot/setHTML</a>
  </p>
</div>
