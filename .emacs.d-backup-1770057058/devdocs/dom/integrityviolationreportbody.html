<h1>IntegrityViolationReportBody</h1>     <div class="notecard secure"><p><strong>Secure context:</strong> This feature is available only in <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts">secure contexts</a> (HTTPS), in some or all <a href="#browser_compatibility">supporting browsers</a>.</p></div> <div class="notecard experimental"><p><strong>Experimental:</strong> <strong>This is an <a href="https://developer.mozilla.org/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental">experimental technology</a></strong><br>Check the <a href="#browser_compatibility">Browser compatibility table</a> carefully before using this in production.</p></div> <p>The <code>IntegrityViolationReportBody</code> dictionary is an extension of the <a href="reporting_api">Reporting API</a> that represents the body of an <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Integrity-Policy">Integrity Policy</a> violation report.</p> <p>Integrity violation reports can be reported to <a href="reporting_api#reporting_server_endpoints">reporting server endpoints</a> or via a <a href="reportingobserver"><code>ReportingObserver</code></a>. They have a <a href="report/type"><code>type</code></a> of <code>"integrity-violation"</code>, a <a href="report/url"><code>url</code></a> indicating the document that contains the violation, and a <a href="report/body"><code>body</code></a> property that is an object matching this dictionary.</p>     <mdn-survey></mdn-survey>  <h2 id="instance_properties" class="heading">Instance properties</h2> <dl> <dt id="blockedurl"><a href="#blockedurl"><code>blockedURL</code> <span class="badge inline readonly">Read only</span></a></dt> <dd> <p>A string representing the URL of the resource blocked by an enforced integrity policy (or just reported for a <a href="#reportonly">reportOnly</a> policy).</p> </dd> <dt id="documenturl"><a href="#documenturl"><code>documentURL</code> <span class="badge inline readonly">Read only</span></a></dt> <dd> <p>A string representing the URL of the document that is attempting to load the resource.</p> </dd> <dt id="destination"><a href="#destination"><code>destination</code> <span class="badge inline readonly">Read only</span></a></dt> <dd> <p>A string indicating the <a href="request/destination#script"><code>Request.destination</code></a> of the resource that was blocked. This can currently only be <code>"script"</code>.</p> </dd> <dt id="reportonly"><a href="#reportonly"><code>reportOnly</code> <span class="badge inline readonly">Read only</span></a></dt> <dd> <p>A boolean: <code>false</code> if the policy was enforced, and <code>true</code> if the violation was only reported.</p> </dd> </dl>  <h2 id="description" class="heading">Description</h2> <p>Integrity Policy violations are reported when a document attempts to load a resource that does not meet the <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">Subresource Integrity</a> guarantees of a policy set using either the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Integrity-Policy"><code>Integrity-Policy</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Integrity-Policy-Report-Only"><code>Integrity-Policy-Report-Only</code></a> HTTP headers.</p> <p>Specifically, a report is sent when a document attempts to load a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/script"><code>&lt;script&gt;</code></a> resource (or other <a href="request/destination">request destination</a> listed in the policy) that does not have valid integrity metadata, or to make a request in <a href="request/mode#no-cors">no-cors</a> mode.</p> <p>Violation reports may be obtained in a violating document using a <a href="reportingobserver"><code>ReportingObserver</code></a> callback (defined in the <a href="reportingobserver/reportingobserver"><code>ReportingObserver()</code></a> constructor), filtering on report objects that have a <code>type</code> of <code>"integrity-violation"</code>.</p> <p>Violation reports may also be sent as JSON objects in <code>POST</code> requests to the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Integrity-Policy#endpoints"><code>endpoints</code></a> specified in the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Integrity-Policy"><code>Integrity-Policy</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Integrity-Policy-Report-Only"><code>Integrity-Policy-Report-Only</code></a> headers. The JSON report objects are a serialization of the reports returned in the <a href="reportingobserver"><code>ReportingObserver</code></a>, and therefore also have a <code>type</code> of <code>"integrity-violation"</code>, and a <code>body</code> property that is a serialization of this object. Note that endpoint values set in the policy must map to identifiers set using the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Reporting-Endpoints"><code>Reporting-Endpoints</code></a> header.</p>  <h2 id="examples" class="heading">Examples</h2> &gt;  <h3 id="reporting_using_the_api" class="heading">Reporting using the API</h3> <p>This example shows how you can obtain Integrity Policy violation reports using a <a href="reportingobserver"><code>ReportingObserver</code></a>.</p> <p>First we set a page's integrity policy using the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Integrity-Policy"><code>Integrity-Policy</code></a>. The policy below reports and blocks resource loading of any <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/script"><code>&lt;script&gt;</code></a> element or <a href="htmlscriptelement"><code>HTMLScriptElement</code></a> object that does not specify an <code>integrity</code> attribute, or when a script resource is requested in <a href="request/mode#no-cors">no-cors</a> mode. Note that for this example we're only interested in reporting the violations using the API, so we're omitting the reporting endpoints:</p> <div class="code-example"><pre data-language="http">Integrity-Policy: blocked-destinations=(script)
</pre></div> <p>Next, we'll assume that our page includes the following element to load a script. Because we want to trigger a violation, it omits the <code>integrity</code> attribute used to check the script matches our expected version. We could also omit the <code>cross-origin</code> attribute so the request is sent in <code>no-cors</code> mode.</p> <div class="code-example"><pre data-language="html">&lt;script
  src="https://example.com/example-framework.js"
  crossorigin="anonymous"&gt;&lt;/script&gt;
</pre></div> <div class="notecard note"> <p><strong>Note:</strong> A script that complies with the policy might look like this:</p> <div class="code-example"><pre data-language="html">&lt;script
  src="https://example.com/example-framework.js"
  integrity="sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC"
  crossorigin="anonymous"&gt;&lt;/script&gt;
</pre></div> </div> <p>To observe violations within the page, we construct a new <a href="reportingobserver"><code>ReportingObserver</code></a> object to listen for reports with the type <code>"integrity-violation"</code>, passing a callback that will receive and log the reports. This code needs to be loaded before the script that causes the violation, in the same page:</p> <div class="code-example"><pre data-language="js">const observer = new ReportingObserver(
  (reports, observer) =&gt; {
    reports.forEach((violation) =&gt; {
      console.log(violation);
      console.log(JSON.stringify(violation));
    });
  },
  {
    types: ["integrity-violation"],
    buffered: true,
  },
);

observer.observe();
</pre></div> <p>Above, we log each violation report object and a JSON-string version of the object, which might look similar to the object below.</p> <div class="code-example"><pre data-language="json">{
  "type": "integrity-violation",
  "url": "https://example.com",
  "body": {
    "documentURL": "https://example.com",
    "blockedURL": "https://example.com/example-framework.js",
    "destination": "script",
    "reportOnly": false
  }
}
</pre></div>  <h3 id="sending_a_report_to_a_reporting_endpoint" class="heading">Sending a report to a reporting endpoint</h3> <p>Configuring a web page to send an Integrity Policy violation report to a <a href="reporting_api#reporting_server_endpoints">reporting server endpoint</a> is very similar to the previous example.</p> <p>The main difference is that we need to specify one or more reporting endpoints where we want the reports to be sent, using the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Reporting-Endpoints"><code>Reporting-Endpoints</code></a> response header, and then reference these in the <code>endpoints</code> field when setting the policy.</p> <p>You can see this below, where we first define two endpoints — <code>integrity-endpoint</code> and <code>backup-integrity-endpoint</code> — and then reference them in our policy:</p> <div class="code-example"><pre data-language="http">Reporting-Endpoints: integrity-endpoint=https://example.com/integrity, backup-integrity-endpoint=https://report-provider.example/integrity
Integrity-Policy: blocked-destinations=(script), endpoints=(integrity-endpoint, backup-integrity-endpoint)
</pre></div> <p>We can trigger a violation by loading an external script from the page that does not meet the subresource integrity guidelines. Just to differ from the previous example, here we send the request in <code>no-cors</code> mode:</p> <div class="code-example"><pre data-language="html">&lt;script
  src="https://example.com/example-framework.js"
  integrity="sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC"&gt;&lt;/script&gt;
</pre></div> <p>The violation report will then be sent to the indicated endpoint as a JSON file. As you can see from the example below, the <code>type</code> is <code>"integrity-violation"</code> and the <code>body</code> property is a serialization of this <code>IntegrityViolationReportBody</code> object:</p> <p>The report in this case would look the same as our JSON report in the previous example.</p> <div class="code-example"><pre data-language="json">{
  "type": "integrity-violation",
  "url": "https://example.com",
  "body": {
    "documentURL": "https://example.com",
    "blockedURL": "https://example.com/example-framework.js",
    "destination": "script",
    "reportOnly": false
  }
}
</pre></div>  <h2 id="specifications" class="heading">Specifications</h2> <div class="_table"><table> <thead> <tr> <th scope="col">Specification</th> </tr> </thead> <tbody> <tr> <td><a href="https://w3c.github.io/webappsec-subresource-integrity/#report-violations" rel="noopener" target="_blank">Subresource Integrity&gt;<br># report-violations&gt;</a></td> </tr> </tbody> </table></div>  <h2 id="browser_compatibility" class="heading">Browser compatibility</h2> <div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="5">Desktop</th>
<th colspan="7">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Opera</th>
<th>Safari</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
<th>WebView Android</th>
<th>WebView on iOS</th>
</tr>
</thead>
<tbody>
<tr>
<th><code>IntegrityViolationReportBody</code></th>
<td class="bc-supports-yes">138</td>
<td class="bc-supports-yes">138</td>
<td class="bc-supports-yes"><details><summary>preview</summary>Reporting <code>endpoints</code> are ignored (violations are logged to console).</details></td>
<td class="bc-supports-yes">122</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">138</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">91</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">138</td>
<td class="bc-supports-no">No</td>
</tr>
<tr>
<th><code>blocked-destinations_script</code></th>
<td class="bc-supports-yes">138</td>
<td class="bc-supports-yes">138</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">122</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">138</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">91</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">138</td>
<td class="bc-supports-no">No</td>
</tr>
<tr>
<th><code>blocked-destinations_style</code></th>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">142</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
</tr>
</tbody>
</table></div>  <h2 id="see_also" class="heading">See also</h2> <ul> <li><a href="reportingobserver"><code>ReportingObserver</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Integrity-Policy"><code>Integrity-Policy</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Integrity-Policy-Report-Only"><code>Integrity-Policy-Report-Only</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Reporting-Endpoints"><code>Reporting-Endpoints</code></a></li> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity#integrity_policy">Integrity Policy</a> in <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity#integrity_policy">Subresource Integrity</a>
</li> <li><a href="reporting_api">Reporting API</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2025 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/IntegrityViolationReportBody" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/IntegrityViolationReportBody</a>
  </p>
</div>
