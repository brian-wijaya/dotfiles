<h1>Sanitizer: removeUnsafe() method</h1> <details class="baseline-indicator not" data-glean-toggle-open="baseline_toggle_open"> <summary>  <div class="status-title"> <span class="not-bold">Limited availability</span> </div>    </summary> <div class="extra"> <p>This feature is not Baseline because it does not work in some of the most widely-used browsers.</p>  <ul> <li> <a href="https://developer.mozilla.org/en-US/docs/Glossary/Baseline/Compatibility" data-glean-id="baseline_link_learn_more" target="_blank" class="learn-more"> Learn more </a> </li> <li> <a href="#browser_compatibility" data-glean-id="baseline_link_bcd_table"> See full compatibility </a> </li> <li> <a href="https://survey.alchemer.com/s3/7634825/MDN-baseline-feedback?page=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FSanitizer%2FremoveUnsafe&amp;level=not" data-glean-id="baseline_link_feedback" class="feedback-link" target="_blank" rel="noreferrer"> Report feedback </a> </li> </ul> </div> </details>   <div class="notecard experimental"><p><strong>Experimental:</strong> <strong>This is an <a href="https://developer.mozilla.org/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental">experimental technology</a></strong><br>Check the <a href="#browser_compatibility">Browser compatibility table</a> carefully before using this in production.</p></div> <p>The <code>removeUnsafe()</code> method of the <a href="../sanitizer"><code>Sanitizer</code></a> interface configures the sanitizer configuration so that it will remove all elements, attributes, and event handler content attributes that are considered XSS-unsafe by the browser.</p> <p>The unsafe elements and attributes are added to the configuration by calling <a href="removeelement"><code>Sanitizer.removeElement()</code></a> and <a href="removeattribute"><code>Sanitizer.removeAttribute()</code></a> for each, respectively. This adds them to the sanitizer configuration disallow lists: <a href="../sanitizerconfig#removeelements"><code>removeElements</code></a> and <a href="../sanitizerconfig#removeattributes_2"><code>removeAttributes</code></a>, and removes them (if present) from the configuration allow lists: <a href="../sanitizerconfig#removeelements"><code>elements</code></a>, <a href="../sanitizerconfig#replacewithchildrenelements"><code>replaceWithChildrenElements</code></a> and <a href="../sanitizerconfig#attributes"><code>attributes</code></a>.</p> <p>The method can be called to make any custom configuration XSS-safe. If used with a configuration that uses the allow lists, it will remove the XSS-unsafe entities from those lists. If used with a configuration that uses only the disallow ("remove") lists, then it ensures the configuration includes the unsafe elements in those lists.</p> <p>Note that if you're using the sanitizer with one of the "safe" HTML setters, such as <a href="../element/sethtml"><code>Element.setHTML()</code></a> and <a href="../shadowroot/sethtml"><code>ShadowRoot.setHTML()</code></a>, you do not need to call this method to make the sanitizer safe. When used in these setters the method is called implicitly, without modifying the <code>Sanitizer</code> instance that is passed.</p>     <mdn-survey></mdn-survey>  <h2 id="syntax" class="heading">Syntax</h2> <div class="code-example"><pre data-language="js">removeUnsafe()
</pre></div>  <h3 id="parameters" class="heading">Parameters</h3> <p>None.</p>  <h3 id="return_value" class="heading">Return value</h3> <p>None (<code>undefined</code>).</p>  <h2 id="examples" class="heading">Examples</h2> &gt;  <h3 id="basic_usage" class="heading">Basic usage</h3> <p>The following code shows how <code>removeUnsafe()</code> is used.</p> <div class="code-example"><pre data-language="js">// Create sanitizer.
const sanitizer = new Sanitizer(/* Some configuration */);

// Make the configuration XSS-safe
sanitizer.removeUnsafe();
</pre></div>  <h3 id="making_a_sanitizer_configuration_safe" class="heading">Making a sanitizer configuration safe</h3> <p>This example demonstrates how calling <code>removeUnsafe()</code> makes the sanitizer configuration XSS-safe.</p>    <h4 id="javascript">JavaScript</h4> <p>The code first creates a new <code>Sanitizer</code> object that allows the safe element <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/p"><code>&lt;p&gt;</code></a>, the unsafe elements <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/script"><code>&lt;script&gt;</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/iframe"><code>&lt;iframe&gt;</code></a>, and the unsafe <code>onwebkitanimationend</code> event handler attribute.</p> <p>The code then calls <code>removeUnsafe()</code> on the sanitizer and logs its configuration.</p>  <div class="code-example"><pre data-language="js">// Create sanitizer that allows
const sanitizer = new Sanitizer({
  elements: ["p", "script"],
  attributes: ["onwebkitanimationend"],
  replaceWithChildrenElements: ["iframe"],
});

// Make the sanitizer safe!
sanitizer.removeUnsafe();

// Log the sanitizer configuration
const sanitizerConfig = sanitizer.get();
log(JSON.stringify(sanitizerConfig, null, 2));
</pre></div>  <h4 id="results">Results</h4> <p>The resulting configuration is shown below. Note how the unsafe elements and attributes have been removed from the "allow" lists to the corresponding "remove" lists. In this case we still have <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/p"><code>&lt;p&gt;</code></a> in the allowed elements, so only <code>&lt;p&gt;</code> elements in the input will be imported when the sanitizer is used.</p> <div class="code-example"><iframe class="sample-code-frame" title="Making a sanitizer configuration safe sample" id="frame_making_a_sanitizer_configuration_safe" width="100" height="480px" src="about:blank" data-live-path="/en-US/docs/Web/API/Sanitizer/removeUnsafe/" data-live-id="making_a_sanitizer_configuration_safe" sandbox="allow-same-origin allow-scripts" loading="lazy"></iframe></div>  <h2 id="specifications" class="heading">Specifications</h2> <div class="_table"><table> <thead> <tr> <th scope="col">Specification</th> </tr> </thead> <tbody> <tr> <td><a href="https://wicg.github.io/sanitizer-api/#dom-sanitizer-removeunsafe" rel="noopener" target="_blank">HTML Sanitizer API&gt;<br># dom-sanitizer-removeunsafe&gt;</a></td> </tr> </tbody> </table></div>  <h2 id="browser_compatibility" class="heading">Browser compatibility</h2> <div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="5">Desktop</th>
<th colspan="7">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Opera</th>
<th>Safari</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
<th>WebView Android</th>
<th>WebView on iOS</th>
</tr>
</thead>
<tbody><tr>
<th><code>removeUnsafe</code></th>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">138</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
</tr></tbody>
</table></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2025 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Sanitizer/removeUnsafe" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/Sanitizer/removeUnsafe</a>
  </p>
</div>
