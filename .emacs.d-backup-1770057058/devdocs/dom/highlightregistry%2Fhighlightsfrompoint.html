<h1>HighlightRegistry: highlightsFromPoint() method</h1> <details class="baseline-indicator not" data-glean-toggle-open="baseline_toggle_open"> <summary>  <div class="status-title"> <span class="not-bold">Limited availability</span> </div>    </summary> <div class="extra"> <p>This feature is not Baseline because it does not work in some of the most widely-used browsers.</p>  <ul> <li> <a href="https://developer.mozilla.org/en-US/docs/Glossary/Baseline/Compatibility" data-glean-id="baseline_link_learn_more" target="_blank" class="learn-more"> Learn more </a> </li> <li> <a href="#browser_compatibility" data-glean-id="baseline_link_bcd_table"> See full compatibility </a> </li> <li> <a href="https://survey.alchemer.com/s3/7634825/MDN-baseline-feedback?page=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FHighlightRegistry%2FhighlightsFromPoint&amp;level=not" data-glean-id="baseline_link_feedback" class="feedback-link" target="_blank" rel="noreferrer"> Report feedback </a> </li> </ul> </div> </details>   <div class="notecard experimental"><p><strong>Experimental:</strong> <strong>This is an <a href="https://developer.mozilla.org/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental">experimental technology</a></strong><br>Check the <a href="#browser_compatibility">Browser compatibility table</a> carefully before using this in production.</p></div> <p>The <code>highlightsFromPoint()</code> method of the <a href="../highlightregistry"><code>HighlightRegistry</code></a> interface returns an array of objects representing the custom highlights applied at a specific point within the viewport.</p>     <mdn-survey></mdn-survey>  <h2 id="syntax" class="heading">Syntax</h2> <div class="code-example"><pre data-language="js">highlightsFromPoint(x, y)
highlightsFromPoint(x, y, options)
</pre></div>  <h3 id="parameters" class="heading">Parameters</h3> <dl> <dt id="x"><a href="#x"><code>x</code></a></dt> <dd> <p>The x-coordinate of the point within the viewport from which to return custom highlight information.</p> </dd> <dt id="y"><a href="#y"><code>y</code></a></dt> <dd> <p>The y-coordinate of the point within the viewport from which to return custom highlight information.</p> </dd> <dt id="options"><a href="#options"><code>options</code> <span class="badge inline optional">Optional</span></a></dt> <dd> <p>An object containing options, which can include:</p> <dl> <dt id="shadowroots"><a href="#shadowroots"><code>shadowRoots</code></a></dt> <dd> <p>An array of <a href="../shadowroot"><code>ShadowRoot</code></a> objects. Custom highlights that exist at the specified point inside shadow roots in the array will also be included in the return value, in addition to those present in the light DOM. By default, highlights inside shadow roots are not returned.</p> </dd> </dl> </dd> </dl>  <h3 id="return_value" class="heading">Return value</h3> <p>An array of <code>HighlightHitResult</code> objects representing the custom highlights applied at the point in the viewport specified by the <code>x</code> and <code>y</code> parameters.</p> <p>Each <code>HighlightHitResult</code> object contains the following properties:</p> <dl> <dt id="highlight"><a href="#highlight"><code>highlight</code></a></dt> <dd> <p>A <a href="../highlight"><code>Highlight</code></a> object representing the applied custom highlight.</p> </dd> <dt id="ranges"><a href="#ranges"><code>ranges</code></a></dt> <dd> <p>An array of <a href="../abstractrange"><code>AbstractRange</code></a> objects representing the ranges to which the custom highlight is applied.</p> </dd> </dl> <p>If no custom highlights are applied at the specified point, or the specified point is outside the viewport, the method returns an empty array.</p>  <h2 id="examples" class="heading">Examples</h2> &gt;  <h3 id="output_custom_highlights_applied_at_the_mouse_pointer_position" class="heading">Output custom highlights applied at the mouse pointer position</h3> <p>In this example, you can apply custom highlights to a paragraph of text. These custom highlights can be overlapping. When the user double-clicks the paragraph, we use the <code>highlightsFromPoint()</code> method to return the content of any custom highlights located at the mouse pointer coordinates of the double-click.</p> <h4 id="html">HTML</h4> <p>The markup includes a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/p"><code>&lt;p&gt;</code></a> element containing text to which you can apply custom highlights, and a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/section"><code>&lt;section&gt;</code></a> element into which we will output the highlighted text fragments.</p> <div class="code-example"><pre data-language="html">&lt;h1&gt;highlightsFromPoint() demo&lt;/h1&gt;
&lt;p class="highlightable-text"&gt;
  When you select a section of text then press "h" on the keyboard, the text you
  selected will be given a custom highlight. Multiple highlights will be colored
  yellow, red, and blue, in that order. When you double-click on a highlighted
  section of text, that section will be outputted at the bottom of the UI. If
  multiple highlights overlap the section, you'll see multiple text sections
  outputted.
&lt;/p&gt;
&lt;h2&gt;Highlighted text at point&lt;/h2&gt;
&lt;section&gt;&lt;/section&gt;
</pre></div> <h4 id="css">CSS</h4> <p>In the CSS, we define styling for three custom highlights named <code>highlight1</code>, <code>highlight2</code>, and <code>highlight3</code>. We select each custom highlight by passing its name into the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/::highlight"><code>::highlight()</code></a> pseudo-element, giving them yellow, red, and blue background colors respectively.</p>  <div class="code-example"><pre data-language="css">:root::highlight(highlight1) {
  background-color: rgb(255 255 0 / 0.5);
}

:root::highlight(highlight2) {
  background-color: rgb(255 0 0 / 0.5);
}

:root::highlight(highlight3) {
  background-color: rgb(0 0 255 / 0.75);
  color: white;
}
</pre></div> <h4 id="javascript">JavaScript</h4> <p>The script for this example has two distinct areas of functionality: We first need to create custom highlights and apply them to our content, then we can use the <code>highlightsFromPoint()</code> method to return custom highlights from a specific point.</p> <h5 id="creating_and_applying_custom_highlights">Creating and applying custom highlights</h5> <p>To create custom highlights, we start by grabbing references to the <code>&lt;p&gt;</code> element and its contained text node. We then create a variable called <code>highlightCount</code>, initially set to <code>1</code>, which will be used to specify which custom highlight to apply later on.</p> <div class="code-example"><pre data-language="js">const pElem = document.querySelector(".highlightable-text");
const textNode = pElem.firstChild;
let highlightCount = 1;
</pre></div> <p>Next, we define a <a href="../element/keydown_event"><code>keydown</code></a> event handler that applies a custom highlight to any selected text if <kbd>h</kbd> is pressed on the keyboard. Inside, we start by grabbing the selected text using <a href="../window/getselection"><code>Window.getSelection()</code></a> and converting it to a <a href="../range"><code>Range</code></a> using <a href="../selection/getrangeat"><code>Selection.getRangeAt()</code></a>.</p> <p>We check that the <code>selectedRange</code> object's <a href="../range/startcontainer"><code>startContainer</code></a> and <a href="../range/endcontainer"><code>endContainer</code></a> are both equal to the paragraph <code>textNode</code>, to make sure we don't allow any cross-container highlights. If so, we set the custom <code>highlightName</code> we want to apply to the <code>selectedRange</code> using <code>highlight${highlightCount++}</code>. Since we are incrementing <code>highlightCount</code>, we add in a check â€” when it reaches <code>4</code>, we set it back to <code>1</code>. This has the effect of cycling through the available highlights in order as they are set.</p> <p>Finally for the <code>keydown</code> event handler, we create a new <code>highlight</code> object using the <a href="../highlight/highlight"><code>Highlight()</code></a> constructor, passing it the <code>selectedRange</code> we created earlier. We then apply the chosen custom highlight referenced in <code>highlightName</code> to <code>highlight</code> using the <a href="set"><code>HighlightRegistry.set()</code></a> method.</p> <div class="code-example"><pre data-language="js">window.addEventListener("keydown", (event) =&gt; {
  if (event.key === "h") {
    const selection = window.getSelection();
    const selectedRange = selection.getRangeAt(0);
    if (
      selectedRange.startContainer === textNode &amp;&amp;
      selectedRange.endContainer === textNode
    ) {
      const highlightName = `highlight${highlightCount++}`;
      if (highlightCount === 4) {
        highlightCount = 1;
      }
      const highlight = new Highlight(selectedRange);
      CSS.highlights.set(highlightName, highlight);
    }
  }
});
</pre></div> <h5 id="returning_custom_highlights_from_a_point">Returning custom highlights from a point</h5> <p>Now that we have the ability to create and apply custom highlights, we can use the <code>highlightsFromPoint()</code> method to return the custom highlights applied at a specific point.</p> <p>We grab a reference to our <code>&lt;section&gt;</code> element, then define a <a href="../element/dblclick_event"><code>dblclick</code></a> event handler function to handle outputting the highlighted text at the mouse cursor position when the event fires. Inside the handler we pass the current mouse coordinates into a <code>highlightsFromPoint()</code> call, clear the contents of the <code>&lt;section&gt;</code> element, then loop through each highlight in the <code>highlights</code> array.</p> <p>For each <code>highlight</code>, we grab the first range in the <a href="#ranges"><code>ranges</code></a> array (there is only ever one range in each highlight, in this case), then get the exact highlighted string using <a href="../range/tostring"><code>Range.toString()</code></a> and add it to the <code>&lt;section&gt;</code> element's <code>innerHTML</code>, inside an <code>&lt;article&gt;</code> element.</p> <div class="code-example"><pre data-language="js">const section = document.querySelector("section");

pElem.addEventListener("dblclick", (event) =&gt; {
  const highlights = CSS.highlights.highlightsFromPoint(
    event.clientX,
    event.clientY,
  );

  section.innerHTML = "";
  for (highlight of highlights) {
    const range = highlight.ranges[0];
    const textSelection = range.toString();
    section.innerHTML += `&lt;article&gt;${textSelection}&lt;/article&gt;`;
  }
});
</pre></div> <h4 id="result">Result</h4> <div class="code-example"><iframe class="sample-code-frame" title="highlights-from-point-example sample" id="frame_highlights-from-point-example" width="100%" height="600" src="about:blank" data-live-path="/en-US/docs/Web/API/HighlightRegistry/highlightsFromPoint/" data-live-id="highlights-from-point-example" sandbox="allow-same-origin allow-scripts" loading="lazy"></iframe></div>  <h2 id="specifications" class="heading">Specifications</h2> <div class="_table"><table> <thead> <tr> <th scope="col">Specification</th> </tr> </thead> <tbody> <tr> <td><a href="https://drafts.csswg.org/css-highlight-api-1/#dom-highlightregistry-highlightsfrompoint" rel="noopener" target="_blank">CSS Custom Highlight API Module Level 1&gt;<br># dom-highlightregistry-highlightsfrompoint&gt;</a></td> </tr> </tbody> </table></div>  <h2 id="browser_compatibility" class="heading">Browser compatibility</h2> <div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="5">Desktop</th>
<th colspan="7">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Opera</th>
<th>Safari</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
<th>WebView Android</th>
<th>WebView on iOS</th>
</tr>
</thead>
<tbody><tr>
<th><code>highlightsFromPoint</code></th>
<td class="bc-supports-yes">140</td>
<td class="bc-supports-yes">140</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">124</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">140</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">140</td>
<td class="bc-supports-no">No</td>
</tr></tbody>
</table></div>  <h2 id="see_also" class="heading">See also</h2> <ul> <li><a href="../css_custom_highlight_api">The CSS Custom Highlight API</a></li> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_custom_highlight_API">CSS custom highlight API</a> module</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2025 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/HighlightRegistry/highlightsFromPoint" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/HighlightRegistry/highlightsFromPoint</a>
  </p>
</div>
