<h1>The structured clone algorithm</h1>    <p>The <strong>structured clone algorithm</strong> copies complex JavaScript objects. It is used internally when invoking <a href="../workerglobalscope/structuredclone"><code>structuredClone()</code></a>, to transfer data between <a href="../worker">Workers</a> via <a href="../worker/postmessage"><code>postMessage()</code></a>, storing objects with <a href="https://developer.mozilla.org/en-US/docs/Glossary/IndexedDB">IndexedDB</a>, or copying objects for <a href="#see_also">other APIs</a>.</p> <p>It clones by recursing through the input object while maintaining a map of previously visited references, to avoid infinitely traversing cycles.</p>     <mdn-survey></mdn-survey>  <h2 id="things_that_dont_work_with_structured_clone" class="heading">Things that don't work with structured clone</h2> <ul> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function"><code>Function</code></a> objects cannot be duplicated by the structured clone algorithm; attempting to throws a <code>DataCloneError</code> exception.</li> <li>Cloning DOM nodes likewise throws a <code>DataCloneError</code> exception.</li> <li>Certain object properties are not preserved: <ul> <li>The <code>lastIndex</code> property of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp"><code>RegExp</code></a> objects is not preserved.</li> <li>Property descriptors, setters, getters, and similar metadata-like features are not duplicated. For example, if an object is marked readonly with a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptor">property descriptor</a>, it will be read/write in the duplicate, since that's the default.</li> <li>The prototype chain is not walked or duplicated.</li> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Private_elements">Class private elements</a> are not duplicated. (Although internal fields of built-in types may.)</li> </ul> </li> </ul>  <h2 id="supported_types" class="heading">Supported types</h2> &gt;  <h3 id="javascript_types" class="heading">JavaScript types</h3> <ul> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array"><code>Array</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer"><code>ArrayBuffer</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean"><code>Boolean</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView"><code>DataView</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date"><code>Date</code></a></li> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error"><code>Error</code></a> types (but see <a href="#error_types">Error types</a> below).</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map"><code>Map</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number"><code>Number</code></a></li> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object"><code>Object</code></a> objects: but only plain objects (e.g., from object literals).</li> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Data_structures#primitive_values">Primitive types</a>, except <code>symbol</code>.</li> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp"><code>RegExp</code></a>: but note that <code>lastIndex</code> is not preserved.</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set"><code>Set</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String"><code>String</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray"><code>TypedArray</code></a></li> </ul> <h4 id="error_types">Error types</h4> <p>For <code>Error</code> types, the error name must be one of: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error"><code>Error</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/EvalError"><code>EvalError</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RangeError"><code>RangeError</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError"><code>ReferenceError</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError"><code>SyntaxError</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError"><code>TypeError</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/URIError"><code>URIError</code></a> (or will be set to "Error").</p> <p>Browsers must serialize the properties <code>name</code> and <code>message</code>, and are expected to serialize other "interesting" properties of the errors such as <code>stack</code>, <code>cause</code>, etc.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AggregateError"><code>AggregateError</code></a> support is expected to be added to the specification in <a href="https://github.com/whatwg/html/pull/5749" target="_blank">whatwg/html#5749</a> (and is already supported in some browsers).</p>  <h3 id="webapi_types" class="heading">Web/API types</h3> <ul> <li><a href="../audiodata"><code>AudioData</code></a></li> <li><a href="../blob"><code>Blob</code></a></li> <li><a href="../croptarget"><code>CropTarget</code></a></li> <li><a href="../cryptokey"><code>CryptoKey</code></a></li> <li>
<a href="../domexception"><code>DOMException</code></a>: browsers must serialize the properties <a href="../domexception/name"><code>name</code></a> and <a href="../domexception/message"><code>message</code></a>. Other attributes may also be serialized/cloned.</li> <li><a href="../dommatrix"><code>DOMMatrix</code></a></li> <li><a href="../dommatrixreadonly"><code>DOMMatrixReadOnly</code></a></li> <li><a href="../dompoint"><code>DOMPoint</code></a></li> <li><a href="../dompointreadonly"><code>DOMPointReadOnly</code></a></li> <li><a href="../domquad"><code>DOMQuad</code></a></li> <li><a href="../domrect"><code>DOMRect</code></a></li> <li><a href="../domrectreadonly"><code>DOMRectReadOnly</code></a></li> <li><a href="../encodedaudiochunk"><code>EncodedAudioChunk</code></a></li> <li><a href="../encodedvideochunk"><code>EncodedVideoChunk</code></a></li> <li><a href="../fencedframeconfig"><code>FencedFrameConfig</code></a></li> <li><a href="../file"><code>File</code></a></li> <li><a href="../filelist"><code>FileList</code></a></li> <li><a href="../filesystemdirectoryhandle"><code>FileSystemDirectoryHandle</code></a></li> <li><a href="../filesystemfilehandle"><code>FileSystemFileHandle</code></a></li> <li><a href="../filesystemhandle"><code>FileSystemHandle</code></a></li> <li><a href="../gpucompilationinfo"><code>GPUCompilationInfo</code></a></li> <li><a href="../gpucompilationmessage"><code>GPUCompilationMessage</code></a></li> <li><a href="../gpupipelineerror"><code>GPUPipelineError</code></a></li> <li><a href="../imagebitmap"><code>ImageBitmap</code></a></li> <li><a href="../imagedata"><code>ImageData</code></a></li> <li><a href="../rtccertificate"><code>RTCCertificate</code></a></li> <li><a href="../rtcencodedaudioframe"><code>RTCEncodedAudioFrame</code></a></li> <li><a href="../rtcencodedvideoframe"><code>RTCEncodedVideoFrame</code></a></li> <li><a href="../videoframe"><code>VideoFrame</code></a></li> <li><a href="../webtransporterror"><code>WebTransportError</code></a></li> </ul> <div class="notecard note"> <p><strong>Note:</strong> Serializable objects are marked up in <a href="https://github.com/w3c/webref/tree/main/ed/idl" target="_blank">Web IDL files</a> with the attribute <code>[Serializable]</code>.</p> </div>  <h2 id="see_also" class="heading">See also</h2> <ul> <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#safe-passing-of-structured-data" target="_blank">HTML Specification: Safe passing of structured data</a></li> <li><a href="transferable_objects">Transferable objects</a></li> <li><a href="../window/structuredclone"><code>Window.structuredClone()</code></a></li> <li><a href="../workerglobalscope/structuredclone"><code>WorkerGlobalScope.structuredClone()</code></a></li> <li><a href="../window/postmessage"><code>window.postMessage()</code></a></li> <li><a href="../web_workers_api">Web Workers</a></li> <li><a href="../indexeddb_api">IndexedDB</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2025 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm</a>
  </p>
</div>
