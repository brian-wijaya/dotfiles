<h1 id="_top" class="astro-62i6xxx4">Upgrade to Astro v5</h1> <div class="content-panel astro-2mug3n2c"> <div class="sl-container astro-2mug3n2c"> <div class="sl-markdown-content"> <p>This guide will help you migrate from Astro v4 to Astro v5.</p> <p>Need to upgrade an older project to v4 first? See our <a href="../v4/index">older migration guide</a>.</p> <p>Need to see the v4 docs? Visit this <a href="https://v4.docs.astro.build/">older version of the docs site (unmaintained v4.16 snapshot)</a>.</p> <div class="sl-heading-wrapper level-h2">
<h2 id="upgrade-astro">Upgrade Astro</h2>
<a class="sl-anchor-link" href="#upgrade-astro"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Upgrade Astro”</span></a>
</div> <p>Update your project’s version of Astro to the latest version using your package manager:</p>  <starlight-tabs data-sync-key="package-managers" class="astro-xtbw65nk"> <div class="tablist-wrapper not-content astro-xtbw65nk"> <ul role="tablist" class="astro-xtbw65nk"> <li role="presentation" class="tab astro-xtbw65nk"> <a role="tab" href="#tab-panel-3549" id="tab-3549" aria-selected="true" tabindex="0" class="astro-xtbw65nk"> npm </a> </li>
<li role="presentation" class="tab astro-xtbw65nk"> <a role="tab" href="#tab-panel-3550" id="tab-3550" aria-selected="false" tabindex="-1" class="astro-xtbw65nk"> pnpm </a> </li>
<li role="presentation" class="tab astro-xtbw65nk"> <a role="tab" href="#tab-panel-3551" id="tab-3551" aria-selected="false" tabindex="-1" class="astro-xtbw65nk"> Yarn </a> </li> </ul> </div> <div id="tab-panel-3549" aria-labelledby="tab-3549" role="tabpanel"> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell"># Upgrade Astro and official integrations together
npx @astrojs/upgrade</pre>

</div> </div> <div id="tab-panel-3550" aria-labelledby="tab-3550" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell"># Upgrade Astro and official integrations together
pnpm dlx @astrojs/upgrade</pre>

</div> </div> <div id="tab-panel-3551" aria-labelledby="tab-3551" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell"># Upgrade Astro and official integrations together
yarn dlx @astrojs/upgrade</pre>

</div> </div> <starlight-tabs-restore class="astro-xtbw65nk"></starlight-tabs-restore> </starlight-tabs>  <p>You can also <a href="../../integrations-guide/index#manual-upgrading">upgrade your Astro integrations manually</a> if needed, and you may also need to upgrade other dependencies in your project.</p> <aside aria-label="Need to continue?" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewbox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Need to continue?</p>
<div class="starlight-aside__content">
<p>After upgrading Astro, you may not need to make any changes to your project at all!</p>
<p>But, if you notice errors or unexpected behavior, please check below for what has changed that might need updating in your project.</p>
</div></aside> <p>Astro v5.0 includes <a href="#breaking-changes">potentially breaking changes</a>, as well as the removal and deprecation of some features.</p> <p>If your project doesn’t work as expected after upgrading to v5.0, check this guide for an overview of all breaking changes and instructions on how to update your codebase.</p> <p>See <a href="https://github.com/withastro/astro/blob/main/packages/astro/CHANGELOG.md">the Astro changelog</a> for full release notes.</p> <div class="sl-heading-wrapper level-h2">
<h2 id="dependency-upgrades">Dependency Upgrades</h2>
<a class="sl-anchor-link" href="#dependency-upgrades"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Dependency Upgrades”</span></a>
</div> <p>Any major upgrades to Astro’s dependencies may cause breaking changes in your project.</p> <div class="sl-heading-wrapper level-h3">
<h3 id="vite-60">Vite 6.0</h3>
<a class="sl-anchor-link" href="#vite-60"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Vite 6.0”</span></a>
</div> <p>Astro v5.0 upgrades to Vite v6.0 as the development server and production bundler.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you are using Vite-specific plugins, configuration, or APIs, check the <a href="https://vite.dev/guide/migration.html">Vite migration guide</a> for their breaking changes and upgrade your project as needed.</p> <div class="sl-heading-wrapper level-h3">
<h3 id="astrojsmdx"><code dir="auto">@astrojs/mdx</code></h3>
<a class="sl-anchor-link" href="#astrojsmdx"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “@astrojs/mdx”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11741" class="astro-ro74hpkt">Implementation PR: Cleanup unused JSX code (#11741)</a> </div> <p>In Astro v4.x, Astro performed internal JSX handling for the <code dir="auto">@astrojs/mdx</code> integration.</p> <p>Astro v5.0 moves this responsibility to handle and render JSX and MDX to the <code dir="auto">@astrojs/mdx</code> package directly. This means that Astro 5.0 is no longer compatible with older versions of the MDX integration.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-1">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-1"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If your project includes <code dir="auto">.mdx</code> files, you must upgrade <code dir="auto">@astrojs/mdx</code> to the latest version (v4.0.0) so that your JSX can be handled properly by the integration.</p> <p>If you are using an MDX server renderer with the experimental <a href="../../../reference/container-reference/index">Astro Container API</a> you must update the import to reflect the new location:</p> <div class="expressive-code">

<pre data-language="ts">import mdxRenderer from "astro/jsx/server.js";
import mdxRenderer from "@astrojs/mdx/server.js";</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Learn more about <a href="../../integrations-guide/mdx/index">using MDX in your project</a>.</span> </div> <div class="sl-heading-wrapper level-h2">
<h2 id="legacy">Legacy</h2>
<a class="sl-anchor-link" href="#legacy"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Legacy”</span></a>
</div> <p>The following features are now considered legacy features. They should function normally but are no longer recommended and are in maintenance mode. They will see no future improvements and documentation will not be updated. These features will eventually be deprecated, and then removed entirely.</p> <div class="sl-heading-wrapper level-h3">
<h3 id="legacy-v20-content-collections-api">Legacy: v2.0 Content Collections API</h3>
<a class="sl-anchor-link" href="#legacy-v20-content-collections-api"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Legacy: v2.0 Content Collections API”</span></a>
</div> <p>In Astro 4.x, content collections were defined, queried, and rendered using <a href="https://astro.build/blog/introducing-content-collections/">the Content Collections API first introduced in Astro v2.0</a>. All collection entries were local files within the reserved <code dir="auto">src/content/</code> folder. Additionally, Astro’s <a href="../../routing/index#excluding-pages">file name convention to exclude building individual pages</a> was built in to the Content Collections API.</p> <p>Astro 5.0 introduces a new version of content collections using the Content Layer API which brings several performance improvements and added capabilities. While old (legacy) and new (Content Layer API) collections can continue exist together in this release, there are potentially breaking changes to existing legacy collections.</p> <p>This release also removes the option to prefix collection entry file names with an underscore (<code dir="auto">_</code>) to prevent building a route.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-2">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-2"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>We recommend <a href="#updating-existing-collections">converting any existing collections to the new Content Layer API</a> as soon as you are able and making any new collections using the Content Layer API.</p> <p>If you are unable to convert your collections, then please consult the <a href="#breaking-changes-to-legacy-content-and-data-collections">legacy collections breaking changes</a> to see whether your existing collections are affected and require updating.</p> <p>If you are unable to make any changes to your collections at this time, you can <a href="#enabling-the-legacycollections-flag">enable the <code dir="auto">legacy.collections</code> flag</a> which will allow you to keep your collections in their current state until the legacy flag is no longer supported.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Learn more about the updated <a href="../../content-collections/index">content collections</a>.</span> </div> <div class="sl-heading-wrapper level-h5">
<h5 id="updating-existing-collections">Updating existing collections</h5>
<a class="sl-anchor-link" href="#updating-existing-collections"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Updating existing collections”</span></a>
</div> <p>See the instructions below for updating an existing content collection (<code dir="auto">type: 'content'</code> or <code dir="auto">type: 'data'</code>) to use the Content Layer API.</p> <details><summary>Step-by-step instructions to update a collection</summary><ol role="list" class="sl-steps"> <li> <p><strong>Move the content config file</strong>. This file no longer lives within the <code dir="auto">src/content/</code> folder. This file should now exist at <code dir="auto">src/content.config.ts</code>.</p> </li> <li> <p><strong>Edit the collection definition</strong>. Your updated collection requires a <code dir="auto">loader</code> which indicates both a folder for the location of your collection (<code dir="auto">base</code>) and a <code dir="auto">pattern</code> defining the collection entry filenames and extensions to match. (You may need to update the example below accordingly. You can use <a href="https://globster.xyz/">globster.xyz</a> to check your glob pattern.) The option to select a collection <code dir="auto">type</code> is no longer available.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/content.config.ts</span></div>
<pre data-language="ts">import { defineCollection, z } from 'astro:content';
import { glob } from 'astro/loaders';


const blog = defineCollection({
  // For content layer you no longer define a `type`
  type: 'content',
  loader: glob({ pattern: '**/[^_]*.{md,mdx}', base: "./src/data/blog" }),
  schema: z.object({
    title: z.string(),
    description: z.string(),
    pubDate: z.coerce.date(),
    updatedDate: z.coerce.date().optional(),
  }),
});</pre>

</div> </li> <li> <p><strong>Change references from <code dir="auto">slug</code> to <code dir="auto">id</code></strong>. Content layer collections do not have a reserved <code dir="auto">slug</code> field. Instead, all updated collections will have an <code dir="auto">id</code>:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/[slug].astro</span></div>
<pre data-language="astro">---
export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) =&gt; ({
    params: { slug: post.slug },
    params: { slug: post.id },
    props: post,
  }));
}
---</pre>

</div> <p>You can also update the dynamic routing file names to match the value of the changed <code dir="auto">getStaticPaths()</code> parameter.</p> </li> <li> <p><strong>Switch to the new <code dir="auto">render()</code> function</strong>. Entries no longer have a <code dir="auto">render()</code> method, as they are now serializable plain objects. Instead, import the <code dir="auto">render()</code> function from <code dir="auto">astro:content</code>.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/index.astro</span></div>
<pre data-language="astro">---
import { getEntry, render } from 'astro:content';


const post = await getEntry('blog', params.slug);


const { Content, headings } = await post.render();
const { Content, headings } = await render(post);
---
&lt;Content /&gt;</pre>

</div> </li> </ol> </details> <div class="sl-heading-wrapper level-h5">
<h5 id="breaking-changes-to-legacy-content-and-data-collections">Breaking changes to legacy <code dir="auto">content</code> and <code dir="auto">data</code> collections</h5>
<a class="sl-anchor-link" href="#breaking-changes-to-legacy-content-and-data-collections"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Breaking changes to legacy content and data collections”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11976" class="astro-ro74hpkt">Implementation PR: Implement legacy collections using glob (#11976)</a> </div> <p>By default, collections that use the old <code dir="auto">type</code> property (<code dir="auto">content</code> or <code dir="auto">data</code>) and do not define a <code dir="auto">loader</code> are now implemented under the hood using the Content Layer API’s built-in <code dir="auto">glob()</code> loader, with extra backward-compatibility handling.</p> <p>Additionally, temporary backwards compatibility exists for keeping the content config file in its original location of <code dir="auto">src/content/config.ts</code>.</p> <p>This backwards compatibility implementation is able to emulate most of the features of legacy collections and will allow many legacy collections to continue to work even without updating your code. However, <strong>there are some differences and limitations that may cause breaking changes to existing collections</strong>:</p> <ul> <li>In previous versions of Astro, collections would be generated for all folders in <code dir="auto">src/content/</code>, even if they were not defined in <code dir="auto">src/content/config.ts</code>. This behavior is now deprecated, and collections should always be defined in <code dir="auto">src/content.config.ts</code>. For existing collections, these can just be empty declarations (e.g. <code dir="auto">const blog = defineCollection({})</code>) and Astro will implicitly define your legacy collection for you in a way that is compatible with the new loading behavior.</li> <li>The special <code dir="auto">layout</code> field is not supported in Markdown collection entries. This property is intended only for standalone page files located in <code dir="auto">src/pages/</code> and not likely to be in your collection entries. However, if you were using this property, you must now create dynamic routes that include your page styling.</li> <li>Sort order of generated collections is non-deterministic and platform-dependent. This means that if you are calling <code dir="auto">getCollection()</code>, the order in which entries are returned may be different than before. If you need a specific order, you must sort the collection entries yourself.</li> <li>
<code dir="auto">image().refine()</code> is not supported. If you need to validate the properties of an image you will need to do this at runtime in your page or component.</li> <li>The <code dir="auto">key</code> argument of <code dir="auto">getEntry(collection, key)</code> is typed as <code dir="auto">string</code>, rather than having types for every entry.</li> <li>Previously when calling <code dir="auto">getEntry(collection, key)</code> with a static string as the key, the return type was not nullable. The type now includes <code dir="auto">undefined</code> so you must check if the entry is defined before using the result or you will have type errors.</li> </ul> <div class="sl-heading-wrapper level-h5">
<h5 id="enabling-the-legacycollections-flag">Enabling the <code dir="auto">legacy.collections</code> flag</h5>
<a class="sl-anchor-link" href="#enabling-the-legacycollections-flag"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Enabling the legacy.collections flag”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11976" class="astro-ro74hpkt">Implementation PR: Implement legacy collections using glob (#11976)</a> </div> <p>If you are not yet ready to update your existing collections, you can enable the <a href="../../../reference/legacy-flags/index"><code dir="auto">legacy.collections</code></a> flag and your existing collections will continue to function as before.</p> <div class="sl-heading-wrapper level-h2">
<h2 id="deprecated">Deprecated</h2>
<a class="sl-anchor-link" href="#deprecated"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Deprecated”</span></a>
</div> <p>The following deprecated features are no longer supported and are no longer documented. Please update your project accordingly.</p> <p>Some deprecated features may temporarily continue to function until they are completely removed. Others may silently have no effect, or throw an error prompting you to update your code.</p> <div class="sl-heading-wrapper level-h3">
<h3 id="deprecated-astroglob">Deprecated: <code dir="auto">Astro.glob()</code>
</h3>
<a class="sl-anchor-link" href="#deprecated-astroglob"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Deprecated: Astro.glob()”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11826" class="astro-ro74hpkt">Implementation PR: Deprecate glob (#11826)</a> </div> <p>In Astro v4.x, you could use <code dir="auto">Astro.glob()</code> in your <code dir="auto">.astro</code> components to query multiple files in your project. This had some limitations (where it could be used, performance, etc.), and using querying functions from the Content Collections API or Vite’s own <code dir="auto">import.meta.glob()</code> often provided more function and flexibility.</p> <p>Astro 5.0 deprecates <code dir="auto">Astro.glob()</code> in favor of using <code dir="auto">getCollection()</code> to query your collections, and <code dir="auto">import.meta.glob()</code> to query other source files in your project.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-3">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-3"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Replace all use of <code dir="auto">Astro.glob()</code> with <code dir="auto">import.meta.glob()</code>. Note that <code dir="auto">import.meta.glob()</code> no longer returns a <code dir="auto">Promise</code>, so you may have to update your code accordingly. You should not require any updates to your <a href="../../imports/index#glob-patterns">glob patterns</a>.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/blog.astro</span></div>
<pre data-language="astro">---
const posts = await Astro.glob('./posts/*.md');
const posts = Object.values(import.meta.glob('./posts/*.md', { eager: true }));
---


{posts.map((post) =&gt; &lt;li&gt;&lt;a href={post.url}&gt;{post.frontmatter.title}&lt;/a&gt;&lt;/li&gt;)}</pre>

</div> <p>Where appropriate, consider using <a href="../../content-collections/index">content collections</a> to organize your content, which has its own newer, more performant querying functions.</p> <p>You may also wish to consider using glob packages from NPM, such as <a href="https://www.npmjs.com/package/fast-glob"><code dir="auto">fast-glob</code></a>.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Learn more about <a href="../../imports/index#importmetaglob">importing files with <code dir="auto">import.meta.glob</code></a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="deprecated-functionperroute-adapter-api">Deprecated: <code dir="auto">functionPerRoute</code> (Adapter API)</h3>
<a class="sl-anchor-link" href="#deprecated-functionperroute-adapter-api"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Deprecated: functionPerRoute (Adapter API)”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11714" class="astro-ro74hpkt">Implementation PR: Remove functionPerRoute option (#11714)</a> </div> <p>In Astro v4.x, you could opt into creating a separate file for each route defined in the project, mirroring your <code dir="auto">src/pages/</code> directory in the build folder. By default, Astro emitted a single <code dir="auto">entry.mjs</code> file, which was responsible for emitting the rendered page on each request.</p> <p>Astro v5.0 removes the option to opt out of the default behavior. This behavior is now standard, and non-configurable.</p> <p>Remove the <code dir="auto">functionPerRoute</code> property from your <code dir="auto">adapterFeatures</code> configuration. It is no longer available.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">my-adapter.mjs</span></div>
<pre data-language="js">export default function createIntegration() {
  return {
    name: '@matthewp/my-adapter',
    hooks: {
      'astro:config:done': ({ setAdapter }) =&gt; {
        setAdapter({
          name: '@matthewp/my-adapter',
          serverEntrypoint: '@matthewp/my-adapter/server.js',
          adapterFeatures: {
              functionPerRoute: true
          }
        });
      },
    },
  };
}</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Learn more about <a href="../../../reference/adapter-reference/index">the Adapter API</a> for building adapter integrations.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="deprecated-routes-on-astrobuilddone-hook-integration-api">Deprecated: <code dir="auto">routes</code> on <code dir="auto">astro:build:done</code> hook (Integration API)</h3>
<a class="sl-anchor-link" href="#deprecated-routes-on-astrobuilddone-hook-integration-api"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Deprecated: routes on astro:build:done hook (Integration API)”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/12329" class="astro-ro74hpkt">Implementation PR: feat(next): astro:routes:resolved (#12329)</a> </div> <p>In Astro v4.x, integrations accessed routes from the <code dir="auto">astro:build:done</code> hook.</p> <p>Astro v5.0 deprecates the <code dir="auto">routes</code> array passed to this hook. Instead, it exposes a new <code dir="auto">astro:routes:resolved</code> hook that runs before <code dir="auto">astro:config:done</code>, and whenever a route changes in development. It has all the same properties of the deprecated <code dir="auto">routes</code> list, except <code dir="auto">distURL</code> which is only available during build.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-4">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-4"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Remove any instance of <code dir="auto">routes</code> passed to <code dir="auto">astro:build:done</code> and replace it with the new <code dir="auto">astro:routes:resolved</code> hook. Access <code dir="auto">distURL</code> on the newly exposed <code dir="auto">assets</code> map:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">my-integration.mjs</span></div>
<pre data-language="js">const integration = () =&gt; {
    let routes
    return {
        name: 'my-integration',
        hooks: {
            'astro:routes:resolved': (params) =&gt; {
                routes = params.routes
            },
            'astro:build:done': ({
                routes
                assets
            }) =&gt; {
                for (const route of routes) {
                    const distURL = assets.get(route.pattern)
                    if (distURL) {
                        Object.assign(route, { distURL })
                    }
                }
                console.log(routes)
            }
        }
    }
}</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Learn more about <a href="../../../reference/integrations-reference/index#astroroutesresolved">the Integration API <code dir="auto">astro:routes:resolved</code> hook</a> for building integrations.</span> </div> <div class="sl-heading-wrapper level-h2">
<h2 id="removed">Removed</h2>
<a class="sl-anchor-link" href="#removed"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Removed”</span></a>
</div> <p>The following features have now been entirely removed from the code base and can no longer be used. Some of these features may have continued to work in your project even after deprecation. Others may have silently had no effect.</p> <p>Projects now containing these removed features will be unable to build, and there will no longer be any supporting documentation prompting you to remove these features.</p> <div class="sl-heading-wrapper level-h3">
<h3 id="removed-the-lit-integration">Removed: The Lit integration</h3>
<a class="sl-anchor-link" href="#removed-the-lit-integration"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Removed: The Lit integration”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11680" class="astro-ro74hpkt">Implementation PR: Remove `@astrojs/lit` (#11680)</a> </div> <p>In Astro v4.x, <a href="https://lit.dev/">Lit</a> was a core-maintained framework library through the <code dir="auto">@astrojs/lit</code> package.</p> <p>Astro v5.0 removes the integration and it will not receive further updates for compatibility with 5.x and above.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-5">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-5"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>You can continue to use Lit for client components by adding a client-side script tag. For example:</p> <div class="expressive-code">

<pre data-language="astro">&lt;script&gt;
  import "../components/MyTabs";
&lt;/script&gt;


&lt;my-tabs title="These are my tabs"&gt;...&lt;/my-tabs&gt;</pre>

</div> <p>If you’re interested in maintaining a Lit integration yourself, you may wish to use the <a href="https://github.com/withastro/astro/tree/astro%404.13.0/packages/integrations/lit">last published version of <code dir="auto">@astrojs/lit</code></a> as a starting point and upgrade the relevant packages.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Learn more about <a href="../../integrations-guide/index">Astro’s official integrations</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="removed-hybrid-rendering-mode">Removed: <code dir="auto">hybrid</code> rendering mode</h3>
<a class="sl-anchor-link" href="#removed-hybrid-rendering-mode"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Removed: hybrid rendering mode”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11824" class="astro-ro74hpkt">Implementation PR: Merge output:hybrid and output:static (#11824)</a> </div> <p>In Astro v4.x, Astro provided three rendering <code dir="auto">output</code> rendering modes: <code dir="auto">'static'</code>, <code dir="auto">'hybrid'</code>, and <code dir="auto">'server'</code></p> <p>Astro v5.0 merges the <code dir="auto">output: 'hybrid'</code> and <code dir="auto">output: 'static'</code> configurations into one single configuration (now called <code dir="auto">'static'</code>) that works the same way as the previous hybrid option.</p> <p>It is no longer necessary to specify <code dir="auto">output: 'hybrid'</code> in your Astro config to use server-rendered pages. The new <code dir="auto">output: 'static'</code> has this capability included.</p> <p>Astro will now automatically allow you to opt out of prerendering in your static site with no change to your output configuration required. Any page route or endpoint can include <code dir="auto">export const prerender = false</code> to be server-rendered on demand, while the rest of your site is statically generated.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-6">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-6"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If your project used hybrid rendering, you must now remove the <code dir="auto">output: 'hybrid'</code> option from your Astro config as it no longer exists. However, no other changes to your project are required, and you should have no breaking changes. The previous <code dir="auto">'hybrid'</code> behavior is now the default, under a new name <code dir="auto">'static'</code>.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">astro.config.mjs</span></div>
<pre data-language="js">import { defineConfig } from "astro/config";


export default defineConfig({
  output: 'hybrid',
});</pre>

</div> <p>If you were using the <code dir="auto">output: 'static'</code> (default) option, you can continue to use it as before. By default, all of your pages will continue to be prerendered and you will have a completely static site. You should have no breaking changes to your project.</p> <p>An adapter is still required to deploy an Astro project with any server-rendered pages, no matter which <code dir="auto">output</code> mode your project uses. Failure to include an adapter will result in a warning in development and an error at build time.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Learn more about <a href="../../on-demand-rendering/index">on-demand rendering in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="removed-support-for-dynamic-prerender-values-in-routes">Removed: support for dynamic <code dir="auto">prerender</code> values in routes</h3>
<a class="sl-anchor-link" href="#removed-support-for-dynamic-prerender-values-in-routes"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Removed: support for dynamic prerender values in routes”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11824" class="astro-ro74hpkt">Implementation PR: Merge output:hybrid and output:static (#11824)</a> </div> <p>In Astro 4.x, environment variables could be used to dynamically set the value of <code dir="auto">prerender</code> exports in routes, for example <code dir="auto">export const prerender =  import.meta.env.SOME_VAR</code>.</p> <p>Astro v5.0 removes support for dynamic values in <code dir="auto">prerender</code> exports. Only the static values <code dir="auto">true</code> and <code dir="auto">false</code> are supported.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-7">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-7"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <ol role="list" class="sl-steps"> <li> <p>Remove any dynamic <code dir="auto">prerender</code> exports in your routes:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/blog/[slug].astro</span></div>
<pre data-language="astro">---
export const prerender = import.meta.env.SOME_VAR;
---</pre>

</div> </li> <li> <p>Use an Astro integration in your <code dir="auto">astro.config.mjs</code> file to set <code dir="auto">prerender</code> values that need to be dynamic in the <code dir="auto">"astro:route:setup"</code> hook:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">astro.config.mjs</span></div>
<pre data-language="js">import { defineConfig } from 'astro/config';
import { loadEnv } from 'vite';


export default defineConfig({
  integrations: [
    {
      name: 'set-prerender',
      hooks: {
        'astro:route:setup': ({ route }) =&gt; {
          // Load environment variables from .env files (if needed)
          const { PRERENDER } = loadEnv(process.env.NODE_ENV, process.cwd(), '');
          // Find routes matching the expected filename.
          if (route.component.endsWith('/blog/[slug].astro')) {
            // Set the prerender value on routes as needed.
            route.prerender = PRERENDER;
          }
        },
      },
    }
  ],
});</pre>

</div> </li> </ol> <div class="sl-heading-wrapper level-h3">
<h3 id="removed-squoosh-image-service">Removed: Squoosh image service</h3>
<a class="sl-anchor-link" href="#removed-squoosh-image-service"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Removed: Squoosh image service”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11770" class="astro-ro74hpkt">Implementation PR: remove the squoosh image service (#11770)</a> </div> <p>In Astro 4.x, you could configure <code dir="auto">image.service: squooshImageService()</code> to use Squoosh to transform your images instead of Sharp. However, the underlying library <code dir="auto">libsquoosh</code> is no longer maintained and has memory and performance issues.</p> <p>Astro 5.0 removes the Squoosh image optimization service entirely.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-8">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-8"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>To switch to the built-in Sharp image service, remove the <code dir="auto">squooshImageService</code> import from your Astro config. By default, you will use Sharp for <code dir="auto">astro:assets</code>.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">astro.config.mjs</span></div>
<pre data-language="ts">import { squooshImageService } from "astro/config";
import { defineConfig } from "astro/config";


export default defineConfig({
 image: {
   service: squooshImageService()
 }
});</pre>

</div> <p>If you are using a strict package manager like <code dir="auto">pnpm</code>, you may need to install the <code dir="auto">sharp</code> package manually to use the Sharp image service, even though it is built into Astro by default.</p> <p>If your adapter does not support Astro’s built-in Sharp image optimization, you can <a href="../../images/index#configure-no-op-passthrough-service">configure a no-op image service</a> to allow you to use the <code dir="auto">&lt;Image /&gt;</code> and <code dir="auto">&lt;Picture /&gt;</code> components.</p> <p>Alternatively, you may wish to consider <a href="https://github.com/Princesseuh/astro-image-service-squoosh">a community-maintained Squoosh image service</a> if you are unable to use the Sharp image service.</p> <div class="sl-heading-wrapper level-h5">
<h5 id="for-adapters">For adapters</h5>
<a class="sl-anchor-link" href="#for-adapters"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “For adapters”</span></a>
</div> <p>If your adapter previously precised its compatibility status with Squoosh, you should now remove this information from your adapter configuration.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">my-adapter.mjs</span></div>
<pre data-language="js">supportedAstroFeatures: {
  assets: {
    isSquooshCompatible: true
  }
}</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../images/index#default-image-service">configuring your default image service</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="removed-some-public-facing-types">Removed: some public-facing types</h3>
<a class="sl-anchor-link" href="#removed-some-public-facing-types"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Removed: some public-facing types”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11715" class="astro-ro74hpkt">Implementation PR: Refactor/types (#11715)</a> </div> <p>In Astro v4.x, <code dir="auto">@types/astro.ts</code> exposed all types publicly to users, whether or not they were still actively used or only intended for internal use.</p> <p>Astro v5.0 refactors this file to remove outdated and internal types. This refactor brings improvements to your editor (e.g. faster completions, lower memory usage, and more relevant completion options). However, this refactor may cause errors in some projects that have been relying on types that are no longer available to the public.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-9">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-9"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Remove any types that now cause errors in your project as you no longer have access to them. These are mostly APIs that have previously been deprecated and removed, but may also include types that are now internal.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">See the <a href="https://github.com/withastro/astro/tree/main/packages/astro/src/types/public">public types exposed for use</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="experimental-flags">Experimental Flags</h3>
<a class="sl-anchor-link" href="#experimental-flags"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Experimental Flags”</span></a>
</div> <p>The following experimental flags have been removed in Astro v5.0 and these features are available for use:</p> <ul> <li><code dir="auto">env</code></li> <li><code dir="auto">serverIslands</code></li> </ul> <p>Additionally, the following experimental flags have been removed and <strong>are now the default or recommended behavior in Astro v5.0</strong>.</p> <ul> <li>
<code dir="auto">directRenderScript</code> (See below for breaking changes to <a href="#script-tags-are-rendered-directly-as-declared">default <code dir="auto">&lt;script&gt;</code> behavior</a>.)</li> <li>
<code dir="auto">globalRoutePriority</code> (See below for breaking changes to <a href="#route-priority-order-for-injected-routes-and-redirects">default route priority order</a>.)</li> <li>
<code dir="auto">contentLayer</code> (See guidance for <a href="#legacy-v20-content-collections-api">upgrading existing content collections</a> to the new, preferred Content Layer API.)</li> </ul> <p>The following experimental flags have been removed and <strong>their corresponding features are not part of Astro v5.0</strong>.</p> <ul> <li><code dir="auto">contentCollectionsCache</code></li> </ul> <p>Remove these experimental flags if you were previously using them, and move your <code dir="auto">env</code> configuration to the root of your Astro config:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">astro.config.mjs</span></div>
<pre data-language="js">import { defineConfig } from 'astro/config';


export default defineConfig({
  experimental: {
    directRenderScript: true,
    globalRoutePriority: true,
    contentLayer: true,
    serverIslands: true,
    contentCollectionsCache: true,
    env: {
      schema: {...}
    }
  },
  env: {
      schema: {...}
  }
})</pre>

</div> <p>These features are all available by default in Astro v5.0.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read about these exciting features and more in <a href="https://astro.build/blog/astro-5/">the v5.0 Blog post</a>.</span> </div> <div class="sl-heading-wrapper level-h2">
<h2 id="changed-defaults">Changed Defaults</h2>
<a class="sl-anchor-link" href="#changed-defaults"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed Defaults”</span></a>
</div> <p>Some default behavior has changed in Astro v5.0 and your project code may need updating to account for these changes.</p> <p>In most cases, the only action needed is to review your existing project’s deployment and ensure that it continues to function as you expect, making updates to your code as necessary. In some cases, there may be a configuration setting to allow you to continue to use the previous default behavior.</p> <div class="sl-heading-wrapper level-h3">
<h3 id="csrf-protection-is-now-set-by-default">CSRF protection is now set by default</h3>
<a class="sl-anchor-link" href="#csrf-protection-is-now-set-by-default"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “CSRF protection is now set by default”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11788" class="astro-ro74hpkt">Implementation PR: change default value of checkOrigin (#11788)</a> </div> <p>In Astro v4.x, The default value of <code dir="auto">security.checkOrigin</code> was <code dir="auto">false</code>. Previously, you had to explicitly set this value to <code dir="auto">true</code> to enable Cross-Site Request Forgery (CSRF) protection.</p> <p>Astro v5.0 changes the default value of this option to <code dir="auto">true</code>, and will automatically check that the “origin” header matches the URL sent by each request in on-demand rendered pages.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-10">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-10"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you had previously configured <code dir="auto">security.checkOrigin: true</code>, you no longer need this line in your Astro config. This is now the default.</p> <p>To disable this behavior, you must explicitly set <code dir="auto">security.checkOrigin: false</code>.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">astro.config.mjs</span></div>
<pre data-language="js">export default defineConfig({
  output: "server",
  security: {
    checkOrigin: false
  }
})</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../../reference/configuration-reference/index#security">security configuration options</a></span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="route-priority-order-for-injected-routes-and-redirects">Route priority order for injected routes and redirects</h3>
<a class="sl-anchor-link" href="#route-priority-order-for-injected-routes-and-redirects"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Route priority order for injected routes and redirects”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11798" class="astro-ro74hpkt">Implementation PR: Remove legacy route prioritization (#11798)</a> </div> <p>In Astro v4.x, <code dir="auto">experimental.globalRoutePriority</code> was an optional flag that ensured that injected routes, file-based routes, and redirects were all prioritized using the <a href="../../routing/index#route-priority-order">route priority order rules for all routes</a>. This allowed more control over routing in your project by not automatically prioritizing certain kinds of routes and standardizing the route priority order.</p> <p>Astro v5.0 removes this experimental flag and makes this the new default behavior in Astro: redirects and injected routes are now prioritized equally alongside file-based project routes.</p> <p>Note that this was already the default behavior in Starlight, and should not affect updated Starlight projects.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-11">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-11"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If your project includes injected routes or redirects, please check that your routes are building page URLs as expected. An example of the new expected behavior is shown below.</p> <p>In a project containing the following routes:</p> <ul> <li>File-based route: <code dir="auto">/blog/post/[pid]</code>
</li> <li>File-based route: <code dir="auto">/[page]</code>
</li> <li>Injected route: <code dir="auto">/blog/[...slug]</code>
</li> <li>Redirect: <code dir="auto">/blog/tags/[tag] -&gt; /[tag]</code>
</li> <li>Redirect: <code dir="auto">/posts -&gt; /blog</code>
</li> </ul> <p>The following URLs will be built (instead of following the route priority order of Astro v4.x):</p> <ul> <li>
<code dir="auto">/blog/tags/astro</code> is built by the redirect to <code dir="auto">/tags/[tag]</code> (instead of the injected route <code dir="auto">/blog/[...slug]</code>)</li> <li>
<code dir="auto">/blog/post/0</code> is built by the file-based route <code dir="auto">/blog/post/[pid]</code> (instead of the injected route <code dir="auto">/blog/[...slug]</code>)</li> <li>
<code dir="auto">/posts</code> is built by the redirect to <code dir="auto">/blog</code> (instead of the file-based route <code dir="auto">/[page]</code>)</li> </ul> <p>In the event of route collisions, where two routes of equal route priority attempt to build the same URL, Astro will log a warning identifying the conflicting routes.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about the <a href="../../routing/index#route-priority-order">route priority order rules</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="script-tags-are-rendered-directly-as-declared">
<code dir="auto">&lt;script&gt;</code> tags are rendered directly as declared</h3>
<a class="sl-anchor-link" href="#script-tags-are-rendered-directly-as-declared"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “&lt;script&gt; tags are rendered directly as declared”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11791" class="astro-ro74hpkt">Implementation PR: Make directRenderScript the default (#11791)</a> </div> <p>In Astro v4.x, <code dir="auto">experimental.directRenderScript</code> was an optional flag to directly render <code dir="auto">&lt;scripts&gt;</code> as declared in <code dir="auto">.astro</code> files (including existing features like TypeScript, importing <code dir="auto">node_modules</code>, and deduplicating scripts). This strategy prevented scripts from being executed in places where they were not used. Additionally, conditionally rendered scripts were previously implicitly inlined, as if an <code dir="auto">is:inline</code> directive was automatically added to them.</p> <p>Astro 5.0 removes this experimental flag and makes this the new default behavior in Astro: scripts are no longer hoisted to the <code dir="auto">&lt;head&gt;</code>, multiple scripts on a page are no longer bundled together, and a <code dir="auto">&lt;script&gt;</code> tag may interfere with CSS styling. Additionally, conditionally rendered scripts are no longer implicitly inlined.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-12">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-12"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Please review your <code dir="auto">&lt;script&gt;</code> tags and ensure they behave as desired.</p> <p>If you previously had conditionally rendered <code dir="auto">&lt;script&gt;</code> tags, you will need to add an <code dir="auto">is:inline</code> attribute to preserve the same behavior as before:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/components/MyComponent.astro</span></div>
<pre data-language="astro">---
type Props = {
  showAlert: boolean
}


const { showAlert } = Astro.props;
---
{
  showAlert &amp;&amp; &lt;script is:inline&gt;alert("Some very important code!!")&lt;/script&gt;
}</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../client-side-scripts/index">using <code dir="auto">script</code> tags in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h2">
<h2 id="breaking-changes">Breaking Changes</h2>
<a class="sl-anchor-link" href="#breaking-changes"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Breaking Changes”</span></a>
</div> <p>The following changes are considered breaking changes in Astro v5.0. Breaking changes may or may not provide temporary backwards compatibility. If you were using these features, you may have to update your code as recommended in each entry.</p> <div class="sl-heading-wrapper level-h3">
<h3 id="renamed-viewtransitions--component">Renamed: <code dir="auto">&lt;ViewTransitions /&gt;</code> component</h3>
<a class="sl-anchor-link" href="#renamed-viewtransitions--component"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Renamed: &lt;ViewTransitions /&gt; component”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11980" class="astro-ro74hpkt">Implementation PR: Rename the ViewTransitions component to ClientRouter (#11980)</a> </div> <p>In Astro 4.x, Astro’s View Transitions API included a <code dir="auto">&lt;ViewTransitions /&gt;</code> router component to enable client-side routing, page transitions, and more.</p> <p>Astro 5.0 renames this component to <code dir="auto">&lt;ClientRouter /&gt;</code> to clarify the role of the component within the API. This makes it more clear that the features you get from Astro’s <code dir="auto">&lt;ClientRouter /&gt;</code> routing component are slightly different from the native CSS-based MPA router.</p> <p>No functionality has changed. This component has only changed its name.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-13">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-13"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Replace all occurrences of the <code dir="auto">ViewTransitions</code> import and component with <code dir="auto">ClientRouter</code>:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/layouts/MyLayout.astro</span></div>
<pre data-language="astro">import { ViewTransitions } from 'astro:transitions';
import { ClientRouter } from 'astro:transitions';


&lt;html&gt;
  &lt;head&gt;
    ...
   &lt;ViewTransitions /&gt;
   &lt;ClientRouter /&gt;
  &lt;/head&gt;
&lt;/html&gt;</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../view-transitions/index">view transitions and client-side routing in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-typescript-configuration">Changed: TypeScript configuration</h3>
<a class="sl-anchor-link" href="#changed-typescript-configuration"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: TypeScript configuration”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11859" class="astro-ro74hpkt">Implementation PR: better tsconfig (#11859)</a> </div> <p>In Astro v4.x, Astro relied on a <code dir="auto">src/env.d.ts</code> file for type inferencing and defining modules for features that relied on generated types.</p> <p>Astro 5.0 instead uses a <code dir="auto">.astro/types.d.ts</code> file for type inferencing, and now recommends setting <code dir="auto">include</code> and <code dir="auto">exclude</code> in <code dir="auto">tsconfig.json</code> to benefit from Astro types and avoid checking built files.</p> <p>Running <code dir="auto">astro sync</code> no longer creates, nor updates, <code dir="auto">src/env.d.ts</code> as it is not required for type-checking standard Astro projects.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-14">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-14"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>To update your project to Astro’s recommended TypeScript settings, add the following <code dir="auto">include</code> and <code dir="auto">exclude</code> properties to your existing <code dir="auto">tsconfig.json</code>:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">tsconfig.json</span></div>
<pre data-language="ts">{
  "extends": "astro/tsconfigs/base",
  "include": [".astro/types.d.ts", "**/*"],
  "exclude": ["dist"]
}</pre>

</div> <p>Note that <code dir="auto">src/env.d.ts</code> is only necessary if you have added custom configurations, or if you’re not using a <code dir="auto">tsconfig.json</code> file.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../typescript/index#setup">TypeScript configuration in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-actions-submitted-by-html-forms-no-longer-use-cookie-redirects">Changed: Actions submitted by HTML forms no longer use cookie redirects</h3>
<a class="sl-anchor-link" href="#changed-actions-submitted-by-html-forms-no-longer-use-cookie-redirects"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: Actions submitted by HTML forms no longer use cookie redirects”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/12373" class="astro-ro74hpkt">Implementation PR: Actions middleware (#12373)</a> </div> <p>In Astro 4.x, actions called from an HTML form would trigger a redirect with the result forwarded using cookies. This caused issues for large form errors and return values that exceeded the 4 KB limit of cookie-based storage.</p> <p>Astro 5.0 now renders the result of an action as a POST result without any forwarding. This will introduce a “confirm form resubmission?” dialog when a user attempts to refresh the page, though it no longer imposes a 4 KB limit on action return value.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-15">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-15"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>You should update handling for action results that relies on redirects, and optionally address the “confirm form resubmission?” dialog with middleware.</p> <div class="sl-heading-wrapper level-h5">
<h5 id="to-redirect-to-the-previous-route-on-error">To redirect to the previous route on error</h5>
<a class="sl-anchor-link" href="#to-redirect-to-the-previous-route-on-error"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “To redirect to the previous route on error”</span></a>
</div> <p>If your HTML form action is directed to a different route (i.e. <code dir="auto">action={"/success-page" + actions.name}</code>), Astro will no longer redirect to the previous route on error. You can implement this behavior manually using redirects from your Astro component. This example instead redirects to a new route on success, and handles errors on the current page otherwise:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/newsletter.astro</span></div>
<pre data-language="astro">---
import { actions } from 'astro:actions';


const result = Astro.getActionResult(actions.newsletter);
if (!result?.error) {
  // Embed relevant result data in the URL if needed
  // example: redirect(`/confirmation?email=${result.data.email}`);
  return redirect('/confirmation');
}
---


&lt;form method="POST" action={'/confirmation' + actions.newsletter}&gt;
  &lt;label&gt;E-mail &lt;input required type="email" name="email" /&gt;&lt;/label&gt;
  &lt;button&gt;Sign up&lt;/button&gt;
&lt;/form&gt;</pre>

</div> <div class="sl-heading-wrapper level-h5">
<h5 id="optional-to-remove-the-confirm-dialog-on-refresh">(Optional) To remove the confirm dialog on refresh</h5>
<a class="sl-anchor-link" href="#optional-to-remove-the-confirm-dialog-on-refresh"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “(Optional) To remove the confirm dialog on refresh”</span></a>
</div> <p>To address the “confirm form resubmission?” dialog on refresh, or to preserve action results across sessions, you can now <a href="../../actions/index#advanced-persist-action-results-with-a-session">customize action result handling from middleware</a>.</p> <p>We recommend using a session storage provider <a href="../../actions/index#advanced-persist-action-results-with-a-session">as described in our Netlify Blob example</a>. However, if you prefer the cookie forwarding behavior from 4.X and accept the 4 KB size limit, you can implement the pattern as shown in this sample snippet:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/middleware.ts</span></div>
<pre data-language="ts">import { defineMiddleware } from 'astro:middleware';
import { getActionContext } from 'astro:actions';


export const onRequest = defineMiddleware(async (context, next) =&gt; {
  // Skip requests for prerendered pages
  if (context.isPrerendered) return next();


  const { action, setActionResult, serializeActionResult } = getActionContext(context);


  // If an action result was forwarded as a cookie, set the result
  // to be accessible from `Astro.getActionResult()`
  const payload = context.cookies.get('ACTION_PAYLOAD');
  if (payload) {
    const { actionName, actionResult } = payload.json();
    setActionResult(actionName, actionResult);
    context.cookies.delete('ACTION_PAYLOAD', { path: '/' });
    return next();
  }


  // If an action was called from an HTML form action,
  // call the action handler and redirect with the result as a cookie.
  if (action?.calledFrom === 'form') {
    const actionResult = await action.handler();


    context.cookies.set('ACTION_PAYLOAD', {
      actionName: action.name,
      actionResult: serializeActionResult(actionResult),
    }, {
      path: '/',
      httpOnly: true,
      sameSite: 'lax',
      maxAge: 60
    });


    if (actionResult.error) {
    // Redirect back to the previous page on error
      const referer = context.request.headers.get('Referer');
      if (!referer) {
        throw new Error('Internal: Referer unexpectedly missing from Action POST request.');
      }
      return context.redirect(referer);
    }
    // Redirect to the destination page on success
    return context.redirect(context.originPathname);
  }


  return next();
})</pre>

</div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-compiledcontent-is-now-an-async-function">Changed: <code dir="auto">compiledContent()</code> is now an async function</h3>
<a class="sl-anchor-link" href="#changed-compiledcontent-is-now-an-async-function"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: compiledContent() is now an async function”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11782" class="astro-ro74hpkt">Implementation PR: Remove TLA by making compiledContent async (#11782)</a> </div> <p>In Astro 4.x, top level await was included in Markdown modules. This caused some issues with custom image services and images inside Markdown, causing Node to suddenly exit with no error message.</p> <p>Astro 5.0 makes the <code dir="auto">compiledContent()</code> property on Markdown import an async function, requiring an <code dir="auto">await</code> to resolve the content.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-16">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-16"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Update your code to use <code dir="auto">await</code> when calling <code dir="auto">compiledContent()</code>.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/post.astro</span></div>
<pre data-language="astro">---
import * as myPost from "../blog/post.md";


const content = myPost.compiledContent();
const content = await myPost.compiledContent();
---


&lt;Fragment set:html={content} /&gt;</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about the <a href="../../markdown-content/index#importing-markdown"><code dir="auto">compiledContent()</code> function</a> for returning compiled Markdown.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-astrocontent-can-no-longer-be-used-on-the-client">Changed: <code dir="auto">astro:content</code> can no longer be used on the client</h3>
<a class="sl-anchor-link" href="#changed-astrocontent-can-no-longer-be-used-on-the-client"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: astro:content can no longer be used on the client”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11827" class="astro-ro74hpkt">Implementation PR: Prevent usage of `astro:content` in the client (#11827)</a> </div> <p>In Astro 4.x, it was possible to access the <code dir="auto">astro:content</code> module on the client.</p> <p>Astro 5.0 removes this access as it was never intentionally exposed for client use. Using <code dir="auto">astro:content</code> this way had limitations and bloated client bundles.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-17">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-17"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you are currently using <code dir="auto">astro:content</code> in the client, pass the data you need through props to your client components instead:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/blog.astro</span></div>
<pre data-language="astro">---
import { getCollection } from 'astro:content';
import ClientComponent from '../components/ClientComponent';


const posts = await getCollection('blog');
const postsData = posts.map(post =&gt; post.data);
---


&lt;ClientComponent posts={postsData} /&gt;</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../../reference/modules/astro-content/index">the <code dir="auto">astro:content</code> API</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="renamed-shiki-css-variables-theme-color-token-names">Renamed: Shiki <code dir="auto">css-variables</code> theme color token names</h3>
<a class="sl-anchor-link" href="#renamed-shiki-css-variables-theme-color-token-names"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Renamed: Shiki css-variables theme color token names”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11661" class="astro-ro74hpkt">Implementation PR: Update to new shiki token names (#11661)</a> </div> <p>In Astro v4.x, the Shiki <code dir="auto">css-variables</code> theme used the <code dir="auto">--astro-code-color-text</code> and <code dir="auto">--astro-code-color-background</code> tokens for styling the foreground and background colors of code blocks respectively.</p> <p>Astro v5.0 renames them to <code dir="auto">--astro-code-foreground</code> and <code dir="auto">--astro-code-background</code> respectively to better align with the Shiki v1 defaults.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-18">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-18"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>You can perform a global find and replace in your project to migrate to the new token names.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/styles/global.css</span></div>
<pre data-language="css">:root {
  --astro-code-color-text: #000;
  --astro-code-color-background: #fff;
  --astro-code-foreground: #000;
  --astro-code-background: #fff;
}</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../syntax-highlighting/index">syntax highlighting in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-internal-shiki-rehype-plugin-for-highlighting-code-blocks">Changed: internal Shiki rehype plugin for highlighting code blocks</h3>
<a class="sl-anchor-link" href="#changed-internal-shiki-rehype-plugin-for-highlighting-code-blocks"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: internal Shiki rehype plugin for highlighting code blocks”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11825" class="astro-ro74hpkt">Implementation PR: Refactor createShikiHighlighter (#11825)</a> </div> <p>In Astro 4.x, Astro’s internal Shiki rehype plugin highlighted code blocks as HTML.</p> <p>Astro 5.0 updates this plugin to highlight code blocks as hast. This allows a more direct Markdown and MDX processing and improves the performance when building the project. However, this may cause issues with existing Shiki transformers.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-19">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-19"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you are using Shiki transformers passed to <code dir="auto">markdown.shikiConfig.transformers</code>, you must make sure they do not use the <code dir="auto">postprocess</code> hook. This hook no longer runs on code blocks in <code dir="auto">.md</code> and <code dir="auto">.mdx</code> files. (See <a href="https://shiki.style/guide/transformers#transformer-hooks">the Shiki documentation on transformer hooks</a> for more information).</p> <p>Code blocks in <code dir="auto">.mdoc</code> files and Astro’s built-in <code dir="auto">&lt;Code /&gt;</code> component do not use the internal Shiki rehype plugin and are unaffected.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../syntax-highlighting/index">syntax highlighting in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-automatic-charsetutf-8-behavior-for-markdown-and-mdx-pages">Changed: Automatic <code dir="auto">charset=utf-8</code> behavior for Markdown and MDX pages</h3>
<a class="sl-anchor-link" href="#changed-automatic-charsetutf-8-behavior-for-markdown-and-mdx-pages"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: Automatic charset=utf-8 behavior for Markdown and MDX pages”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/12231" class="astro-ro74hpkt">Implementation PR: Unset charset=utf-8 content-type for md/mdx pages (#12231)</a> </div> <p>In Astro 4.0, Markdown and MDX pages (located in <code dir="auto">src/pages/</code>) automatically responded with <code dir="auto">charset=utf-8</code> in the <code dir="auto">Content-Type</code> header, which allowed rendering non-ASCII characters in your pages.</p> <p>Astro 5.0 updates the behaviour to add the <code dir="auto">&lt;meta charset="utf-8"&gt;</code> tag instead, and only for pages that do not use Astro’s special <code dir="auto">layout</code> frontmatter property. Similarly for MDX pages, Astro will only add the tag if the MDX content does not import a wrapping <code dir="auto">Layout</code> component.</p> <p>If your Markdown or MDX pages use the <code dir="auto">layout</code> frontmatter property, or if the MDX page content imports a wrapping <code dir="auto">Layout</code> component, then the HTML encoding will be handled by the designated layout component instead, and the <code dir="auto">&lt;meta charset="utf-8"&gt;</code> tag will not be added to your page by default.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-20">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-20"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you require <code dir="auto">charset=utf-8</code> to render your page correctly, make sure that your layout components contain the <code dir="auto">&lt;meta charset="utf-8"&gt;</code> tag. You may need to add this if you have not already done so.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../../basics/layouts/index#markdown-layouts">Markdown layouts</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-astro-specific-metadata-attached-in-remark-and-rehype-plugins">Changed: Astro-specific metadata attached in remark and rehype plugins</h3>
<a class="sl-anchor-link" href="#changed-astro-specific-metadata-attached-in-remark-and-rehype-plugins"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: Astro-specific metadata attached in remark and rehype plugins”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11861" class="astro-ro74hpkt">Implementation PR: Clean up Astro metadata in vfile.data (#11861)</a> </div> <p>In Astro 4.x, the Astro-specific metadata attached to <code dir="auto">vfile.data</code> in remark and rehype plugins was attached in different locations with inconsistent names.</p> <p>Astro 5 cleans up the API and the metadata is now renamed as below:</p> <ul> <li>
<code dir="auto">vfile.data.__astroHeadings</code> -&gt; <code dir="auto">vfile.data.astro.headings</code>
</li> <li>
<code dir="auto">vfile.data.imagePaths</code> -&gt; <code dir="auto">vfile.data.astro.imagePaths</code>
</li> </ul> <p>The types of <code dir="auto">imagePaths</code> has also been updated from <code dir="auto">Set&lt;string&gt;</code> to <code dir="auto">string[]</code>. The <code dir="auto">vfile.data.astro.frontmatter</code> metadata is left unchanged.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-21">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-21"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>While we don’t consider these APIs public, they can be accessed by remark and rehype plugins that want to re-use Astro’s metadata. If you are using these APIs, make sure to access them in the new locations.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../markdown-content/index#markdown-plugins">using Markdown plugins in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-image-endpoint-configuration">Changed: image endpoint configuration</h3>
<a class="sl-anchor-link" href="#changed-image-endpoint-configuration"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: image endpoint configuration”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11908" class="astro-ro74hpkt">Implementation PR: Allow customising the route of the image endpoint (#11908)</a> </div> <p>In Astro 4.x, you could set an endpoint in your <code dir="auto">image</code> configuration to use for image optimization.</p> <p>Astro 5.0 allows you to customize a <code dir="auto">route</code> and <code dir="auto">entrypoint</code> of the <code dir="auto">image.endpoint</code> config. This can be useful in niche situations where the default route <code dir="auto">/_image</code> conflicts with an existing route or your local server setup.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-22">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-22"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you had previously customized <code dir="auto">image.endpoint</code>, move this endpoint to the new <code dir="auto">endpoint.entrypoint</code> property. Optionally, you may customize a <code dir="auto">route</code>:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">astro.config.mjs</span></div>
<pre data-language="js">import { defineConfig } from "astro/config";


defineConfig({
  image: {
    endpoint: './src/image-endpoint.ts',
    endpoint: {
      route: "/image",
      entrypoint: "./src/image_endpoint.ts"
    }
  },
})</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../../reference/configuration-reference/index#imageendpoint">setting an endpoint to use for image optimization</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-buildclient-and-buildserver-resolve-behavior">Changed: <code dir="auto">build.client</code> and <code dir="auto">build.server</code> resolve behavior</h3>
<a class="sl-anchor-link" href="#changed-buildclient-and-buildserver-resolve-behavior"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: build.client and build.server resolve behavior”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11916" class="astro-ro74hpkt">Implementation PR: Fix build.client and build.server resolve behaviour (#11916)</a> </div> <p>In Astro v4.x, the <code dir="auto">build.client</code> and <code dir="auto">build.server</code> options were documented to resolve relatively from the <code dir="auto">outDir</code> option, but it didn’t always work as expected.</p> <p>Astro 5.0 fixes the behavior to correctly resolve from the <code dir="auto">outDir</code> option. For example, if <code dir="auto">outDir</code> is set to <code dir="auto">./dist/nested/</code>, then by default:</p> <ul> <li>
<code dir="auto">build.client</code> will resolve to <code dir="auto">&lt;root&gt;/dist/nested/client/</code>
</li> <li>
<code dir="auto">build.server</code> will resolve to <code dir="auto">&lt;root&gt;/dist/nested/server/</code>
</li> </ul> <p>Previously the values were incorrectly resolved:</p> <ul> <li>
<code dir="auto">build.client</code> was resolved to <code dir="auto">&lt;root&gt;/dist/nested/dist/client/</code>
</li> <li>
<code dir="auto">build.server</code> was resolved to <code dir="auto">&lt;root&gt;/dist/nested/dist/server/</code>
</li> </ul> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-23">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-23"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you were relying on the previous build paths, make sure that your project code is updated to the new build paths.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../../reference/configuration-reference/index#build-options"><code dir="auto">build</code> configuration options in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-js-dependencies-in-config-file-are-no-longer-processed-by-vite">Changed: JS dependencies in config file are no longer processed by Vite</h3>
<a class="sl-anchor-link" href="#changed-js-dependencies-in-config-file-are-no-longer-processed-by-vite"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: JS dependencies in config file are no longer processed by Vite”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11819" class="astro-ro74hpkt">Implementation PR: Set external: true when loading astro config (#11819)</a> </div> <p>In Astro 4.x, locally-linked JS dependencies (e.g. <code dir="auto">npm link</code>, in a monorepo, etc) were able to use Vite features like <code dir="auto">import.meta.glob</code> when imported by the Astro config file.</p> <p>Astro 5 updates the Astro config loading flow to ignore processing locally-linked JS dependencies with Vite. Dependencies exporting raw TypeScript files are unaffected. Instead, these JS dependencies will be normally imported by the Node.js runtime the same way as other dependencies from <code dir="auto">node_modules</code>.</p> <p>This change was made as the previous behavior caused confusion among integration authors who tested against a package that worked locally, but not when published. It also restricted using CJS-only dependencies because Vite required the code to be ESM. While this change only affects JS dependencies, it’s also recommended for packages to export JavaScript instead of raw TypeScript where possible to prevent accidental Vite-specific usage as it’s an implementation detail of Astro’s config loading flow.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-24">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-24"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Make sure your locally-linked JS dependencies are built before running your Astro project. Then, the config loading should work as before.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../../reference/configuration-reference/index#vite">Vite configuration settings in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-urls-returned-by-paginate">Changed: URLs returned by <code dir="auto">paginate()</code>
</h3>
<a class="sl-anchor-link" href="#changed-urls-returned-by-paginate"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: URLs returned by paginate()”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11253" class="astro-ro74hpkt">Implementation PR: Add base to paginate (#11253)</a> </div> <p>In Astro v4.x, the URL returned by <code dir="auto">paginate()</code> (e.g. <code dir="auto">page.url.next</code>, <code dir="auto">page.url.first</code>, etc.) did not include the value set for <code dir="auto">base</code> in your Astro config. You had to manually prepend your configured value for <code dir="auto">base</code> to the URL path.</p> <p>Astro 5.0 automatically includes the <code dir="auto">base</code> value in <code dir="auto">page.url</code>.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-25">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-25"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you are using the <code dir="auto">paginate()</code> function for these URLs, remove any existing <code dir="auto">base</code> value as it is now added for you:</p> <div class="expressive-code">

<pre data-language="astro">---
export async function getStaticPaths({ paginate }) {
  const astronautPages = [{
    astronaut: 'Neil Armstrong',
  }, {
    astronaut: 'Buzz Aldrin',
  }, {
    astronaut: 'Sally Ride',
  }, {
    astronaut: 'John Glenn',
  }];
  return paginate(astronautPages, { pageSize: 1 });
}
const { page } = Astro.props;
// `base: /'docs'` configured in `astro.config.mjs`
const prev = "/docs" + page.url.prev;
const prev = page.url.prev;
---
&lt;a id="prev" href={prev}&gt;Back&lt;/a&gt;</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../routing/index#pagination">pagination in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-non-boolean-html-attribute-values">Changed: non-boolean HTML attribute values</h3>
<a class="sl-anchor-link" href="#changed-non-boolean-html-attribute-values"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: non-boolean HTML attribute values”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11660" class="astro-ro74hpkt">Implementation PR: Fix attribute rendering for boolean values (take 2) (#11660)</a> </div> <p>In Astro v4.x, non-<a href="https://developer.mozilla.org/en-US/docs/Glossary/Boolean/HTML">boolean HTML attributes</a> may not have included their values when rendered to HTML.</p> <p>Astro v5.0 renders the values explicitly as <code dir="auto">="true"</code> or <code dir="auto">="false"</code>, matching proper attribute handling in browsers.</p> <p>In the following <code dir="auto">.astro</code> examples, only <code dir="auto">allowfullscreen</code> is a boolean attribute:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/index.astro</span></div>
<pre data-language="astro">&lt;!-- `allowfullscreen` is a boolean attribute --&gt;
&lt;p allowfullscreen={true}&gt;&lt;/p&gt;
&lt;p allowfullscreen={false}&gt;&lt;/p&gt;
&lt;!-- `inherit` is *not* a boolean attribute --&gt;
&lt;p inherit={true}&gt;&lt;/p&gt;
&lt;p inherit={false}&gt;&lt;/p&gt;
&lt;!-- `data-*` attributes are not boolean attributes --&gt;
&lt;p data-light={true}&gt;&lt;/p&gt;
&lt;p data-light={false}&gt;&lt;/p&gt;</pre>

</div> <p>Astro v5.0 now preserves the full data attribute with its value when rendering the HTML of non-boolean attributes:</p> <div class="expressive-code">

<pre data-language="astro">&lt;p allowfullscreen&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;


&lt;p inherit="true"&gt;&lt;/p&gt;
&lt;p inherit&gt;&lt;/p&gt;
&lt;p inherit="false"&gt;&lt;/p&gt;


&lt;p data-light&gt;&lt;/p&gt;
&lt;p data-light="true"&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p data-light="false"&gt;&lt;/p&gt;</pre>

</div> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-26">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-26"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you rely on attribute values, for example, to locate elements or to conditionally render, update your code to match the new non-boolean attribute values:</p> <div class="expressive-code">

<pre data-language="js">el.getAttribute('inherit') === ''
el.getAttribute('inherit') === 'false'


el.hasAttribute('data-light')
el.dataset.light === 'true'</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../../reference/astro-syntax/index#dynamic-attributes">using HTML attributes in Astro</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-adding-values-to-contextlocals">Changed: adding values to <code dir="auto">context.locals</code>
</h3>
<a class="sl-anchor-link" href="#changed-adding-values-to-contextlocals"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: adding values to context.locals”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11987" class="astro-ro74hpkt">Implementation PR: TODOs (#11987)</a> </div> <p>In Astro 4.x, it was possible to completely replace the entire <code dir="auto">locals</code> object in middleware, API endpoints, and pages when adding new values.</p> <p>Astro 5.0 requires you to append values to the existing <code dir="auto">locals</code> object without deleting it. Locals in middleware, API endpoints, and pages, can no longer be completely overridden.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-27">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-27"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Where you previously were overwriting the object, you must now instead assign values to it:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/middleware.js</span></div>
<pre data-language="js">ctx.locals = {
Object.assign(ctx.locals, {
  one: 1,
  two: 2
}
})</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">See more about <a href="../../middleware/index#storing-data-in-contextlocals">storing data in <code dir="auto">context.locals</code></a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-params-no-longer-decoded">Changed: <code dir="auto">params</code> no longer decoded</h3>
<a class="sl-anchor-link" href="#changed-params-no-longer-decoded"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: params no longer decoded”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/12079" class="astro-ro74hpkt">Implementation PR: decode pathname early, don't decode params (#12079)</a> </div> <p>In Astro v4.x, <code dir="auto">params</code> passed to <code dir="auto">getStaticPath()</code> were automatically decoded using <code dir="auto">decodeURIComponent</code>.</p> <p>Astro v5.0 no longer decodes the value of <code dir="auto">params</code> passed to <code dir="auto">getStaticPaths</code>. You must manually decode them yourself if needed.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-28">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-28"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you were previously relying on the automatic decoding, use <code dir="auto">decodeURI</code> when passing <code dir="auto">params</code>.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/[id].astro</span></div>
<pre data-language="astro">---
export function getStaticPaths() {
  return [
    { params: { id: "%5Bpage%5D" } },
    { params: { id: decodeURI("%5Bpage%5D") } },
  ]
}


const { id } = Astro.params;
---</pre>

</div> <p>Note that the use of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/decodeURIComponent"><code dir="auto">decodeURIComponent</code></a> is discouraged for <code dir="auto">getStaticPaths</code> because it decodes more characters than it should, for example <code dir="auto">/</code>, <code dir="auto">?</code>, <code dir="auto">#</code> and more.</p> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../routing/index#static-ssg-mode">creating dynamic routes with <code dir="auto">params</code></a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-routedata-type-replaced-by-integrationsroutedata-integrations-api">Changed: <code dir="auto">RouteData</code> type replaced by <code dir="auto">IntegrationsRouteData</code> (Integrations API)</h3>
<a class="sl-anchor-link" href="#changed-routedata-type-replaced-by-integrationsroutedata-integrations-api"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: RouteData type replaced by IntegrationsRouteData (Integrations API)”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11864" class="astro-ro74hpkt">Implementation PR: send `IntegrationRouteData` to integrations (#11864)</a> </div> <p>In Astro v4.x, the <code dir="auto">entryPoints</code> type inside the <code dir="auto">astro:build:ssr</code> and <code dir="auto">astro:build:done</code> hooks was <code dir="auto">RouteData</code>.</p> <p>Astro v5.0 the <code dir="auto">entryPoints</code> type is now <code dir="auto">IntegrationRouteData</code>, which contains a subset of the <code dir="auto">RouteData</code> type. The fields <code dir="auto">isIndex</code> and <code dir="auto">fallbackRoutes</code> were removed.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-29">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-29"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Update your adapter to change the type of <code dir="auto">entryPoints</code> from <code dir="auto">RouteData</code> to <code dir="auto">IntegrationRouteData</code>.</p> <div class="expressive-code">

<pre data-language="js">import type {RouteData} from 'astro';
import type {IntegrationRouteData} from "astro"


function useRoute(route: RouteData) {
function useRoute(route: IntegrationRouteData) {
}</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">See the <a href="../../../reference/integrations-reference/index#integrationroutedata-type-reference">API reference for <code dir="auto">IntegrationRouteData</code></a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-disturl-is-now-an-array-integrations-api">Changed: <code dir="auto">distURL</code> is now an array (Integrations API)</h3>
<a class="sl-anchor-link" href="#changed-disturl-is-now-an-array-integrations-api"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: distURL is now an array (Integrations API)”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11864" class="astro-ro74hpkt">Implementation PR: send `IntegrationRouteData` to integrations (#11864)</a> </div> <p>In Astro v4.x, <code dir="auto">RouteData.distURL</code> was <code dir="auto">undefined</code> or a <code dir="auto">URL</code>.</p> <p>Astro v5.0 updates the shape of <code dir="auto">IntegrationRouteData.distURL</code> to be <code dir="auto">undefined</code> or an array of <code dir="auto">URL</code>s. This fixes a previous error because a route can generate multiple files on disk, especially when using dynamic routes such as <code dir="auto">[slug]</code> or <code dir="auto">[...slug]</code>.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-30">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-30"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Update your code to handle <code dir="auto">IntegrationRouteData.distURL</code> as an array.</p> <div class="expressive-code">

<pre data-language="js">if (route.distURL) {
  if (route.distURL.endsWith('index.html')) {
    // do something
  }
  for (const url of route.distURL) {
    if (url.endsWith('index.html')) {
      // do something
    }
  }
}</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">See the <a href="../../../reference/integrations-reference/index#integrationroutedata-type-reference">API reference for <code dir="auto">IntegrationRouteData</code></a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-arguments-passed-to-apprender-adapter-api">Changed: Arguments passed to <code dir="auto">app.render()</code> (Adapter API)</h3>
<a class="sl-anchor-link" href="#changed-arguments-passed-to-apprender-adapter-api"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: Arguments passed to app.render() (Adapter API)”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11987" class="astro-ro74hpkt">Implementation PR: TODOs (#11987)</a> </div> <p>In Astro 4.x, The Adapter API method <code dir="auto">app.render()</code> could receive three arguments: a mandatory <code dir="auto">request</code>, an object of options or a <code dir="auto">routeData</code> object, and <code dir="auto">locals</code>.</p> <p>Astro 5.0 combines these last two arguments into a single options argument named <code dir="auto">renderOptions</code>.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-31">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-31"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>Pass an object as the second argument to <code dir="auto">app.render()</code>, which can include <code dir="auto">routeData</code> and <code dir="auto">locals</code> as properties.</p> <div class="expressive-code">

<pre data-language="js">const response = await app.render(request, routeData, locals);
const response = await app.render(request, {routeData, locals});</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">See the <a href="../../../reference/adapter-reference/index#renderoptions">Adapter API reference for <code dir="auto">renderOptions</code></a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="changed-properties-on-supportedastrofeatures-adapter-api">Changed: Properties on <code dir="auto">supportedAstroFeatures</code> (Adapter API)</h3>
<a class="sl-anchor-link" href="#changed-properties-on-supportedastrofeatures-adapter-api"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed: Properties on supportedAstroFeatures (Adapter API)”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11806" class="astro-ro74hpkt">Implementation PR: rework supportedAstroFeatures (#11806)</a> </div> <p>In Astro 4.x, <code dir="auto">supportedAstroFeatures</code>, which allows adapter authors to specify which features their integration supports, included an <code dir="auto">assets</code> property to specify which of Astro’s image services were supported.</p> <p>Astro 5.0 replaces this property with a dedicated <code dir="auto">sharpImageService</code> property, used to determine whether the adapter is compatible with the built-in sharp image service.</p> <p>v5.0 also adds a new <code dir="auto">limited</code> value for the different properties of <code dir="auto">supportedAstroFeatures</code> for adapters, which indicates that the adapter is compatible with the feature, but with some limitations. This is useful for adapters that support a feature, but not in all cases or with all options.</p> <p>Additionally, the value of the different properties on <code dir="auto">supportedAstroFeatures</code> for adapters can now be objects, with <code dir="auto">support</code> and <code dir="auto">message</code> properties. The content of the <code dir="auto">message</code> property will show a helpful message in the Astro CLI when the adapter is not compatible with a feature. This is notably useful with the new <code dir="auto">limited</code> value, to explain to the user why support is limited.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-32">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-32"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you were using the <code dir="auto">assets</code> property, remove this as it is no longer available. To specify that your adapter supports the built-in sharp image service, replace this with <code dir="auto">sharpImageService</code>.</p> <p>You may also wish to update your supported features with the new <code dir="auto">limited</code> option and include a message about your adapter’s support.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">my-adapter.mjs</span></div>
<pre data-language="ts">supportedAstroFeatures: {
  assets: {
    supportKind: "stable",
    isSharpCompatible: true,
    isSquooshCompatible: true,
  },
  sharpImageService: {
    support: "limited",
    message: 'This adapter supports the built-in sharp image service, but with some limitations.'
  }
}</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../../reference/adapter-reference/index#astro-features">specifying supported Astro features in an adapter</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="removed-deprecated-definition-shape-for-dev-toolbar-apps-dev-toolbar-api">Removed: Deprecated definition shape for dev toolbar apps (Dev Toolbar API)</h3>
<a class="sl-anchor-link" href="#removed-deprecated-definition-shape-for-dev-toolbar-apps-dev-toolbar-api"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Removed: Deprecated definition shape for dev toolbar apps (Dev Toolbar API)”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/11987" class="astro-ro74hpkt">Implementation PR: Remove deprecated dev toolbar app shape (#11987)</a> </div> <p>In Astro 4.x, when building a dev toolbar app, it was still possible to use the previously deprecated <code dir="auto">addDevToolbarApp(string);</code> signature. The <code dir="auto">id</code>, <code dir="auto">title</code>, and <code dir="auto">icon</code> properties to define the app were then made available through the default export of the app’s <code dir="auto">entrypoint</code>.</p> <p>Astro 5.0 completely removes this option entirely in favor of the current object shape when defining a dev toolbar app in an integration that’s more intuitive and allows Astro to provide better errors when toolbar apps fail to load correctly.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-33">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-33"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you were using the deprecated shape, update your dev toolbar app to use the new shape:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">my-integration.mjs</span></div>
<pre data-language="js">// Old shape
addDevToolbarApp("./my-dev-toolbar-app.mjs");


// New shape
addDevToolbarApp({
  id: "my-app",
  name: "My App",
  icon: "&lt;svg&gt;...&lt;/svg&gt;",
  entrypoint: "./my-dev-toolbar-app.mjs",
});</pre>

</div> <div class="expressive-code">
<div class="_pre-heading"><span class="title">my-dev-toolbar-app.mjs</span></div>
<pre data-language="js">export default {
  id: 'my-dev-toolbar-app',
  title: 'My Dev Toolbar App',
  icon: '🚀',
  init() {
    // ...
  }
}</pre>

</div> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">Read more about <a href="../../../reference/dev-toolbar-app-reference/index">developing a dev toolbar app for Astro using the Dev Toolbar API</a>.</span> </div> <div class="sl-heading-wrapper level-h3">
<h3 id="removed-configuring-typescript-during-create-astro">Removed: configuring Typescript during <code dir="auto">create-astro</code>
</h3>
<a class="sl-anchor-link" href="#removed-configuring-typescript-during-create-astro"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Removed: configuring Typescript during create-astro”</span></a>
</div> <div class="source astro-ro74hpkt"> <svg aria-hidden="true" class="icon astro-ro74hpkt astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"></path></svg> <a href="https://github.com/withastro/astro/pull/12083" class="astro-ro74hpkt">Implementation PR: create-astro updates (#12083)</a> </div> <p>In Astro v4.x, it was possible to choose between Astro’s three TypeScript settings when creating a new project using <code dir="auto">create astro</code>, either by answering a question or by passing an associated <code dir="auto">--typescript</code> flag with the desired TypeScript setting.</p> <p>Astro 5.0 updates the <code dir="auto">create astro</code> CLI command to remove the TypeScript question and its associated <code dir="auto">--typescript</code> flag. The “strict” preset is now the default for all new projects created with the command line and it is no longer possible to customize this at that time. However, the TypeScript template can still be changed manually in <code dir="auto">tsconfig.json</code>.</p> <div class="sl-heading-wrapper level-h4">
<h4 id="what-should-i-do-34">What should I do?</h4>
<a class="sl-anchor-link" href="#what-should-i-do-34"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “What should I do?”</span></a>
</div> <p>If you were using the <code dir="auto">--typescript</code> flag with <code dir="auto">create-astro</code>, remove it from your command.</p> <starlight-tabs data-sync-key="package-managers" class="astro-xtbw65nk"> <div class="tablist-wrapper not-content astro-xtbw65nk"> <ul role="tablist" class="astro-xtbw65nk"> <li role="presentation" class="tab astro-xtbw65nk"> <a role="tab" href="#tab-panel-3552" id="tab-3552" aria-selected="true" tabindex="0" class="astro-xtbw65nk"> npm </a> </li>
<li role="presentation" class="tab astro-xtbw65nk"> <a role="tab" href="#tab-panel-3553" id="tab-3553" aria-selected="false" tabindex="-1" class="astro-xtbw65nk"> pnpm </a> </li>
<li role="presentation" class="tab astro-xtbw65nk"> <a role="tab" href="#tab-panel-3554" id="tab-3554" aria-selected="false" tabindex="-1" class="astro-xtbw65nk"> Yarn </a> </li> </ul> </div> <div id="tab-panel-3552" aria-labelledby="tab-3552" role="tabpanel"> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">npm create astro@latest -- --template &lt;example-name&gt; --typescript strict
npm create astro@latest -- --template &lt;example-name&gt;</pre>

</div> </div> <div id="tab-panel-3553" aria-labelledby="tab-3553" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">pnpm create astro@latest --template &lt;example-name&gt; --typescript strict
pnpm create astro@latest --template &lt;example-name&gt;</pre>

</div> </div> <div id="tab-panel-3554" aria-labelledby="tab-3554" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">yarn create astro --template &lt;example-name&gt; --typescript strict
yarn create astro --template &lt;example-name&gt;</pre>

</div> </div> <starlight-tabs-restore class="astro-xtbw65nk"></starlight-tabs-restore> </starlight-tabs> <div class="read-more astro-szj46hnz"> <svg aria-hidden="true" class="icon astro-szj46hnz astro-eytsx3ik" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"></path></svg> <span class="astro-szj46hnz">See <a href="https://github.com/withastro/astro/blob/main/packages/create-astro/README.md">all the available <code dir="auto">create astro</code> command flags</a></span> </div> <div class="sl-heading-wrapper level-h2">
<h2 id="community-resources">Community Resources</h2>
<a class="sl-anchor-link" href="#community-resources"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Community Resources”</span></a>
</div> <p>Know a good resource for Astro v5.0? <a href="https://github.com/withastro/docs/edit/main/src/content/docs/en/guides/upgrade-to/v5.mdx">Edit this page</a> and add a link below!</p> <div class="sl-heading-wrapper level-h2">
<h2 id="known-issues">Known Issues</h2>
<a class="sl-anchor-link" href="#known-issues"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewbox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Known Issues”</span></a>
</div> <p>Please check <a href="https://github.com/withastro/astro/issues/">Astro’s issues on GitHub</a> for any reported issues, or to file an issue yourself.</p> <span id="docsearch-lvl0" hidden>Upgrade Guides</span> </div> <div class="hide-when-toc-is-visible astro-o5o7wsh2"> <div class="container astro-6x7bp2qc" lang="en" dir="ltr" data-algolia-exclude> <aside aria-labelledby="learn-astro-course-1" class="astro-6x7bp2qc"> <img src="data:image/webp;base64,UklGRvIQAABXRUJQVlA4WAoAAAAQAAAAgQAAhAAAQUxQSC0DAAABoBvbmtzMeVNjavtC+LS7UAbw5GmgBIaIYABTO5ABOwDpByMYKAGxMxgEoCp8CajYliyV+jNIAk2gP61OREwAckiV8w52cz2IqqrYRGUzBr1PAKjsCjuocj7o8rp2k6r2NnA9iKb32aOyGYM+NoAq5ylT1I1etyiqqvWxzQ43g+jGfWbGoHss8uJ1l56y4vahL7JS7cRlhOvTTnwmymYMul96n3Iw6c5f5MDtzQF49vzZvuq9+bc+/fzbrz7eS9dXBVDu7fcff/n1z9++vOLa9VvzqqqiWfzjp3YQVVW/tekqt5vz/xHgWow7BM3zpmq1j3M1bQkhU7Kp0Tqq3GRdpdneEOdLg3eHkh7EVTOIZn8a+6pIQ24KamjwjtchqLGChM6aIUVpTZkCYosgaW+LS8O2cBp4SzwSt5YcUpElnArejp+RvLLjkI6CFQEPdFYMD6CTFcd0taiZckhTejV14nV0VHMHXtEFNVjaJaWo0XK4xV4NHxhAp8Z3QGtdC8DZ1uPaWzbiJoldQrfAwSph3C+tKrC0tanFcmdRj7XenhGrSawRWgcOtggjhdg3qbETrTuqucOqTg3uVlRq8mERB5vCZwtY1Oj5/XuTmv2Gbh3V8OFGp6Z3ACo1/gA4644AWAyLvsTNWoyKl5e4z71JsSMs5pM58cxYXYspcS6RtBU7Lh1S82jFEyH9yQqHB4oVlwdUamUs053M0HMyVjsvlKo2JLapvCHqE7FaGilNa4r2acQWn6RQW2OZ4mSMuhRizSUBj5MhMcb5Na8DQGXjfMhcjPHy5viqIDy0qPpxylScn15VjM1KjmbCtvOEfwfOW/P/X5LRdTuJvTvPMcZdBe+aggAg7GMGACobd77EGOPm3NBUjIX9Prqr21Q2r49bW827iLwki34PZ2S23UF8mRsKa8IWODfwy0JLsk64npc9Ibvlop4ADmuEAXZxQfwiPwj3POO6WFPgmk/xzowMu1tTibvtshZ3qzneeMpReRVaLO2X9Fhaz6oaixzBq/aE5ad7I5azizojy71nrKXpltAKgIeXeUrKciWMhGQGiqAaGLbXqhWs73v8DQQAVlA4IJ4NAAAQOQCdASqCAIUAPm0ulEakIiIhKfFNQIANiWoGWBdGb9AP0A8QD8AP0A/gCYQo4/HdWxu/yPnDWL+7/jv+t+6DvpjzdoGTX1Q+Yb+rXTc8xn7Pfr17u3+o9Uv9d9Qb+Y/7T0h/Yg9Any2f3Q+Db90v3Y9rbqAOE8/w3bJ/gPEHx7+3/b/+r86B6b7wfqPOnwH+QuoF+QfzP/I/mDw7AA/zv+i/5vw69Vm9e/4PHo0AP0Z6Jf/T52vrX2Ef5n/af+aw/gTPTU/vLqKfCV8mH5T6U/PmrHeKP4iwI0pGgGIOTwR8GHgNdHTpJ4Q+dNhyfO5imVdCwpBnMq35ttJBnEiM3iZsv5SQktXSwEBbBLD0IG1RmGuGCbaAWSgDGuxMwa6/CsrGIDhuHKp80v5X7AjIQXItjUjkNPZjuQgJjI84s0My4ljxQIEaS65ayH50oCYbwLJtrOzqIes8gjW6AZMjGH/zRyozx9+RD4Mug1jNa/y/XAcE/8mX4+tN3f1aV56pkfC/AJQ780+e/i7lrvwEXqbRU3SpqAzfFPz1ZYL965jgtUqEsc5JZwJMf+O2KqIlgpVcTf7gSBf3DI0KttHzHq/r4iurh+Bi+K4XwcC1KGAA/v5HgnxTjiLf9rueWoIV3ZKnAcWdiQk+8JKA3dxQvlK8YSqal2d0CCOfXQ1xnpiaaNbwpWproUytNP/Z+c4HKicI9XY0dPfjI9F2xPXSEJ1/Mdxwr0jwadiphU+HVPJ/wisObIruUydsXIKrT7rho1+xSIIGnlIBiS7ZWbTkFzgImxBvCt4Rzr8xY9khTZRzBfGdNR8P562aVSSSbl2TqCI1uRRKt1H65eU9WgqsRmsOTaVqojHjYNeivXv78UWtckYKpC2aezZKEi0EbUV2knUAz15G43k461s8rKE2Oer2FXlxgoXctt9NwAPV3qe3t8usyEA90CXTl2taJUQXglWmhOyudhMigXzOSh8b77qVEA7SK0bAGtftHqKcw4CD6+gW87cebJnpxUWk9GMVzH7yb8p0jFqjfn3PmsSnZEQakQ1LlqNFT1fSGU263Y8ZetifSEKngPxo/a/8mOXvx+IW5eom9gfOQB6JZSy+yQWv41ePupkGZ4aJvMDgLqY1ouaq8Njyje/96essb78xkNUOxdm5jJQyDHVOuugL8zphd05AgDvfcHF5NhQh8OT1iXnrUusn/NEHuWRjTM5o0aAYjm+7j+ZMEBD2ldvsX4xft/8BWvbyCOcNGPI15Tnr/NDfmrWvqdP/XCXTw6ESgVr5KMW3GX1fTKioVOs9k6s9I6TpP5YynXNP4P2eCkN0IFbx+uzeehFsx9UVSWuwlBEsHd5Caj2rDhH7qUeG0N9sDCcUE3kcYqtVE81QJ3M6a9fayJ4ZxxSx03a7kIPZiWk3a53cqGWsJ9KIxxjwHgBeHP4yOg6Xvp9PuJfi/8cpUp4JPERIAD75aRe7TThr50j8xGIMwl0xCZquxC//mgCf0MsNOAWFddw8j0Jftq2n9jb+zOUO4v7TQMHc7sYAN7Ct1/nKB/V1PjFO9RpfPiunpUOGh+pq/PrwECAWI0FqZzUWbDS8Shg+6AvCvc5/tPBJVcyRKlep6IYJvB7DWH3aWSoJK1/317/JpcvO3obA3FX9Dn48TbG3fxvgvT63lcbZZ/apnKQp+5tWTmns9wXc/N+WYByjnbgI3sM79BbnVS6oB1+JflbfTGdFWeFPO3RP+2EWAzIPutF4S/pYtzOTNPOzCpgS+BfcMcv/H4NqOP630Ep7otKnEoljvQ33bhFw90L4V6cGdsw5/jWV1Z+HxOj8OC4wMRM8P/0iHBjuwB5oYpPs59z2MyX4ty4BXthtcS0X9LMIR/horHXiBsu+yAGkNmAapUB3ovAPtSZ44HksTqQEX0N00QTslHAetwDAH59SjUPCnAupeAZXdCioRW4RH8Hu81X7eovGrTKs88/l+nICbNdFI/EU+bajYP/i5IngzJVrUlzDtgqX8rSh1ARS/4XC+8aGOu+i+Z9ch0204ah8KA3TJtKU4ax1s7prBo/+wVuoOfZbZgo6/MrxL/KzKDr/9Ppf/9Qnj+Js5hjLYtNPLBAh+lx+KoW4xN+S0muI60C62TECJty8ChdStMHK0vsqXBS52Empg2XazUORL8ihrKqwFQHGYaxvLbysp8dJIFtuiICAx5640v51e0rowenxMsHiLRjQQ/6PG2ZC9kId0S+6o7GaNlpniPO73wSYGBwPZs6FnG5DfW7qutSL++TLH7/xlVqnArmWFUAVP5xpE5EZNKHUa3xRRAAQxoof1EOUbu3PAboBRIMWyuIAcGvCEBiefErl2tu+zSu8BcZcBUuLIPKZ6PqQqXYTNOMFmTZ1N+aB1T11nChDM16lDTcwXE2fC+X9UOVpiywDSej4o1w+V4kg20vMfgOlb92neCr0iWVHw4v8cZG8uyAz1D8Mwpej5VkRtGLV4MqQmQSJVbdh/YAZOFdqZEmioZhJNEraPswZXryMCr8k2e+2Kr21u3DMLdCSt6KsIqIDSqIoesZ/USj/FQf1YMu3DEVGJxFqz9QqA/BmEYd9UqFjsjA0WqF86gbe/MfULl+nya3FXYynm3EK4/Z9YvQAccfFEZjRId4RuorhLwLXgGIJLsSSeMi3aNZWY7QgTFAeOAJTWB5rnuP+LgsQ9JfvUGt6/4uDBozO/ezxRsZkr7BcHNkT9nj6BcJ6WZdh8GMeuvUeB7jxE/gNgD4ACL3ZU/8NGo0qAf7L2lcTy3dlFKkCPoBFpuegSDl/UimIMze66lN4C6Jdt5JyWsi8B1JftvKPvHlVoNtrV/aOdgdBpVQ4sRv55eKLyLtnt+STASUC9+NwngGFDUzOjO0zuL/9ZaWY7yXWihY7puWtVJRK4kcrwZWhcV7rRJJHsc14cI2KcgT140ESNAD3koA9U6nbEgJ4HVubC0AbnoVHKUZ6tkimIvldCLQZeETQZyb71r2RrGsfNVil8GpwLFNh0sRFBpA0yXmB2HRfhPsAMGWrjlrgbDKbbETNmjfX3k8lLSZSP9PsEWmNy3CmTxJxq2wcXcX1Lc4a51pxdOWFvZU+mt0tPhAqDIcFB/5JvWDBQgIbvp50ku3vG7EnC3dRF0kLxN8V7mFfdGHs9pzUO2N+/5e9f89/uFjB3iIOZNBuRkA0sGpva3LlZ5/ABHgMLLJeDTawhs6NUbde0dzbsvHLlmqDGbby48E2dP8T973BESg4EpjjGPor4oIM+n+hXfnJEZlb2pmoYBkH1UzBbp8GrDPgzsSHB4WgJv8ejcJ7azEAtLTaaBrr3QjuVWZOk0xePT/Ej8KuLqv/iVAu3uWbGiZGUTszgRbVvFgiDmhF9ZMBPip3GoSel1O2hR3wO2w5J0U4WohjPKE6EnTW8ObQOr9x85s5I+etJHX3C8WMTJIaRTHoQTIyVwpY2Hq+LgPdOQP4FN/3oLu/UHWzRx1WdjyXwuw14+YSY1aX51LYGg82H1jgF/9eg4KZ5JCkcC5BbxPzjZwuyOZoSuxCZVtUT2Wz90HOQ/Sw7/8MTBS4Ia+/w4ovMo/WBWmdsii8d0KhMILwUouq8o4nHzxr8o8ubBZLtIMkDYTaOZ5GjKJOEKT6tUS+Ft+TWPMv57yV0gfDWZ2+j8r/lvxC1AsmNns6IPImLIsZVLJH08i1kb1Rc0GCec/Xpn0J4PpfH+RfaYlyUIrWr7BJCkWpz7NTlNLWyrnF9VmwjIOBgerx2lXbf3zyRwg+Fj6M9Hks5GW9pw6o/baxr9ANg7963+HAU7qga6FOTCc03t/60u4ADG2UO7kIjOLoZvJow2Vqv5qWlerTRX0QamZ3QG42eZC2QO+wQ8o42wyiLmcP895sNS9jPH0cKw3sUcrrdMorEv+6z4sbN1RYoe9bgyg6r5LB3CenKcTJVz/zgFYn2piU5COjFR5CojGncJMSjktcQTL+UFoZuwM/BLWI3ieJu5BTGGMaVPfwItVkvzWdobB9twbPMi/v283FD8D/X/JoGhU4CmGPaejcYacF0WUBclBoe+5b2bt0Z4mMjGvB18NUAam941jMZSw2WLI/6hE2jqg4Qk1L7DxuWQwSNqCNHYQyG0OG3RRUrYAnVg/8hQu8+4T0emlY6a+pclJL2VMkgFpbQ4dqkiO4Ib722cE5x3yNpgC3MAKeb8QpeqIBs25V7u+aBMRiQtkUf0TBpoatngyDSw6p73APq+LE7SQilTbAyAACOiPdWCOPck/6B7uf3M3YYmd8sFf2LPw5aA1DE6TgaCbuAyxIDbJEv31kZtBX1+pOYzOZMUyzLkw1/B6p3yykaUIwzCug1DsUm1oilXADOJ0y66BosB7eeBtbkM707OcPsNhX6Crok3rDYbglTeZUzQ/XTZ1twRpo9jlgJi6VI+LxioF+M1JY5YkFitFbZvqXghwWP5CVa9XseyuMA1h2vNP07TUsMfYADJG6j8iv7qYX3cTJEAdWKNsnqMpZHMpjFt1/bjbWINaFQ80KA4BePAD/0yUljxmO6mZ12JxxcI7z7xECgEfWQMMaWRUma8+nVWgAAKGf/9tWDQD+abzdX8RW4R2tnutVQ9nvMGwc5YugGXzUbDrmACTSTqR+32qjypHrITBkUaAAAAA=" alt loading="lazy" decoding="async" fetchpriority="auto" width="130" height="133" class="astro-6x7bp2qc"> <h2 id="learn-astro-course-1" class="astro-6x7bp2qc">Learn Astro with <strong class="astro-6x7bp2qc">Coding in Public</strong>
</h2> <p class="sl-flex astro-6x7bp2qc"> <span class="sl-flex astro-6x7bp2qc" style="gap: 0.25rem; align-items: center;"> <svg fill="currentColor" viewbox="0 0 18 18" aria-hidden="true" class="astro-6x7bp2qc"> <path d="M12 7.7 8.25 5.53A1.5 1.5 0 0 0 6 6.83v4.34a1.5 1.5 0 0 0 2.25 1.3L12 10.3a1.5 1.5 0 0 0 0-2.6ZM11.25 9 7.5 11.17V6.83L11.25 9ZM9 1.5a7.5 7.5 0 1 0 0 15 7.5 7.5 0 0 0 0-15ZM9 15A6 6 0 1 1 9 3a6 6 0 0 1 0 12Z" class="astro-6x7bp2qc"></path> </svg> <span class="astro-6x7bp2qc">150+ video lessons</span> </span> <span class="astro-6x7bp2qc">•</span> <span class="astro-6x7bp2qc">Astro v5 ready</span> </p> <a class="sl-link-button not-content primary cta astro-6x7bp2qc astro-n3qr5j5k" href="https://learnastro.dev?code=ASTRO_HOLIDAY_PROMO" data-learn-astro-cta="true"> <span class="astro-6x7bp2qc"><strong class="astro-6x7bp2qc">Price Drop!</strong> Get 33% off</span> </a> </aside> </div>  </div>   </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 Fred K. Schott<br>Licensed under the MIT License.<br>
    <a href="https://docs.astro.build/en/guides/upgrade-to/v5/" class="_attribution-link">https://docs.astro.build/en/guides/upgrade-to/v5/</a>
  </p>
</div>
