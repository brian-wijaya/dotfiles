<h1>before (Lodash Compatibility)</h1>

<p>::: warning Use <span><code>before</code></span> from <code>es-toolkit</code></p>

<p>This <code>before</code> function operates slower due to complex type validation and integer conversion handling.</p>

<p>Instead, use the faster and more modern <span>before</span> from <code>es-toolkit</code>.</p>

<p>:::</p>

<p>Creates a function that executes the original function up to a specified number of times, then returns the last result for subsequent calls.</p>

<pre data-language='typescript'><code class='typescript'>const limitedFunction = before(n, func);
</code></pre>

<h2>Usage</h2>

<h4><code>before(n, func)</code></h4>

<p>Use <code>before</code> when you want to restrict a function to execute only up to a certain number of times. This is useful for limiting function call counts or when you want to execute a function only during the initial setup phase.</p>

<pre data-language='typescript'><code class='typescript'>import { before } from &#39;es-toolkit/compat&#39;;

// Basic usage
let count = 0;
const beforeThree = before(3, () =&gt; ++count);

console.log(beforeThree()); // 1 (first call)
console.log(beforeThree()); // 2 (second call)
console.log(beforeThree()); // 2 (from third call onwards, returns last result)
console.log(beforeThree()); // 2 (continues to return last result)
</code></pre>

<p>Alternative using closures:</p>

<pre data-language='typescript'><code class='typescript'>// Using before
const beforeThree = before(3, myFunction);

// Using closures (simpler and faster)
function createBefore(limit, callback) {
  let callCount = 0;
  let lastResult;

  return function (...args) {
    if (callCount &lt; limit - 1) {
      lastResult = callback.apply(this, args);
      callCount++;
    }
    return lastResult;
  };
}

const beforeThreeAlternative = createBefore(3, myFunction);
</code></pre>

<p>Using as an initialization function:</p>

<pre data-language='typescript'><code class='typescript'>import { before } from &#39;es-toolkit/compat&#39;;

class Database {
  constructor() {
    this.isInitialized = false;

    // Initialization executes only once
    this.initialize = before(2, () =&gt; {
      console.log(&#39;Initializing database...&#39;);
      this.setupConnection();
      this.isInitialized = true;
      return &#39;Initialization complete&#39;;
    });
  }

  setupConnection() {
    // Actual connection setup logic
  }

  query(sql) {
    const initResult = this.initialize();
    console.log(initResult); // First call: &quot;Initialization complete&quot;, subsequent: same result

    // Query execution logic
    return `Query executed: ${sql}`;
  }
}

const db = new Database();
db.query(&#39;SELECT * FROM users&#39;); // Initialization executed
db.query(&#39;SELECT * FROM products&#39;); // Initialization not executed
</code></pre>

<p>Limiting API calls:</p>

<pre data-language='typescript'><code class='typescript'>import { before } from &#39;es-toolkit/compat&#39;;

// Allow API calls up to 5 times maximum
const limitedApiCall = before(6, endpoint =&gt; {
  console.log(`API call: ${endpoint}`);
  return fetch(endpoint).then(res =&gt; res.json());
});

// First 5 calls execute actual API calls
limitedApiCall(&#39;/api/data1&#39;); // Actual call
limitedApiCall(&#39;/api/data2&#39;); // Actual call
limitedApiCall(&#39;/api/data3&#39;); // Actual call
limitedApiCall(&#39;/api/data4&#39;); // Actual call
limitedApiCall(&#39;/api/data5&#39;); // Actual call
limitedApiCall(&#39;/api/data6&#39;); // Returns last result (no API call)
</code></pre>

<p>Limiting event listeners:</p>

<pre data-language='typescript'><code class='typescript'>import { before } from &#39;es-toolkit/compat&#39;;

// Process click events up to 3 times
const limitedClickHandler = before(4, event =&gt; {
  console.log(&#39;Click processed:&#39;, event.target.id);
  return `Processed: ${Date.now()}`;
});

document.getElementById(&#39;button&#39;).addEventListener(&#39;click&#39;, limitedClickHandler);
// Only the first 3 clicks are processed, subsequent calls return the last result
</code></pre>

<p>Handling parameters and return values:</p>

<pre data-language='typescript'><code class='typescript'>import { before } from &#39;es-toolkit/compat&#39;;

const limitedCalculator = before(3, (operation, a, b) =&gt; {
  const result = operation === &#39;add&#39; ? a + b : a - b;
  console.log(`Calculation: ${a} ${operation} ${b} = ${result}`);
  return result;
});

console.log(limitedCalculator(&#39;add&#39;, 5, 3)); // &quot;Calculation: 5 add 3 = 8&quot;, returns: 8
console.log(limitedCalculator(&#39;subtract&#39;, 10, 4)); // &quot;Calculation: 10 subtract 4 = 6&quot;, returns: 6
console.log(limitedCalculator(&#39;multiply&#39;, 7, 2)); // No calculation, returns: 6 (last result)
</code></pre>

<p>Passing 0 or 1 prevents the function from executing:</p>

<pre data-language='typescript'><code class='typescript'>import { before } from &#39;es-toolkit/compat&#39;;

const neverCalled = before(0, () =&gt; {
  console.log(&#39;This function will not execute&#39;);
  return &#39;result&#39;;
});

const onceOnly = before(1, () =&gt; {
  console.log(&#39;This function will also not execute&#39;);
  return &#39;result&#39;;
});

console.log(neverCalled()); // undefined
console.log(onceOnly()); // undefined
</code></pre>

<p>Resource cleanup optimization:</p>

<pre data-language='typescript'><code class='typescript'>import { before } from &#39;es-toolkit/compat&#39;;

// Function references are automatically cleaned up to prevent memory leaks
const limitedProcessor = before(2, data =&gt; {
  // Complex data processing
  return processComplexData(data);
});

// After the 2nd call, the original function reference is removed (garbage collection)
</code></pre>

<h4>Parameters</h4>

<ul>
<li><code>n</code> (<code>number</code>): The maximum number of times to execute the function. It executes up to n-1 times, and from the nth call onwards, returns the last result.</li>
<li><code>func</code> (<code>Function</code>): The function to restrict.</li>
</ul>

<h4>Returns</h4>

<p>(<code>Function</code>): Returns a new function that executes the original function up to the specified number of times, and thereafter returns the last result.</p>
<div class="_attribution">
  <p class="_attribution-p">
          &copy; 2024-2025, Viva Republica<br>
      Licensed under the MIT License.

    <br>
    <a href="https://es-toolkit.slash.page/reference/compat/function/before.html" class="_attribution-link">
      https://es-toolkit.slash.page/reference/compat/function/before.html
    </a>
  </p>
</div>
