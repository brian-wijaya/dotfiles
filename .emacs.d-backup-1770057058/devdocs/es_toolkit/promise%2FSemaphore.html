<h1>Semaphore</h1>

<p>Limits the number of asynchronous tasks that can execute simultaneously.</p>

<pre data-language='typescript'><code class='typescript'>const semaphore = new Semaphore(capacity);
</code></pre>

<h2>Usage</h2>

<h4><code>Semaphore(capacity)</code></h4>

<p>Use <code>Semaphore</code> when you want to limit the number of asynchronous tasks that can execute concurrently. It&#39;s particularly useful in situations where you need to control resource usage, such as database connection pools, API call rate limiting, or file download limits.</p>

<pre data-language='typescript'><code class='typescript'>import { Semaphore } from &#39;es-toolkit&#39;;

const semaphore = new Semaphore(3);

// API call rate limiting example (maximum 3 concurrent executions)
async function callAPI(id: number) {
  await semaphore.acquire();
  try {
    console.log(`Starting API call: ${id}`);
    const response = await fetch(`/api/data/${id}`);
    return response.json();
  } finally {
    semaphore.release();
    console.log(`Completed API call: ${id}`);
  }
}

// File download limiting example
async function downloadFile(url: string) {
  await semaphore.acquire();
  try {
    console.log(`Starting download: ${url}`);
    // File download logic
    await fetch(url);
  } finally {
    semaphore.release();
    console.log(`Completed download: ${url}`);
  }
}

// Even if 5 tasks are called simultaneously, only 3 execute concurrently
callAPI(1);
callAPI(2);
callAPI(3);
callAPI(4); // Waits until one of the previous tasks completes
callAPI(5); // Waits until one of the previous tasks completes
</code></pre>

<h4>Parameters</h4>

<ul>
<li><code>capacity</code> (<code>number</code>): The maximum number of tasks that can execute concurrently. Must be an integer greater than 1.</li>
</ul>

<h4>Properties</h4>

<ul>
<li><code>capacity</code> (<code>number</code>): The maximum number of tasks that can execute concurrently.</li>
<li><code>available</code> (<code>number</code>): The number of currently available permits. If <code>0</code>, all permits are in use.</li>
</ul>

<h4>Methods</h4>

<ul>
<li><code>acquire</code> (<code>() =&gt; Promise&lt;void&gt;</code>): Acquires permission to execute an asynchronous task, or waits until permission is granted.</li>
<li><code>release</code> (<code>() =&gt; void</code>): Returns permission so that the next waiting task can execute.</li>
</ul>
<div class="_attribution">
  <p class="_attribution-p">
          &copy; 2024-2025, Viva Republica<br>
      Licensed under the MIT License.

    <br>
    <a href="https://es-toolkit.slash.page/reference/promise/Semaphore.html" class="_attribution-link">
      https://es-toolkit.slash.page/reference/promise/Semaphore.html
    </a>
  </p>
</div>
