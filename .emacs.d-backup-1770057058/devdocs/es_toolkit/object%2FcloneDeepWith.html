<h1>cloneDeepWith</h1>

<p>Deeply clones the given value with a custom cloning function.</p>

<pre data-language='typescript'><code class='typescript'>const customCloned = cloneDeepWith(obj, cloneValue);
</code></pre>

<h2>Usage</h2>

<h4><code>cloneDeepWith(obj, cloneValue)</code></h4>

<p>Use <code>cloneDeepWith</code> when you want to deeply copy an object or array with custom logic for specific values. If the custom function <code>cloneValue</code> returns a value, that value is used; if it returns <code>undefined</code>, the default deep copying method is used.</p>

<pre data-language='typescript'><code class='typescript'>import { cloneDeepWith } from &#39;es-toolkit/object&#39;;

// Double numbers during cloning
const obj = { a: 1, b: { c: 2, d: &#39;text&#39; } };
const clonedObj = cloneDeepWith(obj, value =&gt; {
  if (typeof value === &#39;number&#39;) {
    return value * 2;
  }
  // Return undefined to use default cloning
});
console.log(clonedObj); // { a: 2, b: { c: 4, d: &#39;text&#39; } }

// Add 1 to all array elements during cloning
const arr = [1, [2, 3], { num: 4 }];
const clonedArr = cloneDeepWith(arr, value =&gt; {
  if (typeof value === &#39;number&#39;) {
    return value + 1;
  }
});
console.log(clonedArr); // [2, [3, 4], { num: 5 }]
</code></pre>

<p>The custom function receives the current value, key, original object, and internal stack information as parameters.</p>

<pre data-language='typescript'><code class='typescript'>const data = {
  user: { name: &#39;Alice&#39;, age: 30 },
  settings: { theme: &#39;dark&#39;, lang: &#39;en&#39; },
};

const result = cloneDeepWith(data, (value, key, obj, stack) =&gt; {
  // Clone &#39;user&#39; object with special handling
  if (key === &#39;user&#39; &amp;&amp; typeof value === &#39;object&#39;) {
    return { ...value, cloned: true };
  }

  // Add prefix to strings
  if (typeof value === &#39;string&#39;) {
    return `cloned_${value}`;
  }
});

console.log(result);
// {
//   user: { name: &#39;cloned_Alice&#39;, age: 30, cloned: true },
//   settings: { theme: &#39;cloned_dark&#39;, lang: &#39;cloned_en&#39; }
// }
</code></pre>

<p>Using a custom function allows you to freely configure how objects are cloned. For example, you can copy <code>Date</code> objects to be one year in the future.</p>

<pre data-language='typescript'><code class='typescript'>const data = {
  created: new Date(&#39;2023-01-01&#39;),
  updated: new Date(&#39;2023-12-31&#39;),
  name: &#39;Document&#39;,
};

const cloned = cloneDeepWith(data, value =&gt; {
  // Set Date objects to one year in the future
  if (value instanceof Date) {
    const newDate = new Date(value);
    newDate.setFullYear(newDate.getFullYear() + 1);
    return newDate;
  }
});

console.log(cloned.created.getFullYear()); // 2024
console.log(cloned.updated.getFullYear()); // 2024
</code></pre>

<h4>Parameters</h4>

<ul>
<li><code>obj</code> (<code>T</code>): The value to deeply copy.</li>
<li><code>cloneValue</code> (<code>(value: any, key: PropertyKey | undefined, obj: T, stack: Map&lt;any, any&gt;) =&gt; any</code>): A custom cloning function. Return the value to clone, or return <code>undefined</code> to use the default method.

<ul>
<li><code>value</code>: The current value being cloned.</li>
<li><code>key</code>: The property name of the current value.</li>
<li><code>obj</code>: The original object to clone.</li>
<li><code>stack</code>: An internal stack to handle circular references.</li>
</ul></li>
</ul>

<h4>Returns</h4>

<p>(<code>T</code>): A deep copy processed through the custom function.</p>
<div class="_attribution">
  <p class="_attribution-p">
          &copy; 2024-2025, Viva Republica<br>
      Licensed under the MIT License.

    <br>
    <a href="https://es-toolkit.slash.page/reference/object/cloneDeepWith.html" class="_attribution-link">
      https://es-toolkit.slash.page/reference/object/cloneDeepWith.html
    </a>
  </p>
</div>
