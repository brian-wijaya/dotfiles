<h1>mergeWith</h1>

<p>Deeply merges the source object into the target object using a custom merge function, modifying the target object.</p>

<pre data-language='typescript'><code class='typescript'>const result = mergeWith(target, source, mergeFunction);
</code></pre>

<h2>Usage</h2>

<h4><code>mergeWith(target, source, merge)</code></h4>

<p>Use <code>mergeWith</code> when you want to apply custom merge logic for each property when merging two objects. If the merge function returns <code>undefined</code>, the default deep merge logic is used.</p>

<pre data-language='typescript'><code class='typescript'>import { mergeWith } from &#39;es-toolkit/object&#39;;

// Add number values during merge
const target = { a: 1, b: 2, c: { x: 10 } };
const source = { b: 3, c: { x: 20, y: 30 }, d: 4 };

const result = mergeWith(target, source, (targetValue, sourceValue, key) =&gt; {
  if (typeof targetValue === &#39;number&#39; &amp;&amp; typeof sourceValue === &#39;number&#39;) {
    return targetValue + sourceValue; // Add numbers
  }
  // Returning undefined uses default merge logic
});
// Both result and target become { a: 1, b: 5, c: { x: 30, y: 30 }, d: 4 }

// Concatenate arrays during merge
const arrayTarget = { items: [1, 2], metadata: { count: 2 } };
const arraySource = { items: [3, 4], metadata: { count: 2 } };

mergeWith(arrayTarget, arraySource, (targetValue, sourceValue) =&gt; {
  if (Array.isArray(targetValue) &amp;&amp; Array.isArray(sourceValue)) {
    return targetValue.concat(sourceValue);
  }
});
// arrayTarget becomes { items: [1, 2, 3, 4], metadata: { count: 2 } }

// Apply different merge logic based on key
const config = { timeout: 1000, retries: 3, features: { featureA: true } };
const updates = { timeout: 2000, retries: 5, features: { featureB: false } };

mergeWith(config, updates, (targetValue, sourceValue, key) =&gt; {
  if (key === &#39;timeout&#39;) {
    return Math.max(targetValue, sourceValue); // Use larger value for timeout
  }
  if (key === &#39;retries&#39;) {
    return Math.min(targetValue, sourceValue); // Use smaller value for retries
  }
  // Use default merge logic for other properties
});
// config becomes { timeout: 2000, retries: 3, features: { featureA: true, featureB: false } }
</code></pre>

<h4>Parameters</h4>

<ul>
<li><code>target</code> (<code>T extends Record&lt;PropertyKey, any&gt;</code>): The target object to merge the source object into. This object is modified.</li>
<li><code>source</code> (<code>S extends Record&lt;PropertyKey, any&gt;</code>): The source object to merge into the target object.</li>
<li><code>merge</code> (<code>(targetValue: any, sourceValue: any, key: string, target: T, source: S) =&gt; any</code>): A custom merge function.

<ul>
<li><code>targetValue</code>: The current value in the target object</li>
<li><code>sourceValue</code>: The value in the source object</li>
<li><code>key</code>: The key of the property being merged</li>
<li><code>target</code>: The target object</li>
<li><code>source</code>: The source object</li>
</ul></li>
</ul>

<h4>Returns</h4>

<p>(<code>T &amp; S</code>): Returns the target object with the source object merged in.</p>

<h2>Examples</h2>

<pre data-language='typescript'><code class='typescript'>const target = { a: 1, b: 2 };
const source = { b: 3, c: 4 };

mergeWith(target, source, (targetValue, sourceValue) =&gt; {
  if (typeof targetValue === &#39;number&#39; &amp;&amp; typeof sourceValue === &#39;number&#39;) {
    return targetValue + sourceValue;
  }
});
// Output: { a: 1, b: 5, c: 4 }

const target = { a: [1], b: [2] };
const source = { a: [3], b: [4] };

const result = mergeWith(target, source, (objValue, srcValue) =&gt; {
  if (Array.isArray(objValue)) {
    return objValue.concat(srcValue);
  }
});
// Output: { a: [1, 3], b: [2, 4] })
</code></pre>

<h2>Demo</h2>

<p>::: sandpack</p>

<p>```ts index.ts
import { mergeWith } from &#39;es-toolkit&#39;;</p>

<p>const target = { a: 1, b: 2 };
const source = { b: 3, c: 4 };</p>

<p>const result = mergeWith(target, source, (targetValue, sourceValue) =&gt; {
  if (typeof targetValue === &#39;number&#39; &amp;&amp; typeof sourceValue === &#39;number&#39;) {
    return targetValue + sourceValue;
  }
});
console.log(result);
```</p>

<p>:::</p>
<div class="_attribution">
  <p class="_attribution-p">
          &copy; 2024-2025, Viva Republica<br>
      Licensed under the MIT License.

    <br>
    <a href="https://es-toolkit.slash.page/reference/object/mergeWith.html" class="_attribution-link">
      https://es-toolkit.slash.page/reference/object/mergeWith.html
    </a>
  </p>
</div>
