<h1>withTimeout</h1>

<p>Sets a time limit on an asynchronous function, throwing a <code>TimeoutError</code> if it doesn&#39;t complete within the specified time.</p>

<pre data-language='typescript'><code class='typescript'>await withTimeout(run, ms);
</code></pre>

<h2>Usage</h2>

<h4><code>withTimeout(run, ms)</code></h4>

<p>Use <code>withTimeout</code> when you want to set a timeout on an asynchronous task. If the Promise doesn&#39;t complete within the specified time, it&#39;s rejected with a <code>TimeoutError</code>, preventing indefinite waiting.</p>

<pre data-language='typescript'><code class='typescript'>import { withTimeout } from &#39;es-toolkit/promise&#39;;

async function fetchData() {
  const response = await fetch(&#39;https://api.example.com/data&#39;);
  return response.json();
}

try {
  // Must complete within 1 second
  const data = await withTimeout(fetchData, 1000);
  console.log(&#39;Received data:&#39;, data);
} catch (error) {
  if (error.name === &#39;TimeoutError&#39;) {
    console.log(&#39;Request timed out&#39;);
  }
}
</code></pre>

<p>You can also use it when you want to set a time limit on database queries.</p>

<pre data-language='typescript'><code class='typescript'>async function queryDatabase(query: string) {
  // Database query logic
  return await db.execute(query);
}

try {
  const result = await withTimeout(
    () =&gt; queryDatabase(&#39;SELECT * FROM users&#39;),
    5000 // 5 second limit
  );
  console.log(&#39;Query result:&#39;, result);
} catch (error) {
  console.log(&#39;Query took too long and was cancelled&#39;);
}
</code></pre>

<p>You can also use it when you want to receive only the fastest response among multiple API calls.</p>

<pre data-language='typescript'><code class='typescript'>async function getFastestResponse() {
  const apis = [() =&gt; fetch(&#39;/api/server1&#39;), () =&gt; fetch(&#39;/api/server2&#39;), () =&gt; fetch(&#39;/api/server3&#39;)];

  try {
    // Set a 2 second limit on each API and receive only the fastest response
    const promises = apis.map(api =&gt; withTimeout(api, 2000));
    const result = await Promise.race(promises);
    return result.json();
  } catch (error) {
    console.log(&#39;All APIs timed out&#39;);
  }
}
</code></pre>

<h4>Parameters</h4>

<ul>
<li><code>run</code> (<code>() =&gt; Promise&lt;T&gt;</code>): The asynchronous function to execute.</li>
<li><code>ms</code> (<code>number</code>): The amount of time in milliseconds until the timeout occurs.</li>
</ul>

<h4>Returns</h4>

<p>(<code>Promise&lt;T&gt;</code>): Returns the result of the given asynchronous function, or a Promise that&#39;s rejected with a TimeoutError if it times out.</p>

<h4>Errors</h4>

<p>Throws <code>TimeoutError</code> if not completed within the specified time.</p>
<div class="_attribution">
  <p class="_attribution-p">
          &copy; 2024-2025, Viva Republica<br>
      Licensed under the MIT License.

    <br>
    <a href="https://es-toolkit.slash.page/reference/promise/withTimeout.html" class="_attribution-link">
      https://es-toolkit.slash.page/reference/promise/withTimeout.html
    </a>
  </p>
</div>
