<h1>Filters</h1>  <p>This document describes the use of filters in Apache.</p>     <h2 id="intro">Filtering in Apache 2</h2> <table class="related">
<tr>
<th>Related Modules</th>
<th>Related Directives</th>
</tr>
<tr>
<td><ul>
<li><code class="module"><a href="mod/mod_filter">mod_filter</a></code></li>
<li><code class="module"><a href="mod/mod_deflate">mod_deflate</a></code></li>
<li><code class="module"><a href="mod/mod_ext_filter">mod_ext_filter</a></code></li>
<li><code class="module"><a href="mod/mod_include">mod_include</a></code></li>
<li><code class="module"><a href="mod/mod_charset_lite">mod_charset_lite</a></code></li>
<li><code class="module"><a href="mod/mod_reflector">mod_reflector</a></code></li>
<li><code class="module"><a href="mod/mod_buffer">mod_buffer</a></code></li>
<li><code class="module"><a href="mod/mod_data">mod_data</a></code></li>
<li><code class="module"><a href="mod/mod_ratelimit">mod_ratelimit</a></code></li>
<li><code class="module"><a href="mod/mod_reqtimeout">mod_reqtimeout</a></code></li>
<li><code class="module"><a href="mod/mod_request">mod_request</a></code></li>
<li><code class="module"><a href="mod/mod_sed">mod_sed</a></code></li>
<li><code class="module"><a href="mod/mod_substitute">mod_substitute</a></code></li>
<li><code class="module"><a href="mod/mod_xml2enc">mod_xml2enc</a></code></li>
<li><code class="module"><a href="mod/mod_proxy_html">mod_proxy_html</a></code></li>
</ul></td>
<td><ul>
<li><code class="directive"><a href="mod/mod_filter#filterchain">FilterChain</a></code></li>
<li><code class="directive"><a href="mod/mod_filter#filterdeclare">FilterDeclare</a></code></li>
<li><code class="directive"><a href="mod/mod_filter#filterprotocol">FilterProtocol</a></code></li>
<li><code class="directive"><a href="mod/mod_filter#filterprovider">FilterProvider</a></code></li>
<li><code class="directive"><a href="mod/mod_mime#addinputfilter">AddInputFilter</a></code></li>
<li><code class="directive"><a href="mod/mod_mime#addoutputfilter">AddOutputFilter</a></code></li>
<li><code class="directive"><a href="mod/mod_mime#removeinputfilter">RemoveInputFilter</a></code></li>
<li><code class="directive"><a href="mod/mod_mime#removeoutputfilter">RemoveOutputFilter</a></code></li>
<li><code class="directive"><a href="mod/mod_reflector#reflectorheader">ReflectorHeader</a></code></li>
<li><code class="directive"><a href="mod/mod_ext_filter#extfilterdefine">ExtFilterDefine</a></code></li>
<li><code class="directive"><a href="mod/mod_ext_filter#extfilteroptions">ExtFilterOptions</a></code></li>
<li><code class="directive"><a href="mod/core#setinputfilter">SetInputFilter</a></code></li>
<li><code class="directive"><a href="mod/core#setoutputfilter">SetOutputFilter</a></code></li>
</ul></td>
</tr>
</table> <p>The Filter Chain is available in Apache 2.0 and higher, and enables applications to process incoming and outgoing data in a highly flexible and configurable manner, regardless of where the data comes from. We can pre-process incoming data, and post-process outgoing data, at will. This is basically independent of the traditional request processing phases.</p> <p class="figure"> <img src="data:image/png;base64,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" width="569" height="392" alt="Filters can be chained, in a Data Axis orthogonal to request processing"> </p> <p>Some examples of filtering in the standard Apache distribution are:</p> <ul> <li>
<code class="module"><a href="mod/mod_include">mod_include</a></code>, implements server-side includes.</li> <li>
<code class="module"><a href="mod/mod_ssl">mod_ssl</a></code>, implements SSL encryption (https).</li> <li>
<code class="module"><a href="mod/mod_deflate">mod_deflate</a></code>, implements compression/decompression on the fly.</li> <li>
<code class="module"><a href="mod/mod_charset_lite">mod_charset_lite</a></code>, transcodes between different character sets.</li> <li>
<code class="module"><a href="mod/mod_ext_filter">mod_ext_filter</a></code>, runs an external program as a filter.</li> </ul> <p>Apache also uses a number of filters internally to perform functions like chunking and byte-range handling.</p> <p>A wider range of applications are implemented by third-party filter modules. A few of these are:</p> <ul> <li>HTML and XML processing and rewriting</li> <li>XSLT transforms and XIncludes</li> <li>XML Namespace support</li> <li>File Upload handling and decoding of HTML Forms</li> <li>Image processing</li> <li>Protection of vulnerable applications such as PHP scripts</li> <li>Text search-and-replace editing</li> </ul>   <h2 id="smart">Smart Filtering</h2> <p class="figure"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAacAAAFLAQMAAABIp9EiAAAABlBMVEX6+voAAAD6MT2PAAADrklEQVR42u3bz0obURQG8HMzQ3NbhJnYTRfFnIKgO9NdF5o4jVRXpY9Qig+QdQk6SaWmUGoeoNCCLzISoa8x+gTjLovQdFJixnBDJt+1phO9H+IfzI/LHCf3zD0gmZiYmJhMSTEgEYUlUOXiD8lEZKOKcJUPYlUrbxR9REmOleuVjkhDsY461FLbuJJ/1TZWQxF162X+5JOJyT8Kz1HVMq+6c1RM9zOceZX9mBqaGs4x+f4owHXZdB3x/xRlXj3MGjoBEZUEqCRTHFXxXajViyu7tlV82kCU01l+bLtV/upB15Vbli3X4xaocgNVaYmQhqn0r9Odpt65HksxOm3x6JOcrqqxogNEiYjrW8VYia6iZrmj8mGiaGZFRV9H0aGWoh5+XXGsSEeRE+goqoDXNUxPS1k/J6j+KOFENbkafvLb8U4EKCW3UwQr0Su9whX5JKWWWtdQNVlxvgSgily57r5hdC1XSndHRxXP6YZqdInoEXHqWvaYsilOqlpv46peXnOOxtX3Mn/Ln17WkPuw0f3gcVPuF1rIfdig114hJ1cLMl05/es0aHug1q4IWitWT+K1xHTFE9X+FCXsSapsO8enFykKuOcTRRqq/nbDOe6EmOrlXpbae6suuFbuBbf3bALVAfOPX50QVE3mNrELqs+xkvB1fWQ+AWsY0iBgd3CS+xDoRJFOh3VIR0U6fdkhDSUiHbWi82wjQh21QqgaLoVf1wopKv2cYoWqSj9xbKr7YbqyAlWln1M2SVHp5xQrUPf59HPKJnDiSM4pAalJP6cojSVVVTGVnFMye142M4eFquGNTmTmh2YG+2BrqHQHcBk5H8WZV5R59UBq2B8lBBQ4j8IVPo/iOc6jZObnUevujo4qnhOupGvrTLG05lF55whUw09zm2Kx/hQrUckUC519qVMsdUaU8SmWmUfNbx6F7/O4wjuR6cvm2Sbrim+r8BPHvUumz3oLElNDU8PpMTVclGS+hof9vgbyiWBW9ClOD0MipEGsAFIrw6+bkIqGX/M+gKzRi0NAPVe+w/4lIA9UMFC/TY9FSd7PrJYoyTNKj/rKJa27PTez2qYkYmblqz+kR4wvDKgmEe1CKjdUHrAR6Cp7oMobjmdd1ohcQP0WpfaZXWhhqim47dkFCapKrPJXBCovVrZAVZXbZ0MFVH6LT3Y7F+DfKwlr34f6Cn+n4O9K/R0A323udmfDd1F8x8a7A96J8K6Hd1i8m+NPDvhTCv5EhD99mZiYLEr+AO3CpdmIpoRgAAAAAElFTkSuQmCC" width="423" height="331" alt="Smart filtering applies different filter providers according to the state of request processing"> </p> <p><code class="module"><a href="mod/mod_filter">mod_filter</a></code>, included in Apache 2.1 and later, enables the filter chain to be configured dynamically at run time. So for example you can set up a proxy to rewrite HTML with an HTML filter and JPEG images with a completely separate filter, despite the proxy having no prior information about what the origin server will send. This works by using a filter harness, that dispatches to different providers according to the actual contents at runtime. Any filter may be either inserted directly in the chain and run unconditionally, or used as a provider and inserted dynamically. For example,</p> <ul> <li>an HTML processing filter will only run if the content is text/html or application/xhtml+xml</li> <li>A compression filter will only run if the input is a compressible type and not already compressed</li> <li>A charset conversion filter will be inserted if a text document is not already in the desired charset</li> </ul>   <h2 id="service">Exposing Filters as an HTTP Service</h2> <p>Filters can be used to process content originating from the client in addition to processing content originating on the server using the <code class="module"><a href="mod/mod_reflector">mod_reflector</a></code> module.</p> <p><code class="module"><a href="mod/mod_reflector">mod_reflector</a></code> accepts POST requests from clients, and reflects the content request body received within the POST request back in the response, passing through the output filter stack on the way back to the client.</p> <p>This technique can be used as an alternative to a web service running within an application server stack, where an output filter provides the transformation required on the request body. For example, the <code class="module"><a href="mod/mod_deflate">mod_deflate</a></code> module might be used to provide a general compression service, or an image transformation filter might be turned into an image transformation service.</p>   <h2 id="using">Using Filters</h2> <p>There are two ways to use filtering: Simple and Dynamic. In general, you should use one or the other; mixing them can have unexpected consequences (although simple Input filtering can be mixed freely with either simple or dynamic Output filtering).</p> <p>The Simple Way is the only way to configure input filters, and is sufficient for output filters where you need a static filter chain. Relevant directives are <code class="directive"><a href="mod/core#setinputfilter">SetInputFilter</a></code>, <code class="directive"><a href="mod/core#setoutputfilter">SetOutputFilter</a></code>, <code class="directive"><a href="mod/mod_mime#addinputfilter">AddInputFilter</a></code>, <code class="directive"><a href="mod/mod_mime#addoutputfilter">AddOutputFilter</a></code>, <code class="directive"><a href="mod/mod_mime#removeinputfilter">RemoveInputFilter</a></code>, and <code class="directive"><a href="mod/mod_mime#removeoutputfilter">RemoveOutputFilter</a></code>.</p> <p>The Dynamic Way enables both static and flexible, dynamic configuration of output filters, as discussed in the <code class="module"><a href="mod/mod_filter">mod_filter</a></code> page. Relevant directives are <code class="directive"><a href="mod/mod_filter#filterchain">FilterChain</a></code>, <code class="directive"><a href="mod/mod_filter#filterdeclare">FilterDeclare</a></code>, and <code class="directive"><a href="mod/mod_filter#filterprovider">FilterProvider</a></code>.</p> <p>One further directive <code class="directive"><a href="mod/mod_filter#addoutputfilterbytype">AddOutputFilterByType</a></code> is still supported, but deprecated. Use dynamic configuration instead.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2018 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://httpd.apache.org/docs/2.4/en/filter.html" class="_attribution-link">https://httpd.apache.org/docs/2.4/en/filter.html</a>
  </p>
</div>
