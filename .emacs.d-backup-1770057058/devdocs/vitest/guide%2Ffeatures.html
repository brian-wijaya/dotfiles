<h1 id="features" tabindex="-1">Features </h1>
<ul class="features-list !gap-1 text-lg" dir="auto" flex="~ col gap2 md:gap-3">
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>
<a target="_blank" href="https://vitejs.dev" rel="noopener noreferrer">Vite</a>'s config, transformers, resolvers, and plugins</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Use the same setup from your app to run the tests!</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Smart &amp; instant watch mode, like HMR for tests!</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Component testing for Vue, React, Svelte, Lit, Marko and more</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Out-of-the-box TypeScript / JSX support</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>ESM first, top level await</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Workers multi-threading via <a target="_blank" href="https://github.com/tinylibs/tinypool" rel="noopener noreferrer">Tinypool</a>
</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Benchmarking support with <a target="_blank" href="https://github.com/tinylibs/tinybench" rel="noopener noreferrer">Tinybench</a>
</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Filtering, timeouts, concurrent for suite and tests</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>
<a href="workspace">Workspace</a> support</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div><a href="snapshot"> Jest-compatible Snapshot </a></div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>
<a target="_blank" href="https://www.chaijs.com/" rel="noopener noreferrer">Chai</a> built-in for assertions + <a target="_blank" href="https://jestjs.io/docs/expect" rel="noopener noreferrer">Jest expect</a> compatible APIs</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>
<a target="_blank" href="https://github.com/tinylibs/tinyspy" rel="noopener noreferrer">Tinyspy</a> built-in for mocking</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>
<a target="_blank" href="https://github.com/capricorn86/happy-dom" rel="noopener noreferrer">happy-dom</a> or <a target="_blank" href="https://github.com/jsdom/jsdom" rel="noopener noreferrer">jsdom</a> for DOM mocking</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>
<a href="browser/index" rel="noopener noreferrer">Browser Mode</a> for running component tests in the browser</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Code coverage via <a target="_blank" href="https://v8.dev/blog/javascript-code-coverage" rel="noopener noreferrer">v8</a> or <a target="_blank" href="https://istanbul.js.org/" rel="noopener noreferrer">istanbul</a>
</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Rust-like <a href="in-source">in-source testing</a>
</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Type Testing via <a target="_blank" href="https://github.com/mmkal/expect-type" rel="noopener noreferrer">expect-type</a>
</div>
</li>
<li style="--vp-c-brand-1:rgba(250, 204, 21);">

<div>Sharding support</div>
</li>
</ul>

<a href="https://vueschool.io/lessons/your-first-test?friend=vueuse" target="_blank" bg-green:10 px4 py3 rounded block mt2 flex items-center gap2>Learn how to write your first test by Video</a><h2 id="shared-config-between-test-dev-and-build" tabindex="-1">Shared Config between Test, Dev and Build </h2>
<p>Vite's config, transformers, resolvers, and plugins. Use the same setup from your app to run the tests.</p>
<p>Learn more at <a href="index#configuring-vitest">Configuring Vitest</a>.</p>
<h2 id="watch-mode" tabindex="-1">Watch Mode </h2>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">$ vitest</pre>
</div>
<p>When you modify your source code or the test files, Vitest smartly searches the module graph and only reruns the related tests, just like how HMR works in Vite!</p>
<p><code>vitest</code> starts in <code>watch mode</code> <strong>by default in development environment</strong> and <code>run mode</code> in CI environment (when <code>process.env.CI</code> presents) smartly. You can use <code>vitest watch</code> or <code>vitest run</code> to explicitly specify the desired mode.</p>
<p>Start Vitest with the <code>--standalone</code> flag to keep it running in the background. It won't run any tests until they change. Vitest will not run tests if the source code is changed until the test that imports the source has been run</p>
<h2 id="common-web-idioms-out-of-the-box" tabindex="-1">Common Web Idioms Out-Of-The-Box </h2>
<p>Out-of-the-box ES Module / TypeScript / JSX support / PostCSS</p>
<h2 id="threads" tabindex="-1">Threads </h2>
<p>By default Vitest runs test files in multiple processes using <a href="https://nodejs.org/api/child_process.html" target="_blank" rel="noreferrer"><code>node:child_process</code></a> via <a href="https://github.com/tinylibs/tinypool" target="_blank" rel="noreferrer">Tinypool</a> (a lightweight fork of <a href="https://github.com/piscinajs/piscina" target="_blank" rel="noreferrer">Piscina</a>), allowing tests to run simultaneously. If you want to speed up your test suite even further, consider enabling <code>--pool=threads</code> to run tests using <a href="https://nodejs.org/api/worker_threads.html" target="_blank" rel="noreferrer"><code>node:worker_threads</code></a> (beware that some packages might not work with this setup).</p>
<p>To run tests in a single thread or process, see <a href="../config/index#pooloptions"><code>poolOptions</code></a>.</p>
<p>Vitest also isolates each file's environment so env mutations in one file don't affect others. Isolation can be disabled by passing <code>--no-isolate</code> to the CLI (trading correctness for run performance).</p>
<h2 id="test-filtering" tabindex="-1">Test Filtering </h2>
<p>Vitest provides many ways to narrow down the tests to run in order to speed up testing so you can focus on development.</p>
<p>Learn more about <a href="filtering">Test Filtering</a>.</p>
<h2 id="running-tests-concurrently" tabindex="-1">Running Tests Concurrently </h2>
<p>Use <code>.concurrent</code> in consecutive tests to start them in parallel.</p>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { describe, it } from 'vitest'

// The two tests marked with concurrent will be started in parallel
describe('suite', () =&gt; {
  it('serial test', async () =&gt; { /* ... */ })
  it.concurrent('concurrent test 1', async ({ expect }) =&gt; { /* ... */ })
  it.concurrent('concurrent test 2', async ({ expect }) =&gt; { /* ... */ })
})</pre>
</div>
<p>If you use <code>.concurrent</code> on a suite, every test in it will be started in parallel.</p>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { describe, it } from 'vitest'

// All tests within this suite will be started in parallel
describe.concurrent('suite', () =&gt; {
  it('concurrent test 1', async ({ expect }) =&gt; { /* ... */ })
  it('concurrent test 2', async ({ expect }) =&gt; { /* ... */ })
  it.concurrent('concurrent test 3', async ({ expect }) =&gt; { /* ... */ })
})</pre>
</div>
<p>You can also use <code>.skip</code>, <code>.only</code>, and <code>.todo</code> with concurrent suites and tests. Read more in the <a href="../api/index#test-concurrent">API Reference</a>.</p>
<div class="warning custom-block">
<strong class="custom-block-title">WARNING</strong><p>When running concurrent tests, Snapshots and Assertions must use <code>expect</code> from the local <a href="test-context">Test Context</a> to ensure the right test is detected.</p>
</div>
<h2 id="snapshot" tabindex="-1">Snapshot </h2>
<p><a href="https://jestjs.io/docs/snapshot-testing" target="_blank" rel="noreferrer">Jest-compatible</a> snapshot support.</p>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { expect, it } from 'vitest'

it('renders correctly', () =&gt; {
  const result = render()
  expect(result).toMatchSnapshot()
})</pre>
</div>
<p>Learn more at <a href="snapshot">Snapshot</a>.</p>
<h2 id="chai-and-jest-expect-compatibility" tabindex="-1">Chai and Jest <code>expect</code> Compatibility </h2>
<p><a href="https://www.chaijs.com/" target="_blank" rel="noreferrer">Chai</a> is built-in for assertions with <a href="https://jestjs.io/docs/expect" target="_blank" rel="noreferrer">Jest <code>expect</code></a>-compatible APIs.</p>
<p>Notice that if you are using third-party libraries that add matchers, setting <a href="../config/index#globals"><code>test.globals</code></a> to <code>true</code> will provide better compatibility.</p>
<h2 id="mocking" tabindex="-1">Mocking </h2>
<p><a href="https://github.com/tinylibs/tinyspy" target="_blank" rel="noreferrer">Tinyspy</a> is built-in for mocking with <code>jest</code>-compatible APIs on <code>vi</code> object.</p>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { expect, vi } from 'vitest'

const fn = vi.fn()

fn('hello', 1)

expect(vi.isMockFunction(fn)).toBe(true)
expect(fn.mock.calls[0]).toEqual(['hello', 1])

fn.mockImplementation((arg: string) =&gt; arg)

fn('world', 2)

expect(fn.mock.results[1].value).toBe('world')</pre>
</div>
<p>Vitest supports both <a href="https://github.com/capricorn86/happy-dom" target="_blank" rel="noreferrer">happy-dom</a> or <a href="https://github.com/jsdom/jsdom" target="_blank" rel="noreferrer">jsdom</a> for mocking DOM and browser APIs. They don't come with Vitest, you will need to install them separately:</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group-w9FxT" id="tab-iPWt_01" checked><label data-title="happy-dom" for="tab-iPWt_01">happy-dom</label><input type="radio" name="group-w9FxT" id="tab-wvPLwrP"><label data-title="jsdom" for="tab-wvPLwrP">jsdom</label>
</div>
<div class="blocks">
<div class="language-bash vp-adaptive-theme active">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">$ npm i -D happy-dom</pre>
</div>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">$ npm i -D jsdom</pre>
</div>
</div>
</div>
<p>After that, change the <code>environment</code> option in your config file:</p>
<div class="vp-code-block-title">
<div class="vp-code-block-title-bar"><span class="vp-code-block-title-text" data-title="vitest.config.ts">vitest.config.ts</span></div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    environment: 'happy-dom', // or 'jsdom', 'node'
  },
})</pre>
</div>
</div>
<p>Learn more at <a href="mocking">Mocking</a>.</p>
<h2 id="coverage" tabindex="-1">Coverage </h2>
<p>Vitest supports Native code coverage via <a href="https://v8.dev/blog/javascript-code-coverage" target="_blank" rel="noreferrer"><code>v8</code></a> and instrumented code coverage via <a href="https://istanbul.js.org/" target="_blank" rel="noreferrer"><code>istanbul</code></a>.</p>
<div class="vp-code-block-title">
<div class="vp-code-block-title-bar"><span class="vp-code-block-title-text" data-title="package.json">package.json</span></div>
<div class="language-json vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">{
  "scripts": {
    "test": "vitest",
    "coverage": "vitest run --coverage"
  }
}</pre>
</div>
</div>
<p>Learn more at <a href="coverage">Coverage</a>.</p>
<h2 id="in-source-testing" tabindex="-1">In-Source Testing </h2>
<p>Vitest also provides a way to run tests within your source code along with the implementation, similar to <a href="https://doc.rust-lang.org/book/ch11-03-test-organization.html#the-tests-module-and-cfgtest" target="_blank" rel="noreferrer">Rust's module tests</a>.</p>
<p>This makes the tests share the same closure as the implementations and able to test against private states without exporting. Meanwhile, it also brings the feedback loop closer for development.</p>
<div class="vp-code-block-title">
<div class="vp-code-block-title-bar"><span class="vp-code-block-title-text" data-title="src/index.ts">src/index.ts</span></div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">// the implementation
export function add(...args: number[]): number {
  return args.reduce((a, b) =&gt; a + b, 0)
}

// in-source test suites
if (import.meta.vitest) {
  const { it, expect } = import.meta.vitest
  it('add', () =&gt; {
    expect(add()).toBe(0)
    expect(add(1)).toBe(1)
    expect(add(1, 2, 3)).toBe(6)
  })
}</pre>
</div>
</div>
<p>Learn more at <a href="in-source">In-source testing</a>.</p>
<h2 id="benchmarking" tabindex="-1">Benchmarking <span class="VPBadge warning">Experimental</span> </h2>
<p>You can run benchmark tests with <a href="../api/index#bench"><code>bench</code></a> function via <a href="https://github.com/tinylibs/tinybench" target="_blank" rel="noreferrer">Tinybench</a> to compare performance results.</p>
<div class="vp-code-block-title">
<div class="vp-code-block-title-bar"><span class="vp-code-block-title-text" data-title="sort.bench.ts">sort.bench.ts</span></div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { bench, describe } from 'vitest'

describe('sort', () =&gt; {
  bench('normal', () =&gt; {
    const x = [1, 5, 4, 2, 3]
    x.sort((a, b) =&gt; {
      return a - b
    })
  })

  bench('reverse', () =&gt; {
    const x = [1, 5, 4, 2, 3]
    x.reverse().sort((a, b) =&gt; {
      return a - b
    })
  })
})</pre>
</div>
</div>
<img alt="Benchmark report" img-dark src="https://github.com/vitest-dev/vitest/assets/4232207/6f0383ea-38ba-4f14-8a05-ab243afea01d"><img alt="Benchmark report" img-light src="https://github.com/vitest-dev/vitest/assets/4232207/efbcb427-ecf1-4882-88de-210cd73415f6"><h2 id="type-testing" tabindex="-1">Type Testing <span class="VPBadge warning">Experimental</span> </h2>
<p>You can <a href="testing-types">write tests</a> to catch type regressions. Vitest comes with <a href="https://github.com/mmkal/expect-type" target="_blank" rel="noreferrer"><code>expect-type</code></a> package to provide you with a similar and easy to understand API.</p>
<div class="vp-code-block-title">
<div class="vp-code-block-title-bar"><span class="vp-code-block-title-text" data-title="types.test-d.ts">types.test-d.ts</span></div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { assertType, expectTypeOf, test } from 'vitest'
import { mount } from './mount.js'

test('my types work properly', () =&gt; {
  expectTypeOf(mount).toBeFunction()
  expectTypeOf(mount).parameter(0).toMatchTypeOf&lt;{ name: string }&gt;()

  // @ts-expect-error name is a string
  assertType(mount({ name: 42 }))
})</pre>
</div>
</div>
<h2 id="sharding" tabindex="-1">Sharding </h2>
<p>Run tests on different machines using <a href="cli#shard"><code>--shard</code></a> and <a href="reporters#blob-reporter"><code>--reporter=blob</code></a> flags. All test and coverage results can be merged at the end of your CI pipeline using <code>--merge-reports</code> command:</p>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">vitest --shard=1/2 --reporter=blob --coverage
vitest --shard=2/2 --reporter=blob --coverage
vitest --merge-reports --reporter=junit --coverage</pre>
</div>
<p>See <a href="improving-performance#sharding"><code>Improving Performance | Sharding</code></a> for more information.</p>
<h2 id="environment-variables" tabindex="-1">Environment Variables </h2>
<p>Vitest exclusively autoloads environment variables prefixed with <code>VITE_</code> from <code>.env</code> files to maintain compatibility with frontend-related tests, adhering to <a href="https://vitejs.dev/guide/env-and-mode.html#env-files" target="_blank" rel="noreferrer">Vite's established convention</a>. To load every environmental variable from <code>.env</code> files anyway, you can use <code>loadEnv</code> method imported from <code>vite</code>:</p>
<div class="vp-code-block-title">
<div class="vp-code-block-title-bar"><span class="vp-code-block-title-text" data-title="vitest.config.ts">vitest.config.ts</span></div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { loadEnv } from 'vite'
import { defineConfig } from 'vitest/config'

export default defineConfig(({ mode }) =&gt; ({
  test: {
    // mode defines what ".env.{mode}" file to choose if exists
    env: loadEnv(mode, process.cwd(), ''),
  },
}))</pre>
</div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021-Present Anthony Fu<br>&copy; 2021-Present Matias Capeletto<br>Licensed under the MIT License.<br>
    <a href="https://vitest.dev/guide/features" class="_attribution-link">https://vitest.dev/guide/features</a>
  </p>
</div>
