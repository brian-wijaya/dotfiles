<h1 id="getting-started" tabindex="-1">Getting Started </h1>
<div class="warning custom-block">
<strong class="custom-block-title">WARNING</strong><p>This guide lists advanced APIs to run tests via a Node.js script. If you just want to <a href="../guide/index">run tests</a>, you probably don't need this. It is primarily used by library authors.</p>
</div>
<p>You can import any method from the <code>vitest/node</code> entry-point.</p>
<h2 id="startvitest" tabindex="-1">startVitest </h2>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">function startVitest(
  mode: VitestRunMode,
  cliFilters: string[] = [],
  options: CliOptions = {},
  viteOverrides?: ViteUserConfig,
  vitestOptions?: VitestOptions,
): Promise&lt;Vitest&gt;</pre>
</div>
<p>You can start running Vitest tests using its Node API:</p>
<div class="language-js vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { startVitest } from 'vitest/node'

const vitest = await startVitest('test')

await vitest.close()</pre>
</div>
<p><code>startVitest</code> function returns <a href="api/vitest"><code>Vitest</code></a> instance if tests can be started.</p>
<p>If watch mode is not enabled, Vitest will call <code>close</code> method automatically.</p>
<p>If watch mode is enabled and the terminal supports TTY, Vitest will register console shortcuts.</p>
<p>You can pass down a list of filters as a second argument. Vitest will run only tests that contain at least one of the passed-down strings in their file path.</p>
<p>Additionally, you can use the third argument to pass in CLI arguments, which will override any test config options. Alternatively, you can pass in the complete Vite config as the fourth argument, which will take precedence over any other user-defined options.</p>
<p>After running the tests, you can get the results from the <a href="api/test-module"><code>state.getTestModules</code></a> API:</p>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import type { TestModule } from 'vitest/node'

const vitest = await startVitest('test')

console.log(vitest.state.getTestModules()) // [TestModule]</pre>
</div>
<div class="tip custom-block">
<strong class="custom-block-title">TIP</strong><p>The <a href="guide/tests#startvitest">"Running Tests"</a> guide has a usage example.</p>
</div>
<h2 id="createvitest" tabindex="-1">createVitest </h2>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">function createVitest(
  mode: VitestRunMode,
  options: UserConfig,
  viteOverrides: ViteUserConfig = {},
  vitestOptions: VitestOptions = {},
): Promise&lt;Vitest&gt;</pre>
</div>
<p>You can create Vitest instance by using <code>createVitest</code> function. It returns the same <a href="api/vitest"><code>Vitest</code></a> instance as <code>startVitest</code>, but it doesn't start tests and doesn't validate installed packages.</p>
<div class="language-js vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { createVitest } from 'vitest/node'

const vitest = await createVitest('test', {
  watch: false,
})</pre>
</div>
<div class="tip custom-block">
<strong class="custom-block-title">TIP</strong><p>The <a href="guide/tests#createvitest">"Running Tests"</a> guide has a usage example.</p>
</div>
<h2 id="resolveconfig" tabindex="-1">resolveConfig </h2>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">function resolveConfig(
  options: UserConfig = {},
  viteOverrides: ViteUserConfig = {},
): Promise&lt;{
  vitestConfig: ResolvedConfig
  viteConfig: ResolvedViteConfig
}&gt;</pre>
</div>
<p>This method resolves the config with custom parameters. If no parameters are given, the <code>root</code> will be <code>process.cwd()</code>.</p>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { resolveConfig } from 'vitest/node'

// vitestConfig only has resolved "test" properties
const { vitestConfig, viteConfig } = await resolveConfig({
  mode: 'custom',
  configFile: false,
  resolve: {
    conditions: ['custom']
  },
  test: {
    setupFiles: ['/my-setup-file.js'],
    pool: 'threads',
  },
})</pre>
</div>
<div class="info custom-block">
<strong class="custom-block-title">INFO</strong><p>Due to how Vite's <code>createServer</code> works, Vitest has to resolve the config during the plugin's <code>configResolve</code> hook. Therefore, this method is not actually used internally and is exposed exclusively as a public API.</p>
<p>If you pass down the config to the <code>startVitest</code> or <code>createVitest</code> APIs, Vitest will still resolve the config again.</p>
</div>
<div class="warning custom-block">
<strong class="custom-block-title">WARNING</strong><p>The <code>resolveConfig</code> doesn't resolve the <code>workspace</code>. To resolve workspace configs, Vitest needs an established Vite server.</p>
<p>Also note that <code>viteConfig.test</code> will not be fully resolved. If you need Vitest config, use <code>vitestConfig</code> instead.</p>
</div>
<h2 id="parsecli" tabindex="-1">parseCLI </h2>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">function parseCLI(argv: string | string[], config: CliParseOptions = {}): {
  filter: string[]
  options: CliOptions
}</pre>
</div>
<p>You can use this method to parse CLI arguments. It accepts a string (where arguments are split by a single space) or a strings array of CLI arguments in the same format that Vitest CLI uses. It returns a filter and <code>options</code> that you can later pass down to <code>createVitest</code> or <code>startVitest</code> methods.</p>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { parseCLI } from 'vitest/node'

const result = parseCLI('vitest ./files.ts --coverage --browser=chrome')

result.options
// {
//   coverage: { enabled: true },
//   browser: { name: 'chrome', enabled: true }
// }

result.filter
// ['./files.ts']</pre>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021-Present Anthony Fu<br>&copy; 2021-Present Matias Capeletto<br>Licensed under the MIT License.<br>
    <a href="https://vitest.dev/advanced/api.html" class="_attribution-link">https://vitest.dev/advanced/api.html</a>
  </p>
</div>
