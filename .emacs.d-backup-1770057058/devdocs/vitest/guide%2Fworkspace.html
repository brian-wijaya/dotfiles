<h1 id="workspace" tabindex="-1">Workspace </h1>
<div class="tip custom-block">
<strong class="custom-block-title">Sample Project</strong><p><a href="https://github.com/vitest-dev/vitest/tree/main/examples/workspace" target="_blank" rel="noreferrer">GitHub</a> - <a href="https://stackblitz.com/fork/github/vitest-dev/vitest/tree/main/examples/workspace?initialPath=__vitest__/" target="_blank" rel="noreferrer">Play Online</a></p>
</div>
<p>Vitest provides a way to define multiple project configurations within a single Vitest process. This feature is particularly useful for monorepo setups but can also be used to run tests with different configurations, such as <code>resolve.alias</code>, <code>plugins</code>, or <code>test.browser</code> and more.</p>
<h2 id="defining-a-workspace" tabindex="-1">Defining a Workspace </h2>
<p>A workspace must include a <code>vitest.workspace</code> or <code>vitest.projects</code> file in its root directory (located in the same folder as your root configuration file or working directory if it doesn't exist). Note that <code>projects</code> is just an alias and does not change the behavior or semantics of this feature. Vitest supports <code>ts</code>, <code>js</code>, and <code>json</code> extensions for this file.</p>
<p>Since Vitest 3, you can also define a workspace in the root config. In this case, Vitest will ignore the <code>vitest.workspace</code> file in the root, if one exists.</p>
<div class="tip custom-block">
<strong class="custom-block-title">NAMING</strong><p>Please note that this feature is named <code>workspace</code>, not <code>workspaces</code> (without an "s" at the end).</p>
</div>
<p>A workspace is a list of inlined configs, files, or glob patterns referencing your projects. For example, if you have a folder named <code>packages</code> that contains your projects, you can either create a workspace file or define an array in the root config:</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group-YbCVa" id="tab-a9EmZDv" checked><label data-title="vitest.workspace.ts" for="tab-a9EmZDv">vitest.workspace.ts</label><input type="radio" name="group-YbCVa" id="tab-hbOC1fO"><label data-title="vitest.config.ts &lt;Version&gt;3.0.0&lt;/Version&gt;" for="tab-hbOC1fO">vitest.config.ts <span class="VPBadge info">3.0.0+ </span></label>
</div>
<div class="blocks">
<div class="language-ts vp-adaptive-theme active">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">export default [
  'packages/*'
]</pre>
</div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    workspace: ['packages/*'],
  },
})</pre>
</div>
</div>
</div>
<p>Vitest will treat every folder in <code>packages</code> as a separate project even if it doesn't have a config file inside. If this glob pattern matches any file it will be considered a Vitest config even if it doesn't have a <code>vitest</code> in its name.</p>
<div class="warning custom-block">
<strong class="custom-block-title">WARNING</strong><p>Vitest does not treat the root <code>vitest.config</code> file as a workspace project unless it is explicitly specified in the workspace configuration. Consequently, the root configuration will only influence global options such as <code>reporters</code> and <code>coverage</code>. Note that Vitest will always run certain plugin hooks, like <code>apply</code>, <code>config</code>, <code>configResolved</code> or <code>configureServer</code>, specified in the root config file. Vitest also uses the same plugins to execute global setups, workspace files and custom coverage provider.</p>
</div>
<p>You can also reference projects with their config files:</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group-FQ77C" id="tab-7BLNhUG" checked><label data-title="vitest.workspace.ts" for="tab-7BLNhUG">vitest.workspace.ts</label><input type="radio" name="group-FQ77C" id="tab-Lfl2JRL"><label data-title="vitest.config.ts &lt;Version&gt;3.0.0&lt;/Version&gt;" for="tab-Lfl2JRL">vitest.config.ts <span class="VPBadge info">3.0.0+ </span></label>
</div>
<div class="blocks">
<div class="language-ts vp-adaptive-theme active">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">export default [
  'packages/*/vitest.config.{e2e,unit}.ts'
]</pre>
</div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    workspace: ['packages/*/vitest.config.{e2e,unit}.ts'],
  },
})</pre>
</div>
</div>
</div>
<p>This pattern will only include projects with a <code>vitest.config</code> file that contains <code>e2e</code> or <code>unit</code> before the extension.</p>
<p>You can also define projects using inline configuration. The workspace file supports both syntaxes simultaneously.</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group-jDcxk" id="tab-evSgQ4T" checked><label data-title="vitest.workspace.ts" for="tab-evSgQ4T">vitest.workspace.ts</label><input type="radio" name="group-jDcxk" id="tab-qo6KhDi"><label data-title="vitest.config.ts &lt;Version&gt;3.0.0&lt;/Version&gt;" for="tab-qo6KhDi">vitest.config.ts <span class="VPBadge info">3.0.0+ </span></label>
</div>
<div class="blocks">
<div class="language-ts vp-adaptive-theme active">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { defineWorkspace } from 'vitest/config'

// defineWorkspace provides a nice type hinting DX
export default defineWorkspace([
  // matches every folder and file inside the `packages` folder
  'packages/*',
  {
    // add "extends" to merge two configs together
    extends: './vite.config.js',
    test: {
      include: ['tests/**/*.{browser}.test.{ts,js}'],
      // it is recommended to define a name when using inline configs
      name: 'happy-dom',
      environment: 'happy-dom',
    }
  },
  {
    test: {
      include: ['tests/**/*.{node}.test.{ts,js}'],
      name: 'node',
      environment: 'node',
    }
  }
])</pre>
</div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    workspace: [
      // matches every folder and file inside the `packages` folder
      'packages/*',
      {
        // add "extends: true" to inherit the options from the root config
        extends: true,
        test: {
          include: ['tests/**/*.{browser}.test.{ts,js}'],
          // it is recommended to define a name when using inline configs
          name: 'happy-dom',
          environment: 'happy-dom',
        }
      },
      {
        test: {
          include: ['tests/**/*.{node}.test.{ts,js}'],
          name: 'node',
          environment: 'node',
        }
      }
    ]
  }
})</pre>
</div>
</div>
</div>
<div class="warning custom-block">
<strong class="custom-block-title">WARNING</strong><p>All projects must have unique names; otherwise, Vitest will throw an error. If a name is not provided in the inline configuration, Vitest will assign a number. For project configurations defined with glob syntax, Vitest will default to using the "name" property in the nearest <code>package.json</code> file or, if none exists, the folder name.</p>
</div>
<p>If you do not use inline configurations, you can create a small JSON file in your root directory or just specify it in the root config:</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group-LBPDi" id="tab-x2F7tfh" checked><label data-title="vitest.workspace.json" for="tab-x2F7tfh">vitest.workspace.json</label><input type="radio" name="group-LBPDi" id="tab-PvH_Wh1"><label data-title="vitest.config.ts &lt;Version&gt;3.0.0&lt;/Version&gt;" for="tab-PvH_Wh1">vitest.config.ts <span class="VPBadge info">3.0.0+ </span></label>
</div>
<div class="blocks">
<div class="language-json vp-adaptive-theme active">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">[
  "packages/*"
]</pre>
</div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    workspace: ['packages/*'],
  },
})</pre>
</div>
</div>
</div>
<p>Workspace projects do not support all configuration properties. For better type safety, use the <code>defineProject</code> method instead of <code>defineConfig</code> within project configuration files:</p>
<div class="vp-code-block-title">
<div class="vp-code-block-title-bar"><span class="vp-code-block-title-text" data-title="packages/a/vitest.config.ts">packages/a/vitest.config.ts</span></div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code twoslash lsp" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import {  } from 'vitest/config'

export default ({
  : {
    : 'jsdom',
    // "reporters" is not supported in a project config,
    // so it will show an error
    reporters: ['json']No overload matches this call.
  The last overload gave the following error.
    Object literal may only specify known properties, and 'reporters' does not exist in type 'ProjectConfig'.  }
})</pre>
</div>
</div>
<h2 id="running-tests" tabindex="-1">Running tests </h2>
<p>To run tests inside the workspace, define a script in your root <code>package.json</code>:</p>
<div class="vp-code-block-title">
<div class="vp-code-block-title-bar"><span class="vp-code-block-title-text" data-title="package.json">package.json</span></div>
<div class="language-json vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">{
  "scripts": {
    "test": "vitest"
  }
}</pre>
</div>
</div>
<p>Now tests can be run using your package manager:</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group-oohub" id="tab-o5SGWMe" checked><label data-title="npm" for="tab-o5SGWMe">npm</label><input type="radio" name="group-oohub" id="tab-O8FMMHv"><label data-title="yarn" for="tab-O8FMMHv">yarn</label><input type="radio" name="group-oohub" id="tab-1fKs3Xd"><label data-title="pnpm" for="tab-1fKs3Xd">pnpm</label><input type="radio" name="group-oohub" id="tab-PYqQ8Na"><label data-title="bun" for="tab-PYqQ8Na">bun</label>
</div>
<div class="blocks">
<div class="language-bash vp-adaptive-theme active">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">npm run test</pre>
</div>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">yarn test</pre>
</div>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">pnpm run test</pre>
</div>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">bun test</pre>
</div>
</div>
</div>
<p>If you need to run tests only inside a single project, use the <code>--project</code> CLI option:</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group-S2EIb" id="tab-NYfJTmv" checked><label data-title="npm" for="tab-NYfJTmv">npm</label><input type="radio" name="group-S2EIb" id="tab-1yoBWnp"><label data-title="yarn" for="tab-1yoBWnp">yarn</label><input type="radio" name="group-S2EIb" id="tab-hjgJVjd"><label data-title="pnpm" for="tab-hjgJVjd">pnpm</label><input type="radio" name="group-S2EIb" id="tab-ROdf7kA"><label data-title="bun" for="tab-ROdf7kA">bun</label>
</div>
<div class="blocks">
<div class="language-bash vp-adaptive-theme active">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">npm run test --project e2e</pre>
</div>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">yarn test --project e2e</pre>
</div>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">pnpm run test --project e2e</pre>
</div>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">bun test --project e2e</pre>
</div>
</div>
</div>
<div class="tip custom-block">
<strong class="custom-block-title">TIP</strong><p>CLI option <code>--project</code> can be used multiple times to filter out several projects:</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group-dlwlr" id="tab-WsHFnFz" checked><label data-title="npm" for="tab-WsHFnFz">npm</label><input type="radio" name="group-dlwlr" id="tab-8SkyB-6"><label data-title="yarn" for="tab-8SkyB-6">yarn</label><input type="radio" name="group-dlwlr" id="tab-aJT1_xf"><label data-title="pnpm" for="tab-aJT1_xf">pnpm</label><input type="radio" name="group-dlwlr" id="tab-NXl1wdS"><label data-title="bun" for="tab-NXl1wdS">bun</label>
</div>
<div class="blocks">
<div class="language-bash vp-adaptive-theme active">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">npm run test --project e2e --project unit</pre>
</div>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">yarn test --project e2e --project unit</pre>
</div>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">pnpm run test --project e2e --project unit</pre>
</div>
<div class="language-bash vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">bun test --project e2e --project unit</pre>
</div>
</div>
</div>
</div>
<h2 id="configuration" tabindex="-1">Configuration </h2>
<p>None of the configuration options are inherited from the root-level config file, even if the workspace is defined inside that config and not in a separate <code>vitest.workspace</code> file. You can create a shared config file and merge it with the project config yourself:</p>
<div class="vp-code-block-title">
<div class="vp-code-block-title-bar"><span class="vp-code-block-title-text" data-title="packages/a/vitest.config.ts">packages/a/vitest.config.ts</span></div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { defineProject, mergeConfig } from 'vitest/config'
import configShared from '../vitest.shared.js'

export default mergeConfig(
  configShared,
  defineProject({
    test: {
      environment: 'jsdom',
    }
  })
)</pre>
</div>
</div>
<p>Additionally, at the <code>defineWorkspace</code> level, you can use the <code>extends</code> option to inherit from your root-level configuration. All options will be merged.</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group-XR6Uz" id="tab-pr1wVyT" checked><label data-title="vitest.workspace.ts" for="tab-pr1wVyT">vitest.workspace.ts</label><input type="radio" name="group-XR6Uz" id="tab-prLyuGW"><label data-title="vitest.config.ts &lt;Version&gt;3.0.0&lt;/Version&gt;" for="tab-prLyuGW">vitest.config.ts <span class="VPBadge info">3.0.0+ </span></label>
</div>
<div class="blocks">
<div class="language-ts vp-adaptive-theme active">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { defineWorkspace } from 'vitest/config'

export default defineWorkspace([
  {
    extends: './vitest.config.ts',
    test: {
      name: 'unit',
      include: ['**/*.unit.test.ts'],
    },
  },
  {
    extends: './vitest.config.ts',
    test: {
      name: 'integration',
      include: ['**/*.integration.test.ts'],
    },
  },
])</pre>
</div>
<div class="language-ts vp-adaptive-theme">
<pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="javascript">import { defineConfig } from 'vitest/config'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  test: {
    pool: 'threads',
    workspace: [
      {
        // will inherit options from this config like plugins and pool
        extends: true,
        test: {
          name: 'unit',
          include: ['**/*.unit.test.ts'],
        },
      },
      {
        // won't inherit any options from this config
        // this is the default behaviour
        extends: false,
        test: {
          name: 'integration',
          include: ['**/*.integration.test.ts'],
        },
      },
    ],
  },
})</pre>
</div>
</div>
</div>
<p>Some of the configuration options are not allowed in a project config. Most notably:</p>
<ul>
<li>
<code>coverage</code>: coverage is done for the whole workspace</li>
<li>
<code>reporters</code>: only root-level reporters can be supported</li>
<li>
<code>resolveSnapshotPath</code>: only root-level resolver is respected</li>
<li>all other options that don't affect test runners</li>
</ul>
<div class="tip custom-block">
<strong class="custom-block-title">TIP</strong><p>All configuration options that are not supported inside a project configuration are marked with a <span text-sm text-orange cursor-not-allowed title="Not supported in workspace project config"> * </span> sign in the <a href="../config/index">"Config"</a> guide.</p>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021-Present Anthony Fu<br>&copy; 2021-Present Matias Capeletto<br>Licensed under the MIT License.<br>
    <a href="https://vitest.dev/guide/workspace" class="_attribution-link">https://vitest.dev/guide/workspace</a>
  </p>
</div>
