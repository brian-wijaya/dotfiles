<h1 id="header">Use Gel with Bun</h1>
<div data-page-title="Use Gel with Bun" data-page-href="/guides/ecosystem/gel" id="content">
<span data-as="p">Gel (formerly EdgeDB) is a graph-relational database powered by Postgres under the hood. It provides a declarative schema language, migrations system, and object-oriented query language, in addition to supporting raw SQL queries. It solves the object-relational mapping problem at the database layer, eliminating the need for an ORM library in your application code.</span> <hr> <span data-as="p">First, <a href="https://docs.geldata.com/learn/installation" target="_blank" rel="noreferrer">install Gel</a> if you havenâ€™t already.</span> <pre dir="ltr" data-orientation="horizontal" data-language="typescript">Linux/macOS terminalWindows terminalHomebrew terminalcurl https://www.geldata.com/sh --proto "=https" -sSf1 | sh
</pre> <hr> <span data-as="p">Use <code>bun init</code> to create a fresh project.</span> <pre numberoflines="3" language="shellscript" data-language="typescript">mkdir my-edgedb-app
cd my-edgedb-app
bun init -y
</pre> <hr> <span data-as="p">Weâ€™ll use the Gel CLI to initialize a Gel instance for our project. This creates a <code>gel.toml</code> file in our project root.</span> <pre numberoflines="1" language="shellscript" data-language="typescript">gel project init
</pre> <pre numberoflines="23" language="text" data-language="typescript">No `gel.toml` found in `/Users/colinmcd94/Documents/bun/fun/examples/my-gel-app` or above
Do you want to initialize a new project? [Y/n]
&gt; Y
Specify the name of Gel instance to use with this project [default: my_gel_app]:
&gt; my_gel_app
Checking Gel versions...
Specify the version of Gel to use with this project [default: x.y]:
&gt; x.y
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Project directory   â”‚ /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app         â”‚
â”‚ Project config      â”‚ /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app/gel.tomlâ”‚
â”‚ Schema dir (empty)  â”‚ /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app/dbschemaâ”‚
â”‚ Installation method â”‚ portable package                                                 â”‚
â”‚ Version             â”‚ x.y+6d5921b                                                      â”‚
â”‚ Instance name       â”‚ my_gel_app                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Version x.y+6d5921b is already downloaded
Initializing Gel instance...
Applying migrations...
Everything is up to date. Revision initial
Project initialized.
To connect to my_gel_app, run `gel`
</pre> <hr> <span data-as="p">To see if the database is running, letâ€™s open a REPL and run a simple query.</span> <pre numberoflines="2" language="shellscript" data-language="typescript">gel
gel&gt; select 1 + 1;
</pre> <pre numberoflines="2" language="text" data-language="typescript">2
</pre> <span data-as="p">Then run <code>\quit</code> to exit the REPL.</span> <pre numberoflines="1" language="shellscript" data-language="typescript">gel&gt; \quit
</pre> <hr> <span data-as="p">With the project initialized, we can define a schema. The <code>gel project init</code> command already created a <code>dbschema/default.esdl</code> file to contain our schema.</span> <pre numberoflines="4" language="text" data-language="typescript">dbschema
â”œâ”€â”€ default.esdl
â””â”€â”€ migrations
</pre> <hr> <span data-as="p">Open that file and paste the following contents.</span> <pre numberoflines="6" language="typescript" data-language="typescript">module default {
  type Movie {
    required title: str;
    releaseYear: int64;
  }
};
</pre> <hr> <span data-as="p">Then generate and apply an initial migration.</span> <pre numberoflines="1" language="shellscript" data-language="typescript">gel migration create
</pre> <pre numberoflines="2" language="text" data-language="typescript">Created /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app/dbschema/migrations/00001.edgeql, id: m1uwekrn4ni4qs7ul7hfar4xemm5kkxlpswolcoyqj3xdhweomwjrq
</pre> <pre numberoflines="1" language="shellscript" data-language="typescript">gel migrate
</pre> <pre numberoflines="2" language="text" data-language="typescript">Applied m1uwekrn4ni4qs7ul7hfar4xemm5kkxlpswolcoyqj3xdhweomwjrq (00001.edgeql)
</pre> <hr> <span data-as="p">With our schema applied, letâ€™s execute some queries using Gelâ€™s JavaScript client library. Weâ€™ll install the client library and Gelâ€™s codegen CLI, and create a <code>seed.ts</code>.file.</span> <pre numberoflines="3" language="shellscript" data-language="typescript">bun add gel
bun add -D @gel/generate
touch seed.ts
</pre> <hr> <span data-as="p">Paste the following code into <code>seed.ts</code>.</span> <span data-as="p">The client auto-connects to the database. We insert a couple movies using the <code>.execute()</code> method. We will use EdgeQLâ€™s <code>for</code> expression to turn this bulk insert into a single optimized query.</span> <pre numberoflines="24" language="typescript" data-language="typescript">import { createClient } from "gel";

const client = createClient();

const INSERT_MOVIE = `
  with movies := &lt;array&lt;tuple&lt;title: str, year: int64&gt;&gt;&gt;$movies
  for movie in array_unpack(movies) union (
    insert Movie {
      title := movie.title,
      releaseYear := movie.year,
    }
  )
`;

const movies = [
  { title: "The Matrix", year: 1999 },
  { title: "The Matrix Reloaded", year: 2003 },
  { title: "The Matrix Revolutions", year: 2003 },
];

await client.execute(INSERT_MOVIE, { movies });

console.log(`Seeding complete.`);
process.exit();
</pre> <hr> <span data-as="p">Then run this file with Bun.</span> <pre numberoflines="1" language="shellscript" data-language="typescript">bun run seed.ts
</pre> <pre numberoflines="2" language="text" data-language="typescript">Seeding complete.
</pre> <hr> <span data-as="p">Gel implements a number of code generation tools for TypeScript. To query our newly seeded database in a typesafe way, weâ€™ll use <code>@gel/generate</code> to code-generate the EdgeQL query builder.</span> <pre numberoflines="1" language="shellscript" data-language="typescript">bunx @gel/generate edgeql-js
</pre> <pre numberoflines="16" language="text" data-language="typescript">Generating query builder...
Detected tsconfig.json, generating TypeScript files.
   To override this, use the --target flag.
   Run `npx @edgedb/generate --help` for full options.
Introspecting database schema...
Writing files to ./dbschema/edgeql-js
Generation complete! ğŸ¤˜
Checking the generated query builder into version control
is not recommended. Would you like to update .gitignore to ignore
the query builder directory? The following line will be added:

   dbschema/edgeql-js

[y/n] (leave blank for "y")
&gt; y
</pre> <hr> <span data-as="p">In <code>index.ts</code>, we can import the generated query builder from <code>./dbschema/edgeql-js</code> and write a simple select query.</span> <pre numberoflines="14" language="typescript" data-language="typescript">import { createClient } from "gel";
import e from "./dbschema/edgeql-js";

const client = createClient();

const query = e.select(e.Movie, () =&gt; ({
  title: true,
  releaseYear: true,
}));

const results = await query.run(client);
console.log(results);

results; // { title: string, releaseYear: number | null }[]
</pre> <hr> <span data-as="p">Running the file with Bun, we can see the list of movies we inserted.</span> <pre numberoflines="1" language="shellscript" data-language="typescript">bun run index.ts
</pre> <pre numberoflines="13" language="text" data-language="typescript">[
  {
    title: "The Matrix",
    releaseYear: 1999
  }, {
    title: "The Matrix Reloaded",
    releaseYear: 2003
  }, {
    title: "The Matrix Revolutions",
    releaseYear: 2003
  }
]
</pre> <hr> <span data-as="p">For complete documentation, refer to the <a href="https://docs.geldata.com/" target="_blank" rel="noreferrer">Gel docs</a>.</span>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; bun.com, oven-sh, Jarred Sumner<br>Licensed under the MIT License.<br>
    <a href="https://bun.com/docs/guides/ecosystem/gel" class="_attribution-link">https://bun.com/docs/guides/ecosystem/gel</a>
  </p>
</div>
