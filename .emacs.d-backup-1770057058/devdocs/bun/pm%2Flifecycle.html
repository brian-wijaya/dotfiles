<h1 id="header">Lifecycle scripts</h1>
<div data-page-title="Lifecycle scripts" data-page-href="/pm/lifecycle" id="content">
<span data-as="p">Packages on <code>npm</code> can define <em>lifecycle scripts</em> in their <code>package.json</code>. Some of the most common are below, but there are <a href="https://docs.npmjs.com/cli/v10/using-npm/scripts" target="_blank" rel="noreferrer">many others</a>.</span> <ul> <li>
<code>preinstall</code>: Runs before the package is installed</li> <li>
<code>postinstall</code>: Runs after the package is installed</li> <li>
<code>preuninstall</code>: Runs before the package is uninstalled</li> <li>
<code>prepublishOnly</code>: Runs before the package is published</li> </ul> <span data-as="p">These scripts are arbitrary shell commands that the package manager is expected to read and execute at the appropriate time. But executing arbitrary scripts represents a potential security risk, so—unlike other <code>npm</code> clients—Bun does not execute arbitrary lifecycle scripts by default.</span> <hr> <h2 id="postinstall"><span><code>postinstall</code></span></h2> <span data-as="p">The <code>postinstall</code> script is particularly important. It’s widely used to build or install platform-specific binaries for packages that are implemented as <a href="https://nodejs.org/api/addons.html" target="_blank" rel="noreferrer">native Node.js add-ons</a>. For example, <code>node-sass</code> is a popular package that uses <code>postinstall</code> to build a native binary for Sass.</span> <pre numberoflines="7" language="json" data-language="typescript">{
  "name": "my-app",
  "version": "1.0.0",
  "dependencies": {
    "node-sass": "^6.0.1"
  }
}
</pre> <hr> <h2 id="trusteddependencies"><span><code>trustedDependencies</code></span></h2> <span data-as="p">Instead of executing arbitrary scripts, Bun uses a “default-secure” approach. You can add certain packages to an allow list, and Bun will execute lifecycle scripts for those packages. To tell Bun to allow lifecycle scripts for a particular package, add the package name to <code>trustedDependencies</code> array in your <code>package.json</code>.</span> <pre numberoflines="5" language="json" data-language="typescript">{
  "name": "my-app",
  "version": "1.0.0",
  "trustedDependencies": ["node-sass"] 
}
</pre> <span data-as="p">Once added to <code>trustedDependencies</code>, install/re-install the package. Bun will read this field and run lifecycle scripts for <code>my-trusted-package</code>.</span> <span data-as="p">The top 500 npm packages with lifecycle scripts are allowed by default. You can see the full list <a href="https://github.com/oven-sh/bun/blob/main/src/install/default-trusted-dependencies.txt" target="_blank" rel="noreferrer">here</a>.</span> <div data-callout-type="note">

<div data-component-part="callout-content"><span data-as="p">The default trusted dependencies list only applies to packages installed from npm. For packages from other sources (such as <code>file:</code>, <code>link:</code>, <code>git:</code>, or <code>github:</code> dependencies), you must explicitly add them to <code>trustedDependencies</code> to run their lifecycle scripts, even if the package name matches an entry in the default list. This prevents malicious packages from spoofing trusted package names through local file paths or git repositories.</span></div>
</div> <hr> <h2 id="ignore-scripts"><span><code>--ignore-scripts</code></span></h2> <span data-as="p">To disable lifecycle scripts for all packages, use the <code>--ignore-scripts</code> flag.</span> <pre numberoflines="1" language="shellscript" data-language="typescript">bun install --ignore-scripts
</pre>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; bun.com, oven-sh, Jarred Sumner<br>Licensed under the MIT License.<br>
    <a href="https://bun.com/docs/pm/lifecycle" class="_attribution-link">https://bun.com/docs/pm/lifecycle</a>
  </p>
</div>
