<h1 id="header">Build a simple WebSocket server</h1>
<div data-page-title="Build a simple WebSocket server" data-page-href="/guides/websocket/simple" id="content">
<span data-as="p">Start a simple WebSocket server using <a href="../../runtime/http/server"><code>Bun.serve</code></a>.</span> <span data-as="p">Inside <code>fetch</code>, we attempt to upgrade incoming <code>ws:</code> or <code>wss:</code> requests to WebSocket connections.</span> <pre numberoflines="26" language="typescript" data-language="typescript">const server = Bun.serve({
  fetch(req, server) {
    const success = server.upgrade(req);
    if (success) {
      // Bun automatically returns a 101 Switching Protocols
      // if the upgrade succeeds
      return undefined;
    }

    // handle HTTP request normally
    return new Response("Hello world!");
  },
  websocket: {
    // TypeScript: specify the type of ws.data like this
    data: {} as { authToken: string },

    // this is called when a message is received
    async message(ws, message) {
      console.log(`Received ${message}`);
      // send back a message
      ws.send(`You said: ${message}`);
    },
  },
});

console.log(`Listening on ${server.hostname}:${server.port}`);
</pre>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; bun.com, oven-sh, Jarred Sumner<br>Licensed under the MIT License.<br>
    <a href="https://bun.com/docs/guides/websocket/simple" class="_attribution-link">https://bun.com/docs/guides/websocket/simple</a>
  </p>
</div>
