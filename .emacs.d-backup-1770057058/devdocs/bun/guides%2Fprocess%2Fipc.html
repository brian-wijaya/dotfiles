<h1 id="header">Spawn a child process and communicate using IPC</h1>
<div data-page-title="Spawn a child process and communicate using IPC" data-page-href="/guides/process/ipc" id="content">
<span data-as="p">Use <a href="../../runtime/child-process"><code>Bun.spawn()</code></a> to spawn a child process. When spawning a second <code>bun</code> process, you can open a direct inter-process communication (IPC) channel between the two processes.</span> <div data-callout-type="note">

<div data-component-part="callout-content"><span data-as="p">This API is only compatible with other <code>bun</code> processes. Use <code>process.execPath</code> to get a path to the currently running <code>bun</code> executable.</span></div>
</div> <pre numberoflines="7" language="typescript" data-language="typescript">const child = Bun.spawn(["bun", "child.ts"], {
  ipc(message) {
    /**
     * The message received from the sub process
     **/
  },
});
</pre> <hr> <span data-as="p">The parent process can send messages to the subprocess using the <code>.send()</code> method on the returned <code>Subprocess</code> instance. A reference to the sending subprocess is also available as the second argument in the <code>ipc</code> handler.</span> <pre numberoflines="10" language="typescript" data-language="typescript">const childProc = Bun.spawn(["bun", "child.ts"], {
  ipc(message, childProc) {
    /**
     * The message received from the sub process
     **/
    childProc.send("Respond to child");
  },
});

childProc.send("I am your father"); // The parent can send messages to the child as well
</pre> <hr> <span data-as="p">Meanwhile the child process can send messages to its parent using with <code>process.send()</code> and receive messages with <code>process.on("message")</code>. This is the same API used for <code>child_process.fork()</code> in Node.js.</span> <pre numberoflines="7" language="typescript" data-language="typescript">process.send("Hello from child as string");
process.send({ message: "Hello from child as object" });

process.on("message", message =&gt; {
  // print message from parent
  console.log(message);
});
</pre> <hr> <span data-as="p">All messages are serialized using the JSC <code>serialize</code> API, which allows for the same set of <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Transferable_objects" target="_blank" rel="noreferrer">transferrable types</a> supported by <code>postMessage</code> and <code>structuredClone</code>, including strings, typed arrays, streams, and objects.</span> <pre numberoflines="5" language="typescript" data-language="typescript">// send a string
process.send("Hello from child as string");

// send an object
process.send({ message: "Hello from child as object" });
</pre> <hr> <span data-as="p">See <a href="../../runtime/child-process">Docs &gt; API &gt; Child processes</a> for complete documentation.</span>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; bun.com, oven-sh, Jarred Sumner<br>Licensed under the MIT License.<br>
    <a href="https://bun.com/docs/guides/process/ipc" class="_attribution-link">https://bun.com/docs/guides/process/ipc</a>
  </p>
</div>
