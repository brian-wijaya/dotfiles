<h1 id="header">Global cache</h1>
<div data-page-title="Global cache" data-page-href="/pm/global-cache" id="content">
<span data-as="p">All packages downloaded from the registry are stored in a global cache at <code>~/.bun/install/cache</code>, or the path defined by the environment variable <code>BUN_INSTALL_CACHE_DIR</code>. They are stored in subdirectories named like <code>${name}@${version}</code>, so multiple versions of a package can be cached.</span> <details><summary aria-controls="configuring-cache-behavior accordion children" aria-expanded="false" data-component-part="accordion-button">

<div contenteditable="false" data-component-part="accordion-title-container"><p data-component-part="accordion-title">Configuring cache behavior</p></div></summary><div id="configuring-cache-behavior accordion children" role="region" aria-labelledby="configuring-cache-behavior" data-component-part="accordion-content"><pre numberoflines="10" language="toml" data-language="typescript">[install.cache]
# the directory to use for the cache
dir = "~/.bun/install/cache"

# when true, don't load from the global cache.
# Bun may still write to node_modules/.cache
disable = false

# when true, always resolve the latest versions from the registry
disableManifest = false
</pre></div></details> <hr> <h2 id="minimizing-re-downloads"><span>Minimizing re-downloads</span></h2> <span data-as="p">Bun strives to avoid re-downloading packages multiple times. When installing a package, if the cache already contains a version in the range specified by <code>package.json</code>, Bun will use the cached package instead of downloading it again.</span> <details><summary aria-controls="installation-details accordion children" aria-expanded="false" data-component-part="accordion-button">

<div contenteditable="false" data-component-part="accordion-title-container"><p data-component-part="accordion-title">Installation details</p></div></summary><div id="installation-details accordion children" role="region" aria-labelledby="installation-details" data-component-part="accordion-content">
<span data-as="p">If the semver version has pre-release suffix (<code>1.0.0-beta.0</code>) or a build suffix (<code>1.0.0+20220101</code>), it is replaced with a hash of that value instead, to reduce the chances of errors associated with long file paths.</span><span data-as="p">When the <code>node_modules</code> folder exists, before installing, Bun checks that <code>node_modules</code> contains all expected packages with appropriate versions. If so <code>bun install</code> completes. Bun uses a custom JSON parser which stops parsing as soon as it finds <code>"name"</code> and <code>"version"</code>.</span><span data-as="p">If a package is missing or has a version incompatible with the <code>package.json</code>, Bun checks for a compatible module in the cache. If found, it is installed into <code>node_modules</code>. Otherwise, the package will be downloaded from the registry then installed.</span>
</div></details> <hr> <h2 id="fast-copying"><span>Fast copying</span></h2> <span data-as="p">Once a package is downloaded into the cache, Bun still needs to copy those files into <code>node_modules</code>. Bun uses the fastest syscalls available to perform this task. On Linux, it uses hardlinks; on macOS, it uses <code>clonefile</code>.</span> <hr> <h2 id="saving-disk-space"><span>Saving disk space</span></h2> <span data-as="p">Since Bun uses hardlinks to “copy” a module into a project’s <code>node_modules</code> directory on Linux and Windows, the contents of the package only exist in a single location on disk, greatly reducing the amount of disk space dedicated to <code>node_modules</code>.</span> <span data-as="p">This benefit also applies to macOS, but there are exceptions. It uses <code>clonefile</code> which is copy-on-write, meaning it will not occupy disk space, but it will count towards drive’s limit. This behavior is useful if something attempts to patch <code>node_modules/*</code>, so it’s impossible to affect other installations.</span> <details><summary aria-controls="installation-strategies accordion children" aria-expanded="false" data-component-part="accordion-button">

<div contenteditable="false" data-component-part="accordion-title-container"><p data-component-part="accordion-title">Installation strategies</p></div></summary><div id="installation-strategies accordion children" role="region" aria-labelledby="installation-strategies" data-component-part="accordion-content">
<span data-as="p">This behavior is configurable with the <code>--backend</code> flag, which is respected by all of Bun’s package management commands.</span><ul> <li>
<strong><code>hardlink</code></strong>: Default on Linux and Windows.</li> <li>
<strong><code>clonefile</code></strong> Default on macOS.</li> <li>
<strong><code>clonefile_each_dir</code></strong>: Similar to <code>clonefile</code>, except it clones each file individually per directory. It is only available on macOS and tends to perform slower than <code>clonefile</code>.</li> <li>
<strong><code>copyfile</code></strong>: The fallback used when any of the above fail. It is the slowest option. On macOS, it uses <code>fcopyfile()</code>; on Linux it uses <code>copy_file_range()</code>.</li> <li>
<strong><code>symlink</code></strong>: Currently used only <code>file:</code> (and eventually <code>link:</code>) dependencies. To prevent infinite loops, it skips symlinking the <code>node_modules</code> folder.</li> </ul>
<span data-as="p">If you install with <code>--backend=symlink</code>, Node.js won’t resolve node_modules of dependencies unless each dependency has its own <code>node_modules</code> folder or you pass <code>--preserve-symlinks</code> to <code>node</code>. See <a href="https://nodejs.org/api/cli.html#--preserve-symlinks" target="_blank" rel="noreferrer">Node.js documentation on <code>--preserve-symlinks</code></a>.</span><pre numberoflines="2" language="shellscript" data-language="typescript">bun install --backend symlink
node --preserve-symlinks ./foo.js
</pre>
<span data-as="p">Bun’s runtime does not currently expose an equivalent of <code>--preserve-symlinks</code>.</span>
</div></details>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; bun.com, oven-sh, Jarred Sumner<br>Licensed under the MIT License.<br>
    <a href="https://bun.com/docs/pm/global-cache" class="_attribution-link">https://bun.com/docs/pm/global-cache</a>
  </p>
</div>
