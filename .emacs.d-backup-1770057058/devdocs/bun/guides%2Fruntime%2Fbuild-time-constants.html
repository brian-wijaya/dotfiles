<h1 id="header">Build-time constants with --define</h1>
<div data-page-title="Build-time constants with --define" data-page-href="/guides/runtime/build-time-constants" id="content">
<span data-as="p">The <code>--define</code> flag can be used with <code>bun build</code> and <code>bun build --compile</code> to inject build-time constants into your application. This is especially useful for embedding metadata like build versions, timestamps, or configuration flags directly into your compiled executables.</span> <pre numberoflines="1" language="shellscript" data-language="typescript">bun build --compile --define BUILD_VERSION='"1.2.3"' --define BUILD_TIME='"2024-01-15T10:30:00Z"' src/index.ts --outfile myapp
</pre> <hr> <h2 id="why-use-build-time-constants"><span>Why use build-time constants?</span></h2> <span data-as="p">Build-time constants are embedded directly into your compiled code, making them:</span> <ul> <li>
<strong>Zero runtime overhead</strong> - No environment variable lookups or file reads</li> <li>
<strong>Immutable</strong> - Values are baked into the binary at compile time</li> <li>
<strong>Optimizable</strong> - Dead code elimination can remove unused branches</li> <li>
<strong>Secure</strong> - No external dependencies or configuration files to manage</li> </ul> <span data-as="p">This is similar to <code>gcc -D</code> or <code>#define</code> in C/C++, but for JavaScript/TypeScript.</span> <hr> <h2 id="basic-usage"><span>Basic usage</span></h2> <h3 id="with-bun-build"><span>With <code>bun build</code></span></h3> <pre numberoflines="2" language="shellscript" data-language="typescript"># Bundle with build-time constants
bun build --define BUILD_VERSION='"1.0.0"' --define NODE_ENV='"production"' src/index.ts --outdir ./dist
</pre> <h3 id="with-bun-build-compile"><span>With <code>bun build --compile</code></span></h3> <pre numberoflines="2" language="shellscript" data-language="typescript"># Compile to executable with build-time constants
bun build --compile --define BUILD_VERSION='"1.0.0"' --define BUILD_TIME='"2024-01-15T10:30:00Z"' src/cli.ts --outfile mycli
</pre> <h3 id="javascript-api"><span>JavaScript API</span></h3> <pre numberoflines="9" language="typescript" data-language="typescript">await Bun.build({
  entrypoints: ["./src/index.ts"],
  outdir: "./dist",
  define: {
    BUILD_VERSION: '"1.0.0"',
    BUILD_TIME: '"2024-01-15T10:30:00Z"',
    DEBUG: "false",
  },
});
</pre> <hr> <h2 id="common-use-cases"><span>Common use cases</span></h2> <h3 id="version-information"><span>Version information</span></h3> <span data-as="p">Embed version and build metadata directly into your executable:</span> <pre dir="ltr" data-orientation="horizontal" data-language="typescript">src/version.tsBuild command// These constants are replaced at build time
declare const BUILD_VERSION: string;
declare const BUILD_TIME: string;
declare const GIT_COMMIT: string;

export function getVersion() {
  return {
    version: BUILD_VERSION,
    buildTime: BUILD_TIME,
    commit: GIT_COMMIT,
  };
}
</pre> <h3 id="feature-flags"><span>Feature flags</span></h3> <span data-as="p">Use build-time constants to enable/disable features:</span> <pre numberoflines="14" language="typescript" data-language="typescript">// Replaced at build time
declare const ENABLE_ANALYTICS: boolean;
declare const ENABLE_DEBUG: boolean;

function trackEvent(event: string) {
  if (ENABLE_ANALYTICS) {
    // This entire block is removed if ENABLE_ANALYTICS is false
    console.log("Tracking:", event);
  }
}

if (ENABLE_DEBUG) {
  console.log("Debug mode enabled");
}
</pre> <pre numberoflines="5" language="shellscript" data-language="typescript"># Production build - analytics enabled, debug disabled
bun build --compile --define ENABLE_ANALYTICS=true --define ENABLE_DEBUG=false src/app.ts --outfile app-prod

# Development build - both enabled
bun build --compile --define ENABLE_ANALYTICS=false --define ENABLE_DEBUG=true src/app.ts --outfile app-dev
</pre> <h3 id="configuration"><span>Configuration</span></h3> <span data-as="p">Replace configuration objects at build time:</span> <pre numberoflines="10" language="typescript" data-language="typescript">declare const CONFIG: {
  apiUrl: string;
  timeout: number;
  retries: number;
};

// CONFIG is replaced with the actual object at build time
const response = await fetch(CONFIG.apiUrl, {
  timeout: CONFIG.timeout,
});
</pre> <pre numberoflines="1" language="shellscript" data-language="typescript">bun build --compile --define 'CONFIG={"apiUrl":"https://api.example.com","timeout":5000,"retries":3}' src/app.ts --outfile app
</pre> <hr> <h2 id="advanced-patterns"><span>Advanced patterns</span></h2> <h3 id="environment-specific-builds"><span>Environment-specific builds</span></h3> <span data-as="p">Create different executables for different environments:</span> <pre numberoflines="7" language="json" data-language="typescript">{
  "scripts": {
    "build:dev": "bun build --compile --define NODE_ENV='\"development\"' --define API_URL='\"http://localhost:3000\"' src/app.ts --outfile app-dev",
    "build:staging": "bun build --compile --define NODE_ENV='\"staging\"' --define API_URL='\"https://staging.example.com\"' src/app.ts --outfile app-staging",
    "build:prod": "bun build --compile --define NODE_ENV='\"production\"' --define API_URL='\"https://api.example.com\"' src/app.ts --outfile app-prod"
  }
}
</pre> <h3 id="using-shell-commands-for-dynamic-values"><span>Using shell commands for dynamic values</span></h3> <span data-as="p">Generate build-time constants from shell commands:</span> <pre numberoflines="6" language="shellscript" data-language="typescript"># Use git to get current commit and timestamp
bun build --compile \
  --define BUILD_VERSION="\"$(git describe --tags --always)\"" \
  --define BUILD_TIME="\"$(date -u +%Y-%m-%dT%H:%M:%SZ)\"" \
  --define GIT_COMMIT="\"$(git rev-parse HEAD)\"" \
  src/cli.ts --outfile mycli
</pre> <h3 id="build-automation-script"><span>Build automation script</span></h3> <span data-as="p">Create a build script that automatically injects build metadata:</span> <pre numberoflines="18" language="typescript" data-language="typescript">// build.ts
import { $ } from "bun";

const version = await $`git describe --tags --always`.text();
const buildTime = new Date().toISOString();
const gitCommit = await $`git rev-parse HEAD`.text();

await Bun.build({
  entrypoints: ["./src/cli.ts"],
  outdir: "./dist",
  define: {
    BUILD_VERSION: JSON.stringify(version.trim()),
    BUILD_TIME: JSON.stringify(buildTime),
    GIT_COMMIT: JSON.stringify(gitCommit.trim()),
  },
});

console.log(`Built with version ${version.trim()}`);
</pre> <hr> <h2 id="important-considerations"><span>Important considerations</span></h2> <h3 id="value-format"><span>Value format</span></h3> <span data-as="p">Values must be valid JSON that will be parsed and inlined as JavaScript expressions:</span> <pre numberoflines="17" language="shellscript" data-language="typescript"># ✅ Strings must be JSON-quoted
--define VERSION='"1.0.0"'

# ✅ Numbers are JSON literals
--define PORT=3000

# ✅ Booleans are JSON literals
--define DEBUG=true

# ✅ Objects and arrays (use single quotes to wrap the JSON)
--define 'CONFIG={"host":"localhost","port":3000}'

# ✅ Arrays work too
--define 'FEATURES=["auth","billing","analytics"]'

# ❌ This won't work - missing quotes around string
--define VERSION=1.0.0
</pre> <h3 id="property-keys"><span>Property keys</span></h3> <span data-as="p">You can use property access patterns as keys, not just simple identifiers:</span> <pre numberoflines="11" language="shellscript" data-language="typescript"># ✅ Replace process.env.NODE_ENV with "production"
--define 'process.env.NODE_ENV="production"'

# ✅ Replace process.env.API_KEY with the actual key
--define 'process.env.API_KEY="abc123"'

# ✅ Replace nested properties
--define 'window.myApp.version="1.0.0"'

# ✅ Replace array access
--define 'process.argv[2]="--production"'
</pre> <span data-as="p">This is particularly useful for environment variables:</span> <pre numberoflines="12" language="typescript" data-language="typescript">// Before compilation
if (process.env.NODE_ENV === "production") {
  console.log("Production mode");
}

// After compilation with --define 'process.env.NODE_ENV="production"'
if ("production" === "production") {
  console.log("Production mode");
}

// After optimization
console.log("Production mode");
</pre> <h3 id="typescript-declarations"><span>TypeScript declarations</span></h3> <span data-as="p">For TypeScript projects, declare your constants to avoid type errors:</span> <pre numberoflines="5" language="typescript" data-language="typescript">// types/build-constants.d.ts
declare const BUILD_VERSION: string;
declare const BUILD_TIME: string;
declare const NODE_ENV: "development" | "staging" | "production";
declare const DEBUG: boolean;
</pre> <h3 id="cross-platform-compatibility"><span>Cross-platform compatibility</span></h3> <span data-as="p">When building for multiple platforms, constants work the same way:</span> <pre numberoflines="8" language="shellscript" data-language="typescript"># Linux
bun build --compile --target=bun-linux-x64 --define PLATFORM='"linux"' src/app.ts --outfile app-linux

# macOS
bun build --compile --target=bun-darwin-x64 --define PLATFORM='"darwin"' src/app.ts --outfile app-macos

# Windows
bun build --compile --target=bun-windows-x64 --define PLATFORM='"windows"' src/app.ts --outfile app-windows.exe
</pre> <hr> <h2 id="related"><span>Related</span></h2> <ul> <li>
<a href="define-constant">Define constants at runtime</a> - Using <code>--define</code> with <code>bun run</code>
</li> <li>
<a href="../../bundler/executables">Building executables</a> - Complete guide to <code>bun build --compile</code>
</li> <li>
<a href="../../bundler">Bundler API</a> - Full bundler documentation including <code>define</code> option</li> </ul>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; bun.com, oven-sh, Jarred Sumner<br>Licensed under the MIT License.<br>
    <a href="https://bun.com/docs/guides/runtime/build-time-constants" class="_attribution-link">https://bun.com/docs/guides/runtime/build-time-constants</a>
  </p>
</div>
