<h1 id="header">Write browser DOM tests with Bun and happy-dom</h1>
<div data-page-title="Write browser DOM tests with Bun and happy-dom" data-page-href="/guides/test/happy-dom" id="content">
<span data-as="p">You can write and run browser tests with Bun’s test runner in conjunction with <a href="https://github.com/capricorn86/happy-dom" target="_blank" rel="noreferrer">Happy DOM</a>. Happy DOM implements mocked versions of browser APIs like <code>document</code> and <code>location</code>.</span> <hr> <span data-as="p">To get started, install <code>happy-dom</code>.</span> <pre numberoflines="1" language="shellscript" data-language="typescript">bun add -d @happy-dom/global-registrator
</pre> <hr> <span data-as="p">This module exports a “registrator” that injects the mocked browser APIs to the global scope.</span> <pre numberoflines="3" language="typescript" data-language="typescript">import { GlobalRegistrator } from "@happy-dom/global-registrator";

GlobalRegistrator.register();
</pre> <hr> <span data-as="p">We need to make sure this file is executed before any of our test files. That’s a job for Bun’s built-in <a href="happy-dom" target="_blank" rel="noreferrer"><em>preload</em></a> functionality. Create a <code>bunfig.toml</code> file in the root of your project (if it doesn’t already exist) and add the following lines.</span> <span data-as="p">The <code>./happydom.ts</code> file should contain the registration code above.</span> <pre numberoflines="2" language="toml" data-language="typescript">[test]
preload = "./happydom.ts"
</pre> <hr> <span data-as="p">Now running <code>bun test</code> inside our project will automatically execute <code>happydom.ts</code> first. We can start writing tests that use browser APIs.</span> <pre numberoflines="7" language="typescript" data-language="typescript">import { test, expect } from "bun:test";

test("set button text", () =&gt; {
  document.body.innerHTML = `&lt;button&gt;My button&lt;/button&gt;`;
  const button = document.querySelector("button");
  expect(button?.innerText).toEqual("My button");
});
</pre> <hr> <span data-as="p">With Happy DOM properly configured, this test runs as expected.</span> <pre numberoflines="1" language="shellscript" data-language="typescript">bun test
</pre> <pre numberoflines="9" language="text" data-language="typescript">
dom.test.ts:
✓ set button text [0.82ms]

 1 pass
 0 fail
 1 expect() calls
Ran 1 tests across 1 files. 1 total [125.00ms]
</pre> <hr> <span data-as="p">Refer to the <a href="https://github.com/capricorn86/happy-dom" target="_blank" rel="noreferrer">Happy DOM repo</a> and <a href="../../test/dom">Docs &gt; Test runner &gt; DOM</a> for complete documentation on writing browser tests with Bun.</span>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; bun.com, oven-sh, Jarred Sumner<br>Licensed under the MIT License.<br>
    <a href="https://bun.com/docs/guides/test/happy-dom" class="_attribution-link">https://bun.com/docs/guides/test/happy-dom</a>
  </p>
</div>
