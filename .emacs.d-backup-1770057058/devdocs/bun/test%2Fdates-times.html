<h1 id="header">Dates and times</h1>
<div data-page-title="Dates and times" data-page-href="/test/dates-times" id="content">
<span data-as="p"><code>bun:test</code> lets you change what time it is in your tests.</span> <span data-as="p">This works with any of the following:</span> <ul> <li><code>Date.now</code></li> <li><code>new Date()</code></li> <li><code>new Intl.DateTimeFormat().format()</code></li> </ul> <div data-callout-type="note">

<div data-component-part="callout-content">Timers are not impacted yet, but may be in a future release of Bun.</div>
</div> <h2 id="setsystemtime"><span>setSystemTime</span></h2> <span data-as="p">To change the system time, use <code>setSystemTime</code>:</span> <pre numberoflines="9" language="typescript" data-language="typescript">import { setSystemTime, beforeAll, test, expect } from "bun:test";

beforeAll(() =&gt; {
  setSystemTime(new Date("2020-01-01T00:00:00.000Z"));
});

test("it is 2020", () =&gt; {
  expect(new Date().getFullYear()).toBe(2020);
});
</pre> <span data-as="p">To support existing tests that use Jest’s <code>useFakeTimers</code> and <code>useRealTimers</code>, you can use <code>useFakeTimers</code> and <code>useRealTimers</code>:</span> <pre numberoflines="22" language="typescript" data-language="typescript">test("just like in jest", () =&gt; {
  jest.useFakeTimers();
  jest.setSystemTime(new Date("2020-01-01T00:00:00.000Z"));
  expect(new Date().getFullYear()).toBe(2020);
  jest.useRealTimers();
  expect(new Date().getFullYear()).toBeGreaterThan(2020);
});

test("unlike in jest", () =&gt; {
  const OriginalDate = Date;
  jest.useFakeTimers();
  if (typeof Bun === "undefined") {
    // In Jest, the Date constructor changes
    // That can cause all sorts of bugs because suddenly Date !== Date before the test.
    expect(Date).not.toBe(OriginalDate);
    expect(Date.now).not.toBe(OriginalDate.now);
  } else {
    // In bun:test, Date constructor does not change when you useFakeTimers
    expect(Date).toBe(OriginalDate);
    expect(Date.now).toBe(OriginalDate.now);
  }
});
</pre> <div data-callout-type="warning">

<div data-component-part="callout-content"><span data-as="p"><strong>Timers</strong> — Note that we have not implemented builtin support for mocking timers yet, but this is on the roadmap.</span></div>
</div> <h2 id="reset-the-system-time"><span>Reset the system time</span></h2> <span data-as="p">To reset the system time, pass no arguments to <code>setSystemTime</code>:</span> <pre numberoflines="12" language="typescript" data-language="typescript">import { setSystemTime, expect, test } from "bun:test";

test("it was 2020, for a moment.", () =&gt; {
  // Set it to something!
  setSystemTime(new Date("2020-01-01T00:00:00.000Z"));
  expect(new Date().getFullYear()).toBe(2020);

  // reset it!
  setSystemTime();

  expect(new Date().getFullYear()).toBeGreaterThan(2020);
});
</pre> <h2 id="get-mocked-time-with-jest-now"><span>Get mocked time with jest.now()</span></h2> <span data-as="p">When you’re using mocked time (with <code>setSystemTime</code> or <code>useFakeTimers</code>), you can use <code>jest.now()</code> to get the current mocked timestamp:</span> <pre numberoflines="11" language="typescript" data-language="typescript">import { test, expect, jest } from "bun:test";

test("get the current mocked time", () =&gt; {
  jest.useFakeTimers();
  jest.setSystemTime(new Date("2020-01-01T00:00:00.000Z"));

  expect(Date.now()).toBe(1577836800000); // Jan 1, 2020 timestamp
  expect(jest.now()).toBe(1577836800000); // Same value

  jest.useRealTimers();
});
</pre> <span data-as="p">This is useful when you need to access the mocked time directly without creating a new Date object.</span> <h2 id="set-the-time-zone"><span>Set the time zone</span></h2> <span data-as="p">By default, the time zone for all <code>bun test</code> runs is set to UTC (<code>Etc/UTC</code>) unless overridden. To change the time zone, either pass the <code>$TZ</code> environment variable to <code>bun test</code>:</span> <pre numberoflines="1" language="shellscript" data-language="typescript">TZ=America/Los_Angeles bun test
</pre> <span data-as="p">Or set <code>process.env.TZ</code> at runtime:</span> <pre numberoflines="14" language="typescript" data-language="typescript">import { test, expect } from "bun:test";

test("Welcome to California!", () =&gt; {
  process.env.TZ = "America/Los_Angeles";
  expect(new Date().getTimezoneOffset()).toBe(420);
  expect(new Intl.DateTimeFormat().resolvedOptions().timeZone).toBe("America/Los_Angeles");
});

test("Welcome to New York!", () =&gt; {
  // Unlike in Jest, you can set the timezone multiple times at runtime and it will work.
  process.env.TZ = "America/New_York";
  expect(new Date().getTimezoneOffset()).toBe(240);
  expect(new Intl.DateTimeFormat().resolvedOptions().timeZone).toBe("America/New_York");
});
</pre> <div data-callout-type="info">

<div data-component-part="callout-content">Unlike in Jest, you can set the timezone multiple times at runtime and it will work.</div>
</div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; bun.com, oven-sh, Jarred Sumner<br>Licensed under the MIT License.<br>
    <a href="https://bun.com/docs/test/dates-times" class="_attribution-link">https://bun.com/docs/test/dates-times</a>
  </p>
</div>
