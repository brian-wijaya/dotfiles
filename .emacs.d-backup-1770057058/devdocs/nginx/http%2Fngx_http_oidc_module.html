<h1>Module ngx_http_oidc_module</h1>
<ul>
<li><a href="#example">Example Configuration</a></li>
<li><a href="#directives">Directives</a></li>
<li><a href="#oidc_provider">oidc_provider</a></li>
<li><a href="#auth_oidc">auth_oidc</a></li>
<li><a href="#issuer">issuer</a></li>
<li><a href="#client_id">client_id</a></li>
<li><a href="#client_secret">client_secret</a></li>
<li><a href="#config_url">config_url</a></li>
<li><a href="#cookie_name">cookie_name</a></li>
<li><a href="#extra_auth_args">extra_auth_args</a></li>
<li><a href="#redirect_uri">redirect_uri</a></li>
<li><a href="#scope">scope</a></li>
<li><a href="#session_store">session_store</a></li>
<li><a href="#session_timeout">session_timeout</a></li>
<li><a href="#ssl_crl">ssl_crl</a></li>
<li><a href="#ssl_trusted_certificate">ssl_trusted_certificate</a></li>
<li><a href="#variables">Embedded Variables</a></li>
</ul> <p id="summary"> The <code>ngx_http_oidc_module</code> module (1.27.4) implements authentication as a Relying Party in OpenID Connect using the <a href="https://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth"> Authorization Code Flow</a>. </p>
<p> The module expects the OpenID Provider's configuration to be available via <a href="https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderConfig"> metadata</a> and requires dynamic <a href="ngx_http_core_module#resolver">resolver</a>. </p>
<p> The module can be combined with other access modules via the <a href="ngx_http_core_module#satisfy">satisfy</a> directive. Note that the module may still block requests even with <code>satisfy any;</code> as an OpenID Provider might not redirect the user back to nginx. </p>
 <blockquote class="note"> This module is available as part of our <a href="https://www.f5.com/products/nginx">commercial subscription</a>. </blockquote>
 <h4 id="example">Example Configuration</h4>
 <pre data-language="nginx">
http {
    resolver 10.0.0.1;

    oidc_provider my_idp {
        issuer        "https://provider.domain";
        client_id     "unique_id";
        client_secret "unique_secret";
    }

    server {
        location / {
            auth_oidc my_idp;

            proxy_set_header username $oidc_claim_sub;
            proxy_pass       http://backend;
        }
    }
}
</pre>
<p> The example assumes that the “<code>https://&lt;nginx-host&gt;/oidc_callback</code>” Redirection URI is configured on the OpenID Provider's side. The path can be customized with the <a href="#redirect_uri">redirect_uri</a> directive. </p> <h4 id="directives">Directives</h4>
<div class="directive" id="oidc_provider"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>oidc_provider</strong> <i>name</i> { ... }</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code><br> </td> </tr> </table></div>
<p> Defines an OpenID Provider for use with the <a href="#auth_oidc">auth_oidc</a> directive. </p>
<div class="directive" id="auth_oidc"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>auth_oidc</strong> <i>name</i> | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>auth_oidc off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Enables end user authentication with the <a href="#oidc_provider">specified</a> OpenID Provider. </p>
<p> The special value <code>off</code> cancels the effect of the <code>auth_oidc</code> directive inherited from the previous configuration level. </p>
<div class="directive" id="issuer"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>issuer</strong> <i>URL</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Sets the Issuer Identifier URL of the OpenID Provider; required directive. The URL must exactly match the value of “<code>issuer</code>” in the OpenID Provider metadata and requires the “<code>https</code>” scheme. </p>
<div class="directive" id="client_id"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>client_id</strong> <i>string</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Specifies the client ID of the Relying Party; required directive. </p>
<div class="directive" id="client_secret"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>client_secret</strong> <i>string</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Specifies a secret value used to authenticate the Relying Party with the OpenID Provider. </p>
<div class="directive" id="config_url"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>config_url</strong> <i>URL</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>config_url &lt;issuer&gt;/.well-known/openid-configuration;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Sets a custom URL to retrieve the OpenID Provider metadata. </p>
<div class="directive" id="cookie_name"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>cookie_name</strong> <i>name</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>cookie_name NGX_OIDC_SESSION;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Sets the name of a session cookie. </p>
<div class="directive" id="extra_auth_args"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>extra_auth_args</strong> <i>string</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Sets additional query arguments for the <a href="https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest">authentication request</a> URL. </p> <pre data-language="nginx">
extra_auth_args "display=page&amp;prompt=login";
</pre>

<div class="directive" id="redirect_uri"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>redirect_uri</strong> <i>uri</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>redirect_uri /oidc_callback;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Defines the Redirection URI path for post-authentication redirects expected by the module from the OpenID Provider. The <code><i>uri</i></code> must match the configuration on the Provider's side. </p>
<div class="directive" id="scope"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>scope</strong> <i>scope</i> ...;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>scope openid;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Sets requested scopes. The <code>openid</code> scope is always required by OIDC. </p>
<div class="directive" id="session_store"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>session_store</strong> <i>name</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Specifies a custom <a href="ngx_http_keyval_module#keyval_zone">key-value database</a> that stores session data. By default, an 8-megabyte key-value database named <code>oidc_default_store_&lt;provider name&gt;</code> is created automatically. </p> <blockquote class="note"> A separate key-value database should be configured for each Provider to prevent session reuse across providers. </blockquote>

<div class="directive" id="session_timeout"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>session_timeout</strong> <i>time</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>session_timeout 8h;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Sets a timeout after which the session is deleted, unless it was <a href="https://openid.net/specs/openid-connect-core-1_0.html#RefreshTokens">refreshed</a>. </p>
<div class="directive" id="ssl_crl"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>ssl_crl</strong> <i>file</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Specifies a <code><i>file</i></code> with revoked certificates (CRL) in the PEM format used to verify the certificates of the OpenID Provider endpoints. </p>
<div class="directive" id="ssl_trusted_certificate"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>ssl_trusted_certificate</strong> <i>file</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>ssl_trusted_certificate system CA bundle;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>oidc_provider</code><br> </td> </tr> </table></div>
<p> Specifies a <code><i>file</i></code> with trusted CA certificates in the PEM format used to verify the certificates of the OpenID Provider endpoints. </p> <h4 id="variables">Embedded Variables</h4>
<p> The <code>ngx_http_oidc_module</code> module supports embedded variables: </p>
 <dl class="compact"> <dt id="var_oidc_id_token"><code>$oidc_id_token</code></dt> <dd> ID token </dd> <dt id="var_oidc_access_token"><code>$oidc_access_token</code></dt> <dd> access token </dd> <dt id="var_oidc_claim_">
<code>$oidc_claim_</code><code><i>name</i></code>
</dt> <dd> top-level ID token claim <p> Nested claims can be fetched with the <a href="ngx_http_auth_jwt_module">auth_jwt</a> module: </p> <pre data-language="nginx">
http {
    auth_jwt_claim_set $postal_code address postal_code;

    server {
        location / {
            auth_oidc my_idp;
            auth_jwt  off token=$oidc_id_token;

            proxy_set_header x-postal_code $postal_code;
            proxy_pass       http://backend;
        }
    }
}
</pre>
 </dd> </dl>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2002-2021 Igor Sysoev<br>&copy; 2011-2025 Nginx, Inc.<br>Licensed under the BSD License.<br>
    <a href="https://nginx.org/en/docs/http/ngx_http_oidc_module.html" class="_attribution-link">https://nginx.org/en/docs/http/ngx_http_oidc_module.html</a>
  </p>
</div>
