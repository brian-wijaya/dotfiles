<mdn-survey></mdn-survey> <h1>AsyncDisposableStack.prototype.move()</h1> <details class="baseline-indicator not" data-glean-toggle-open="baseline_toggle_open"> <summary>  <div class="status-title"> <span class="not-bold">Limited availability</span> </div>   </summary> <div class="extra"> <p>This feature is not Baseline because it does not work in some of the most widely-used browsers.</p> <ul> <li> <a href="https://developer.mozilla.org/en-US/docs/Glossary/Baseline/Compatibility" data-glean-id="baseline_link_learn_more" target="_blank" class="learn-more"> Learn more </a> </li> <li> <a href="#browser_compatibility" data-glean-id="baseline_link_bcd_table"> See full compatibility </a> </li> <li> <a href="https://survey.alchemer.com/s3/7634825/MDN-baseline-feedback?page=%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FAsyncDisposableStack%2Fmove&amp;level=not" data-glean-id="baseline_link_feedback" class="feedback-link" target="_blank" rel="noreferrer"> Report feedback </a> </li> </ul> </div> </details><section class="content-section"> <p>The <code>move()</code> method of <a href="../asyncdisposablestack"><code>AsyncDisposableStack</code></a> instances creates a new <code>AsyncDisposableStack</code> instance that contains the same disposers as this stack, and then marks this stack as disposed, without calling any disposers.</p> </section>    <section class="content-section" aria-labelledby="syntax"> <h2 id="syntax" class="heading">Syntax</h2> <div class="code-example"><pre data-language="js">move()
</pre></div> </section><section class="content-section" aria-labelledby="parameters"> <h3 id="parameters" class="heading">Parameters</h3> <p>None.</p> </section><section class="content-section" aria-labelledby="return_value"> <h3 id="return_value" class="heading">Return value</h3> <p>A new <a href="../asyncdisposablestack"><code>AsyncDisposableStack</code></a> instance.</p> </section><section class="content-section" aria-labelledby="exceptions"> <h3 id="exceptions" class="heading">Exceptions</h3> <dl> <dt id="referenceerror"><a href="../referenceerror"><code>ReferenceError</code></a></dt> <dd> <p>Thrown if the stack is already disposed.</p> </dd> </dl> </section><section class="content-section" aria-labelledby="examples"> <h2 id="examples" class="heading">Examples</h2> &gt; </section><section class="content-section" aria-labelledby="claiming_ownership_of_a_stack"> <h3 id="claiming_ownership_of_a_stack" class="heading">Claiming ownership of a stack</h3> <div class="code-example"><pre data-language="js">async function consumeStack(stack) {
  await using newStack = stack.move(); // newStack now owns the disposers
  console.log(stack.disposed); // true
  console.log(newStack.disposed); // false
  // newStack is disposed here immediately before the function exits
}

const stack = new AsyncDisposableStack();
console.log(stack.disposed); // false
await consumeStack(stack);
console.log(stack.disposed); // true
</pre></div> </section><section class="content-section" aria-labelledby="allowing_resources_to_be_disposed_within_two_code_paths"> <h3 id="allowing_resources_to_be_disposed_within_two_code_paths" class="heading">Allowing resources to be disposed within two code paths</h3> <p>The major use case of <code>move()</code> is when you have one or more resources which could either be disposed right here or could be persisted for later use. In this case, you can put the resources in an <code>AsyncDisposableStack</code> and then call <code>move()</code> when you need to persist the resources for later usage.</p> <div class="code-example"><pre data-language="js">class PluginHost {
  #disposed = false;
  #disposables;
  #channel;
  #socket;

  static async init() {
    // Create an AsyncDisposableStack that is disposed when init exits.
    // If construction succeeds, we move everything out of `stack` and into
    // `#disposables` to be disposed later.
    await using stack = new AsyncDisposableStack();

    const channel = stack.use(await getChannel());

    const socket = stack.use(await getSocket());

    // If we made it here, then there were no errors during construction and
    // we can safely move the disposables out of `stack`.
    return new PluginHost(channel, socket, stack.move());

    // If construction failed, then `stack` would be disposed before reaching
    // the line above, which would dispose `channel` and `socket` in turn.
  }

  constructor(channel, socket, disposables) {
    this.#channel = channel;
    this.#socket = socket;
    this.#disposables = disposables;
  }

  [Symbol.asyncDispose]() {
    if (this.#disposed) {
      return;
    }
    this.#disposed = true;
    // Put `this.#disposables` into a `using` variable, so it is automatically
    // disposed when the function exits.
    await using disposables = this.#disposables;

    // NOTE: we can free `#socket` and `#channel` here since they will be
    // disposed by the call to `disposables[Symbol.asyncDispose]()`, below.
    // This isn't strictly a requirement for every disposable, but is
    // good housekeeping since these objects will no longer be useable.
    this.#socket = undefined;
    this.#channel = undefined;
    this.#disposables = undefined;
  }
}
</pre></div> </section><section class="content-section" aria-labelledby="specifications"> <h2 id="specifications" class="heading">Specifications</h2> <div class="_table"><table> <thead> <tr> <th scope="col">Specification</th> </tr> </thead> <tbody> <tr> <td><a href="https://tc39.es/proposal-async-explicit-resource-management/#sec-asyncdisposablestack.prototype.move" rel="noopener" target="_blank">ECMAScript Async Explicit Resource Management&gt;<br># sec-asyncdisposablestack.prototype.move&gt;</a></td> </tr> </tbody> </table></div> </section><section class="content-section" aria-labelledby="browser_compatibility"> <h2 id="browser_compatibility" class="heading">Browser compatibility</h2> <div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="5">Desktop</th>
<th colspan="7">Mobile</th>
<th colspan="3">Server</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Opera</th>
<th>Safari</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
<th>WebView Android</th>
<th>WebView on iOS</th>
<th>Bun</th>
<th>Deno</th>
<th>Node.js</th>
</tr>
</thead>
<tbody><tr>
<th><code>move</code></th>
<td class="bc-supports-yes"><abbr title="Release date: 2025-03-04">134</abbr></td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-03-06">134</abbr></td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-07-22">141</abbr></td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-05-13">119</abbr></td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-03-04">134</abbr></td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-07-22">141</abbr></td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-03-19">88</abbr></td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-10-25">29.0</abbr></td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-03-04">134</abbr></td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-10-10">1.3.0</abbr></td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-04-15">2.2.10</abbr></td>
<td class="bc-supports-yes"><abbr title="Release date: 2025-05-06">24.0.0</abbr></td>
</tr></tbody>
</table></div> </section><section class="content-section" aria-labelledby="see_also"> <h2 id="see_also" class="heading">See also</h2> <ul> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Resource_management">JavaScript resource management</a></li> <li><a href="../asyncdisposablestack"><code>AsyncDisposableStack</code></a></li> <li><a href="disposeasync"><code>AsyncDisposableStack.prototype.disposeAsync()</code></a></li> </ul> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2025 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncDisposableStack/move" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncDisposableStack/move</a>
  </p>
</div>
