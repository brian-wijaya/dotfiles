<mdn-survey></mdn-survey> <h1>TypeError: WeakSet key/WeakMap value 'x' must be an object or an unregistered symbol</h1> <section class="content-section"> <p>The JavaScript exception "WeakSet key (or WeakMap value) 'x' must be an object or an unregistered symbol" occurs when a value of invalid type is used as a key in a <a href="../global_objects/weakset"><code>WeakSet</code></a> or as a value in a <a href="../global_objects/weakmap"><code>WeakMap</code></a>.</p> </section>    <section class="content-section" aria-labelledby="message"> <h2 id="message" class="heading">Message</h2> <pre data-language="plain">TypeError: Invalid value used as weak map key (V8-based)
TypeError: WeakMap key 1 must be an object or an unregistered symbol (Firefox)
TypeError: WeakMap keys must be objects or non-registered symbols (Safari)

TypeError: Invalid value used in weak set (V8-based)
TypeError: WeakSet value 1 must be an object or an unregistered symbol (Firefox)
TypeError: WeakSet values must be objects or non-registered symbols (Safari)
</pre> </section><section class="content-section" aria-labelledby="error_type"> <h2 id="error_type" class="heading">Error type</h2> <a href="../global_objects/typeerror"><code>TypeError</code></a> </section><section class="content-section" aria-labelledby="what_went_wrong"> <h2 id="what_went_wrong" class="heading">What went wrong?</h2> <p><a href="../global_objects/weakset"><code>WeakSet</code></a> and <a href="../global_objects/weakmap"><code>WeakMap</code></a> require the keys to be <em>garbage collectable</em>. Only objects and non-registered symbols (that is, <a href="../global_objects/symbol">symbols</a> not returned by <a href="../global_objects/symbol/for"><code>Symbol.for()</code></a>) are valid. For more information, see <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Memory_management#weakmaps_and_weaksets">Memory management</a>. If you want to add keys that are strings, numbers, or other primitive values, you should store them in a regular <code>Set</code> or <code>Map</code> instead.</p> </section><section class="content-section" aria-labelledby="examples"> <h2 id="examples" class="heading">Examples</h2> &gt; </section><section class="content-section" aria-labelledby="invalid_cases"> <h3 id="invalid_cases" class="heading">Invalid cases</h3> <div class="code-example"><pre data-language="js">new WeakSet().add(1); // TypeError
new WeakMap().set(1, {}); // TypeError
new WeakSet([1]); // TypeError
new WeakMap([[1, {}]]); // TypeError
</pre></div> </section><section class="content-section" aria-labelledby="valid_cases"> <h3 id="valid_cases" class="heading">Valid cases</h3> <div class="code-example"><pre data-language="js">new WeakSet().add({}); // OK
new WeakMap().set({}, 1); // OK

new Set([1]); // OK
new Map([[1, {}]]); // OK
</pre></div> </section><section class="content-section" aria-labelledby="see_also"> <h2 id="see_also" class="heading">See also</h2> <ul> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Memory_management">Memory management</a></li> <li><a href="../global_objects/weakset"><code>WeakSet</code></a></li> <li><a href="../global_objects/weakmap"><code>WeakMap</code></a></li> <li><a href="../global_objects/set"><code>Set</code></a></li> <li><a href="../global_objects/map"><code>Map</code></a></li> </ul> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2025 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Key_not_weakly_held" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Key_not_weakly_held</a>
  </p>
</div>
