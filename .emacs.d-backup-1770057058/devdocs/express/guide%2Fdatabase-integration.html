<main> <h1 id="database-integration" data-level="11">Database integration</h1> <p>Adding the capability to connect databases to Express apps is just a matter of loading an appropriate Node.js driver for the database in your app. This document briefly explains how to add and use some of the most popular Node.js modules for database systems in your Express app:</p> <ul> <li><a href="#cassandra">Cassandra</a></li> <li><a href="#couchbase">Couchbase</a></li> <li><a href="#couchdb">CouchDB</a></li> <li><a href="#leveldb">LevelDB</a></li> <li><a href="#mysql">MySQL</a></li> <li><a href="#mongodb">MongoDB</a></li> <li><a href="#neo4j">Neo4j</a></li> <li><a href="#oracle">Oracle</a></li> <li><a href="#postgresql">PostgreSQL</a></li> <li><a href="#redis">Redis</a></li> <li><a href="#sql-server">SQL Server</a></li> <li><a href="#sqlite">SQLite</a></li> <li><a href="#elasticsearch">Elasticsearch</a></li> </ul> <div class="doc-box doc-notice"> <p>These database drivers are among many that are available. For other options, search on the <a href="https://www.npmjs.com/">npm</a> site.</p> </div> <h2 id="cassandra">Cassandra</h2> <p><strong>Module</strong>: <a href="https://github.com/datastax/nodejs-driver">cassandra-driver</a></p> <h3 id="installation">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install cassandra-driver
</pre></div> <h3 id="example">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const cassandra = require('cassandra-driver')
const client = new cassandra.Client({ contactPoints: ['localhost'] })

client.execute('select key from system.local', (err, result) =&gt; {
  if (err) throw err
  console.log(result.rows[0])
})
</pre></div> <h2 id="couchbase">Couchbase</h2> <p><strong>Module</strong>: <a href="https://github.com/couchbase/couchnode">couchnode</a></p> <h3 id="installation-1">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install couchbase
</pre></div> <h3 id="example-1">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const couchbase = require('couchbase')
const bucket = (new couchbase.Cluster('http://localhost:8091')).openBucket('bucketName')

// add a document to a bucket
bucket.insert('document-key', { name: 'Matt', shoeSize: 13 }, (err, result) =&gt; {
  if (err) {
    console.log(err)
  } else {
    console.log(result)
  }
})

// get all documents with shoe size 13
const n1ql = 'SELECT d.* FROM `bucketName` d WHERE shoeSize = $1'
const query = N1qlQuery.fromString(n1ql)
bucket.query(query, [13], (err, result) =&gt; {
  if (err) {
    console.log(err)
  } else {
    console.log(result)
  }
})
</pre></div> <h2 id="couchdb">CouchDB</h2> <p><strong>Module</strong>: <a href="https://github.com/dscape/nano">nano</a></p> <h3 id="installation-2">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install nano
</pre></div> <h3 id="example-2">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const nano = require('nano')('http://localhost:5984')
nano.db.create('books')
const books = nano.db.use('books')

// Insert a book document in the books database
books.insert({ name: 'The Art of war' }, null, (err, body) =&gt; {
  if (err) {
    console.log(err)
  } else {
    console.log(body)
  }
})

// Get a list of all books
books.list((err, body) =&gt; {
  if (err) {
    console.log(err)
  } else {
    console.log(body.rows)
  }
})
</pre></div> <h2 id="leveldb">LevelDB</h2> <p><strong>Module</strong>: <a href="https://github.com/rvagg/node-levelup">levelup</a></p> <h3 id="installation-3">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install level levelup leveldown
</pre></div> <h3 id="example-3">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const levelup = require('levelup')
const db = levelup('./mydb')

db.put('name', 'LevelUP', (err) =&gt; {
  if (err) return console.log('Ooops!', err)

  db.get('name', (err, value) =&gt; {
    if (err) return console.log('Ooops!', err)

    console.log(`name=${value}`)
  })
})
</pre></div> <h2 id="mysql">MySQL</h2> <p><strong>Module</strong>: <a href="https://github.com/felixge/node-mysql/">mysql</a></p> <h3 id="installation-4">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install mysql
</pre></div> <h3 id="example-4">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const mysql = require('mysql')
const connection = mysql.createConnection({
  host: 'localhost',
  user: 'dbuser',
  password: 's3kreee7',
  database: 'my_db'
})

connection.connect()

connection.query('SELECT 1 + 1 AS solution', (err, rows, fields) =&gt; {
  if (err) throw err

  console.log('The solution is: ', rows[0].solution)
})

connection.end()
</pre></div> <h2 id="mongodb">MongoDB</h2> <p><strong>Module</strong>: <a href="https://github.com/mongodb/node-mongodb-native">mongodb</a></p> <h3 id="installation-5">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install mongodb
</pre></div> <h3 id="example-v2">Example (v2.*)</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const MongoClient = require('mongodb').MongoClient

MongoClient.connect('mongodb://localhost:27017/animals', (err, db) =&gt; {
  if (err) throw err

  db.collection('mammals').find().toArray((err, result) =&gt; {
    if (err) throw err

    console.log(result)
  })
})
</pre></div> <h3 id="example-v3">Example (v3.*)</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const MongoClient = require('mongodb').MongoClient

MongoClient.connect('mongodb://localhost:27017/animals', (err, client) =&gt; {
  if (err) throw err

  const db = client.db('animals')

  db.collection('mammals').find().toArray((err, result) =&gt; {
    if (err) throw err

    console.log(result)
  })
})
</pre></div> <p>If you want an object model driver for MongoDB, look at <a href="https://github.com/LearnBoost/mongoose">Mongoose</a>.</p> <h2 id="neo4j">Neo4j</h2> <p><strong>Module</strong>: <a href="https://github.com/neo4j/neo4j-javascript-driver">neo4j-driver</a></p> <h3 id="installation-6">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install neo4j-driver
</pre></div> <h3 id="example-5">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const neo4j = require('neo4j-driver')
const driver = neo4j.driver('neo4j://localhost:7687', neo4j.auth.basic('neo4j', 'letmein'))

const session = driver.session()

session.readTransaction((tx) =&gt; {
  return tx.run('MATCH (n) RETURN count(n) AS count')
    .then((res) =&gt; {
      console.log(res.records[0].get('count'))
    })
    .catch((error) =&gt; {
      console.log(error)
    })
})
</pre></div> <h2 id="oracle">Oracle</h2> <p><strong>Module</strong>: <a href="https://github.com/oracle/node-oracledb">oracledb</a></p> <h3 id="installation-7">Installation</h3> <p>NOTE: <a href="https://github.com/oracle/node-oracledb#-installation">See installation prerequisites</a>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install oracledb
</pre></div> <h3 id="example-6">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const oracledb = require('oracledb')
const config = {
  user: '&lt;your db user&gt;',
  password: '&lt;your db password&gt;',
  connectString: 'localhost:1521/orcl'
}

async function getEmployee (empId) {
  let conn

  try {
    conn = await oracledb.getConnection(config)

    const result = await conn.execute(
      'select * from employees where employee_id = :id',
      [empId]
    )

    console.log(result.rows[0])
  } catch (err) {
    console.log('Ouch!', err)
  } finally {
    if (conn) { // conn assignment worked, need to close
      await conn.close()
    }
  }
}

getEmployee(101)
</pre></div> <h2 id="postgresql">PostgreSQL</h2> <p><strong>Module</strong>: <a href="https://github.com/vitaly-t/pg-promise">pg-promise</a></p> <h3 id="installation-8">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install pg-promise
</pre></div> <h3 id="example-7">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const pgp = require('pg-promise')(/* options */)
const db = pgp('postgres://username:password@host:port/database')

db.one('SELECT $1 AS value', 123)
  .then((data) =&gt; {
    console.log('DATA:', data.value)
  })
  .catch((error) =&gt; {
    console.log('ERROR:', error)
  })
</pre></div> <h2 id="redis">Redis</h2> <p><strong>Module</strong>: <a href="https://github.com/mranney/node_redis">redis</a></p> <h3 id="installation-9">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install redis
</pre></div> <h3 id="example-8">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const redis = require('redis')
const client = redis.createClient()

client.on('error', (err) =&gt; {
  console.log(`Error ${err}`)
})

client.set('string key', 'string val', redis.print)
client.hset('hash key', 'hashtest 1', 'some value', redis.print)
client.hset(['hash key', 'hashtest 2', 'some other value'], redis.print)

client.hkeys('hash key', (err, replies) =&gt; {
  console.log(`${replies.length} replies:`)

  replies.forEach((reply, i) =&gt; {
    console.log(`    ${i}: ${reply}`)
  })

  client.quit()
})
</pre></div> <h2 id="sql-server">SQL Server</h2> <p><strong>Module</strong>: <a href="https://github.com/tediousjs/tedious">tedious</a></p> <h3 id="installation-10">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install tedious
</pre></div> <h3 id="example-9">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const Connection = require('tedious').Connection
const Request = require('tedious').Request

const config = {
  server: 'localhost',
  authentication: {
    type: 'default',
    options: {
      userName: 'your_username', // update me
      password: 'your_password' // update me
    }
  }
}

const connection = new Connection(config)

connection.on('connect', (err) =&gt; {
  if (err) {
    console.log(err)
  } else {
    executeStatement()
  }
})

function executeStatement () {
  request = new Request("select 123, 'hello world'", (err, rowCount) =&gt; {
    if (err) {
      console.log(err)
    } else {
      console.log(`${rowCount} rows`)
    }
    connection.close()
  })

  request.on('row', (columns) =&gt; {
    columns.forEach((column) =&gt; {
      if (column.value === null) {
        console.log('NULL')
      } else {
        console.log(column.value)
      }
    })
  })

  connection.execSql(request)
}
</pre></div> <h2 id="sqlite">SQLite</h2> <p><strong>Module</strong>: <a href="https://github.com/mapbox/node-sqlite3">sqlite3</a></p> <h3 id="installation-11">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install sqlite3
</pre></div> <h3 id="example-10">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const sqlite3 = require('sqlite3').verbose()
const db = new sqlite3.Database(':memory:')

db.serialize(() =&gt; {
  db.run('CREATE TABLE lorem (info TEXT)')
  const stmt = db.prepare('INSERT INTO lorem VALUES (?)')

  for (let i = 0; i &lt; 10; i++) {
    stmt.run(`Ipsum ${i}`)
  }

  stmt.finalize()

  db.each('SELECT rowid AS id, info FROM lorem', (err, row) =&gt; {
    console.log(`${row.id}: ${row.info}`)
  })
})

db.close()
</pre></div> <h2 id="elasticsearch">Elasticsearch</h2> <p><strong>Module</strong>: <a href="https://github.com/elastic/elasticsearch-js">elasticsearch</a></p> <h3 id="installation-12">Installation</h3> <div class="highlight"><pre class="highlight" data-language="javascript">$ npm install elasticsearch
</pre></div> <h3 id="example-11">Example</h3> <div class="highlight"><pre class="highlight" data-language="javascript">const elasticsearch = require('elasticsearch')
const client = elasticsearch.Client({
  host: 'localhost:9200'
})

client.search({
  index: 'books',
  type: 'book',
  body: {
    query: {
      multi_match: {
        query: 'express js',
        fields: ['title', 'description']
      }
    }
  }
}).then((response) =&gt; {
  const hits = response.hits.hits
}, (error) =&gt; {
  console.trace(error.message)
})
</pre></div>  <a role="button" class="edit-github-btn" href="https://github.com/expressjs/expressjs.com/edit/gh-pages/en/guide/database-integration.md"> <svg viewbox="0 0 256 250" width="20" height="20" xmlns="http://www.w3.org/2000/svg" fill="currentColor"> <path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path> </svg> Edit this page </a> </main><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2017 StrongLoop, IBM, and other expressjs.com contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v3.0.<br>
    <a href="https://expressjs.com/en/guide/database-integration.html" class="_attribution-link">https://expressjs.com/en/guide/database-integration.html</a>
  </p>
</div>
