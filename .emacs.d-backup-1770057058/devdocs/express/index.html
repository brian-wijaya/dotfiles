<h1>Express</h1>  <main> <div id="api-doc">  <div class="doc-box doc-info"> <p class="doc-title"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" height="24" width="24" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg> Note </p> <p>Express 5.0 requires Node.js 18 or higher.</p> </div> <h2 id="express">express()</h2> <p>Creates an Express application. The <code class="language-plaintext highlighter-rouge">express()</code> function is a top-level function exported by the <code class="language-plaintext highlighter-rouge">express</code> module.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const express = require('express')
const app = express()
</pre></div>  <h3 id="express.methods">Methods</h3>  <h3 id="express.json" class="h2">express.json([options])</h3> <p>This is a built-in middleware function in Express. It parses incoming requests with JSON payloads and is based on <a href="https://expressjs.com/resources/middleware/body-parser.html">body-parser</a>.</p> <p>Returns middleware that only parses JSON and only looks at requests where the <code class="language-plaintext highlighter-rouge">Content-Type</code> header matches the <code class="language-plaintext highlighter-rouge">type</code> option. This parser accepts any Unicode encoding of the body and supports automatic inflation of <code class="language-plaintext highlighter-rouge">gzip</code> and <code class="language-plaintext highlighter-rouge">deflate</code> encodings.</p> <p>A new <code class="language-plaintext highlighter-rouge">body</code> object containing the parsed data is populated on the <code class="language-plaintext highlighter-rouge">request</code> object after the middleware (i.e. <code class="language-plaintext highlighter-rouge">req.body</code>), or <code class="language-plaintext highlighter-rouge">undefined</code> if there was no body to parse, the <code class="language-plaintext highlighter-rouge">Content-Type</code> was not matched, or an error occurred.</p> <div class="doc-box doc-warn"> <p>As <code class="language-plaintext highlighter-rouge">req.body</code>’s shape is based on user-controlled input, all properties and values in this object are untrusted and should be validated before trusting. For example, <code class="language-plaintext highlighter-rouge">req.body.foo.toString()</code> may fail in multiple ways, for example <code class="language-plaintext highlighter-rouge">foo</code> may not be there or may not be a string, and <code class="language-plaintext highlighter-rouge">toString</code> may not be a function and instead a string or other user-input.</p> </div> <p>The following table describes the properties of the optional <code class="language-plaintext highlighter-rouge">options</code> object.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Property</th> <th>Description</th> <th>Type</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">inflate</code></td> <td>Enables or disables handling deflated (compressed) bodies; when disabled, deflated bodies are rejected.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">limit</code></td> <td>Controls the maximum request body size. If this is a number, then the value specifies the number of bytes; if it is a string, the value is passed to the <a href="https://www.npmjs.com/package/bytes">bytes</a> library for parsing.</td> <td>Mixed</td> <td><code class="language-plaintext highlighter-rouge">"100kb"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">reviver</code></td> <td>The <code class="language-plaintext highlighter-rouge">reviver</code> option is passed directly to <code class="language-plaintext highlighter-rouge">JSON.parse</code> as the second argument. You can find more information on this argument <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse#Example.3A_Using_the_reviver_parameter">in the MDN documentation about JSON.parse</a>.</td> <td>Function</td> <td><code class="language-plaintext highlighter-rouge">null</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">strict</code></td> <td>Enables or disables only accepting arrays and objects; when disabled will accept anything <code class="language-plaintext highlighter-rouge">JSON.parse</code> accepts.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">type</code></td> <td>This is used to determine what media type the middleware will parse. This option can be a string, array of strings, or a function. If not a function, <code class="language-plaintext highlighter-rouge">type</code> option is passed directly to the <a href="https://www.npmjs.org/package/type-is#readme">type-is</a> library and this can be an extension name (like <code class="language-plaintext highlighter-rouge">json</code>), a mime type (like <code class="language-plaintext highlighter-rouge">application/json</code>), or a mime type with a wildcard (like <code class="language-plaintext highlighter-rouge">*/*</code> or <code class="language-plaintext highlighter-rouge">*/json</code>). If a function, the <code class="language-plaintext highlighter-rouge">type</code> option is called as <code class="language-plaintext highlighter-rouge">fn(req)</code> and the request is parsed if it returns a truthy value.</td> <td>Mixed</td> <td><code class="language-plaintext highlighter-rouge">"application/json"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">verify</code></td> <td>This option, if supplied, is called as <code class="language-plaintext highlighter-rouge">verify(req, res, buf, encoding)</code>, where <code class="language-plaintext highlighter-rouge">buf</code> is a <code class="language-plaintext highlighter-rouge">Buffer</code> of the raw request body and <code class="language-plaintext highlighter-rouge">encoding</code> is the encoding of the request. The parsing can be aborted by throwing an error.</td> <td>Function</td> <td><code class="language-plaintext highlighter-rouge">undefined</code></td> </tr> </tbody> </table> </div>   <h3 id="express.raw" class="h2">express.raw([options])</h3> <p>This is a built-in middleware function in Express. It parses incoming request payloads into a <code class="language-plaintext highlighter-rouge">Buffer</code> and is based on <a href="https://expressjs.com/resources/middleware/body-parser.html">body-parser</a>.</p> <p>Returns middleware that parses all bodies as a <code class="language-plaintext highlighter-rouge">Buffer</code> and only looks at requests where the <code class="language-plaintext highlighter-rouge">Content-Type</code> header matches the <code class="language-plaintext highlighter-rouge">type</code> option. This parser accepts any Unicode encoding of the body and supports automatic inflation of <code class="language-plaintext highlighter-rouge">gzip</code> and <code class="language-plaintext highlighter-rouge">deflate</code> encodings.</p> <p>A new <code class="language-plaintext highlighter-rouge">body</code> <code class="language-plaintext highlighter-rouge">Buffer</code> containing the parsed data is populated on the <code class="language-plaintext highlighter-rouge">request</code> object after the middleware (i.e. <code class="language-plaintext highlighter-rouge">req.body</code>), or <code class="language-plaintext highlighter-rouge">undefined</code> if there was no body to parse, the <code class="language-plaintext highlighter-rouge">Content-Type</code> was not matched, or an error occurred.</p> <div class="doc-box doc-warn"> <p>As <code class="language-plaintext highlighter-rouge">req.body</code>’s shape is based on user-controlled input, all properties and values in this object are untrusted and should be validated before trusting. For example, <code class="language-plaintext highlighter-rouge">req.body.toString()</code> may fail in multiple ways, for example stacking multiple parsers <code class="language-plaintext highlighter-rouge">req.body</code> may be from a different parser. Testing that <code class="language-plaintext highlighter-rouge">req.body</code> is a <code class="language-plaintext highlighter-rouge">Buffer</code> before calling buffer methods is recommended.</p> </div> <p>The following table describes the properties of the optional <code class="language-plaintext highlighter-rouge">options</code> object.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Property</th> <th>Description</th> <th>Type</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">inflate</code></td> <td>Enables or disables handling deflated (compressed) bodies; when disabled, deflated bodies are rejected.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">limit</code></td> <td>Controls the maximum request body size. If this is a number, then the value specifies the number of bytes; if it is a string, the value is passed to the <a href="https://www.npmjs.com/package/bytes">bytes</a> library for parsing.</td> <td>Mixed</td> <td><code class="language-plaintext highlighter-rouge">"100kb"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">type</code></td> <td>This is used to determine what media type the middleware will parse. This option can be a string, array of strings, or a function. If not a function, <code class="language-plaintext highlighter-rouge">type</code> option is passed directly to the <a href="https://www.npmjs.org/package/type-is#readme">type-is</a> library and this can be an extension name (like <code class="language-plaintext highlighter-rouge">bin</code>), a mime type (like <code class="language-plaintext highlighter-rouge">application/octet-stream</code>), or a mime type with a wildcard (like <code class="language-plaintext highlighter-rouge">*/*</code> or <code class="language-plaintext highlighter-rouge">application/*</code>). If a function, the <code class="language-plaintext highlighter-rouge">type</code> option is called as <code class="language-plaintext highlighter-rouge">fn(req)</code> and the request is parsed if it returns a truthy value.</td> <td>Mixed</td> <td><code class="language-plaintext highlighter-rouge">"application/octet-stream"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">verify</code></td> <td>This option, if supplied, is called as <code class="language-plaintext highlighter-rouge">verify(req, res, buf, encoding)</code>, where <code class="language-plaintext highlighter-rouge">buf</code> is a <code class="language-plaintext highlighter-rouge">Buffer</code> of the raw request body and <code class="language-plaintext highlighter-rouge">encoding</code> is the encoding of the request. The parsing can be aborted by throwing an error.</td> <td>Function</td> <td><code class="language-plaintext highlighter-rouge">undefined</code></td> </tr> </tbody> </table> </div>   <h3 id="express.router" class="h2">express.Router([options])</h3> <p>Creates a new <a href="#router">router</a> object.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const router = express.Router([options])
</pre></div>  <p>The optional <code class="language-plaintext highlighter-rouge">options</code> parameter specifies the behavior of the router.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Property</th> <th>Description</th> <th>Default</th> <th>Availability</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">caseSensitive</code></td> <td>Enable case sensitivity.</td> <td>Disabled by default, treating “/Foo” and “/foo” as the same.</td> <td> </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">mergeParams</code></td> <td>Preserve the <code class="language-plaintext highlighter-rouge">req.params</code> values from the parent router. If the parent and the child have conflicting param names, the child’s value take precedence.</td> <td><code class="language-plaintext highlighter-rouge">false</code></td> <td>4.5.0+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">strict</code></td> <td>Enable strict routing.</td> <td>Disabled by default, “/foo” and “/foo/” are treated the same by the router.</td> <td> </td> </tr> </tbody> </table> </div> <p>You can add middleware and HTTP method routes (such as <code class="language-plaintext highlighter-rouge">get</code>, <code class="language-plaintext highlighter-rouge">put</code>, <code class="language-plaintext highlighter-rouge">post</code>, and so on) to <code class="language-plaintext highlighter-rouge">router</code> just like an application.</p> <p>For more information, see <a href="#router">Router</a>.</p>   <h3 id="express.static" class="h2">express.static(root, [options])</h3> <p>This is a built-in middleware function in Express. It serves static files and is based on <a href="https://expressjs.com/resources/middleware/serve-static.html">serve-static</a>.</p> <div class="doc-box doc-info"> <p>NOTE: For best results, <a href="advanced/best-practice-performance#use-a-reverse-proxy">use a reverse proxy</a> cache to improve performance of serving static assets.</p> </div> <p>The <code class="language-plaintext highlighter-rouge">root</code> argument specifies the root directory from which to serve static assets. The function determines the file to serve by combining <code class="language-plaintext highlighter-rouge">req.url</code> with the provided <code class="language-plaintext highlighter-rouge">root</code> directory. When a file is not found, instead of sending a 404 response, it instead calls <code class="language-plaintext highlighter-rouge">next()</code> to move on to the next middleware, allowing for stacking and fall-backs.</p> <p>The following table describes the properties of the <code class="language-plaintext highlighter-rouge">options</code> object. See also the <a href="#example.of.express.static">example below</a>.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Property</th> <th>Description</th> <th>Type</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">dotfiles</code></td> <td>Determines how dotfiles (files or directories that begin with a dot “.”) are treated. <br><br>See <a href="#dotfiles">dotfiles</a> below.</td> <td>String</td> <td>“ignore”</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">etag</code></td> <td>Enable or disable etag generation <br><br>NOTE: <code class="language-plaintext highlighter-rouge">express.static</code> always sends weak ETags.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">extensions</code></td> <td>Sets file extension fallbacks: If a file is not found, search for files with the specified extensions and serve the first one found. Example: <code class="language-plaintext highlighter-rouge">['html', 'htm']</code>.</td> <td>Mixed</td> <td><code class="language-plaintext highlighter-rouge">false</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">fallthrough</code></td> <td>Let client errors fall-through as unhandled requests, otherwise forward a client error. <br><br>See <a href="#fallthrough">fallthrough</a> below.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">immutable</code></td> <td>Enable or disable the <code class="language-plaintext highlighter-rouge">immutable</code> directive in the <code class="language-plaintext highlighter-rouge">Cache-Control</code> response header. If enabled, the <code class="language-plaintext highlighter-rouge">maxAge</code> option should also be specified to enable caching. The <code class="language-plaintext highlighter-rouge">immutable</code> directive will prevent supported clients from making conditional requests during the life of the <code class="language-plaintext highlighter-rouge">maxAge</code> option to check if the file has changed.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">false</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">index</code></td> <td>Sends the specified directory index file. Set to <code class="language-plaintext highlighter-rouge">false</code> to disable directory indexing.</td> <td>Mixed</td> <td>“index.html”</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">lastModified</code></td> <td>Set the <code class="language-plaintext highlighter-rouge">Last-Modified</code> header to the last modified date of the file on the OS.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">maxAge</code></td> <td>Set the max-age property of the Cache-Control header in milliseconds or a string in <a href="https://www.npmjs.org/package/ms">ms format</a>.</td> <td>Number</td> <td>0</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">redirect</code></td> <td>Redirect to trailing “/” when the pathname is a directory.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">setHeaders</code></td> <td>Function for setting HTTP headers to serve with the file. <br><br>See <a href="#setHeaders">setHeaders</a> below.</td> <td>Function</td> <td> </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">acceptRanges</code></td> <td>Enable or disable accepting ranged requests. Disabling this will not send the Accept-Ranges header and will ignore the contents of the Range request header.</td> <td>Boolean</td> <td>true</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">cacheControl</code></td> <td>Enable or disable setting the Cache-Control response header. Disabling this will ignore the immutable and maxAge options.</td> <td>Boolean</td> <td>true</td> </tr> </tbody> </table> </div> <p>For more information, see <a href="https://expressjs.com/starter/static-files.html">Serving static files in Express</a>. and <a href="guide/using-middleware#middleware.built-in">Using middleware - Built-in middleware</a>.</p> <h5 id="dotfiles"> dotfiles</h5> <p>Possible values for this option are:</p> <ul> <li>“allow” - No special treatment for dotfiles.</li> <li>“deny” - Deny a request for a dotfile, respond with <code class="language-plaintext highlighter-rouge">403</code>, then call <code class="language-plaintext highlighter-rouge">next()</code>.</li> <li>“ignore” - Act as if the dotfile does not exist, respond with <code class="language-plaintext highlighter-rouge">404</code>, then call <code class="language-plaintext highlighter-rouge">next()</code>.</li> </ul> <h5 id="fallthrough">fallthrough</h5> <p>When this option is <code class="language-plaintext highlighter-rouge">true</code>, client errors such as a bad request or a request to a non-existent file will cause this middleware to simply call <code class="language-plaintext highlighter-rouge">next()</code> to invoke the next middleware in the stack. When false, these errors (even 404s), will invoke <code class="language-plaintext highlighter-rouge">next(err)</code>.</p> <p>Set this option to <code class="language-plaintext highlighter-rouge">true</code> so you can map multiple physical directories to the same web address or for routes to fill in non-existent files.</p> <p>Use <code class="language-plaintext highlighter-rouge">false</code> if you have mounted this middleware at a path designed to be strictly a single file system directory, which allows for short-circuiting 404s for less overhead. This middleware will also reply to all methods.</p> <h5 id="setHeaders">setHeaders</h5> <p>For this option, specify a function to set custom response headers. Alterations to the headers must occur synchronously.</p> <p>The signature of the function is:</p> <div class="highlight"><pre class="highlight" data-language="javascript">fn(res, path, stat)
</pre></div>  <p>Arguments:</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">res</code>, the <a href="#res">response object</a>.</li> <li>
<code class="language-plaintext highlighter-rouge">path</code>, the file path that is being sent.</li> <li>
<code class="language-plaintext highlighter-rouge">stat</code>, the <code class="language-plaintext highlighter-rouge">stat</code> object of the file that is being sent.</li> </ul> <h4 id="example.of.express.static">Example of express.static</h4> <p>Here is an example of using the <code class="language-plaintext highlighter-rouge">express.static</code> middleware function with an elaborate options object:</p> <div class="highlight"><pre class="highlight" data-language="javascript">const options = {
  dotfiles: 'ignore',
  etag: false,
  extensions: ['htm', 'html'],
  index: false,
  maxAge: '1d',
  redirect: false,
  setHeaders (res, path, stat) {
    res.set('x-timestamp', Date.now())
  }
}

app.use(express.static('public', options))
</pre></div>    <h3 id="express.text" class="h2">express.text([options])</h3> <p>This is a built-in middleware function in Express. It parses incoming request payloads into a string and is based on <a href="https://expressjs.com/resources/middleware/body-parser.html">body-parser</a>.</p> <p>Returns middleware that parses all bodies as a string and only looks at requests where the <code class="language-plaintext highlighter-rouge">Content-Type</code> header matches the <code class="language-plaintext highlighter-rouge">type</code> option. This parser accepts any Unicode encoding of the body and supports automatic inflation of <code class="language-plaintext highlighter-rouge">gzip</code> and <code class="language-plaintext highlighter-rouge">deflate</code> encodings.</p> <p>A new <code class="language-plaintext highlighter-rouge">body</code> string containing the parsed data is populated on the <code class="language-plaintext highlighter-rouge">request</code> object after the middleware (i.e. <code class="language-plaintext highlighter-rouge">req.body</code>), or <code class="language-plaintext highlighter-rouge">undefined</code> if there was no body to parse, the <code class="language-plaintext highlighter-rouge">Content-Type</code> was not matched, or an error occurred.</p> <div class="doc-box doc-warn"> <p>As <code class="language-plaintext highlighter-rouge">req.body</code>’s shape is based on user-controlled input, all properties and values in this object are untrusted and should be validated before trusting. For example, <code class="language-plaintext highlighter-rouge">req.body.trim()</code> may fail in multiple ways, for example stacking multiple parsers <code class="language-plaintext highlighter-rouge">req.body</code> may be from a different parser. Testing that <code class="language-plaintext highlighter-rouge">req.body</code> is a string before calling string methods is recommended.</p> </div> <p>The following table describes the properties of the optional <code class="language-plaintext highlighter-rouge">options</code> object.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Property</th> <th>Description</th> <th>Type</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">defaultCharset</code></td> <td>Specify the default character set for the text content if the charset is not specified in the <code class="language-plaintext highlighter-rouge">Content-Type</code> header of the request.</td> <td>String</td> <td><code class="language-plaintext highlighter-rouge">"utf-8"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">inflate</code></td> <td>Enables or disables handling deflated (compressed) bodies; when disabled, deflated bodies are rejected.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">limit</code></td> <td>Controls the maximum request body size. If this is a number, then the value specifies the number of bytes; if it is a string, the value is passed to the <a href="https://www.npmjs.com/package/bytes">bytes</a> library for parsing.</td> <td>Mixed</td> <td><code class="language-plaintext highlighter-rouge">"100kb"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">type</code></td> <td>This is used to determine what media type the middleware will parse. This option can be a string, array of strings, or a function. If not a function, <code class="language-plaintext highlighter-rouge">type</code> option is passed directly to the <a href="https://www.npmjs.org/package/type-is#readme">type-is</a> library and this can be an extension name (like <code class="language-plaintext highlighter-rouge">txt</code>), a mime type (like <code class="language-plaintext highlighter-rouge">text/plain</code>), or a mime type with a wildcard (like <code class="language-plaintext highlighter-rouge">*/*</code> or <code class="language-plaintext highlighter-rouge">text/*</code>). If a function, the <code class="language-plaintext highlighter-rouge">type</code> option is called as <code class="language-plaintext highlighter-rouge">fn(req)</code> and the request is parsed if it returns a truthy value.</td> <td>Mixed</td> <td><code class="language-plaintext highlighter-rouge">"text/plain"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">verify</code></td> <td>This option, if supplied, is called as <code class="language-plaintext highlighter-rouge">verify(req, res, buf, encoding)</code>, where <code class="language-plaintext highlighter-rouge">buf</code> is a <code class="language-plaintext highlighter-rouge">Buffer</code> of the raw request body and <code class="language-plaintext highlighter-rouge">encoding</code> is the encoding of the request. The parsing can be aborted by throwing an error.</td> <td>Function</td> <td><code class="language-plaintext highlighter-rouge">undefined</code></td> </tr> </tbody> </table> </div>   <h3 id="express.urlencoded" class="h2">express.urlencoded([options])</h3> <p>This is a built-in middleware function in Express. It parses incoming requests with urlencoded payloads and is based on <a href="https://expressjs.com/resources/middleware/body-parser.html">body-parser</a>.</p> <p>Returns middleware that only parses urlencoded bodies and only looks at requests where the <code class="language-plaintext highlighter-rouge">Content-Type</code> header matches the <code class="language-plaintext highlighter-rouge">type</code> option. This parser accepts only UTF-8 encoding of the body and supports automatic inflation of <code class="language-plaintext highlighter-rouge">gzip</code> and <code class="language-plaintext highlighter-rouge">deflate</code> encodings.</p> <p>A new <code class="language-plaintext highlighter-rouge">body</code> object containing the parsed data is populated on the <code class="language-plaintext highlighter-rouge">request</code> object after the middleware (i.e. <code class="language-plaintext highlighter-rouge">req.body</code>), or <code class="language-plaintext highlighter-rouge">undefined</code> if there was no body to parse, the <code class="language-plaintext highlighter-rouge">Content-Type</code> was not matched, or an error occurred. This object will contain key-value pairs, where the value can be a string or array (when <code class="language-plaintext highlighter-rouge">extended</code> is <code class="language-plaintext highlighter-rouge">false</code>), or any type (when <code class="language-plaintext highlighter-rouge">extended</code> is <code class="language-plaintext highlighter-rouge">true</code>).</p> <div class="doc-box doc-warn"> <p>As <code class="language-plaintext highlighter-rouge">req.body</code>’s shape is based on user-controlled input, all properties and values in this object are untrusted and should be validated before trusting. For example, <code class="language-plaintext highlighter-rouge">req.body.foo.toString()</code> may fail in multiple ways, for example <code class="language-plaintext highlighter-rouge">foo</code> may not be there or may not be a string, and <code class="language-plaintext highlighter-rouge">toString</code> may not be a function and instead a string or other user-input.</p> </div> <p>The following table describes the properties of the optional <code class="language-plaintext highlighter-rouge">options</code> object.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Property</th> <th>Description</th> <th>Type</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">extended</code></td> <td>This option allows to choose between parsing the URL-encoded data with the <code class="language-plaintext highlighter-rouge">querystring</code> library (when <code class="language-plaintext highlighter-rouge">false</code>) or the <code class="language-plaintext highlighter-rouge">qs</code> library (when <code class="language-plaintext highlighter-rouge">true</code>). The “extended” syntax allows for rich objects and arrays to be encoded into the URL-encoded format, allowing for a JSON-like experience with URL-encoded. For more information, please <a href="https://www.npmjs.org/package/qs#readme">see the qs library</a>.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">false</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">inflate</code></td> <td>Enables or disables handling deflated (compressed) bodies; when disabled, deflated bodies are rejected.</td> <td>Boolean</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">limit</code></td> <td>Controls the maximum request body size. If this is a number, then the value specifies the number of bytes; if it is a string, the value is passed to the <a href="https://www.npmjs.com/package/bytes">bytes</a> library for parsing.</td> <td>Mixed</td> <td><code class="language-plaintext highlighter-rouge">"100kb"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">parameterLimit</code></td> <td>This option controls the maximum number of parameters that are allowed in the URL-encoded data. If a request contains more parameters than this value, an error will be raised.</td> <td>Number</td> <td><code class="language-plaintext highlighter-rouge">1000</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">type</code></td> <td>This is used to determine what media type the middleware will parse. This option can be a string, array of strings, or a function. If not a function, <code class="language-plaintext highlighter-rouge">type</code> option is passed directly to the <a href="https://www.npmjs.org/package/type-is#readme">type-is</a> library and this can be an extension name (like <code class="language-plaintext highlighter-rouge">urlencoded</code>), a mime type (like <code class="language-plaintext highlighter-rouge">application/x-www-form-urlencoded</code>), or a mime type with a wildcard (like <code class="language-plaintext highlighter-rouge">*/x-www-form-urlencoded</code>). If a function, the <code class="language-plaintext highlighter-rouge">type</code> option is called as <code class="language-plaintext highlighter-rouge">fn(req)</code> and the request is parsed if it returns a truthy value.</td> <td>Mixed</td> <td><code class="language-plaintext highlighter-rouge">"application/x-www-form-urlencoded"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">verify</code></td> <td>This option, if supplied, is called as <code class="language-plaintext highlighter-rouge">verify(req, res, buf, encoding)</code>, where <code class="language-plaintext highlighter-rouge">buf</code> is a <code class="language-plaintext highlighter-rouge">Buffer</code> of the raw request body and <code class="language-plaintext highlighter-rouge">encoding</code> is the encoding of the request. The parsing can be aborted by throwing an error.</td> <td>Function</td> <td><code class="language-plaintext highlighter-rouge">undefined</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">depth</code></td> <td>Configure the maximum depth of the <code class="language-plaintext highlighter-rouge">qs</code> library when <code class="language-plaintext highlighter-rouge">extended</code> is <code class="language-plaintext highlighter-rouge">true</code>. This allows you to limit the amount of keys that are parsed and can be useful to prevent certain types of abuse. Defaults to <code class="language-plaintext highlighter-rouge">32</code>. It is recommended to keep this value as low as possible.</td> <td>Number</td> <td><code class="language-plaintext highlighter-rouge">32</code></td> </tr> </tbody> </table> </div>  <h2 id="app">Application</h2> <p>The <code class="language-plaintext highlighter-rouge">app</code> object conventionally denotes the Express application. Create it by calling the top-level <code class="language-plaintext highlighter-rouge">express()</code> function exported by the Express module:</p> <div class="highlight"><pre class="highlight" data-language="javascript">const express = require('express')
const app = express()

app.get('/', (req, res) =&gt; {
  res.send('hello world')
})

app.listen(3000)
</pre></div>  <p>The <code class="language-plaintext highlighter-rouge">app</code> object has methods for</p> <ul> <li>Routing HTTP requests; see for example, <a href="#app.METHOD">app.METHOD</a> and <a href="#app.param">app.param</a>.</li> <li>Configuring middleware; see <a href="#app.route">app.route</a>.</li> <li>Rendering HTML views; see <a href="#app.render">app.render</a>.</li> <li>Registering a template engine; see <a href="#app.engine">app.engine</a>.</li> </ul> <p>It also has settings (properties) that affect how the application behaves; for more information, see <a href="#app.settings.table">Application settings</a>.</p> <div class="doc-box doc-info"> <p>The Express application object can be referred from the <a href="#req">request object</a> and the <a href="#res">response object</a> as <code class="language-plaintext highlighter-rouge">req.app</code>, and <code class="language-plaintext highlighter-rouge">res.app</code>, respectively.</p> </div> <h3 id="app.properties">Properties</h3>  <h3 id="app.locals">app.locals</h3> <p>The <code class="language-plaintext highlighter-rouge">app.locals</code> object has properties that are local variables within the application, and will be available in templates rendered with <a href="#res.render">res.render</a>.</p> <div class="doc-box doc-warn"> <p>The <code class="language-plaintext highlighter-rouge">locals</code> object is used by view engines to render a response. The object keys may be particularly sensitive and should not contain user-controlled input, as it may affect the operation of the view engine or provide a path to cross-site scripting. Consult the documentation for the used view engine for additional considerations.</p> </div> <div class="highlight"><pre class="highlight" data-language="javascript">console.dir(app.locals.title)
// =&gt; 'My App'

console.dir(app.locals.email)
// =&gt; 'me@myapp.com'
</pre></div>  <p>Once set, the value of <code class="language-plaintext highlighter-rouge">app.locals</code> properties persist throughout the life of the application, in contrast with <a href="#res.locals">res.locals</a> properties that are valid only for the lifetime of the request.</p> <p>You can access local variables in templates rendered within the application. This is useful for providing helper functions to templates, as well as application-level data. Local variables are available in middleware via <code class="language-plaintext highlighter-rouge">req.app.locals</code> (see <a href="#req.app">req.app</a>)</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.locals.title = 'My App'
app.locals.strftime = require('strftime')
app.locals.email = 'me@myapp.com'
</pre></div>    <h3 id="app.mountpath">app.mountpath</h3> <p>The <code class="language-plaintext highlighter-rouge">app.mountpath</code> property contains one or more path patterns on which a sub-app was mounted.</p> <div class="doc-box doc-info"> <p>A sub-app is an instance of <code class="language-plaintext highlighter-rouge">express</code> that may be used for handling the request to a route.</p> </div> <div class="highlight"><pre class="highlight" data-language="javascript">const express = require('express')

const app = express() // the main app
const admin = express() // the sub app

admin.get('/', (req, res) =&gt; {
  console.log(admin.mountpath) // /admin
  res.send('Admin Homepage')
})

app.use('/admin', admin) // mount the sub app
</pre></div>  <p>It is similar to the <a href="#req.baseUrl">baseUrl</a> property of the <code class="language-plaintext highlighter-rouge">req</code> object, except <code class="language-plaintext highlighter-rouge">req.baseUrl</code> returns the matched URL path, instead of the matched patterns.</p> <p>If a sub-app is mounted on multiple path patterns, <code class="language-plaintext highlighter-rouge">app.mountpath</code> returns the list of patterns it is mounted on, as shown in the following example.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const admin = express()

admin.get('/', (req, res) =&gt; {
  console.log(admin.mountpath) // [ '/adm{*splat}n', '/manager' ]
  res.send('Admin Homepage')
})

const secret = express()
secret.get('/', (req, res) =&gt; {
  console.log(secret.mountpath) // /secr{*splat}t
  res.send('Admin Secret')
})

admin.use('/secr{*splat}t', secret) // load the 'secret' router on '/secr{*splat}t', on the 'admin' sub app
app.use(['/adm{*splat}n', '/manager'], admin) // load the 'admin' router on '/adm{*splat}n' and '/manager', on the parent app
</pre></div>    <h3 id="app.router">app.router</h3> <p>The application’s in-built instance of router. This is created lazily, on first access.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const express = require('express')
const app = express()
const router = app.router

router.get('/', (req, res) =&gt; {
  res.send('hello world')
})

app.listen(3000)
</pre></div>  <p>You can add middleware and HTTP method routes to the <code class="language-plaintext highlighter-rouge">router</code> just like an application.</p> <p>For more information, see <a href="#router">Router</a>.</p>  <h3 id="app.events">Events</h3>  <h3 id="app.onmount">app.on('mount', callback(parent))</h3> <p>The <code class="language-plaintext highlighter-rouge">mount</code> event is fired on a sub-app, when it is mounted on a parent app. The parent app is passed to the callback function.</p> <div class="doc-box doc-info"> <p><strong>NOTE</strong></p> <p>Sub-apps will:</p> <ul> <li>Not inherit the value of settings that have a default value. You must set the value in the sub-app.</li> <li>Inherit the value of settings with no default value.</li> </ul> <p>For details, see <a href="5x/api#app.settings.table">Application settings</a>.</p> </div> <div class="highlight"><pre class="highlight" data-language="javascript">const admin = express()

admin.on('mount', (parent) =&gt; {
  console.log('Admin Mounted')
  console.log(parent) // refers to the parent app
})

admin.get('/', (req, res) =&gt; {
  res.send('Admin Homepage')
})

app.use('/admin', admin)
</pre></div>   <h3 id="app.methods">Methods</h3>  <h3 id="app.all">app.all(path, callback [, callback ...])</h3> <p>This method is like the standard <a href="#app.METHOD">app.METHOD()</a> methods, except it matches all HTTP verbs.</p> <h4>Arguments</h4> <div class="table-scroller"> <table> <thead> <tr> <th>Argument</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>path</code></td> <td> The path for which the middleware function is invoked. It can be any of the following: <ul> <li>A string representing a path.</li> <li>A path pattern.</li> <li>A regular expression pattern to match paths.</li> <li>An array containing any combination of the above.</li> </ul> For examples, see <a href="#path-examples">Path examples</a>. </td> <td>
<code>'/'</code> (root path)</td> </tr> <tr> <td><code>callback</code></td> <td> One or more callback functions. Accepted formats: <ul> <li>A single middleware function.</li> <li>Multiple middleware functions separated by commas.</li> <li>An array of middleware functions.</li> <li>A combination of the above.</li> </ul> <p> You may provide multiple callbacks that behave like middleware. These can call <code>next('route')</code> to skip remaining callbacks for the current route. This is useful for conditional routing logic. </p> <p> If a callback throws an error or returns a rejected promise, <code>next(err)</code> is invoked automatically. </p> <p> Since both <a href="#router">router</a> and <a href="#application">app</a> implement the middleware interface, they can also be used as callback middleware. </p> <p> For examples, see <a href="#middleware-callback-function-examples">Middleware callback function examples</a>. </p> </td> <td><em>None</em></td> </tr> </tbody> </table> </div> <h4 id="examples">Examples</h4> <p>The following callback is executed for requests to <code class="language-plaintext highlighter-rouge">/secret</code> whether using GET, POST, PUT, DELETE, or any other HTTP request method:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.all('/secret', (req, res, next) =&gt; {
  console.log('Accessing the secret section ...')
  next() // pass control to the next handler
})
</pre></div>  <p>The <code class="language-plaintext highlighter-rouge">app.all()</code> method is useful for mapping “global” logic for specific path prefixes or arbitrary matches. For example, if you put the following at the top of all other route definitions, it requires that all routes from that point on require authentication, and automatically load a user. Keep in mind that these callbacks do not have to act as end-points: <code class="language-plaintext highlighter-rouge">loadUser</code> can perform a task, then call <code class="language-plaintext highlighter-rouge">next()</code> to continue matching subsequent routes.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.all('{*splat}', requireAuthentication, loadUser)
</pre></div>  <p>Or the equivalent:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.all('{*splat}', requireAuthentication)
app.all('{*splat}', loadUser)
</pre></div>  <p>Another example is white-listed “global” functionality. The example is similar to the ones above, but it only restricts paths that start with “/api”:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.all('/api/{*splat}', requireAuthentication)
</pre></div>    <h3 id="app.delete.method">app.delete(path, callback [, callback ...])</h3> <p>Routes HTTP DELETE requests to the specified path with the specified callback functions. For more information, see the <a href="guide/routing">routing guide</a>.</p> <h4>Arguments</h4> <div class="table-scroller"> <table> <thead> <tr> <th>Argument</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>path</code></td> <td> The path for which the middleware function is invoked. It can be any of the following: <ul> <li>A string representing a path.</li> <li>A path pattern.</li> <li>A regular expression pattern to match paths.</li> <li>An array containing any combination of the above.</li> </ul> For examples, see <a href="#path-examples">Path examples</a>. </td> <td>
<code>'/'</code> (root path)</td> </tr> <tr> <td><code>callback</code></td> <td> One or more callback functions. Accepted formats: <ul> <li>A single middleware function.</li> <li>Multiple middleware functions separated by commas.</li> <li>An array of middleware functions.</li> <li>A combination of the above.</li> </ul> <p> You may provide multiple callbacks that behave like middleware. These can call <code>next('route')</code> to skip remaining callbacks for the current route. This is useful for conditional routing logic. </p> <p> If a callback throws an error or returns a rejected promise, <code>next(err)</code> is invoked automatically. </p> <p> Since both <a href="#router">router</a> and <a href="#application">app</a> implement the middleware interface, they can also be used as callback middleware. </p> <p> For examples, see <a href="#middleware-callback-function-examples">Middleware callback function examples</a>. </p> </td> <td><em>None</em></td> </tr> </tbody> </table> </div> <h4 id="example">Example</h4> <div class="highlight"><pre class="highlight" data-language="javascript">app.delete('/', (req, res) =&gt; {
  res.send('DELETE request to homepage')
})
</pre></div>    <h3 id="app.disable">app.disable(name)</h3> <p>Sets the Boolean setting <code class="language-plaintext highlighter-rouge">name</code> to <code class="language-plaintext highlighter-rouge">false</code>, where <code class="language-plaintext highlighter-rouge">name</code> is one of the properties from the <a href="#app.settings.table">app settings table</a>. Calling <code class="language-plaintext highlighter-rouge">app.set('foo', false)</code> for a Boolean property is the same as calling <code class="language-plaintext highlighter-rouge">app.disable('foo')</code>.</p> <p>For example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.disable('trust proxy')
app.get('trust proxy')
// =&gt; false
</pre></div>    <h3 id="app.disabled">app.disabled(name)</h3> <p>Returns <code class="language-plaintext highlighter-rouge">true</code> if the Boolean setting <code class="language-plaintext highlighter-rouge">name</code> is disabled (<code class="language-plaintext highlighter-rouge">false</code>), where <code class="language-plaintext highlighter-rouge">name</code> is one of the properties from the <a href="#app.settings.table">app settings table</a>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.disabled('trust proxy')
// =&gt; true

app.enable('trust proxy')
app.disabled('trust proxy')
// =&gt; false
</pre></div>    <h3 id="app.enable">app.enable(name)</h3> <p>Sets the Boolean setting <code class="language-plaintext highlighter-rouge">name</code> to <code class="language-plaintext highlighter-rouge">true</code>, where <code class="language-plaintext highlighter-rouge">name</code> is one of the properties from the <a href="#app.settings.table">app settings table</a>. Calling <code class="language-plaintext highlighter-rouge">app.set('foo', true)</code> for a Boolean property is the same as calling <code class="language-plaintext highlighter-rouge">app.enable('foo')</code>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.enable('trust proxy')
app.get('trust proxy')
// =&gt; true
</pre></div>    <h3 id="app.enabled">app.enabled(name)</h3> <p>Returns <code class="language-plaintext highlighter-rouge">true</code> if the setting <code class="language-plaintext highlighter-rouge">name</code> is enabled (<code class="language-plaintext highlighter-rouge">true</code>), where <code class="language-plaintext highlighter-rouge">name</code> is one of the properties from the <a href="#app.settings.table">app settings table</a>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.enabled('trust proxy')
// =&gt; false

app.enable('trust proxy')
app.enabled('trust proxy')
// =&gt; true
</pre></div>    <h3 id="app.engine">app.engine(ext, callback)</h3> <p>Registers the given template engine <code class="language-plaintext highlighter-rouge">callback</code> as <code class="language-plaintext highlighter-rouge">ext</code>.</p> <p>By default, Express will <code class="language-plaintext highlighter-rouge">require()</code> the engine based on the file extension. For example, if you try to render a “foo.pug” file, Express invokes the following internally, and caches the <code class="language-plaintext highlighter-rouge">require()</code> on subsequent calls to increase performance.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.engine('pug', require('pug').__express)
</pre></div>  <p>Use this method for engines that do not provide <code class="language-plaintext highlighter-rouge">.__express</code> out of the box, or if you wish to “map” a different extension to the template engine.</p> <p>For example, to map the EJS template engine to “.html” files:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.engine('html', require('ejs').renderFile)
</pre></div>  <p>In this case, EJS provides a <code class="language-plaintext highlighter-rouge">.renderFile()</code> method with the same signature that Express expects: <code class="language-plaintext highlighter-rouge">(path, options, callback)</code>, though note that it aliases this method as <code class="language-plaintext highlighter-rouge">ejs.__express</code> internally so if you’re using “.ejs” extensions you don’t need to do anything.</p> <p>Some template engines do not follow this convention. The <a href="https://github.com/tj/consolidate.js">consolidate.js</a> library maps Node template engines to follow this convention, so they work seamlessly with Express.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const engines = require('consolidate')
app.engine('haml', engines.haml)
app.engine('html', engines.hogan)
</pre></div>    <h3 id="app.get">app.get(name)</h3> <p>Returns the value of <code class="language-plaintext highlighter-rouge">name</code> app setting, where <code class="language-plaintext highlighter-rouge">name</code> is one of the strings in the <a href="#app.settings.table">app settings table</a>. For example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.get('title')
// =&gt; undefined

app.set('title', 'My Site')
app.get('title')
// =&gt; "My Site"
</pre></div>    <h3 id="app.get.method">app.get(path, callback [, callback ...])</h3> <p>Routes HTTP GET requests to the specified path with the specified callback functions.</p> <h4>Arguments</h4> <div class="table-scroller"> <table> <thead> <tr> <th>Argument</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>path</code></td> <td> The path for which the middleware function is invoked. It can be any of the following: <ul> <li>A string representing a path.</li> <li>A path pattern.</li> <li>A regular expression pattern to match paths.</li> <li>An array containing any combination of the above.</li> </ul> For examples, see <a href="#path-examples">Path examples</a>. </td> <td>
<code>'/'</code> (root path)</td> </tr> <tr> <td><code>callback</code></td> <td> One or more callback functions. Accepted formats: <ul> <li>A single middleware function.</li> <li>Multiple middleware functions separated by commas.</li> <li>An array of middleware functions.</li> <li>A combination of the above.</li> </ul> <p> You may provide multiple callbacks that behave like middleware. These can call <code>next('route')</code> to skip remaining callbacks for the current route. This is useful for conditional routing logic. </p> <p> If a callback throws an error or returns a rejected promise, <code>next(err)</code> is invoked automatically. </p> <p> Since both <a href="#router">router</a> and <a href="#application">app</a> implement the middleware interface, they can also be used as callback middleware. </p> <p> For examples, see <a href="#middleware-callback-function-examples">Middleware callback function examples</a>. </p> </td> <td><em>None</em></td> </tr> </tbody> </table> </div> <p>For more information, see the <a href="guide/routing">routing guide</a>.</p> <h4 id="example-1">Example</h4> <div class="highlight"><pre class="highlight" data-language="javascript">app.get('/', (req, res) =&gt; {
  res.send('GET request to homepage')
})
</pre></div>    <h3 id="app.listen_path_callback">app.listen(path, [callback])</h3> <p>Starts a UNIX socket and listens for connections on the given path. This method is identical to Node’s <a href="https://nodejs.org/api/http.html#http_server_listen">http.Server.listen()</a>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const express = require('express')
const app = express()
app.listen('/tmp/sock')
</pre></div>  <h3 id="app.listen">app.listen([port[, host[, backlog]]][, callback])</h3> <p>Binds and listens for connections on the specified host and port. This method is identical to Node’s <a href="https://nodejs.org/api/http.html#http_server_listen">http.Server.listen()</a>.</p> <p>If port is omitted or is 0, the operating system will assign an arbitrary unused port, which is useful for cases like automated tasks (tests, etc.).</p> <div class="highlight"><pre class="highlight" data-language="javascript">const express = require('express')
const app = express()
app.listen(3000)
</pre></div>  <p>The <code class="language-plaintext highlighter-rouge">app</code> returned by <code class="language-plaintext highlighter-rouge">express()</code> is in fact a JavaScript <code class="language-plaintext highlighter-rouge">Function</code>, designed to be passed to Node’s HTTP servers as a callback to handle requests. This makes it easy to provide both HTTP and HTTPS versions of your app with the same code base, as the app does not inherit from these (it is simply a callback):</p> <div class="highlight"><pre class="highlight" data-language="javascript">const express = require('express')
const https = require('https')
const http = require('http')
const app = express()

http.createServer(app).listen(80)
https.createServer(options, app).listen(443)
</pre></div>  <p>The <code class="language-plaintext highlighter-rouge">app.listen()</code> method returns an <a href="https://nodejs.org/api/http.html#http_class_http_server">http.Server</a> object and (for HTTP) is a convenience method for the following:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.listen = function () {
  const server = http.createServer(this)
  return server.listen.apply(server, arguments)
}
</pre></div>  <div class="doc-box doc-info"> <p class="doc-title"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" height="24" width="24" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg> Note </p> <p>All the forms of Node’s <a href="https://nodejs.org/api/http.html#http_server_listen">http.Server.listen()</a> method are in fact actually supported.</p> </div>   <h3 id="app.METHOD">app.METHOD(path, callback [, callback ...])</h3> <p>Routes an HTTP request, where METHOD is the HTTP method of the request, such as GET, PUT, POST, and so on, in lowercase. Thus, the actual methods are <code class="language-plaintext highlighter-rouge">app.get()</code>, <code class="language-plaintext highlighter-rouge">app.post()</code>, <code class="language-plaintext highlighter-rouge">app.put()</code>, and so on. See <a href="#routing-methods">Routing methods</a> below for the complete list.</p> <h4>Arguments</h4> <div class="table-scroller"> <table> <thead> <tr> <th>Argument</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>path</code></td> <td> The path for which the middleware function is invoked. It can be any of the following: <ul> <li>A string representing a path.</li> <li>A path pattern.</li> <li>A regular expression pattern to match paths.</li> <li>An array containing any combination of the above.</li> </ul> For examples, see <a href="#path-examples">Path examples</a>. </td> <td>
<code>'/'</code> (root path)</td> </tr> <tr> <td><code>callback</code></td> <td> One or more callback functions. Accepted formats: <ul> <li>A single middleware function.</li> <li>Multiple middleware functions separated by commas.</li> <li>An array of middleware functions.</li> <li>A combination of the above.</li> </ul> <p> You may provide multiple callbacks that behave like middleware. These can call <code>next('route')</code> to skip remaining callbacks for the current route. This is useful for conditional routing logic. </p> <p> If a callback throws an error or returns a rejected promise, <code>next(err)</code> is invoked automatically. </p> <p> Since both <a href="#router">router</a> and <a href="#application">app</a> implement the middleware interface, they can also be used as callback middleware. </p> <p> For examples, see <a href="#middleware-callback-function-examples">Middleware callback function examples</a>. </p> </td> <td><em>None</em></td> </tr> </tbody> </table> </div> <h4 id="routing-methods">Routing methods</h4> <p>Express supports the following routing methods corresponding to the HTTP methods of the same names:</p> <div class="methods-columns"> <ul> <li><code>checkout</code></li> <li><code>copy</code></li> <li><code>delete</code></li> <li><code>get</code></li> <li><code>head</code></li> <li><code>lock</code></li> <li><code>merge</code></li> <li><code>mkactivity</code></li> </ul> <ul> <li><code>mkcol</code></li> <li><code>move</code></li> <li><code>m-search</code></li> <li><code>notify</code></li> <li><code>options</code></li> <li><code>patch</code></li> <li><code>post</code></li> </ul> <ul> <li><code>purge</code></li> <li><code>put</code></li> <li><code>report</code></li> <li><code>search</code></li> <li><code>subscribe</code></li> <li><code>trace</code></li> <li><code>unlock</code></li> <li><code>unsubscribe</code></li> </ul> </div> <p>The API documentation has explicit entries only for the most popular HTTP methods <code class="language-plaintext highlighter-rouge">app.get()</code>, <code class="language-plaintext highlighter-rouge">app.post()</code>, <code class="language-plaintext highlighter-rouge">app.put()</code>, and <code class="language-plaintext highlighter-rouge">app.delete()</code>. However, the other methods listed above work in exactly the same way.</p> <p>To route methods that translate to invalid JavaScript variable names, use the bracket notation. For example, <code class="language-plaintext highlighter-rouge">app['m-search']('/', function ...</code>.</p> <div class="doc-box doc-info"> <p>The <code class="language-plaintext highlighter-rouge">app.get()</code> function is automatically called for the HTTP <code class="language-plaintext highlighter-rouge">HEAD</code> method in addition to the <code class="language-plaintext highlighter-rouge">GET</code> method if <code class="language-plaintext highlighter-rouge">app.head()</code> was not called for the path before <code class="language-plaintext highlighter-rouge">app.get()</code>.</p> </div> <p>The method, <code class="language-plaintext highlighter-rouge">app.all()</code>, is not derived from any HTTP method and loads middleware at the specified path for <em>all</em> HTTP request methods. For more information, see <a href="#app.all">app.all</a>.</p> <p>For more information on routing, see the <a href="guide/routing">routing guide</a>.</p>   <h3 id="app.param">app.param(name, callback)</h3> <p>Add callback triggers to <a href="guide/routing#route-parameters">route parameters</a>, where <code class="language-plaintext highlighter-rouge">name</code> is the name of the parameter or an array of them, and <code class="language-plaintext highlighter-rouge">callback</code> is the callback function. The parameters of the callback function are the request object, the response object, the next middleware, the value of the parameter and the name of the parameter, in that order.</p> <p>If <code class="language-plaintext highlighter-rouge">name</code> is an array, the <code class="language-plaintext highlighter-rouge">callback</code> trigger is registered for each parameter declared in it, in the order in which they are declared. Furthermore, for each declared parameter except the last one, a call to <code class="language-plaintext highlighter-rouge">next</code> inside the callback will call the callback for the next declared parameter. For the last parameter, a call to <code class="language-plaintext highlighter-rouge">next</code> will call the next middleware in place for the route currently being processed, just like it would if <code class="language-plaintext highlighter-rouge">name</code> were just a string.</p> <p>For example, when <code class="language-plaintext highlighter-rouge">:user</code> is present in a route path, you may map user loading logic to automatically provide <code class="language-plaintext highlighter-rouge">req.user</code> to the route, or perform validations on the parameter input.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.param('user', (req, res, next, id) =&gt; {
  // try to get the user details from the User model and attach it to the request object
  User.find(id, (err, user) =&gt; {
    if (err) {
      next(err)
    } else if (user) {
      req.user = user
      next()
    } else {
      next(new Error('failed to load user'))
    }
  })
})
</pre></div>  <p>Param callback functions are local to the router on which they are defined. They are not inherited by mounted apps or routers, nor are they triggered for route parameters inherited from parent routers. Hence, param callbacks defined on <code class="language-plaintext highlighter-rouge">app</code> will be triggered only by route parameters defined on <code class="language-plaintext highlighter-rouge">app</code> routes.</p> <p>All param callbacks will be called before any handler of any route in which the param occurs, and they will each be called only once in a request-response cycle, even if the parameter is matched in multiple routes, as shown in the following examples.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.param('id', (req, res, next, id) =&gt; {
  console.log('CALLED ONLY ONCE')
  next()
})

app.get('/user/:id', (req, res, next) =&gt; {
  console.log('although this matches')
  next()
})

app.get('/user/:id', (req, res) =&gt; {
  console.log('and this matches too')
  res.end()
})
</pre></div>  <p>On <code class="language-plaintext highlighter-rouge">GET /user/42</code>, the following is printed:</p> <div class="highlight"><pre class="highlight" data-language="javascript">CALLED ONLY ONCE
although this matches
and this matches too
</pre></div>  <div class="highlight"><pre class="highlight" data-language="javascript">app.param(['id', 'page'], (req, res, next, value) =&gt; {
  console.log('CALLED ONLY ONCE with', value)
  next()
})

app.get('/user/:id/:page', (req, res, next) =&gt; {
  console.log('although this matches')
  next()
})

app.get('/user/:id/:page', (req, res) =&gt; {
  console.log('and this matches too')
  res.end()
})
</pre></div>  <p>On <code class="language-plaintext highlighter-rouge">GET /user/42/3</code>, the following is printed:</p> <div class="highlight"><pre class="highlight" data-language="javascript">CALLED ONLY ONCE with 42
CALLED ONLY ONCE with 3
although this matches
and this matches too
</pre></div>    <h3 id="app.path">app.path()</h3> <p>Returns the canonical path of the app, a string.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const app = express()
const blog = express()
const blogAdmin = express()

app.use('/blog', blog)
blog.use('/admin', blogAdmin)

console.log(app.path()) // ''
console.log(blog.path()) // '/blog'
console.log(blogAdmin.path()) // '/blog/admin'
</pre></div>  <p>The behavior of this method can become very complicated in complex cases of mounted apps: it is usually better to use <a href="#req.baseUrl">req.baseUrl</a> to get the canonical path of the app.</p>   <h3 id="app.post.method">app.post(path, callback [, callback ...])</h3> <p>Routes HTTP POST requests to the specified path with the specified callback functions. For more information, see the <a href="guide/routing">routing guide</a>.</p> <h4>Arguments</h4> <div class="table-scroller"> <table> <thead> <tr> <th>Argument</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>path</code></td> <td> The path for which the middleware function is invoked. It can be any of the following: <ul> <li>A string representing a path.</li> <li>A path pattern.</li> <li>A regular expression pattern to match paths.</li> <li>An array containing any combination of the above.</li> </ul> For examples, see <a href="#path-examples">Path examples</a>. </td> <td>
<code>'/'</code> (root path)</td> </tr> <tr> <td><code>callback</code></td> <td> One or more callback functions. Accepted formats: <ul> <li>A single middleware function.</li> <li>Multiple middleware functions separated by commas.</li> <li>An array of middleware functions.</li> <li>A combination of the above.</li> </ul> <p> You may provide multiple callbacks that behave like middleware. These can call <code>next('route')</code> to skip remaining callbacks for the current route. This is useful for conditional routing logic. </p> <p> If a callback throws an error or returns a rejected promise, <code>next(err)</code> is invoked automatically. </p> <p> Since both <a href="#router">router</a> and <a href="#application">app</a> implement the middleware interface, they can also be used as callback middleware. </p> <p> For examples, see <a href="#middleware-callback-function-examples">Middleware callback function examples</a>. </p> </td> <td><em>None</em></td> </tr> </tbody> </table> </div> <h4 id="example-2">Example</h4> <div class="highlight"><pre class="highlight" data-language="javascript">app.post('/', (req, res) =&gt; {
  res.send('POST request to homepage')
})
</pre></div>    <h3 id="app.put.method">app.put(path, callback [, callback ...])</h3> <p>Routes HTTP PUT requests to the specified path with the specified callback functions.</p> <h4>Arguments</h4> <div class="table-scroller"> <table> <thead> <tr> <th>Argument</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>path</code></td> <td> The path for which the middleware function is invoked. It can be any of the following: <ul> <li>A string representing a path.</li> <li>A path pattern.</li> <li>A regular expression pattern to match paths.</li> <li>An array containing any combination of the above.</li> </ul> For examples, see <a href="#path-examples">Path examples</a>. </td> <td>
<code>'/'</code> (root path)</td> </tr> <tr> <td><code>callback</code></td> <td> One or more callback functions. Accepted formats: <ul> <li>A single middleware function.</li> <li>Multiple middleware functions separated by commas.</li> <li>An array of middleware functions.</li> <li>A combination of the above.</li> </ul> <p> You may provide multiple callbacks that behave like middleware. These can call <code>next('route')</code> to skip remaining callbacks for the current route. This is useful for conditional routing logic. </p> <p> If a callback throws an error or returns a rejected promise, <code>next(err)</code> is invoked automatically. </p> <p> Since both <a href="#router">router</a> and <a href="#application">app</a> implement the middleware interface, they can also be used as callback middleware. </p> <p> For examples, see <a href="#middleware-callback-function-examples">Middleware callback function examples</a>. </p> </td> <td><em>None</em></td> </tr> </tbody> </table> </div> <h4 id="example-3">Example</h4> <div class="highlight"><pre class="highlight" data-language="javascript">app.put('/', (req, res) =&gt; {
  res.send('PUT request to homepage')
})
</pre></div>    <h3 id="app.render">app.render(view, [locals], callback)</h3> <p>Returns the rendered HTML of a view via the <code class="language-plaintext highlighter-rouge">callback</code> function. It accepts an optional parameter that is an object containing local variables for the view. It is like <a href="#res.render">res.render()</a>, except it cannot send the rendered view to the client on its own.</p> <div class="doc-box doc-info"> <p>Think of <code class="language-plaintext highlighter-rouge">app.render()</code> as a utility function for generating rendered view strings. Internally <code class="language-plaintext highlighter-rouge">res.render()</code> uses <code class="language-plaintext highlighter-rouge">app.render()</code> to render views.</p> </div> <div class="doc-box doc-warn"> <p>The <code class="language-plaintext highlighter-rouge">view</code> argument performs file system operations like reading a file from disk and evaluating Node.js modules, and as so for security reasons should not contain input from the end-user.</p> </div> <div class="doc-box doc-warn"> <p>The <code class="language-plaintext highlighter-rouge">locals</code> object is used by view engines to render a response. The object keys may be particularly sensitive and should not contain user-controlled input, as it may affect the operation of the view engine or provide a path to cross-site scripting. Consult the documentation for the used view engine for additional considerations.</p> </div> <div class="doc-box doc-notice"> <p>The local variable <code class="language-plaintext highlighter-rouge">cache</code> is reserved for enabling view cache. Set it to <code class="language-plaintext highlighter-rouge">true</code>, if you want to cache view during development; view caching is enabled in production by default.</p> </div> <div class="highlight"><pre class="highlight" data-language="javascript">app.render('email', (err, html) =&gt; {
  // ...
})

app.render('email', { name: 'Tobi' }, (err, html) =&gt; {
  // ...
})
</pre></div>    <h3 id="app.route">app.route(path)</h3> <p>Returns an instance of a single route, which you can then use to handle HTTP verbs with optional middleware. Use <code class="language-plaintext highlighter-rouge">app.route()</code> to avoid duplicate route names (and thus typo errors).</p> <div class="highlight"><pre class="highlight" data-language="javascript">const app = express()

app.route('/events')
  .all((req, res, next) =&gt; {
    // runs for all HTTP verbs first
    // think of it as route specific middleware!
  })
  .get((req, res, next) =&gt; {
    res.json({})
  })
  .post((req, res, next) =&gt; {
    // maybe add a new event...
  })
</pre></div>    <h3 id="app.set">app.set(name, value)</h3> <p>Assigns setting <code class="language-plaintext highlighter-rouge">name</code> to <code class="language-plaintext highlighter-rouge">value</code>. You may store any value that you want, but certain names can be used to configure the behavior of the server. These special names are listed in the <a href="#app.settings.table">app settings table</a>.</p> <p>Calling <code class="language-plaintext highlighter-rouge">app.set('foo', true)</code> for a Boolean property is the same as calling <code class="language-plaintext highlighter-rouge">app.enable('foo')</code>. Similarly, calling <code class="language-plaintext highlighter-rouge">app.set('foo', false)</code> for a Boolean property is the same as calling <code class="language-plaintext highlighter-rouge">app.disable('foo')</code>.</p> <p>Retrieve the value of a setting with <a href="#app.get"><code class="language-plaintext highlighter-rouge">app.get()</code></a>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.set('title', 'My Site')
app.get('title') // "My Site"
</pre></div>  <h4 id="app.settings.table">Application Settings</h4> <p>The following table lists application settings.</p> <p>Note that sub-apps will:</p> <ul> <li>Not inherit the value of settings that have a default value. You must set the value in the sub-app.</li> <li>Inherit the value of settings with no default value; these are explicitly noted in the table below.</li> </ul> <p>Exceptions: Sub-apps will inherit the value of <code class="language-plaintext highlighter-rouge">trust proxy</code> even though it has a default value (for backward-compatibility); Sub-apps will not inherit the value of <code class="language-plaintext highlighter-rouge">view cache</code> in production (when <code class="language-plaintext highlighter-rouge">NODE_ENV</code> is “production”).</p> <div class="table-scroller"> <table> <thead><tr>
<th id="app-settings-property">Property</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr></thead> <tbody> <tr> <td> <p><code class="language-plaintext highlighter-rouge">case sensitive routing</code></p> </td> <td>Boolean</td> <td>
<p>Enable case sensitivity. When enabled, "/Foo" and "/foo" are different routes. When disabled, "/Foo" and "/foo" are treated the same.</p> <p><b>NOTE</b>: Sub-apps will inherit the value of this setting.</p> </td> <td>N/A (undefined) </td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">env</code></p> </td> <td>String</td> <td>Environment mode. Be sure to set to "production" in a production environment; see <a href="https://expressjs.com/advanced/best-practice-performance.html#env">Production best practices: performance and reliability</a>. </td> <td> <p><code class="language-plaintext highlighter-rouge">process.env.NODE_ENV</code> (<code class="language-plaintext highlighter-rouge">NODE_ENV</code> environment variable) or “development” if <code class="language-plaintext highlighter-rouge">NODE_ENV</code> is not set.</p> </td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">etag</code></p> </td> <td>Varied</td> <td> <p>Set the ETag response header. For possible values, see the <a href="#etag.options.table"><code class="language-plaintext highlighter-rouge">etag</code> options table</a>.</p> <p><a href="http://en.wikipedia.org/wiki/HTTP_ETag">More about the HTTP ETag header</a>.</p> </td> <td> <p><code class="language-plaintext highlighter-rouge">weak</code></p> </td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">jsonp callback name</code></p> </td> <td>String</td> <td>Specifies the default JSONP callback name.</td> <td> <p>“callback”</p> </td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">json escape</code></p> </td> <td>Boolean</td> <td> <p>Enable escaping JSON responses from the <code class="language-plaintext highlighter-rouge">res.json</code>, <code class="language-plaintext highlighter-rouge">res.jsonp</code>, and <code class="language-plaintext highlighter-rouge">res.send</code> APIs. This will escape the characters <code class="language-plaintext highlighter-rouge">&lt;</code>, <code class="language-plaintext highlighter-rouge">&gt;</code>, and <code class="language-plaintext highlighter-rouge">&amp;</code> as Unicode escape sequences in JSON. The purpose of this is to assist with <a href="https://blog.mozilla.org/security/2017/07/18/web-service-audits-firefox-accounts/">mitigating certain types of persistent XSS attacks</a> when clients sniff responses for HTML.</p> <p><b>NOTE</b>: Sub-apps will inherit the value of this setting.</p> </td> <td>N/A (undefined)</td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">json replacer</code></p> </td> <td>Varied</td> <td>The <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#The_replacer_parameter">'replacer' argument used by `JSON.stringify`</a>. <p><b>NOTE</b>: Sub-apps will inherit the value of this setting.</p> </td> <td>N/A (undefined) </td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">json spaces</code></p> </td> <td>Varied</td> <td>The <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#The_space_argument">'space' argument used by `JSON.stringify`</a>. This is typically set to the number of spaces to use to indent prettified JSON. <p><b>NOTE</b>: Sub-apps will inherit the value of this setting.</p> </td> <td>N/A (undefined)</td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">query parser</code></p> </td> <td>Varied</td> <td> <p>Disable query parsing by setting the value to <code class="language-plaintext highlighter-rouge">false</code>, or set the query parser to use either “simple” or “extended” or a custom query string parsing function.</p> <p>The simple query parser is based on Node’s native query parser, <a href="http://nodejs.org/api/querystring.html">querystring</a>.</p> <p>The extended query parser is based on <a href="https://www.npmjs.org/package/qs">qs</a>.</p> <p>A custom query string parsing function will receive the complete query string, and must return an object of query keys and their values.</p> </td> <td>"simple"</td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">strict routing</code></p> </td> <td>Boolean</td> <td>
<p>Enable strict routing. When enabled, the router treats "/foo" and "/foo/" as different. Otherwise, the router treats "/foo" and "/foo/" as the same.</p> <p><b>NOTE</b>: Sub-apps will inherit the value of this setting.</p> </td> <td>N/A (undefined) </td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">subdomain offset</code></p> </td> <td>Number</td> <td>The number of dot-separated parts of the host to remove to access subdomain.</td> <td>2</td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">trust proxy</code></p> </td> <td>Varied</td> <td> <p>Indicates the app is behind a front-facing proxy, and to use the <code class="language-plaintext highlighter-rouge">X-Forwarded-*</code> headers to determine the connection and the IP address of the client. NOTE: <code class="language-plaintext highlighter-rouge">X-Forwarded-*</code> headers are easily spoofed and the detected IP addresses are unreliable.</p> <p> When enabled, Express attempts to determine the IP address of the client connected through the front-facing proxy, or series of proxies. The `req.ips` property, then contains an array of IP addresses the client is connected through. To enable it, use the values described in the <a href="#trust.proxy.options.table">trust proxy options table</a>. </p> <p> The `trust proxy` setting is implemented using the <a href="https://www.npmjs.org/package/proxy-addr">proxy-addr</a> package. For more information, see its documentation. </p> <p> <b>NOTE</b>: Sub-apps <i>will</i> inherit the value of this setting, even though it has a default value. </p> </td> <td> <p><code class="language-plaintext highlighter-rouge">false</code> (disabled)</p> </td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">views</code></p> </td> <td>String or Array</td> <td>A directory or an array of directories for the application's views. If an array, the views are looked up in the order they occur in the array.</td> <td> <p><code class="language-plaintext highlighter-rouge">process.cwd() + '/views'</code></p> </td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">view cache</code></p> </td> <td>Boolean</td> <td>
<p>Enables view template compilation caching.</p> <p><b>NOTE</b>: Sub-apps will not inherit the value of this setting in production (when `NODE_ENV` is "production").</p> </td> <td> <p><code class="language-plaintext highlighter-rouge">true</code> in production, otherwise undefined.</p> </td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">view engine</code></p> </td> <td>String</td> <td>The default engine extension to use when omitted. <p><b>NOTE</b>: Sub-apps will inherit the value of this setting.</p> </td> <td>N/A (undefined)</td> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">x-powered-by</code></p> </td> <td>Boolean</td> <td>Enables the "X-Powered-By: Express" HTTP header.</td> <td> <p><code class="language-plaintext highlighter-rouge">true</code></p> </td> </tr> </tbody> </table> </div> <h5 id="trust.proxy.options.table">Options for `trust proxy` setting</h5> <p> Read <a href="guide/behind-proxies">Express behind proxies</a> for more information. </p> <div class="table-scroller"> <table> <thead><tr>
<th>Type</th>
<th>Value</th>
</tr></thead> <tbody> <tr> <td>Boolean</td> <td> <p>If <code class="language-plaintext highlighter-rouge">true</code>, the client’s IP address is understood as the left-most entry in the <code class="language-plaintext highlighter-rouge">X-Forwarded-*</code> header.</p> <p>If <code class="language-plaintext highlighter-rouge">false</code>, the app is understood as directly facing the Internet and the client’s IP address is derived from <code class="language-plaintext highlighter-rouge">req.connection.remoteAddress</code>. This is the default setting.</p> </td> </tr> <tr> <td>String<br>String containing comma-separated values<br>Array of strings </td> <td> <p>An IP address, subnet, or an array of IP addresses, and subnets to trust. Pre-configured subnet names are:</p> <ul> <li>loopback - <code class="language-plaintext highlighter-rouge">127.0.0.1/8</code>, <code class="language-plaintext highlighter-rouge">::1/128</code>
</li> <li>linklocal - <code class="language-plaintext highlighter-rouge">169.254.0.0/16</code>, <code class="language-plaintext highlighter-rouge">fe80::/10</code>
</li> <li>uniquelocal - <code class="language-plaintext highlighter-rouge">10.0.0.0/8</code>, <code class="language-plaintext highlighter-rouge">172.16.0.0/12</code>, <code class="language-plaintext highlighter-rouge">192.168.0.0/16</code>, <code class="language-plaintext highlighter-rouge">fc00::/7</code>
</li> </ul> <p>Set IP addresses in any of the following ways:</p> <p>Specify a single subnet:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.set('trust proxy', 'loopback')
</pre></div>  <p>Specify a subnet and an address:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.set('trust proxy', 'loopback, 123.123.123.123')
</pre></div>  <p>Specify multiple subnets as CSV:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.set('trust proxy', 'loopback, linklocal, uniquelocal')
</pre></div>  <p>Specify multiple subnets as an array:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.set('trust proxy', ['loopback', 'linklocal', 'uniquelocal'])
</pre></div>  <p>When specified, the IP addresses or the subnets are excluded from the address determination process, and the untrusted IP address nearest to the application server is determined as the client’s IP address.</p> </td> </tr> <tr> <td>Number</td> <td> <p>Trust the <i>n</i><sup>th</sup> hop from the front-facing proxy server as the client.</p> </td> </tr> <tr> <td>Function</td> <td> <p>Custom trust implementation. Use this only if you know what you are doing.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.set('trust proxy', (ip) =&gt; {
  if (ip === '127.0.0.1' || ip === '123.123.123.123') return true // trusted IPs
  else return false
})
</pre></div>  </td> </tr> </tbody> </table> </div> <h5 id="etag.options.table">Options for `etag` setting</h5> <p> <strong>NOTE</strong>: These settings apply only to dynamic files, not static files. The <a href="#express.static">express.static</a> middleware ignores these settings. </p> <p> The ETag functionality is implemented using the <a href="https://www.npmjs.org/package/etag">etag</a> package. For more information, see its documentation. </p> <div class="table-scroller"> <table> <thead><tr>
<th>Type</th>
<th>Value</th>
</tr></thead> <tbody> <tr> <td>Boolean</td> <td> <p><code class="language-plaintext highlighter-rouge">true</code> enables weak ETag. This is the default setting.<br> <code class="language-plaintext highlighter-rouge">false</code> disables ETag altogether.</p> </td> </tr> <tr> <td>String</td> <td> If "strong", enables strong ETag.<br> If "weak", enables weak ETag. </td> </tr> <tr> <td>Function</td> <td> <p>Custom ETag function implementation. Use this only if you know what you are doing.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.set('etag', (body, encoding) =&gt; {
  return generateHash(body, encoding) // consider the function is defined
})
</pre></div>  </td> </tr> </tbody> </table> </div>   <h3 id="app.use">app.use([path,] callback [, callback...])</h3> <p>Mounts the specified <a href="guide/using-middleware">middleware</a> function or functions at the specified path: the middleware function is executed when the base of the requested path matches <code class="language-plaintext highlighter-rouge">path</code>.</p> <h4>Arguments</h4> <div class="table-scroller"> <table> <thead> <tr> <th>Argument</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>path</code></td> <td> The path for which the middleware function is invoked. It can be any of the following: <ul> <li>A string representing a path.</li> <li>A path pattern.</li> <li>A regular expression pattern to match paths.</li> <li>An array containing any combination of the above.</li> </ul> For examples, see <a href="#path-examples">Path examples</a>. </td> <td>
<code>'/'</code> (root path)</td> </tr> <tr> <td><code>callback</code></td> <td> One or more callback functions. Accepted formats: <ul> <li>A single middleware function.</li> <li>Multiple middleware functions separated by commas.</li> <li>An array of middleware functions.</li> <li>A combination of the above.</li> </ul> <p> You may provide multiple callbacks that behave like middleware. These can call <code>next('route')</code> to skip remaining callbacks for the current route. This is useful for conditional routing logic. </p> <p> If a callback throws an error or returns a rejected promise, <code>next(err)</code> is invoked automatically. </p> <p> Since both <a href="#router">router</a> and <a href="#application">app</a> implement the middleware interface, they can also be used as callback middleware. </p> <p> For examples, see <a href="#middleware-callback-function-examples">Middleware callback function examples</a>. </p> </td> <td><em>None</em></td> </tr> </tbody> </table> </div> <h4 id="description">Description</h4> <p>A route will match any path that follows its path immediately with a “<code class="language-plaintext highlighter-rouge">/</code>”. For example: <code class="language-plaintext highlighter-rouge">app.use('/apple', ...)</code> will match “/apple”, “/apple/images”, “/apple/images/news”, and so on.</p> <p>Since <code class="language-plaintext highlighter-rouge">path</code> defaults to “/”, middleware mounted without a path will be executed for every request to the app. For example, this middleware function will be executed for <em>every</em> request to the app:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use((req, res, next) =&gt; {
  console.log('Time: %d', Date.now())
  next()
})
</pre></div>  <div class="doc-box doc-info"> <p><strong>NOTE</strong></p> <p>Sub-apps will:</p> <ul> <li>Not inherit the value of settings that have a default value. You must set the value in the sub-app.</li> <li>Inherit the value of settings with no default value.</li> </ul> <p>For details, see <a href="5x/api#app.settings.table">Application settings</a>.</p> </div> <p>Middleware functions are executed sequentially, therefore the order of middleware inclusion is important.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// this middleware will not allow the request to go beyond it
app.use((req, res, next) =&gt; {
  res.send('Hello World')
})

// requests will never reach this route
app.get('/', (req, res) =&gt; {
  res.send('Welcome')
})
</pre></div>  <p><strong>Error-handling middleware</strong></p> <p>Error-handling middleware always takes <em>four</em> arguments. You must provide four arguments to identify it as an error-handling middleware function. Even if you don’t need to use the <code class="language-plaintext highlighter-rouge">next</code> object, you must specify it to maintain the signature. Otherwise, the <code class="language-plaintext highlighter-rouge">next</code> object will be interpreted as regular middleware and will fail to handle errors. For details about error-handling middleware, see: <a href="guide/error-handling">Error handling</a>.</p> <p>Define error-handling middleware functions in the same way as other middleware functions, except with four arguments instead of three, specifically with the signature <code class="language-plaintext highlighter-rouge">(err, req, res, next)</code>):</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use((err, req, res, next) =&gt; {
  console.error(err.stack)
  res.status(500).send('Something broke!')
})
</pre></div>  <h4 id="path-examples">Path examples</h4> <p>The following table provides some simple examples of valid <code class="language-plaintext highlighter-rouge">path</code> values for mounting middleware.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Type</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td>Path</td> <td> <p>Matches the exact path <code class="language-plaintext highlighter-rouge">/abcd</code> and any sub-paths starting with <code class="language-plaintext highlighter-rouge">/abcd/</code> (for example, <code class="language-plaintext highlighter-rouge">/abcd/foo</code>):</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use('/abcd', (req, res, next) =&gt; {
  next()
})
</pre></div>  </td> </tr> <tr> <td>Path Pattern</td> <td> <p>This will match paths starting with <code class="language-plaintext highlighter-rouge">/abcd</code> and <code class="language-plaintext highlighter-rouge">/abd</code>:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use('/ab{c}d', (req, res, next) =&gt; {
  next()
})
</pre></div>  </td> </tr> <tr> <td>Regular Expression</td> <td> <p>This will match paths starting with <code class="language-plaintext highlighter-rouge">/abc</code> and <code class="language-plaintext highlighter-rouge">/xyz</code>:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use(/\/abc|\/xyz/, (req, res, next) =&gt; {
  next()
})
</pre></div>  </td> </tr> <tr> <td>Array</td> <td> <p>This will match paths starting with <code class="language-plaintext highlighter-rouge">/abcd</code>, <code class="language-plaintext highlighter-rouge">/xyza</code>, <code class="language-plaintext highlighter-rouge">/lmn</code>, and <code class="language-plaintext highlighter-rouge">/pqr</code>:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use(['/abcd', '/xyza', /\/lmn|\/pqr/], (req, res, next) =&gt; {
  next()
})
</pre></div>  </td> </tr> </tbody> </table> </div> <h4 id="middleware-callback-function-examples">Middleware callback function examples</h4> <p>The following table provides some simple examples of middleware functions that can be used as the <code class="language-plaintext highlighter-rouge">callback</code> argument to <code class="language-plaintext highlighter-rouge">app.use()</code>, <code class="language-plaintext highlighter-rouge">app.METHOD()</code>, and <code class="language-plaintext highlighter-rouge">app.all()</code>.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Usage</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td>Single Middleware</td> <td> <p>You can define and mount a middleware function locally.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use((req, res, next) =&gt; {
  next()
})
</pre></div>  <p>A router is valid middleware.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const router = express.Router()
router.get('/', (req, res, next) =&gt; {
  next()
})
app.use(router)
</pre></div>  <p>An Express app is valid middleware.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const subApp = express()
subApp.get('/', (req, res, next) =&gt; {
  next()
})
app.use(subApp)
</pre></div>  </td> </tr> <tr> <td>Series of Middleware</td> <td> <p>You can specify more than one middleware function at the same mount path.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const r1 = express.Router()
r1.get('/', (req, res, next) =&gt; {
  next()
})

const r2 = express.Router()
r2.get('/', (req, res, next) =&gt; {
  next()
})

app.use(r1, r2)
</pre></div>  </td> </tr> <tr> <td>Array</td> <td> <p>Use an array to group middleware logically.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const r1 = express.Router()
r1.get('/', (req, res, next) =&gt; {
  next()
})

const r2 = express.Router()
r2.get('/', (req, res, next) =&gt; {
  next()
})

app.use([r1, r2])
</pre></div>  </td> </tr> <tr> <td>Combination</td> <td> <p>You can combine all the above ways of mounting middleware.</p> <div class="highlight"><pre class="highlight" data-language="javascript">function mw1 (req, res, next) { next() }
function mw2 (req, res, next) { next() }

const r1 = express.Router()
r1.get('/', (req, res, next) =&gt; { next() })

const r2 = express.Router()
r2.get('/', (req, res, next) =&gt; { next() })

const subApp = express()
subApp.get('/', (req, res, next) =&gt; { next() })

app.use(mw1, [mw2, r1, r2], subApp)
</pre></div>  </td> </tr> </tbody> </table> </div> <p>Following are some examples of using the <a href="guide/using-middleware#middleware.built-in">express.static</a> middleware in an Express app.</p> <p>Serve static content for the app from the “public” directory in the application directory:</p> <div class="highlight"><pre class="highlight" data-language="javascript">// GET /style.css etc
app.use(express.static(path.join(__dirname, 'public')))
</pre></div>  <p>Mount the middleware at “/static” to serve static content only when their request path is prefixed with “/static”:</p> <div class="highlight"><pre class="highlight" data-language="javascript">// GET /static/style.css etc.
app.use('/static', express.static(path.join(__dirname, 'public')))
</pre></div>  <p>Disable logging for static content requests by loading the logger middleware after the static middleware:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use(express.static(path.join(__dirname, 'public')))
app.use(logger())
</pre></div>  <p>Serve static files from multiple directories, but give precedence to “./public” over the others:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use(express.static(path.join(__dirname, 'public')))
app.use(express.static(path.join(__dirname, 'files')))
app.use(express.static(path.join(__dirname, 'uploads')))
</pre></div>   <h2 id="req">Request</h2> <p>The <code class="language-plaintext highlighter-rouge">req</code> object represents the HTTP request and has properties for the request query string, parameters, body, HTTP headers, and so on. In this documentation and by convention, the object is always referred to as <code class="language-plaintext highlighter-rouge">req</code> (and the HTTP response is <code class="language-plaintext highlighter-rouge">res</code>) but its actual name is determined by the parameters to the callback function in which you’re working.</p> <p>For example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.get('/user/:id', (req, res) =&gt; {
  res.send(`user ${req.params.id}`)
})
</pre></div>  <p>But you could just as well have:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.get('/user/:id', (request, response) =&gt; {
  response.send(`user ${request.params.id}`)
})
</pre></div>  <p>The <code class="language-plaintext highlighter-rouge">req</code> object is an enhanced version of Node’s own request object and supports all <a href="https://nodejs.org/api/http.html#http_class_http_incomingmessage">built-in fields and methods</a>.</p> <h3 id="req.properties">Properties</h3> <div class="doc-box doc-notice"> <p>In Express 4, <code class="language-plaintext highlighter-rouge">req.files</code> is no longer available on the <code class="language-plaintext highlighter-rouge">req</code> object by default. To access uploaded files on the <code class="language-plaintext highlighter-rouge">req.files</code> object, use multipart-handling middleware like <a href="#">busboy</a>, <a href="https://www.npmjs.com/package/multer">multer</a>, <a href="https://www.npmjs.com/package/formidable">formidable</a>, <a href="https://www.npmjs.com/package/multiparty">multiparty</a>, <a href="https://www.npmjs.com/package/connect-multiparty">connect-multiparty</a>, or <a href="https://www.npmjs.com/package/pez">pez</a>.</p> </div>  <h3 id="req.app">req.app</h3> <p>This property holds a reference to the instance of the Express application that is using the middleware.</p> <p>If you follow the pattern in which you create a module that just exports a middleware function and <code class="language-plaintext highlighter-rouge">require()</code> it in your main file, then the middleware can access the Express instance via <code class="language-plaintext highlighter-rouge">req.app</code></p> <p>For example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">// index.js
app.get('/viewdirectory', require('./mymiddleware.js'))
</pre></div>  <div class="highlight"><pre class="highlight" data-language="javascript">// mymiddleware.js
module.exports = (req, res) =&gt; {
  res.send(`The views directory is ${req.app.get('views')}`)
}
</pre></div>    <h3 id="req.baseUrl">req.baseUrl</h3> <p>The URL path on which a router instance was mounted.</p> <p>The <code class="language-plaintext highlighter-rouge">req.baseUrl</code> property is similar to the <a href="#app.mountpath">mountpath</a> property of the <code class="language-plaintext highlighter-rouge">app</code> object, except <code class="language-plaintext highlighter-rouge">app.mountpath</code> returns the matched path pattern(s).</p> <p>For example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">const greet = express.Router()

greet.get('/jp', (req, res) =&gt; {
  console.log(req.baseUrl) // /greet
  res.send('Konichiwa!')
})

app.use('/greet', greet) // load the router on '/greet'
</pre></div>  <p>Even if you use a path pattern or a set of path patterns to load the router, the <code class="language-plaintext highlighter-rouge">baseUrl</code> property returns the matched string, not the pattern(s). In the following example, the <code class="language-plaintext highlighter-rouge">greet</code> router is loaded on two path patterns.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use(['/gre:"param"t', '/hel{l}o'], greet) // load the router on '/gre:"param"t' and '/hel{l}o'
</pre></div>  <p>When a request is made to <code class="language-plaintext highlighter-rouge">/greet/jp</code>, <code class="language-plaintext highlighter-rouge">req.baseUrl</code> is “/greet”. When a request is made to <code class="language-plaintext highlighter-rouge">/hello/jp</code>, <code class="language-plaintext highlighter-rouge">req.baseUrl</code> is “/hello”.</p>   <h3 id="req.body">req.body</h3> <p>Contains key-value pairs of data submitted in the request body. By default, it is <code class="language-plaintext highlighter-rouge">undefined</code>, and is populated when you use body-parsing middleware such as <a href="#express.json"><code class="language-plaintext highlighter-rouge">express.json()</code></a> or <a href="#express.urlencoded"><code class="language-plaintext highlighter-rouge">express.urlencoded()</code></a>.</p> <div class="doc-box doc-warn"> <p>As <code class="language-plaintext highlighter-rouge">req.body</code>’s shape is based on user-controlled input, all properties and values in this object are untrusted and should be validated before trusting. For example, <code class="language-plaintext highlighter-rouge">req.body.foo.toString()</code> may fail in multiple ways, for example <code class="language-plaintext highlighter-rouge">foo</code> may not be there or may not be a string, and <code class="language-plaintext highlighter-rouge">toString</code> may not be a function and instead a string or other user-input.</p> </div> <p>The following example shows how to use body-parsing middleware to populate <code class="language-plaintext highlighter-rouge">req.body</code>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const express = require('express')

const app = express()

app.use(express.json()) // for parsing application/json
app.use(express.urlencoded({ extended: true })) // for parsing application/x-www-form-urlencoded

app.post('/profile', (req, res, next) =&gt; {
  console.log(req.body)
  res.json(req.body)
})
</pre></div>    <h3 id="req.cookies">req.cookies</h3> <p>When using <a href="https://www.npmjs.com/package/cookie-parser">cookie-parser</a> middleware, this property is an object that contains cookies sent by the request. If the request contains no cookies, it defaults to <code class="language-plaintext highlighter-rouge">{}</code>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// Cookie: name=tj
console.dir(req.cookies.name)
// =&gt; "tj"
</pre></div>  <p>If the cookie has been signed, you have to use <a href="#req.signedCookies">req.signedCookies</a>.</p> <p>For more information, issues, or concerns, see <a href="https://github.com/expressjs/cookie-parser">cookie-parser</a>.</p>   <h3 id="req.fresh">req.fresh</h3> <p>When the response is still “fresh” in the client’s cache <code class="language-plaintext highlighter-rouge">true</code> is returned, otherwise <code class="language-plaintext highlighter-rouge">false</code> is returned to indicate that the client cache is now stale and the full response should be sent.</p> <p>When a client sends the <code class="language-plaintext highlighter-rouge">Cache-Control: no-cache</code> request header to indicate an end-to-end reload request, this module will return <code class="language-plaintext highlighter-rouge">false</code> to make handling these requests transparent.</p> <p>Further details for how cache validation works can be found in the <a href="https://tools.ietf.org/html/rfc7234">HTTP/1.1 Caching Specification</a>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">console.dir(req.fresh)
// =&gt; true
</pre></div>    <h3 id="req.host">req.host</h3> <p>Contains the host derived from the <code class="language-plaintext highlighter-rouge">Host</code> HTTP header.</p> <p>When the <a href="5x/api#app.settings.table"><code class="language-plaintext highlighter-rouge">trust proxy</code> setting</a> does not evaluate to <code class="language-plaintext highlighter-rouge">false</code>, this property will instead get the value from the <code class="language-plaintext highlighter-rouge">X-Forwarded-Host</code> header field. This header can be set by the client or by the proxy.</p> <p>If there is more than one <code class="language-plaintext highlighter-rouge">X-Forwarded-Host</code> header in the request, the value of the first header is used. This includes a single header with comma-separated values, in which the first value is used.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// Host: "example.com:3000"
console.dir(req.host)
// =&gt; 'example.com:3000'

// Host: "[::1]:3000"
console.dir(req.host)
// =&gt; '[::1]:3000'
</pre></div>    <h3 id="req.hostname">req.hostname</h3> <p>Contains the hostname derived from the <code class="language-plaintext highlighter-rouge">Host</code> HTTP header.</p> <p>When the <a href="https://expressjs.com/5x/api.html#trust.proxy.options.table"><code class="language-plaintext highlighter-rouge">trust proxy</code> setting</a> does not evaluate to <code class="language-plaintext highlighter-rouge">false</code>, this property will instead get the value from the <code class="language-plaintext highlighter-rouge">X-Forwarded-Host</code> header field. This header can be set by the client or by the proxy.</p> <p>If there is more than one <code class="language-plaintext highlighter-rouge">X-Forwarded-Host</code> header in the request, the value of the first header is used. This includes a single header with comma-separated values, in which the first value is used.</p> <div class="doc-box doc-info"> <p>Prior to Express v4.17.0, the <code class="language-plaintext highlighter-rouge">X-Forwarded-Host</code> could not contain multiple values or be present more than once.</p> </div> <div class="highlight"><pre class="highlight" data-language="javascript">// Host: "example.com:3000"
console.dir(req.hostname)
// =&gt; 'example.com'
</pre></div>    <h3 id="req.ip">req.ip</h3> <p>Contains the remote IP address of the request.</p> <p>When the <a href="https://expressjs.com/5x/api.html#trust.proxy.options.table"><code class="language-plaintext highlighter-rouge">trust proxy</code> setting</a> does not evaluate to <code class="language-plaintext highlighter-rouge">false</code>, the value of this property is derived from the left-most entry in the <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> header. This header can be set by the client or by the proxy.</p> <div class="highlight"><pre class="highlight" data-language="javascript">console.dir(req.ip)
// =&gt; "127.0.0.1"
</pre></div>    <h3 id="req.ips">req.ips</h3> <p>When the <a href="https://expressjs.com/5x/api.html#trust.proxy.options.table"><code class="language-plaintext highlighter-rouge">trust proxy</code> setting</a> does not evaluate to <code class="language-plaintext highlighter-rouge">false</code>, this property contains an array of IP addresses specified in the <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> request header. Otherwise, it contains an empty array. This header can be set by the client or by the proxy.</p> <p>For example, if <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> is <code class="language-plaintext highlighter-rouge">client, proxy1, proxy2</code>, <code class="language-plaintext highlighter-rouge">req.ips</code> would be <code class="language-plaintext highlighter-rouge">["client", "proxy1", "proxy2"]</code>, where <code class="language-plaintext highlighter-rouge">proxy2</code> is the furthest downstream.</p>   <h3 id="req.method">req.method</h3> <p>Contains a string corresponding to the HTTP method of the request: <code class="language-plaintext highlighter-rouge">GET</code>, <code class="language-plaintext highlighter-rouge">POST</code>, <code class="language-plaintext highlighter-rouge">PUT</code>, and so on.</p>   <h3 id="req.originalUrl">req.originalUrl</h3> <div class="doc-box doc-notice"> <p><code class="language-plaintext highlighter-rouge">req.url</code> is not a native Express property, it is inherited from Node’s <a href="https://nodejs.org/api/http.html#http_message_url">http module</a>.</p> </div> <p>This property is much like <code class="language-plaintext highlighter-rouge">req.url</code>; however, it retains the original request URL, allowing you to rewrite <code class="language-plaintext highlighter-rouge">req.url</code> freely for internal routing purposes. For example, the “mounting” feature of <a href="#app.use">app.use()</a> will rewrite <code class="language-plaintext highlighter-rouge">req.url</code> to strip the mount point.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// GET /search?q=something
console.dir(req.originalUrl)
// =&gt; "/search?q=something"
</pre></div>  <p><code class="language-plaintext highlighter-rouge">req.originalUrl</code> is available both in middleware and router objects, and is a combination of <code class="language-plaintext highlighter-rouge">req.baseUrl</code> and <code class="language-plaintext highlighter-rouge">req.url</code>. Consider following example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">// GET 'http://www.example.com/admin/new?sort=desc'
app.use('/admin', (req, res, next) =&gt; {
  console.dir(req.originalUrl) // '/admin/new?sort=desc'
  console.dir(req.baseUrl) // '/admin'
  console.dir(req.path) // '/new'
  next()
})
</pre></div>    <h3 id="req.params">req.params</h3> <p>This property is an object containing properties mapped to the <a href="guide/routing#route-parameters">named route “parameters”</a>. For example, if you have the route <code class="language-plaintext highlighter-rouge">/user/:name</code>, then the “name” property is available as <code class="language-plaintext highlighter-rouge">req.params.name</code>. This object defaults to <code class="language-plaintext highlighter-rouge">{}</code>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// GET /user/tj
console.dir(req.params.name)
// =&gt; "tj"
</pre></div>  <p>When you use a regular expression for the route definition, capture groups are provided in the array using <code class="language-plaintext highlighter-rouge">req.params[n]</code>, where <code class="language-plaintext highlighter-rouge">n</code> is the n<sup>th</sup> capture group.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use(/^\/file\/(.*)$/, (req, res) =&gt; {
  // GET /file/javascripts/jquery.js
  console.dir(req.params[0])
  // =&gt; "javascripts/jquery.js"
})
</pre></div>  <p>If you need to make changes to a key in <code class="language-plaintext highlighter-rouge">req.params</code>, use the <a href="5x/api#app.param">app.param</a> handler. Changes are applicable only to <a href="guide/routing#route-parameters">parameters</a> already defined in the route path.</p> <p>Any changes made to the <code class="language-plaintext highlighter-rouge">req.params</code> object in a middleware or route handler will be reset.</p> <div class="doc-box doc-info"> <p class="doc-title"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" height="24" width="24" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg> Note </p> <p>Express automatically decodes the values in <code class="language-plaintext highlighter-rouge">req.params</code> (using <code class="language-plaintext highlighter-rouge">decodeURIComponent</code>).</p> </div>   <h3 id="req.path">req.path</h3> <p>Contains the path part of the request URL.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// example.com/users?sort=desc
console.dir(req.path)
// =&gt; "/users"
</pre></div>  <div class="doc-box doc-info"> <p>When called from a middleware, the mount point is not included in <code class="language-plaintext highlighter-rouge">req.path</code>. See <a href="https://expressjs.com/5x/api.html#app.use">app.use()</a> for more details.</p> </div>   <h3 id="req.protocol">req.protocol</h3> <p>Contains the request protocol string: either <code class="language-plaintext highlighter-rouge">http</code> or (for TLS requests) <code class="language-plaintext highlighter-rouge">https</code>.</p> <p>When the <a href="#trust.proxy.options.table"><code class="language-plaintext highlighter-rouge">trust proxy</code> setting</a> does not evaluate to <code class="language-plaintext highlighter-rouge">false</code>, this property will use the value of the <code class="language-plaintext highlighter-rouge">X-Forwarded-Proto</code> header field if present. This header can be set by the client or by the proxy.</p> <div class="highlight"><pre class="highlight" data-language="javascript">console.dir(req.protocol)
// =&gt; "http"
</pre></div>    <h3 id="req.query">req.query</h3> <p>This property is an object containing a property for each query string parameter in the route. When <a href="#app.settings.table">query parser</a> is set to disabled, it is an empty object <code class="language-plaintext highlighter-rouge">{}</code>, otherwise it is the result of the configured query parser.</p> <div class="doc-box doc-warn"> <p>As <code class="language-plaintext highlighter-rouge">req.query</code>’s shape is based on user-controlled input, all properties and values in this object are untrusted and should be validated before trusting. For example, <code class="language-plaintext highlighter-rouge">req.query.foo.toString()</code> may fail in multiple ways, for example <code class="language-plaintext highlighter-rouge">foo</code> may not be there or may not be a string, and <code class="language-plaintext highlighter-rouge">toString</code> may not be a function and instead a string or other user-input.</p> </div> <p>The value of this property can be configured with the <a href="#app.settings.table">query parser application setting</a> to work how your application needs it. A very popular query string parser is the <a href="https://www.npmjs.org/package/qs"><code class="language-plaintext highlighter-rouge">qs</code> module</a>, and this is used by default. The <code class="language-plaintext highlighter-rouge">qs</code> module is very configurable with many settings, and it may be desirable to use different settings than the default to populate <code class="language-plaintext highlighter-rouge">req.query</code>:</p> <div class="highlight"><pre class="highlight" data-language="javascript">const qs = require('qs')
app.set('query parser',
  (str) =&gt; qs.parse(str, { /* custom options */ }))
</pre></div>  <p>Check out the <a href="#app.settings.table">query parser application setting</a> documentation for other customization options.</p>   <h3 id="req.res">req.res</h3> <p>This property holds a reference to the <a href="#res">response object</a> that relates to this request object.</p>   <h3 id="req.route">req.route</h3> <p>Contains the currently-matched route, a string. For example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.get('/user/{:id}', (req, res) =&gt; {
  console.dir(req.route, { depth: null })
  res.send('GET')
})
</pre></div>  <p>Example output from the previous snippet:</p> <div class="highlight"><pre class="highlight" data-language="javascript">Route {
  path: '/user/{:id}',
  stack: [
    Layer {
      handle: [Function (anonymous)],
      keys: [],
      name: '&lt;anonymous&gt;',
      params: undefined,
      path: undefined,
      slash: false,
      matchers: [ [Function: match] ],
      method: 'get'
    }
  ],
  methods: [Object: null prototype] { get: true }
}
</pre></div>    <h3 id="req.secure">req.secure</h3> <p>A Boolean property that is true if a TLS connection is established. Equivalent to the following:</p>  <div class="highlight"><pre class="highlight" data-language="javascript">req.protocol === 'https'
</pre></div>    <h3 id="req.signedCookies">req.signedCookies</h3> <p>When using <a href="https://www.npmjs.com/package/cookie-parser">cookie-parser</a> middleware, this property contains signed cookies sent by the request, unsigned and ready for use. Signed cookies reside in a different object to show developer intent; otherwise, a malicious attack could be placed on <code class="language-plaintext highlighter-rouge">req.cookie</code> values (which are easy to spoof). Note that signing a cookie does not make it “hidden” or encrypted; but simply prevents tampering (because the secret used to sign is private).</p> <p>If no signed cookies are sent, the property defaults to <code class="language-plaintext highlighter-rouge">{}</code>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// Cookie: user=tobi.CP7AWaXDfAKIRfH49dQzKJx7sKzzSoPq7/AcBBRVwlI3
console.dir(req.signedCookies.user)
// =&gt; "tobi"
</pre></div>  <p>For more information, issues, or concerns, see <a href="https://github.com/expressjs/cookie-parser">cookie-parser</a>.</p>   <h3 id="req.stale">req.stale</h3> <p>Indicates whether the request is “stale,” and is the opposite of <code class="language-plaintext highlighter-rouge">req.fresh</code>. For more information, see <a href="#req.fresh">req.fresh</a>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">console.dir(req.stale)
// =&gt; true
</pre></div>    <h3 id="req.subdomains">req.subdomains</h3> <p>An array of subdomains in the domain name of the request.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// Host: "tobi.ferrets.example.com"
console.dir(req.subdomains)
// =&gt; ["ferrets", "tobi"]
</pre></div>  <p>The application property <code class="language-plaintext highlighter-rouge">subdomain offset</code>, which defaults to 2, is used for determining the beginning of the subdomain segments. To change this behavior, change its value using <a href="5x/api#app.set">app.set</a>.</p>   <h3 id="req.xhr">req.xhr</h3> <p>A Boolean property that is <code class="language-plaintext highlighter-rouge">true</code> if the request’s <code class="language-plaintext highlighter-rouge">X-Requested-With</code> header field is “XMLHttpRequest”, indicating that the request was issued by a client library such as jQuery.</p> <div class="highlight"><pre class="highlight" data-language="javascript">console.dir(req.xhr)
// =&gt; true
</pre></div>   <h3 id="req.methods">Methods</h3>  <h3 id="req.accepts">req.accepts(types)</h3> <p>Checks if the specified content types are acceptable, based on the request’s <code class="language-plaintext highlighter-rouge">Accept</code> HTTP header field. The method returns the best match, or if none of the specified content types is acceptable, returns <code class="language-plaintext highlighter-rouge">false</code> (in which case, the application should respond with <code class="language-plaintext highlighter-rouge">406 "Not Acceptable"</code>).</p> <p>The <code class="language-plaintext highlighter-rouge">type</code> value may be a single MIME type string (such as “application/json”), an extension name such as “json”, a comma-delimited list, or an array. For a list or array, the method returns the <em>best</em> match (if any).</p> <div class="highlight"><pre class="highlight" data-language="javascript">// Accept: text/html
req.accepts('html')
// =&gt; "html"

// Accept: text/*, application/json
req.accepts('html')
// =&gt; "html"
req.accepts('text/html')
// =&gt; "text/html"
req.accepts(['json', 'text'])
// =&gt; "json"
req.accepts('application/json')
// =&gt; "application/json"

// Accept: text/*, application/json
req.accepts('image/png')
req.accepts('png')
// =&gt; false

// Accept: text/*;q=.5, application/json
req.accepts(['html', 'json'])
// =&gt; "json"
</pre></div>  <p>For more information, or if you have issues or concerns, see <a href="https://github.com/expressjs/accepts">accepts</a>.</p>   <h3 id="req.acceptsCharsets">req.acceptsCharsets(charset [, ...])</h3> <p>Returns the first accepted charset of the specified character sets, based on the request’s <code class="language-plaintext highlighter-rouge">Accept-Charset</code> HTTP header field. If none of the specified charsets is accepted, returns <code class="language-plaintext highlighter-rouge">false</code>.</p> <p>For more information, or if you have issues or concerns, see <a href="https://github.com/expressjs/accepts">accepts</a>.</p>   <h3 id="req.acceptsEncodings">req.acceptsEncodings(encoding [, ...])</h3> <p>Returns the first accepted encoding of the specified encodings, based on the request’s <code class="language-plaintext highlighter-rouge">Accept-Encoding</code> HTTP header field. If none of the specified encodings is accepted, returns <code class="language-plaintext highlighter-rouge">false</code>.</p> <p>For more information, or if you have issues or concerns, see <a href="https://github.com/expressjs/accepts">accepts</a>.</p>   <h3 id="req.acceptsLanguages">req.acceptsLanguages([lang, ...])</h3> <p>Returns the first accepted language of the specified languages, based on the request’s <code class="language-plaintext highlighter-rouge">Accept-Language</code> HTTP header field. If none of the specified languages is accepted, returns <code class="language-plaintext highlighter-rouge">false</code>.</p> <p>If no <code class="language-plaintext highlighter-rouge">lang</code> argument is given, then <code class="language-plaintext highlighter-rouge">req.acceptsLanguages()</code> returns all languages from the HTTP <code class="language-plaintext highlighter-rouge">Accept-Language</code> header as an <code class="language-plaintext highlighter-rouge">Array</code>.</p> <p>For more information, or if you have issues or concerns, see <a href="https://github.com/expressjs/accepts">accepts</a>.</p> <p>Express (5.x) source: <a href="https://github.com/expressjs/express/blob/v5.1.0/lib/request.js#L172">request.js line 172</a></p> <p>Accepts (2.0) source: <a href="https://github.com/jshttp/accepts/blob/2.0.0/index.js#L195">index.js line 195</a></p>   <h3 id="req.get">req.get(field)</h3> <p>Returns the specified HTTP request header field (case-insensitive match). The <code class="language-plaintext highlighter-rouge">Referrer</code> and <code class="language-plaintext highlighter-rouge">Referer</code> fields are interchangeable.</p> <div class="highlight"><pre class="highlight" data-language="javascript">req.get('Content-Type')
// =&gt; "text/plain"

req.get('content-type')
// =&gt; "text/plain"

req.get('Something')
// =&gt; undefined
</pre></div>  <p>Aliased as <code class="language-plaintext highlighter-rouge">req.header(field)</code>.</p>   <h3 id="req.is">req.is(type)</h3> <p>Returns the matching content type if the incoming request’s “Content-Type” HTTP header field matches the MIME type specified by the <code class="language-plaintext highlighter-rouge">type</code> parameter. If the request has no body, returns <code class="language-plaintext highlighter-rouge">null</code>. Returns <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// With Content-Type: text/html; charset=utf-8
req.is('html') // =&gt; 'html'
req.is('text/html') // =&gt; 'text/html'
req.is('text/*') // =&gt; 'text/*'

// When Content-Type is application/json
req.is('json') // =&gt; 'json'
req.is('application/json') // =&gt; 'application/json'
req.is('application/*') // =&gt; 'application/*'

// Using arrays
// When Content-Type is application/json
req.is(['json', 'html']) // =&gt; 'json'

// Using multiple arguments
// When Content-Type is application/json
req.is('json', 'html') // =&gt; 'json'

req.is('html') // =&gt; false
req.is(['xml', 'yaml']) // =&gt; false
req.is('xml', 'yaml') // =&gt; false
</pre></div>  <p>For more information, or if you have issues or concerns, see <a href="https://github.com/expressjs/type-is">type-is</a>.</p>   <h3 id="req.range">req.range(size[, options])</h3> <p><code class="language-plaintext highlighter-rouge">Range</code> header parser.</p> <p>The <code class="language-plaintext highlighter-rouge">size</code> parameter is the maximum size of the resource.</p> <p>The <code class="language-plaintext highlighter-rouge">options</code> parameter is an object that can have the following properties.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">combine</code></td> <td>Boolean</td> <td>Specify if overlapping &amp; adjacent ranges should be combined, defaults to <code class="language-plaintext highlighter-rouge">false</code>. When <code class="language-plaintext highlighter-rouge">true</code>, ranges will be combined and returned as if they were specified that way in the header.</td> </tr> </tbody> </table> </div> <p>An array of ranges will be returned or negative numbers indicating an error parsing.</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">-2</code> signals a malformed header string</li> <li>
<code class="language-plaintext highlighter-rouge">-1</code> signals an unsatisfiable range</li> </ul> <div class="highlight"><pre class="highlight" data-language="javascript">// parse header from request
const range = req.range(1000)

// the type of the range
if (range.type === 'bytes') {
  // the ranges
  range.forEach((r) =&gt; {
    // do something with r.start and r.end
  })
}
</pre></div>   <h2 id="res">Response</h2> <p>The <code class="language-plaintext highlighter-rouge">res</code> object represents the HTTP response that an Express app sends when it gets an HTTP request.</p> <p>In this documentation and by convention, the object is always referred to as <code class="language-plaintext highlighter-rouge">res</code> (and the HTTP request is <code class="language-plaintext highlighter-rouge">req</code>) but its actual name is determined by the parameters to the callback function in which you’re working.</p> <p>For example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.get('/user/:id', (req, res) =&gt; {
  res.send(`user ${req.params.id}`)
})
</pre></div>  <p>But you could just as well have:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.get('/user/:id', (request, response) =&gt; {
  response.send(`user ${request.params.id}`)
})
</pre></div>  <p>The <code class="language-plaintext highlighter-rouge">res</code> object is an enhanced version of Node’s own response object and supports all <a href="https://nodejs.org/api/http.html#http_class_http_serverresponse">built-in fields and methods</a>.</p> <h3 id="res.properties">Properties</h3>  <h3 id="res.app">res.app</h3> <p>This property holds a reference to the instance of the Express application that is using the middleware.</p> <p><code class="language-plaintext highlighter-rouge">res.app</code> is identical to the <a href="#req.app">req.app</a> property in the request object.</p>   <h3 id="res.headersSent">res.headersSent</h3> <p>Boolean property that indicates if the app sent HTTP headers for the response.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.get('/', (req, res) =&gt; {
  console.log(res.headersSent) // false
  res.send('OK')
  console.log(res.headersSent) // true
})
</pre></div>    <h3 id="res.locals">res.locals</h3> <p>Use this property to set variables accessible in templates rendered with <a href="#res.render">res.render</a>. The variables set on <code class="language-plaintext highlighter-rouge">res.locals</code> are available within a single request-response cycle, and will not be shared between requests.</p> <div class="doc-box doc-warn"> <p>The <code class="language-plaintext highlighter-rouge">locals</code> object is used by view engines to render a response. The object keys may be particularly sensitive and should not contain user-controlled input, as it may affect the operation of the view engine or provide a path to cross-site scripting. Consult the documentation for the used view engine for additional considerations.</p> </div> <p>In order to keep local variables for use in template rendering between requests, use <a href="#app.locals">app.locals</a> instead.</p> <p>This property is useful for exposing request-level information such as the request path name, authenticated user, user settings, and so on to templates rendered within the application.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use((req, res, next) =&gt; {
  // Make `user` and `authenticated` available in templates
  res.locals.user = req.user
  res.locals.authenticated = !req.user.anonymous
  next()
})
</pre></div>    <h3 id="res.req">res.req</h3> <p>This property holds a reference to the <a href="#req">request object</a> that relates to this response object.</p>  <h3 id="res.methods">Methods</h3>  <h3 id="res.append">res.append(field [, value])</h3> <div class="doc-box doc-info"> <p><code class="language-plaintext highlighter-rouge">res.append()</code> is supported by Express v4.11.0+</p> </div> <p>Appends the specified <code class="language-plaintext highlighter-rouge">value</code> to the HTTP response header <code class="language-plaintext highlighter-rouge">field</code>. If the header is not already set, it creates the header with the specified value. The <code class="language-plaintext highlighter-rouge">value</code> parameter can be a string or an array.</p> <div class="doc-box doc-info"> <p class="doc-title"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" height="24" width="24" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg> Note </p> <p>calling <code class="language-plaintext highlighter-rouge">res.set()</code> after <code class="language-plaintext highlighter-rouge">res.append()</code> will reset the previously-set header value.</p> </div> <div class="highlight"><pre class="highlight" data-language="javascript">res.append('Link', ['&lt;http://localhost/&gt;', '&lt;http://localhost:3000/&gt;'])
res.append('Set-Cookie', 'foo=bar; Path=/; HttpOnly')
res.append('Warning', '199 Miscellaneous warning')
</pre></div>    <h3 id="res.attachment">res.attachment([filename])</h3> <p>Sets the HTTP response <code class="language-plaintext highlighter-rouge">Content-Disposition</code> header field to “attachment”. If a <code class="language-plaintext highlighter-rouge">filename</code> is given, then it sets the <code class="language-plaintext highlighter-rouge">Content-Type</code> based on the extension name via <code class="language-plaintext highlighter-rouge">res.type()</code>, and sets the <code class="language-plaintext highlighter-rouge">Content-Disposition</code> “filename=” parameter.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.attachment()
// Content-Disposition: attachment

res.attachment('path/to/logo.png')
// Content-Disposition: attachment; filename="logo.png"
// Content-Type: image/png
</pre></div>    <h3 id="res.cookie">res.cookie(name, value [, options])</h3> <p>Sets cookie <code class="language-plaintext highlighter-rouge">name</code> to <code class="language-plaintext highlighter-rouge">value</code>. The <code class="language-plaintext highlighter-rouge">value</code> parameter may be a string or object converted to JSON.</p> <p>The <code class="language-plaintext highlighter-rouge">options</code> parameter is an object that can have the following properties.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">domain</code></td> <td>String</td> <td>Domain name for the cookie. Defaults to the domain name of the app.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">encode</code></td> <td>Function</td> <td>A synchronous function used for cookie value encoding. Defaults to <code class="language-plaintext highlighter-rouge">encodeURIComponent</code>.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">expires</code></td> <td>Date</td> <td>Expiry date of the cookie in GMT. If not specified or set to 0, creates a session cookie.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">httpOnly</code></td> <td>Boolean</td> <td>Flags the cookie to be accessible only by the web server.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">maxAge</code></td> <td>Number</td> <td>Convenient option for setting the expiry time relative to the current time in milliseconds.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">path</code></td> <td>String</td> <td>Path for the cookie. Defaults to “/”.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">partitioned</code></td> <td>Boolean</td> <td>Indicates that the cookie should be stored using partitioned storage. See <a href="https://developer.mozilla.org/en-US/docs/Web/Privacy/Partitioned_cookies">Cookies Having Independent Partitioned State (CHIPS)</a> for more details.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">priority</code></td> <td>String</td> <td>Value of the “Priority” <strong>Set-Cookie</strong> attribute.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">secure</code></td> <td>Boolean</td> <td>Marks the cookie to be used with HTTPS only.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">signed</code></td> <td>Boolean</td> <td>Indicates if the cookie should be signed.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">sameSite</code></td> <td>Boolean or String</td> <td>Value of the “SameSite” <strong>Set-Cookie</strong> attribute. More information at <a href="https://tools.ietf.org/html/draft-ietf-httpbis-cookie-same-site-00#section-4.1.1">https://tools.ietf.org/html/draft-ietf-httpbis-cookie-same-site-00#section-4.1.1</a>.</td> </tr> </tbody> </table> </div> <div class="doc-box doc-notice"> <p>All <code class="language-plaintext highlighter-rouge">res.cookie()</code> does is set the HTTP <code class="language-plaintext highlighter-rouge">Set-Cookie</code> header with the options provided. Any option not specified defaults to the value stated in <a href="http://tools.ietf.org/html/rfc6265">RFC 6265</a>.</p> </div> <p>For example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.cookie('name', 'tobi', { domain: '.example.com', path: '/admin', secure: true })
res.cookie('rememberme', '1', { expires: new Date(Date.now() + 900000), httpOnly: true })
</pre></div>  <p>You can set multiple cookies in a single response by calling <code class="language-plaintext highlighter-rouge">res.cookie</code> multiple times, for example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res
  .status(201)
  .cookie('access_token', `Bearer ${token}`, {
    expires: new Date(Date.now() + 8 * 3600000) // cookie will be removed after 8 hours
  })
  .cookie('test', 'test')
  .redirect(301, '/admin')
</pre></div>  <p>The <code class="language-plaintext highlighter-rouge">encode</code> option allows you to choose the function used for cookie value encoding. Does not support asynchronous functions.</p> <p>Example use case: You need to set a domain-wide cookie for another site in your organization. This other site (not under your administrative control) does not use URI-encoded cookie values.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// Default encoding
res.cookie('some_cross_domain_cookie', 'http://mysubdomain.example.com', { domain: 'example.com' })
// Result: 'some_cross_domain_cookie=http%3A%2F%2Fmysubdomain.example.com; Domain=example.com; Path=/'

// Custom encoding
res.cookie('some_cross_domain_cookie', 'http://mysubdomain.example.com', { domain: 'example.com', encode: String })
// Result: 'some_cross_domain_cookie=http://mysubdomain.example.com; Domain=example.com; Path=/;'
</pre></div>  <p>The <code class="language-plaintext highlighter-rouge">maxAge</code> option is a convenience option for setting “expires” relative to the current time in milliseconds. The following is equivalent to the second example above.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.cookie('rememberme', '1', { maxAge: 900000, httpOnly: true })
</pre></div>  <p>You can pass an object as the <code class="language-plaintext highlighter-rouge">value</code> parameter; it is then serialized as JSON and parsed by <code class="language-plaintext highlighter-rouge">bodyParser()</code> middleware.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.cookie('cart', { items: [1, 2, 3] })
res.cookie('cart', { items: [1, 2, 3] }, { maxAge: 900000 })
</pre></div>  <p>When using <a href="https://www.npmjs.com/package/cookie-parser">cookie-parser</a> middleware, this method also supports signed cookies. Simply include the <code class="language-plaintext highlighter-rouge">signed</code> option set to <code class="language-plaintext highlighter-rouge">true</code>. Then, <code class="language-plaintext highlighter-rouge">res.cookie()</code> will use the secret passed to <code class="language-plaintext highlighter-rouge">cookieParser(secret)</code> to sign the value.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.cookie('name', 'tobi', { signed: true })
</pre></div>  <p>Later, you may access this value through the <a href="#req.signedCookies">req.signedCookies</a> object.</p>   <h3 id="res.clearCookie">res.clearCookie(name [, options])</h3> <p>Clears the cookie with the specified <code class="language-plaintext highlighter-rouge">name</code> by sending a <code class="language-plaintext highlighter-rouge">Set-Cookie</code> header that sets its expiration date in the past. This instructs the client that the cookie has expired and is no longer valid. For more information about available <code class="language-plaintext highlighter-rouge">options</code>, see <a href="#res.cookie">res.cookie()</a>.</p> <div class="doc-box doc-notice"> <p>The <code class="language-plaintext highlighter-rouge">expires</code> and <code class="language-plaintext highlighter-rouge">max-age</code> options are being ignored completely.</p> </div> <div class="doc-box doc-notice"> <p>Web browsers and other compliant clients will only clear the cookie if the given <code class="language-plaintext highlighter-rouge">options</code> is identical to those given to <a href="#res.cookie">res.cookie()</a></p> </div> <div class="highlight"><pre class="highlight" data-language="javascript">res.cookie('name', 'tobi', { path: '/admin' })
res.clearCookie('name', { path: '/admin' })
</pre></div>    <h3 id="res.download">res.download(path [, filename] [, options] [, fn])</h3> <div class="doc-box doc-info"> <p>The optional <code class="language-plaintext highlighter-rouge">options</code> argument is supported by Express v4.16.0 onwards.</p> </div> <p>Transfers the file at <code class="language-plaintext highlighter-rouge">path</code> as an “attachment”. Typically, browsers will prompt the user for download. By default, the <code class="language-plaintext highlighter-rouge">Content-Disposition</code> header “filename=” parameter is derived from the <code class="language-plaintext highlighter-rouge">path</code> argument, but can be overridden with the <code class="language-plaintext highlighter-rouge">filename</code> parameter. If <code class="language-plaintext highlighter-rouge">path</code> is relative, then it will be based on the current working directory of the process or the <code class="language-plaintext highlighter-rouge">root</code> option, if provided.</p> <div class="doc-box doc-warn"> <p>This API provides access to data on the running file system. Ensure that either (a) the way in which the <code class="language-plaintext highlighter-rouge">path</code> argument was constructed is secure if it contains user input or (b) set the <code class="language-plaintext highlighter-rouge">root</code> option to the absolute path of a directory to contain access within.</p> <p>When the <code class="language-plaintext highlighter-rouge">root</code> option is provided, Express will validate that the relative path provided as <code class="language-plaintext highlighter-rouge">path</code> will resolve within the given <code class="language-plaintext highlighter-rouge">root</code> option.</p> </div> <p>The following table provides details on the <code class="language-plaintext highlighter-rouge">options</code> parameter.</p> <div class="doc-box doc-info"> <p>The optional <code class="language-plaintext highlighter-rouge">options</code> argument is supported by Express v4.16.0 onwards.</p> </div> <div class="table-scroller"> <table> <thead> <tr> <th>Property</th> <th>Description</th> <th>Default</th> <th>Availability</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">maxAge</code></td> <td>Sets the max-age property of the <code class="language-plaintext highlighter-rouge">Cache-Control</code> header in milliseconds or a string in <a href="https://www.npmjs.org/package/ms">ms format</a>
</td> <td>0</td> <td>4.16+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">root</code></td> <td>Root directory for relative filenames.</td> <td> </td> <td>4.18+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">lastModified</code></td> <td>Sets the <code class="language-plaintext highlighter-rouge">Last-Modified</code> header to the last modified date of the file on the OS. Set <code class="language-plaintext highlighter-rouge">false</code> to disable it.</td> <td>Enabled</td> <td>4.16+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">headers</code></td> <td>Object containing HTTP headers to serve with the file. The header <code class="language-plaintext highlighter-rouge">Content-Disposition</code> will be overridden by the <code class="language-plaintext highlighter-rouge">filename</code> argument.</td> <td> </td> <td>4.16+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">dotfiles</code></td> <td>Option for serving dotfiles. Possible values are “allow”, “deny”, “ignore”.</td> <td>“ignore”</td> <td>4.16+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">acceptRanges</code></td> <td>Enable or disable accepting ranged requests.</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> <td>4.16+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">cacheControl</code></td> <td>Enable or disable setting <code class="language-plaintext highlighter-rouge">Cache-Control</code> response header.</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> <td>4.16+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">immutable</code></td> <td>Enable or disable the <code class="language-plaintext highlighter-rouge">immutable</code> directive in the <code class="language-plaintext highlighter-rouge">Cache-Control</code> response header. If enabled, the <code class="language-plaintext highlighter-rouge">maxAge</code> option should also be specified to enable caching. The <code class="language-plaintext highlighter-rouge">immutable</code> directive will prevent supported clients from making conditional requests during the life of the <code class="language-plaintext highlighter-rouge">maxAge</code> option to check if the file has changed.</td> <td><code class="language-plaintext highlighter-rouge">false</code></td> <td>4.16+</td> </tr> </tbody> </table> </div> <p>The method invokes the callback function <code class="language-plaintext highlighter-rouge">fn(err)</code> when the transfer is complete or when an error occurs. If the callback function is specified and an error occurs, the callback function must explicitly handle the response process either by ending the request-response cycle, or by passing control to the next route.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.download('/report-12345.pdf')

res.download('/report-12345.pdf', 'report.pdf')

res.download('/report-12345.pdf', 'report.pdf', (err) =&gt; {
  if (err) {
    // Handle error, but keep in mind the response may be partially-sent
    // so check res.headersSent
  } else {
    // decrement a download credit, etc.
  }
})
</pre></div>    <h3 id="res.end">res.end([data[, encoding]][, callback])</h3> <p>Ends the response process. This method actually comes from Node core, specifically the <a href="https://nodejs.org/api/http.html#responseenddata-encoding-callback">response.end() method of http.ServerResponse</a>.</p> <p>Use to quickly end the response without any data. If you need to respond with data, instead use methods such as <a href="#res.send">res.send()</a> and <a href="#res.json">res.json()</a>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.end()
res.status(404).end()
</pre></div>    <h3 id="res.format">res.format(object)</h3> <p>Performs content-negotiation on the <code class="language-plaintext highlighter-rouge">Accept</code> HTTP header on the request object, when present. It uses <a href="#req.accepts">req.accepts()</a> to select a handler for the request, based on the acceptable types ordered by their quality values. If the header is not specified, the first callback is invoked. When no match is found, the server responds with 406 “Not Acceptable”, or invokes the <code class="language-plaintext highlighter-rouge">default</code> callback.</p> <p>The <code class="language-plaintext highlighter-rouge">Content-Type</code> response header is set when a callback is selected. However, you may alter this within the callback using methods such as <code class="language-plaintext highlighter-rouge">res.set()</code> or <code class="language-plaintext highlighter-rouge">res.type()</code>.</p> <p>The following example would respond with <code class="language-plaintext highlighter-rouge">{ "message": "hey" }</code> when the <code class="language-plaintext highlighter-rouge">Accept</code> header field is set to “application/json” or “*/json” (however, if it is “*/*”, then the response will be “hey”).</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.format({
  'text/plain' () {
    res.send('hey')
  },

  'text/html' () {
    res.send('&lt;p&gt;hey&lt;/p&gt;')
  },

  'application/json' () {
    res.send({ message: 'hey' })
  },

  default () {
    // log the request and respond with 406
    res.status(406).send('Not Acceptable')
  }
})
</pre></div>  <p>In addition to canonicalized MIME types, you may also use extension names mapped to these types for a slightly less verbose implementation:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.format({
  text () {
    res.send('hey')
  },

  html () {
    res.send('&lt;p&gt;hey&lt;/p&gt;')
  },

  json () {
    res.send({ message: 'hey' })
  }
})
</pre></div>    <h3 id="res.get">res.get(field)</h3> <p>Returns the HTTP response header specified by <code class="language-plaintext highlighter-rouge">field</code>. The match is case-insensitive.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.get('Content-Type')
// =&gt; "text/plain"
</pre></div>    <h3 id="res.json">res.json([body])</h3> <p>Sends a JSON response. This method sends a response (with the correct content-type) that is the parameter converted to a JSON string using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify">JSON.stringify()</a>.</p> <p>The parameter can be any JSON type, including object, array, string, Boolean, number, or null, and you can also use it to convert other values to JSON.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.json(null)
res.json({ user: 'tobi' })
res.status(500).json({ error: 'message' })
</pre></div>    <h3 id="res.jsonp">res.jsonp([body])</h3> <p>Sends a JSON response with JSONP support. This method is identical to <code class="language-plaintext highlighter-rouge">res.json()</code>, except that it opts-in to JSONP callback support.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.jsonp(null)
// =&gt; callback(null)

res.jsonp({ user: 'tobi' })
// =&gt; callback({ "user": "tobi" })

res.status(500).jsonp({ error: 'message' })
// =&gt; callback({ "error": "message" })
</pre></div>  <p>By default, the JSONP callback name is simply <code class="language-plaintext highlighter-rouge">callback</code>. Override this with the <a href="#app.settings.table">jsonp callback name</a> setting.</p> <p>The following are some examples of JSONP responses using the same code:</p> <div class="highlight"><pre class="highlight" data-language="javascript">// ?callback=foo
res.jsonp({ user: 'tobi' })
// =&gt; foo({ "user": "tobi" })

app.set('jsonp callback name', 'cb')

// ?cb=foo
res.status(500).jsonp({ error: 'message' })
// =&gt; foo({ "error": "message" })
</pre></div>    <h3 id="res.links">res.links(links)</h3> <p>Joins the <code class="language-plaintext highlighter-rouge">links</code> provided as properties of the parameter to populate the response’s <code class="language-plaintext highlighter-rouge">Link</code> HTTP header field.</p> <p>For example, the following call:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.links({
  next: 'http://api.example.com/users?page=2',
  last: 'http://api.example.com/users?page=5'
})
</pre></div>  <p>Yields the following results:</p> <div class="highlight"><pre class="highlight" data-language="javascript">Link: &lt;http://api.example.com/users?page=2&gt;; rel="next",
      &lt;http://api.example.com/users?page=5&gt;; rel="last"
</pre></div>    <h3 id="res.location">res.location(path)</h3> <p>Sets the response <code class="language-plaintext highlighter-rouge">Location</code> HTTP header to the specified <code class="language-plaintext highlighter-rouge">path</code> parameter.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.location('/foo/bar')
res.location('http://example.com')
</pre></div>  <div class="doc-box doc-warn"> <p>After encoding the URL, if not encoded already, Express passes the specified URL to the browser in the <code class="language-plaintext highlighter-rouge">Location</code> header, without any validation.</p> <p>Browsers take the responsibility of deriving the intended URL from the current URL or the referring URL, and the URL specified in the <code class="language-plaintext highlighter-rouge">Location</code> header; and redirect the user accordingly.</p> </div>   <h3 id="res.redirect">res.redirect([status,] path)</h3> <p>Redirects to the URL derived from the specified <code class="language-plaintext highlighter-rouge">path</code>, with specified <code class="language-plaintext highlighter-rouge">status</code>, a positive integer that corresponds to an <a href="https://www.rfc-editor.org/rfc/rfc9110.html#name-status-codes">HTTP status code</a>. If not specified, <code class="language-plaintext highlighter-rouge">status</code> defaults to <code class="language-plaintext highlighter-rouge">302 "Found"</code>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.redirect('/foo/bar')
res.redirect('http://example.com')
res.redirect(301, 'http://example.com')
res.redirect('../login')
</pre></div>  <p>Redirects can be a fully-qualified URL for redirecting to a different site:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.redirect('http://google.com')
</pre></div>  <p>Redirects can be relative to the root of the host name. For example, if the application is on <code class="language-plaintext highlighter-rouge">http://example.com/admin/post/new</code>, the following would redirect to the URL <code class="language-plaintext highlighter-rouge">http://example.com/admin</code>:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.redirect('/admin')
</pre></div>  <p>Redirects can be relative to the current URL. For example, from <code class="language-plaintext highlighter-rouge">http://example.com/blog/admin/</code> (notice the trailing slash), the following would redirect to the URL <code class="language-plaintext highlighter-rouge">http://example.com/blog/admin/post/new</code>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.redirect('post/new')
</pre></div>  <p>Redirecting to <code class="language-plaintext highlighter-rouge">post/new</code> from <code class="language-plaintext highlighter-rouge">http://example.com/blog/admin</code> (no trailing slash), will redirect to <code class="language-plaintext highlighter-rouge">http://example.com/blog/post/new</code>.</p> <p>If you found the above behavior confusing, think of path segments as directories (with trailing slashes) and files, it will start to make sense.</p> <p>Path-relative redirects are also possible. If you were on <code class="language-plaintext highlighter-rouge">http://example.com/admin/post/new</code>, the following would redirect to <code class="language-plaintext highlighter-rouge">http://example.com/admin/post</code>:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.redirect('..')
</pre></div>  <p>See also <a href="http://expressjs.com/en/advanced/best-practice-security.html#prevent-open-redirects">Security best practices: Prevent open redirect vulnerabilities</a>.</p>   <h3 id="res.render">res.render(view [, locals] [, callback])</h3> <p>Renders a <code class="language-plaintext highlighter-rouge">view</code> and sends the rendered HTML string to the client. Optional parameters:</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">locals</code>, an object whose properties define local variables for the view.</li> <li>
<code class="language-plaintext highlighter-rouge">callback</code>, a callback function. If provided, the method returns both the possible error and rendered string, but does not perform an automated response. When an error occurs, the method invokes <code class="language-plaintext highlighter-rouge">next(err)</code> internally.</li> </ul> <p>The <code class="language-plaintext highlighter-rouge">view</code> argument is a string that is the file path of the view file to render. This can be an absolute path, or a path relative to the <code class="language-plaintext highlighter-rouge">views</code> setting. If the path does not contain a file extension, then the <code class="language-plaintext highlighter-rouge">view engine</code> setting determines the file extension. If the path does contain a file extension, then Express will load the module for the specified template engine (via <code class="language-plaintext highlighter-rouge">require()</code>) and render it using the loaded module’s <code class="language-plaintext highlighter-rouge">__express</code> function.</p> <p>For more information, see <a href="guide/using-template-engines">Using template engines with Express</a>.</p> <div class="doc-box doc-warn"> <p class="doc-title"><svg viewbox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 7C11.7348 7 11.4804 7.10536 11.2929 7.29289C11.1054 7.48043 11 7.73478 11 8V12C11 12.2652 11.1054 12.5196 11.2929 12.7071C11.4804 12.8946 11.7348 13 12 13C12.2652 13 12.5196 12.8946 12.7071 12.7071C12.8946 12.5196 13 12.2652 13 12V8C13 7.73478 12.8946 7.48043 12.7071 7.29289C12.5196 7.10536 12.2652 7 12 7ZM12 15C11.8022 15 11.6089 15.0586 11.4444 15.1685C11.28 15.2784 11.1518 15.4346 11.0761 15.6173C11.0004 15.8 10.9806 16.0011 11.0192 16.1951C11.0578 16.3891 11.153 16.5673 11.2929 16.7071C11.4327 16.847 11.6109 16.9422 11.8049 16.9808C11.9989 17.0194 12.2 16.9996 12.3827 16.9239C12.5654 16.8482 12.7216 16.72 12.8315 16.5556C12.9414 16.3911 13 16.1978 13 16C13 15.7348 12.8946 15.4804 12.7071 15.2929C12.5196 15.1054 12.2652 15 12 15ZM21.71 7.56L16.44 2.29C16.2484 2.10727 15.9948 2.00368 15.73 2H8.27C8.00523 2.00368 7.75163 2.10727 7.56 2.29L2.29 7.56C2.10727 7.75163 2.00368 8.00523 2 8.27V15.73C2.00368 15.9948 2.10727 16.2484 2.29 16.44L7.56 21.71C7.75163 21.8927 8.00523 21.9963 8.27 22H15.73C15.9948 21.9963 16.2484 21.8927 16.44 21.71L21.71 16.44C21.8927 16.2484 21.9963 15.9948 22 15.73V8.27C21.9963 8.00523 21.8927 7.75163 21.71 7.56ZM20 15.31L15.31 20H8.69L4 15.31V8.69L8.69 4H15.31L20 8.69V15.31Z"></path></svg> Warning</p> <p>The <code class="language-plaintext highlighter-rouge">view</code> argument performs file system operations like reading a file from disk and evaluating Node.js modules, and as so for security reasons should not contain input from the end-user.</p> </div> <div class="doc-box doc-warn"> <p class="doc-title"><svg viewbox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 7C11.7348 7 11.4804 7.10536 11.2929 7.29289C11.1054 7.48043 11 7.73478 11 8V12C11 12.2652 11.1054 12.5196 11.2929 12.7071C11.4804 12.8946 11.7348 13 12 13C12.2652 13 12.5196 12.8946 12.7071 12.7071C12.8946 12.5196 13 12.2652 13 12V8C13 7.73478 12.8946 7.48043 12.7071 7.29289C12.5196 7.10536 12.2652 7 12 7ZM12 15C11.8022 15 11.6089 15.0586 11.4444 15.1685C11.28 15.2784 11.1518 15.4346 11.0761 15.6173C11.0004 15.8 10.9806 16.0011 11.0192 16.1951C11.0578 16.3891 11.153 16.5673 11.2929 16.7071C11.4327 16.847 11.6109 16.9422 11.8049 16.9808C11.9989 17.0194 12.2 16.9996 12.3827 16.9239C12.5654 16.8482 12.7216 16.72 12.8315 16.5556C12.9414 16.3911 13 16.1978 13 16C13 15.7348 12.8946 15.4804 12.7071 15.2929C12.5196 15.1054 12.2652 15 12 15ZM21.71 7.56L16.44 2.29C16.2484 2.10727 15.9948 2.00368 15.73 2H8.27C8.00523 2.00368 7.75163 2.10727 7.56 2.29L2.29 7.56C2.10727 7.75163 2.00368 8.00523 2 8.27V15.73C2.00368 15.9948 2.10727 16.2484 2.29 16.44L7.56 21.71C7.75163 21.8927 8.00523 21.9963 8.27 22H15.73C15.9948 21.9963 16.2484 21.8927 16.44 21.71L21.71 16.44C21.8927 16.2484 21.9963 15.9948 22 15.73V8.27C21.9963 8.00523 21.8927 7.75163 21.71 7.56ZM20 15.31L15.31 20H8.69L4 15.31V8.69L8.69 4H15.31L20 8.69V15.31Z"></path></svg> Warning</p> <p>The <code class="language-plaintext highlighter-rouge">locals</code> object is used by view engines to render a response. The object keys may be particularly sensitive and should not contain user-controlled input, as it may affect the operation of the view engine or provide a path to cross-site scripting. Consult the documentation for the used view engine for additional considerations.</p> </div> <div class="doc-box doc-notice"> <p class="doc-title"><svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" height="24" width="24" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"></path></svg> Caution</p> <p>The local variable <code class="language-plaintext highlighter-rouge">cache</code> enables view caching. Set it to <code class="language-plaintext highlighter-rouge">true</code>, to cache the view during development; view caching is enabled in production by default.</p> </div> <div class="highlight"><pre class="highlight" data-language="javascript">// send the rendered view to the client
res.render('index')

// if a callback is specified, the rendered HTML string has to be sent explicitly
res.render('index', (err, html) =&gt; {
  res.send(html)
})

// pass a local variable to the view
res.render('user', { name: 'Tobi' }, (err, html) =&gt; {
  // ...
})
</pre></div>    <h3 id="res.send">res.send([body])</h3> <p>Sends the HTTP response.</p> <p>The <code class="language-plaintext highlighter-rouge">body</code> parameter can be a <code class="language-plaintext highlighter-rouge">Buffer</code> object, a <code class="language-plaintext highlighter-rouge">String</code>, an object, <code class="language-plaintext highlighter-rouge">Boolean</code>, or an <code class="language-plaintext highlighter-rouge">Array</code>. For example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.send(Buffer.from('whoop'))
res.send({ some: 'json' })
res.send('&lt;p&gt;some html&lt;/p&gt;')
res.status(404).send('Sorry, we cannot find that!')
res.status(500).send({ error: 'something blew up' })
</pre></div>  <p>This method performs many useful tasks for simple non-streaming responses: For example, it automatically assigns the <code class="language-plaintext highlighter-rouge">Content-Length</code> HTTP response header field and provides automatic HEAD and HTTP cache freshness support.</p> <p>When the parameter is a <code class="language-plaintext highlighter-rouge">Buffer</code> object, the method sets the <code class="language-plaintext highlighter-rouge">Content-Type</code> response header field to “application/octet-stream”, unless previously defined as shown below:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.set('Content-Type', 'text/html')
res.send(Buffer.from('&lt;p&gt;some html&lt;/p&gt;'))
</pre></div>  <p>When the parameter is a <code class="language-plaintext highlighter-rouge">String</code>, the method sets the <code class="language-plaintext highlighter-rouge">Content-Type</code> to “text/html”:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.send('&lt;p&gt;some html&lt;/p&gt;')
</pre></div>  <p>When the parameter is an <code class="language-plaintext highlighter-rouge">Array</code> or <code class="language-plaintext highlighter-rouge">Object</code>, Express responds with the JSON representation:</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.send({ user: 'tobi' })
res.send([1, 2, 3])
</pre></div>    <h3 id="res.sendFile">res.sendFile(path [, options] [, fn])</h3> <div class="doc-box doc-info"> <p><code class="language-plaintext highlighter-rouge">res.sendFile()</code> is supported by Express v4.8.0 onwards.</p> </div> <p>Transfers the file at the given <code class="language-plaintext highlighter-rouge">path</code>. Sets the <code class="language-plaintext highlighter-rouge">Content-Type</code> response HTTP header field based on the filename’s extension. Unless the <code class="language-plaintext highlighter-rouge">root</code> option is set in the options object, <code class="language-plaintext highlighter-rouge">path</code> must be an absolute path to the file.</p> <div class="doc-box doc-warn"> <p>This API provides access to data on the running file system. Ensure that either (a) the way in which the <code class="language-plaintext highlighter-rouge">path</code> argument was constructed into an absolute path is secure if it contains user input or (b) set the <code class="language-plaintext highlighter-rouge">root</code> option to the absolute path of a directory to contain access within.</p> <p>When the <code class="language-plaintext highlighter-rouge">root</code> option is provided, the <code class="language-plaintext highlighter-rouge">path</code> argument is allowed to be a relative path, including containing <code class="language-plaintext highlighter-rouge">..</code>. Express will validate that the relative path provided as <code class="language-plaintext highlighter-rouge">path</code> will resolve within the given <code class="language-plaintext highlighter-rouge">root</code> option.</p> </div> <p>The following table provides details on the <code class="language-plaintext highlighter-rouge">options</code> parameter.</p> <div class="table-scroller"> <table> <thead> <tr> <th>Property</th> <th>Description</th> <th>Default</th> <th>Availability</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">maxAge</code></td> <td>Sets the max-age property of the <code class="language-plaintext highlighter-rouge">Cache-Control</code> header in milliseconds or a string in <a href="https://www.npmjs.org/package/ms">ms format</a>
</td> <td>0</td> <td> </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">root</code></td> <td>Root directory for relative filenames.</td> <td> </td> <td> </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">lastModified</code></td> <td>Sets the <code class="language-plaintext highlighter-rouge">Last-Modified</code> header to the last modified date of the file on the OS. Set <code class="language-plaintext highlighter-rouge">false</code> to disable it.</td> <td>Enabled</td> <td>4.9.0+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">headers</code></td> <td>Object containing HTTP headers to serve with the file.</td> <td> </td> <td> </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">dotfiles</code></td> <td>Option for serving dotfiles. Possible values are “allow”, “deny”, “ignore”.</td> <td>“ignore”</td> <td> </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">acceptRanges</code></td> <td>Enable or disable accepting ranged requests.</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> <td>4.14+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">cacheControl</code></td> <td>Enable or disable setting <code class="language-plaintext highlighter-rouge">Cache-Control</code> response header.</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> <td>4.14+</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">immutable</code></td> <td>Enable or disable the <code class="language-plaintext highlighter-rouge">immutable</code> directive in the <code class="language-plaintext highlighter-rouge">Cache-Control</code> response header. If enabled, the <code class="language-plaintext highlighter-rouge">maxAge</code> option should also be specified to enable caching. The <code class="language-plaintext highlighter-rouge">immutable</code> directive will prevent supported clients from making conditional requests during the life of the <code class="language-plaintext highlighter-rouge">maxAge</code> option to check if the file has changed.</td> <td><code class="language-plaintext highlighter-rouge">false</code></td> <td>4.16+</td> </tr> </tbody> </table> </div> <p>The method invokes the callback function <code class="language-plaintext highlighter-rouge">fn(err)</code> when the transfer is complete or when an error occurs. If the callback function is specified and an error occurs, the callback function must explicitly handle the response process either by ending the request-response cycle, or by passing control to the next route.</p> <p>Here is an example of using <code class="language-plaintext highlighter-rouge">res.sendFile</code> with all its arguments.</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.get('/file/:name', (req, res, next) =&gt; {
  const options = {
    root: path.join(__dirname, 'public'),
    dotfiles: 'deny',
    headers: {
      'x-timestamp': Date.now(),
      'x-sent': true
    }
  }

  const fileName = req.params.name
  res.sendFile(fileName, options, (err) =&gt; {
    if (err) {
      next(err)
    } else {
      console.log('Sent:', fileName)
    }
  })
})
</pre></div>  <p>The following example illustrates using <code class="language-plaintext highlighter-rouge">res.sendFile</code> to provide fine-grained support for serving files:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.get('/user/:uid/photos/:file', (req, res) =&gt; {
  const uid = req.params.uid
  const file = req.params.file

  req.user.mayViewFilesFrom(uid, (yes) =&gt; {
    if (yes) {
      res.sendFile(`/uploads/${uid}/${file}`)
    } else {
      res.status(403).send("Sorry! You can't see that.")
    }
  })
})
</pre></div>  <p>For more information, or if you have issues or concerns, see <a href="https://github.com/pillarjs/send">send</a>.</p>   <h3 id="res.sendStatus">res.sendStatus(statusCode)</h3> <p>Sets the response HTTP status code to <code class="language-plaintext highlighter-rouge">statusCode</code> and sends the registered status message as the text response body. If an unknown status code is specified, the response body will just be the code number.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.sendStatus(404)
</pre></div>  <div class="doc-box doc-notice"> <p>Some versions of Node.js will throw when <code class="language-plaintext highlighter-rouge">res.statusCode</code> is set to an invalid HTTP status code (outside of the range <code class="language-plaintext highlighter-rouge">100</code> to <code class="language-plaintext highlighter-rouge">599</code>). Consult the HTTP server documentation for the Node.js version being used.</p> </div> <p><a href="http://en.wikipedia.org/wiki/List_of_HTTP_status_codes">More about HTTP Status Codes</a></p>   <h3 id="res.set">res.set(field [, value])</h3> <p>Sets the response’s HTTP header <code class="language-plaintext highlighter-rouge">field</code> to <code class="language-plaintext highlighter-rouge">value</code>. To set multiple fields at once, pass an object as the parameter.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.set('Content-Type', 'text/plain')

res.set({
  'Content-Type': 'text/plain',
  'Content-Length': '123',
  ETag: '12345'
})
</pre></div>  <p>Aliased as <code class="language-plaintext highlighter-rouge">res.header(field [, value])</code>.</p>   <h3 id="res.status">res.status(code)</h3> <p>Sets the HTTP status for the response. It is a chainable alias of Node’s <a href="http://nodejs.org/api/http.html#http_response_statuscode">response.statusCode</a>.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.status(403).end()
res.status(400).send('Bad Request')
res.status(404).sendFile('/absolute/path/to/404.png')
</pre></div>    <h3 id="res.type">res.type(type)</h3> <p>Sets the <code class="language-plaintext highlighter-rouge">Content-Type</code> HTTP header to the MIME type as determined by the specified <code class="language-plaintext highlighter-rouge">type</code>. If <code class="language-plaintext highlighter-rouge">type</code> contains the “/” character, then it sets the <code class="language-plaintext highlighter-rouge">Content-Type</code> to the exact value of <code class="language-plaintext highlighter-rouge">type</code>, otherwise it is assumed to be a file extension and the MIME type is looked up using the <code class="language-plaintext highlighter-rouge">contentType()</code> method of the <code class="language-plaintext highlighter-rouge">mime-types</code> package.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.type('.html') // =&gt; 'text/html'
res.type('html') // =&gt; 'text/html'
res.type('json') // =&gt; 'application/json'
res.type('application/json') // =&gt; 'application/json'
res.type('png') // =&gt; image/png:
</pre></div>  <p>Aliased as <code class="language-plaintext highlighter-rouge">res.contentType(type)</code>.</p>   <h3 id="res.vary">res.vary(field)</h3> <p>Adds the field to the <code class="language-plaintext highlighter-rouge">Vary</code> response header, if it is not there already.</p> <div class="highlight"><pre class="highlight" data-language="javascript">res.vary('User-Agent').render('docs')
</pre></div>   <h2 id="router">Router</h2>  <p>A <code class="language-plaintext highlighter-rouge">router</code> object is an instance of middleware and routes. You can think of it as a “mini-application,” capable only of performing middleware and routing functions. Every Express application has a built-in app router.</p> <p>A router behaves like middleware itself, so you can use it as an argument to <a href="#app.use">app.use()</a> or as the argument to another router’s <a href="#router.use">use()</a> method.</p> <p>The top-level <code class="language-plaintext highlighter-rouge">express</code> object has a <a href="#express.router">Router()</a> method that creates a new <code class="language-plaintext highlighter-rouge">router</code> object.</p> <p>Once you’ve created a router object, you can add middleware and HTTP method routes (such as <code class="language-plaintext highlighter-rouge">get</code>, <code class="language-plaintext highlighter-rouge">put</code>, <code class="language-plaintext highlighter-rouge">post</code>, and so on) to it just like an application. For example:</p> <div class="highlight"><pre class="highlight" data-language="javascript">// invoked for any requests passed to this router
router.use((req, res, next) =&gt; {
  // .. some logic here .. like any other middleware
  next()
})

// will handle any request that ends in /events
// depends on where the router is "use()'d"
router.get('/events', (req, res, next) =&gt; {
  // ..
})
</pre></div>  <p>You can then use a router for a particular root URL in this way separating your routes into files or even mini-apps.</p> <div class="highlight"><pre class="highlight" data-language="javascript">// only requests to /calendar/* will be sent to our "router"
app.use('/calendar', router)
</pre></div>  <p>Keep in mind that any middleware applied to a router will run for all requests on that router’s path, even those that aren’t part of the router.</p>  <h3 id="router.methods">Methods</h3>  <h3 id="router.all">router.all(path, [callback, ...] callback)</h3> <p>This method is just like the <code class="language-plaintext highlighter-rouge">router.METHOD()</code> methods, except that it matches all HTTP methods (verbs).</p> <p>This method is extremely useful for mapping “global” logic for specific path prefixes or arbitrary matches. For example, if you placed the following route at the top of all other route definitions, it would require that all routes from that point on would require authentication, and automatically load a user. Keep in mind that these callbacks do not have to act as end points; <code class="language-plaintext highlighter-rouge">loadUser</code> can perform a task, then call <code class="language-plaintext highlighter-rouge">next()</code> to continue matching subsequent routes.</p> <div class="highlight"><pre class="highlight" data-language="javascript">router.all('{*splat}', requireAuthentication, loadUser)
</pre></div>  <p>Or the equivalent:</p> <div class="highlight"><pre class="highlight" data-language="javascript">router.all('{*splat}', requireAuthentication)
router.all('{*splat}', loadUser)
</pre></div>  <p>Another example of this is white-listed “global” functionality. Here, the example is much like before, but it only restricts paths prefixed with “/api”:</p> <div class="highlight"><pre class="highlight" data-language="javascript">router.all('/api/{*splat}', requireAuthentication)
</pre></div>    <h3 id="router.METHOD">router.METHOD(path, [callback, ...] callback)</h3> <p>The <code class="language-plaintext highlighter-rouge">router.METHOD()</code> methods provide the routing functionality in Express, where METHOD is one of the HTTP methods, such as GET, PUT, POST, and so on, in lowercase. Thus, the actual methods are <code class="language-plaintext highlighter-rouge">router.get()</code>, <code class="language-plaintext highlighter-rouge">router.post()</code>, <code class="language-plaintext highlighter-rouge">router.put()</code>, and so on.</p> <div class="doc-box doc-info"> <p>The <code class="language-plaintext highlighter-rouge">router.get()</code> function is automatically called for the HTTP <code class="language-plaintext highlighter-rouge">HEAD</code> method in addition to the <code class="language-plaintext highlighter-rouge">GET</code> method if <code class="language-plaintext highlighter-rouge">router.head()</code> was not called for the path before <code class="language-plaintext highlighter-rouge">router.get()</code>.</p> </div> <p>You can provide multiple callbacks, and all are treated equally, and behave just like middleware, except that these callbacks may invoke <code class="language-plaintext highlighter-rouge">next('route')</code> to bypass the remaining route callback(s). You can use this mechanism to perform pre-conditions on a route then pass control to subsequent routes when there is no reason to proceed with the route matched.</p> <p>The following snippet illustrates the most simple route definition possible. Express translates the path strings to regular expressions, used internally to match incoming requests. Query strings are <em>not</em> considered when performing these matches, for example “GET /” would match the following route, as would “GET /?name=tobi”.</p> <div class="highlight"><pre class="highlight" data-language="javascript">router.get('/', (req, res) =&gt; {
  res.send('hello world')
})
</pre></div>  <p>You can also use regular expressions—useful if you have very specific constraints, for example the following would match “GET /commits/71dbb9c” as well as “GET /commits/71dbb9c..4c084f9”.</p> <div class="highlight"><pre class="highlight" data-language="javascript">router.get(/^\/commits\/(\w+)(?:\.\.(\w+))?$/, (req, res) =&gt; {
  const from = req.params[0]
  const to = req.params[1] || 'HEAD'
  res.send(`commit range ${from}..${to}`)
})
</pre></div>  <p>You can use <code class="language-plaintext highlighter-rouge">next</code> primitive to implement a flow control between different middleware functions, based on a specific program state. Invoking <code class="language-plaintext highlighter-rouge">next</code> with the string <code class="language-plaintext highlighter-rouge">'router'</code> will cause all the remaining route callbacks on that router to be bypassed.</p> <p>The following example illustrates <code class="language-plaintext highlighter-rouge">next('router')</code> usage.</p> <div class="highlight"><pre class="highlight" data-language="javascript">function fn (req, res, next) {
  console.log('I come here')
  next('router')
}
router.get('/foo', fn, (req, res, next) =&gt; {
  console.log('I dont come here')
})
router.get('/foo', (req, res, next) =&gt; {
  console.log('I dont come here')
})
app.get('/foo', (req, res) =&gt; {
  console.log(' I come here too')
  res.end('good')
})
</pre></div>    <h3 id="router.param">router.param(name, callback)</h3> <p>Adds callback triggers to route parameters, where <code class="language-plaintext highlighter-rouge">name</code> is the name of the parameter and <code class="language-plaintext highlighter-rouge">callback</code> is the callback function. Although <code class="language-plaintext highlighter-rouge">name</code> is technically optional, using this method without it is deprecated starting with Express v4.11.0 (see below).</p> <p>The parameters of the callback function are:</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">req</code>, the request object.</li> <li>
<code class="language-plaintext highlighter-rouge">res</code>, the response object.</li> <li>
<code class="language-plaintext highlighter-rouge">next</code>, indicating the next middleware function.</li> <li>The value of the <code class="language-plaintext highlighter-rouge">name</code> parameter.</li> <li>The name of the parameter.</li> </ul> <div class="doc-box doc-info"> <p>Unlike <code class="language-plaintext highlighter-rouge">app.param()</code>, <code class="language-plaintext highlighter-rouge">router.param()</code> does not accept an array of route parameters.</p> </div> <p>For example, when <code class="language-plaintext highlighter-rouge">:user</code> is present in a route path, you may map user loading logic to automatically provide <code class="language-plaintext highlighter-rouge">req.user</code> to the route, or perform validations on the parameter input.</p> <div class="highlight"><pre class="highlight" data-language="javascript">router.param('user', (req, res, next, id) =&gt; {
  // try to get the user details from the User model and attach it to the request object
  User.find(id, (err, user) =&gt; {
    if (err) {
      next(err)
    } else if (user) {
      req.user = user
      next()
    } else {
      next(new Error('failed to load user'))
    }
  })
})
</pre></div>  <p>Param callback functions are local to the router on which they are defined. They are not inherited by mounted apps or routers, nor are they triggered for route parameters inherited from parent routers. Hence, param callbacks defined on <code class="language-plaintext highlighter-rouge">router</code> will be triggered only by route parameters defined on <code class="language-plaintext highlighter-rouge">router</code> routes.</p> <p>A param callback will be called only once in a request-response cycle, even if the parameter is matched in multiple routes, as shown in the following examples.</p> <div class="highlight"><pre class="highlight" data-language="javascript">router.param('id', (req, res, next, id) =&gt; {
  console.log('CALLED ONLY ONCE')
  next()
})

router.get('/user/:id', (req, res, next) =&gt; {
  console.log('although this matches')
  next()
})

router.get('/user/:id', (req, res) =&gt; {
  console.log('and this matches too')
  res.end()
})
</pre></div>  <p>On <code class="language-plaintext highlighter-rouge">GET /user/42</code>, the following is printed:</p> <div class="highlight"><pre class="highlight" data-language="javascript">CALLED ONLY ONCE
although this matches
and this matches too
</pre></div>    <h3 id="router.route">router.route(path)</h3> <p>Returns an instance of a single route which you can then use to handle HTTP verbs with optional middleware. Use <code class="language-plaintext highlighter-rouge">router.route()</code> to avoid duplicate route naming and thus typing errors.</p> <p>Building on the <code class="language-plaintext highlighter-rouge">router.param()</code> example above, the following code shows how to use <code class="language-plaintext highlighter-rouge">router.route()</code> to specify various HTTP method handlers.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const router = express.Router()

router.param('user_id', (req, res, next, id) =&gt; {
  // sample user, would actually fetch from DB, etc...
  req.user = {
    id,
    name: 'TJ'
  }
  next()
})

router.route('/users/:user_id')
  .all((req, res, next) =&gt; {
  // runs for all HTTP verbs first
  // think of it as route specific middleware!
    next()
  })
  .get((req, res, next) =&gt; {
    res.json(req.user)
  })
  .put((req, res, next) =&gt; {
  // just an example of maybe updating the user
    req.user.name = req.params.name
    // save user ... etc
    res.json(req.user)
  })
  .post((req, res, next) =&gt; {
    next(new Error('not implemented'))
  })
  .delete((req, res, next) =&gt; {
    next(new Error('not implemented'))
  })
</pre></div>  <p>This approach re-uses the single <code class="language-plaintext highlighter-rouge">/users/:user_id</code> path and adds handlers for various HTTP methods.</p> <div class="doc-box doc-info"> <p class="doc-title"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" height="24" width="24" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg> Note </p> <p>When you use <code class="language-plaintext highlighter-rouge">router.route()</code>, middleware ordering is based on when the <em>route</em> is created, not when method handlers are added to the route. For this purpose, you can consider method handlers to belong to the route to which they were added.</p> </div>   <h3 id="router.use">router.use([path], [function, ...] function)</h3> <p>Uses the specified middleware function or functions, with optional mount path <code class="language-plaintext highlighter-rouge">path</code>, that defaults to “/”.</p> <p>This method is similar to <a href="#app.use">app.use()</a>. A simple example and use case is described below. See <a href="#app.use">app.use()</a> for more information.</p> <p>Middleware is like a plumbing pipe: requests start at the first middleware function defined and work their way “down” the middleware stack processing for each path they match.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const express = require('express')
const app = express()
const router = express.Router()

// simple logger for this router's requests
// all requests to this router will first hit this middleware
router.use((req, res, next) =&gt; {
  console.log('%s %s %s', req.method, req.url, req.path)
  next()
})

// this will only be invoked if the path starts with /bar from the mount point
router.use('/bar', (req, res, next) =&gt; {
  // ... maybe some additional /bar logging ...
  next()
})

// always invoked
router.use((req, res, next) =&gt; {
  res.send('Hello World')
})

app.use('/foo', router)

app.listen(3000)
</pre></div>  <p>The “mount” path is stripped and is <em>not</em> visible to the middleware function. The main effect of this feature is that a mounted middleware function may operate without code changes regardless of its “prefix” pathname.</p> <p>The order in which you define middleware with <code class="language-plaintext highlighter-rouge">router.use()</code> is very important. They are invoked sequentially, thus the order defines middleware precedence. For example, usually a logger is the very first middleware you would use, so that every request gets logged.</p> <div class="highlight"><pre class="highlight" data-language="javascript">const logger = require('morgan')

router.use(logger())
router.use(express.static(path.join(__dirname, 'public')))
router.use((req, res) =&gt; {
  res.send('Hello')
})
</pre></div>  <p>Now suppose you wanted to ignore logging requests for static files, but to continue logging routes and middleware defined after <code class="language-plaintext highlighter-rouge">logger()</code>. You would simply move the call to <code class="language-plaintext highlighter-rouge">express.static()</code> to the top, before adding the logger middleware:</p> <div class="highlight"><pre class="highlight" data-language="javascript">router.use(express.static(path.join(__dirname, 'public')))
router.use(logger())
router.use((req, res) =&gt; {
  res.send('Hello')
})
</pre></div>  <p>Another example is serving files from multiple directories, giving precedence to “./public” over the others:</p> <div class="highlight"><pre class="highlight" data-language="javascript">app.use(express.static(path.join(__dirname, 'public')))
app.use(express.static(path.join(__dirname, 'files')))
app.use(express.static(path.join(__dirname, 'uploads')))
</pre></div>  <p>The <code class="language-plaintext highlighter-rouge">router.use()</code> method also supports named parameters so that your mount points for other routers can benefit from preloading using named parameters.</p> <p><strong>NOTE</strong>: Although these middleware functions are added via a particular router, <em>when</em> they run is defined by the path they are attached to (not the router). Therefore, middleware added via one router may run for other routers if its routes match. For example, this code shows two different routers mounted on the same path:</p> <div class="highlight"><pre class="highlight" data-language="javascript">const authRouter = express.Router()
const openRouter = express.Router()

authRouter.use(require('./authenticate').basic(usersdb))

authRouter.get('/:user_id/edit', (req, res, next) =&gt; {
  // ... Edit user UI ...
})
openRouter.get('/', (req, res, next) =&gt; {
  // ... List users ...
})
openRouter.get('/:user_id', (req, res, next) =&gt; {
  // ... View user ...
})

app.use('/users', authRouter)
app.use('/users', openRouter)
</pre></div>  <p>Even though the authentication middleware was added via the <code class="language-plaintext highlighter-rouge">authRouter</code> it will run on the routes defined by the <code class="language-plaintext highlighter-rouge">openRouter</code> as well since both routers were mounted on <code class="language-plaintext highlighter-rouge">/users</code>. To avoid this behavior, use different paths for each router.</p>  </div> <a role="button" class="edit-github-btn" href="https://github.com/expressjs/expressjs.com/tree/gh-pages/_includes/api/en/5x"> <svg viewbox="0 0 256 250" width="20" height="20" xmlns="http://www.w3.org/2000/svg" fill="currentColor"> <path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path> </svg> Edit this page </a> </main><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2017 StrongLoop, IBM, and other expressjs.com contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v3.0.<br>
    <a href="https://expressjs.com/en/5x/api.html" class="_attribution-link">https://expressjs.com/en/5x/api.html</a>
  </p>
</div>
