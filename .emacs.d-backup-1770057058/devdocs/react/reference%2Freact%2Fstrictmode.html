<h1>&lt;StrictMode&gt;<a href="#undefined" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h1>
<div>
<p><code dir="ltr">&lt;StrictMode&gt;</code> lets you find common bugs in your components early during development.</p>
<pre data-language="jsx"><code><span>&lt;</span><span>StrictMode</span><span>&gt;</span>
  <span>&lt;</span><span>App</span> <span>/&gt;</span>
<span>&lt;/</span><span>StrictMode</span><span>&gt;</span></code></pre>
</div> <ul>
<li>
<a href="#reference">Reference </a><ul><li><a href="#strictmode"><code dir="ltr">&lt;StrictMode&gt;</code> </a></li></ul>
</li>
<li>
<a href="#usage">Usage </a><ul>
<li><a href="#enabling-strict-mode-for-entire-app">Enabling Strict Mode for entire app </a></li>
<li><a href="#enabling-strict-mode-for-a-part-of-the-app">Enabling Strict Mode for a part of the app </a></li>
<li><a href="#fixing-bugs-found-by-double-rendering-in-development">Fixing bugs found by double rendering in development </a></li>
<li><a href="#fixing-bugs-found-by-re-running-effects-in-development">Fixing bugs found by re-running Effects in development </a></li>
<li><a href="#fixing-bugs-found-by-re-running-ref-callbacks-in-development">Fixing bugs found by re-running ref callbacks in development </a></li>
<li><a href="#fixing-deprecation-warnings-enabled-by-strict-mode">Fixing deprecation warnings enabled by Strict Mode </a></li>
</ul>
</li>
</ul> <hr> <h2 id="reference">Reference <a href="#reference" aria-label="Link for Reference " title="Link for Reference "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="strictmode">
<code dir="ltr">&lt;StrictMode&gt;</code> <a href="#strictmode" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Use <code dir="ltr">StrictMode</code> to enable additional development behaviors and warnings for the component tree inside:</p> <pre data-language="jsx"><code><span>import</span> <span>{</span> <span>StrictMode</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>createRoot</span> <span>}</span> <span>from</span> <span>'react-dom/client'</span><span>;</span>

<span>const</span> <span>root</span> = <span>createRoot</span><span>(</span><span>document</span>.<span>getElementById</span><span>(</span><span>'root'</span><span>)</span><span>)</span><span>;</span>
<span>root</span>.<span>render</span><span>(</span>
  <span>&lt;</span><span>StrictMode</span><span>&gt;</span>
    <span>&lt;</span><span>App</span> <span>/&gt;</span>
  <span>&lt;/</span><span>StrictMode</span><span>&gt;</span>
<span>)</span><span>;</span></code></pre> <p><a href="#usage">See more examples below.</a></p> <p>Strict Mode enables the following development-only behaviors:</p> <ul> <li>Your components will <a href="#fixing-bugs-found-by-double-rendering-in-development">re-render an extra time</a> to find bugs caused by impure rendering.</li> <li>Your components will <a href="#fixing-bugs-found-by-re-running-effects-in-development">re-run Effects an extra time</a> to find bugs caused by missing Effect cleanup.</li> <li>Your components will <a href="#fixing-bugs-found-by-re-running-ref-callbacks-in-development">re-run refs callbacks an extra time</a> to find bugs caused by missing ref cleanup.</li> <li>Your components will <a href="#fixing-deprecation-warnings-enabled-by-strict-mode">be checked for usage of deprecated APIs.</a>
</li> </ul> <h4 id="props">Props <a href="#props" aria-label="Link for Props " title="Link for Props "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4> <p><code dir="ltr">StrictMode</code> accepts no props.</p> <h4 id="caveats">Caveats <a href="#caveats" aria-label="Link for Caveats " title="Link for Caveats "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4> <ul> <li>There is no way to opt out of Strict Mode inside a tree wrapped in <code dir="ltr">&lt;StrictMode&gt;</code>. This gives you confidence that all components inside <code dir="ltr">&lt;StrictMode&gt;</code> are checked. If two teams working on a product disagree whether they find the checks valuable, they need to either reach consensus or move <code dir="ltr">&lt;StrictMode&gt;</code> down in the tree.</li> </ul> <hr> <h2 id="usage">Usage <a href="#usage" aria-label="Link for Usage " title="Link for Usage "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="enabling-strict-mode-for-entire-app">Enabling Strict Mode for entire app <a href="#enabling-strict-mode-for-entire-app" aria-label="Link for Enabling Strict Mode for entire app " title="Link for Enabling Strict Mode for entire app "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Strict Mode enables extra development-only checks for the entire component tree inside the <code dir="ltr">&lt;StrictMode&gt;</code> component. These checks help you find common bugs in your components early in the development process.</p> <p>To enable Strict Mode for your entire app, wrap your root component with <code dir="ltr">&lt;StrictMode&gt;</code> when you render it:</p> <pre data-language="jsx"><code><span>import</span> <span>{</span> <span>StrictMode</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>createRoot</span> <span>}</span> <span>from</span> <span>'react-dom/client'</span><span>;</span>

<span>const</span> <span>root</span> = <span>createRoot</span><span>(</span><span>document</span>.<span>getElementById</span><span>(</span><span>'root'</span><span>)</span><span>)</span><span>;</span>
<span>root</span>.<span>render</span><span>(</span>
  <span>&lt;</span><span>StrictMode</span><span>&gt;</span>
    <span>&lt;</span><span>App</span> <span>/&gt;</span>
  <span>&lt;/</span><span>StrictMode</span><span>&gt;</span>
<span>)</span><span>;</span></code></pre> <p>We recommend wrapping your entire app in Strict Mode, especially for newly created apps. If you use a framework that calls <a href="../react-dom/client/createroot"><code dir="ltr">createRoot</code></a> for you, check its documentation for how to enable Strict Mode.</p> <p>Although the Strict Mode checks <strong>only run in development,</strong> they help you find bugs that already exist in your code but can be tricky to reliably reproduce in production. Strict Mode lets you fix bugs before your users report them.</p> <div class="note note-green">
<h4>Note</h4>
<div>
<p>Strict Mode enables the following checks in development:</p>
<ul> <li>Your components will <a href="#fixing-bugs-found-by-double-rendering-in-development">re-render an extra time</a> to find bugs caused by impure rendering.</li> <li>Your components will <a href="#fixing-bugs-found-by-re-running-effects-in-development">re-run Effects an extra time</a> to find bugs caused by missing Effect cleanup.</li> <li>Your components will <a href="#fixing-bugs-found-by-re-running-ref-callbacks-in-development">re-run ref callbacks an extra time</a> to find bugs caused by missing ref cleanup.</li> <li>Your components will <a href="#fixing-deprecation-warnings-enabled-by-strict-mode">be checked for usage of deprecated APIs.</a>
</li> </ul>
<p><strong>All of these checks are development-only and do not impact the production build.</strong></p>
</div>
</div> <hr> <h3 id="enabling-strict-mode-for-a-part-of-the-app">Enabling Strict Mode for a part of the app <a href="#enabling-strict-mode-for-a-part-of-the-app" aria-label="Link for Enabling Strict Mode for a part of the app " title="Link for Enabling Strict Mode for a part of the app "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>You can also enable Strict Mode for any part of your application:</p> <pre data-language="jsx"><code><span>import</span> <span>{</span> <span>StrictMode</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>Header</span> <span>/&gt;</span>
      <span>&lt;</span><span>StrictMode</span><span>&gt;</span>
        <span>&lt;</span><span>main</span><span>&gt;</span>
          <span>&lt;</span><span>Sidebar</span> <span>/&gt;</span>
          <span>&lt;</span><span>Content</span> <span>/&gt;</span>
        <span>&lt;/</span><span>main</span><span>&gt;</span>
      <span>&lt;/</span><span>StrictMode</span><span>&gt;</span>
      <span>&lt;</span><span>Footer</span> <span>/&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span></code></pre> <p>In this example, Strict Mode checks will not run against the <code dir="ltr">Header</code> and <code dir="ltr">Footer</code> components. However, they will run on <code dir="ltr">Sidebar</code> and <code dir="ltr">Content</code>, as well as all of the components inside them, no matter how deep.</p> <div class="note note-green">
<h4>Note</h4>
<div><p>When <code dir="ltr">StrictMode</code> is enabled for a part of the app, React will only enable behaviors that are possible in production. For example, if <code dir="ltr">&lt;StrictMode&gt;</code> is not enabled at the root of the app, it will not <a href="#fixing-bugs-found-by-re-running-effects-in-development">re-run Effects an extra time</a> on initial mount, since this would cause child effects to double fire without the parent effects, which cannot happen in production.</p></div>
</div> <hr> <h3 id="fixing-bugs-found-by-double-rendering-in-development">Fixing bugs found by double rendering in development <a href="#fixing-bugs-found-by-double-rendering-in-development" aria-label="Link for Fixing bugs found by double rendering in development " title="Link for Fixing bugs found by double rendering in development "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p><a href="../../learn/keeping-components-pure">React assumes that every component you write is a pure function.</a> This means that React components you write must always return the same JSX given the same inputs (props, state, and context).</p> <p>Components breaking this rule behave unpredictably and cause bugs. To help you find accidentally impure code, Strict Mode calls some of your functions (only the ones that should be pure) <strong>twice in development.</strong> This includes:</p> <ul> <li>Your component function body (only top-level logic, so this doesn‚Äôt include code inside event handlers)</li> <li>Functions that you pass to <a href="usestate"><code dir="ltr">useState</code></a>, <a href="usestate#setstate"><code dir="ltr">set</code> functions</a>, <a href="usememo"><code dir="ltr">useMemo</code></a>, or <a href="usereducer"><code dir="ltr">useReducer</code></a>
</li> <li>Some class component methods like <a href="component#constructor"><code dir="ltr">constructor</code></a>, <a href="component#render"><code dir="ltr">render</code></a>, <a href="component#shouldcomponentupdate"><code dir="ltr">shouldComponentUpdate</code></a> (<a href="https://reactjs.org/docs/strict-mode.html#detecting-unexpected-side-effects" target="_blank" rel="nofollow noopener noreferrer">see the whole list</a>)</li> </ul> <p>If a function is pure, running it twice does not change its behavior because a pure function produces the same result every time. However, if a function is impure (for example, it mutates the data it receives), running it twice tends to be noticeable (that‚Äôs what makes it impure!) This helps you spot and fix the bug early.</p> <p><strong>Here is an example to illustrate how double rendering in Strict Mode helps you find bugs early.</strong></p> <p>This <code dir="ltr">StoryTray</code> component takes an array of <code dir="ltr">stories</code> and adds one last ‚ÄúCreate Story‚Äù item at the end:</p> 
<pre data-language="jsx"><span>export</span> <span>default</span> <span>function</span> <span>StoryTray</span><span>(</span><span>{</span> <span>stories</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>items</span> = <span>stories</span><span>;</span>
  <span>items</span>.<span>push</span><span>(</span><span>{</span> <span>id</span><span>:</span> <span>'create'</span><span>,</span> <span>label</span><span>:</span> <span>'Create Story'</span> <span>}</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>ul</span><span>&gt;</span>
      <span>{</span><span>items</span>.<span>map</span><span>(</span><span>story</span> <span>=&gt;</span> <span>(</span>
        <span>&lt;</span><span>li</span> <span>key</span>=<span>{</span><span>story</span>.<span>id</span><span>}</span><span>&gt;</span>
          <span>{</span><span>story</span>.<span>label</span><span>}</span>
        <span>&lt;/</span><span>li</span><span>&gt;</span>
      <span>)</span><span>)</span><span>}</span>
    <span>&lt;/</span><span>ul</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>There is a mistake in the code above. However, it is easy to miss because the initial output appears correct.</p> <p>This mistake will become more noticeable if the <code dir="ltr">StoryTray</code> component re-renders multiple times. For example, let‚Äôs make the <code dir="ltr">StoryTray</code> re-render with a different background color whenever you hover over it:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>StoryTray</span><span>(</span><span>{</span> <span>stories</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isHover</span><span>,</span> <span>setIsHover</span><span>]</span> = <span>useState</span><span>(</span><span>false</span><span>)</span><span>;</span>
  <span>const</span> <span>items</span> = <span>stories</span><span>;</span>
  <span>items</span>.<span>push</span><span>(</span><span>{</span> <span>id</span><span>:</span> <span>'create'</span><span>,</span> <span>label</span><span>:</span> <span>'Create Story'</span> <span>}</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>ul</span>
      <span>onPointerEnter</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setIsHover</span><span>(</span><span>true</span><span>)</span><span>}</span>
      <span>onPointerLeave</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setIsHover</span><span>(</span><span>false</span><span>)</span><span>}</span>
      <span>style</span>=<span>{</span><span>{</span>
        <span>backgroundColor</span><span>:</span> <span>isHover</span> ? <span>'#ddd'</span> : <span>'#fff'</span>
      <span>}</span><span>}</span>
    <span>&gt;</span>
      <span>{</span><span>items</span>.<span>map</span><span>(</span><span>story</span> <span>=&gt;</span> <span>(</span>
        <span>&lt;</span><span>li</span> <span>key</span>=<span>{</span><span>story</span>.<span>id</span><span>}</span><span>&gt;</span>
          <span>{</span><span>story</span>.<span>label</span><span>}</span>
        <span>&lt;/</span><span>li</span><span>&gt;</span>
      <span>)</span><span>)</span><span>}</span>
    <span>&lt;/</span><span>ul</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Notice how every time you hover over the <code dir="ltr">StoryTray</code> component, ‚ÄúCreate Story‚Äù gets added to the list again. The intention of the code was to add it once at the end. But <code dir="ltr">StoryTray</code> directly modifies the <code dir="ltr">stories</code> array from the props. Every time <code dir="ltr">StoryTray</code> renders, it adds ‚ÄúCreate Story‚Äù again at the end of the same array. In other words, <code dir="ltr">StoryTray</code> is not a pure function‚Äîrunning it multiple times produces different results.</p> <p>To fix this problem, you can make a copy of the array, and modify that copy instead of the original one:</p> <pre data-language="jsx"><code><span>export</span> <span>default</span> <span>function</span> <span>StoryTray</span><span>(</span><span>{</span> <span>stories</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>items</span> = <span>stories</span>.<span>slice</span><span>(</span><span>)</span><span>;</span> <span>// Clone the array</span>
  <span>// ‚úÖ Good: Pushing into a new array</span>
  <span>items</span>.<span>push</span><span>(</span><span>{</span> <span>id</span><span>:</span> <span>'create'</span><span>,</span> <span>label</span><span>:</span> <span>'Create Story'</span> <span>}</span><span>)</span><span>;</span></code></pre> <p>This would <a href="../../learn/keeping-components-pure">make the <code dir="ltr">StoryTray</code> function pure.</a> Each time it is called, it would only modify a new copy of the array, and would not affect any external objects or variables. This solves the bug, but you had to make the component re-render more often before it became obvious that something is wrong with its behavior.</p> <p><strong>In the original example, the bug wasn‚Äôt obvious. Now let‚Äôs wrap the original (buggy) code in <code dir="ltr">&lt;StrictMode&gt;</code>:</strong></p> 
<pre data-language="jsx"><span>export</span> <span>default</span> <span>function</span> <span>StoryTray</span><span>(</span><span>{</span> <span>stories</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>items</span> = <span>stories</span><span>;</span>
  <span>items</span>.<span>push</span><span>(</span><span>{</span> <span>id</span><span>:</span> <span>'create'</span><span>,</span> <span>label</span><span>:</span> <span>'Create Story'</span> <span>}</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>ul</span><span>&gt;</span>
      <span>{</span><span>items</span>.<span>map</span><span>(</span><span>story</span> <span>=&gt;</span> <span>(</span>
        <span>&lt;</span><span>li</span> <span>key</span>=<span>{</span><span>story</span>.<span>id</span><span>}</span><span>&gt;</span>
          <span>{</span><span>story</span>.<span>label</span><span>}</span>
        <span>&lt;/</span><span>li</span><span>&gt;</span>
      <span>)</span><span>)</span><span>}</span>
    <span>&lt;/</span><span>ul</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p><strong>Strict Mode <em>always</em> calls your rendering function twice, so you can see the mistake right away</strong> (‚ÄúCreate Story‚Äù appears twice). This lets you notice such mistakes early in the process. When you fix your component to render in Strict Mode, you <em>also</em> fix many possible future production bugs like the hover functionality from before:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>StoryTray</span><span>(</span><span>{</span> <span>stories</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isHover</span><span>,</span> <span>setIsHover</span><span>]</span> = <span>useState</span><span>(</span><span>false</span><span>)</span><span>;</span>
  <span>const</span> <span>items</span> = <span>stories</span>.<span>slice</span><span>(</span><span>)</span><span>;</span> <span>// Clone the array</span>
  <span>items</span>.<span>push</span><span>(</span><span>{</span> <span>id</span><span>:</span> <span>'create'</span><span>,</span> <span>label</span><span>:</span> <span>'Create Story'</span> <span>}</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>ul</span>
      <span>onPointerEnter</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setIsHover</span><span>(</span><span>true</span><span>)</span><span>}</span>
      <span>onPointerLeave</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setIsHover</span><span>(</span><span>false</span><span>)</span><span>}</span>
      <span>style</span>=<span>{</span><span>{</span>
        <span>backgroundColor</span><span>:</span> <span>isHover</span> ? <span>'#ddd'</span> : <span>'#fff'</span>
      <span>}</span><span>}</span>
    <span>&gt;</span>
      <span>{</span><span>items</span>.<span>map</span><span>(</span><span>story</span> <span>=&gt;</span> <span>(</span>
        <span>&lt;</span><span>li</span> <span>key</span>=<span>{</span><span>story</span>.<span>id</span><span>}</span><span>&gt;</span>
          <span>{</span><span>story</span>.<span>label</span><span>}</span>
        <span>&lt;/</span><span>li</span><span>&gt;</span>
      <span>)</span><span>)</span><span>}</span>
    <span>&lt;/</span><span>ul</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Without Strict Mode, it was easy to miss the bug until you added more re-renders. Strict Mode made the same bug appear right away. Strict Mode helps you find bugs before you push them to your team and to your users.</p> <p><a href="../../learn/keeping-components-pure">Read more about keeping components pure.</a></p> <div class="note note-green">
<h4>Note</h4>
<div><p>If you have <a href="../../learn/react-developer-tools">React DevTools</a> installed, any <code dir="ltr">console.log</code> calls during the second render call will appear slightly dimmed. React DevTools also offers a setting (off by default) to suppress them completely.</p></div>
</div> <hr> <h3 id="fixing-bugs-found-by-re-running-effects-in-development">Fixing bugs found by re-running Effects in development <a href="#fixing-bugs-found-by-re-running-effects-in-development" aria-label="Link for Fixing bugs found by re-running Effects in development " title="Link for Fixing bugs found by re-running Effects in development "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Strict Mode can also help find bugs in <a href="../../learn/synchronizing-with-effects">Effects.</a></p> <p>Every Effect has some setup code and may have some cleanup code. Normally, React calls setup when the component <em>mounts</em> (is added to the screen) and calls cleanup when the component <em>unmounts</em> (is removed from the screen). React then calls cleanup and setup again if its dependencies changed since the last render.</p> <p>When Strict Mode is on, React will also run <strong>one extra setup+cleanup cycle in development for every Effect.</strong> This may feel surprising, but it helps reveal subtle bugs that are hard to catch manually.</p> <p><strong>Here is an example to illustrate how re-running Effects in Strict Mode helps you find bugs early.</strong></p> <p>Consider this example that connects a component to a chat:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>createRoot</span> <span>}</span> <span>from</span> <span>'react-dom/client'</span><span>;</span>
<span>import</span> <span>'./styles.css'</span><span>;</span>

<span>import</span> <span>App</span> <span>from</span> <span>'./App'</span><span>;</span>

<span>const</span> <span>root</span> = <span>createRoot</span><span>(</span><span>document</span>.<span>getElementById</span><span>(</span><span>"root"</span><span>)</span><span>)</span><span>;</span>
<span>root</span>.<span>render</span><span>(</span><span>&lt;</span><span>App</span> <span>/&gt;</span><span>)</span><span>;</span>

</pre> <p>There is an issue with this code, but it might not be immediately clear.</p> <p>To make the issue more obvious, let‚Äôs implement a feature. In the example below, <code dir="ltr">roomId</code> is not hardcoded. Instead, the user can select the <code dir="ltr">roomId</code> that they want to connect to from a dropdown. Click ‚ÄúOpen chat‚Äù and then select different chat rooms one by one. Keep track of the number of active connections in the console:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>createRoot</span> <span>}</span> <span>from</span> <span>'react-dom/client'</span><span>;</span>
<span>import</span> <span>'./styles.css'</span><span>;</span>

<span>import</span> <span>App</span> <span>from</span> <span>'./App'</span><span>;</span>

<span>const</span> <span>root</span> = <span>createRoot</span><span>(</span><span>document</span>.<span>getElementById</span><span>(</span><span>"root"</span><span>)</span><span>)</span><span>;</span>
<span>root</span>.<span>render</span><span>(</span><span>&lt;</span><span>App</span> <span>/&gt;</span><span>)</span><span>;</span>

</pre> <p>You‚Äôll notice that the number of open connections always keeps growing. In a real app, this would cause performance and network problems. The issue is that <a href="../../learn/synchronizing-with-effects#step-3-add-cleanup-if-needed">your Effect is missing a cleanup function:</a></p> <pre data-language="jsx"><code>  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>]</span><span>)</span><span>;</span></code></pre> <p>Now that your Effect ‚Äúcleans up‚Äù after itself and destroys the outdated connections, the leak is solved. However, notice that the problem did not become visible until you‚Äôve added more features (the select box).</p> <p><strong>In the original example, the bug wasn‚Äôt obvious. Now let‚Äôs wrap the original (buggy) code in <code dir="ltr">&lt;StrictMode&gt;</code>:</strong></p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>StrictMode</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>createRoot</span> <span>}</span> <span>from</span> <span>'react-dom/client'</span><span>;</span>
<span>import</span> <span>'./styles.css'</span><span>;</span>

<span>import</span> <span>App</span> <span>from</span> <span>'./App'</span><span>;</span>

<span>const</span> <span>root</span> = <span>createRoot</span><span>(</span><span>document</span>.<span>getElementById</span><span>(</span><span>"root"</span><span>)</span><span>)</span><span>;</span>
<span>root</span>.<span>render</span><span>(</span>
  <span>&lt;</span><span>StrictMode</span><span>&gt;</span>
    <span>&lt;</span><span>App</span> <span>/&gt;</span>
  <span>&lt;/</span><span>StrictMode</span><span>&gt;</span>
<span>)</span><span>;</span>

</pre> <p><strong>With Strict Mode, you immediately see that there is a problem</strong> (the number of active connections jumps to 2). Strict Mode runs an extra setup+cleanup cycle for every Effect. This Effect has no cleanup logic, so it creates an extra connection but doesn‚Äôt destroy it. This is a hint that you‚Äôre missing a cleanup function.</p> <p>Strict Mode lets you notice such mistakes early in the process. When you fix your Effect by adding a cleanup function in Strict Mode, you <em>also</em> fix many possible future production bugs like the select box from before:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>StrictMode</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>createRoot</span> <span>}</span> <span>from</span> <span>'react-dom/client'</span><span>;</span>
<span>import</span> <span>'./styles.css'</span><span>;</span>

<span>import</span> <span>App</span> <span>from</span> <span>'./App'</span><span>;</span>

<span>const</span> <span>root</span> = <span>createRoot</span><span>(</span><span>document</span>.<span>getElementById</span><span>(</span><span>"root"</span><span>)</span><span>)</span><span>;</span>
<span>root</span>.<span>render</span><span>(</span>
  <span>&lt;</span><span>StrictMode</span><span>&gt;</span>
    <span>&lt;</span><span>App</span> <span>/&gt;</span>
  <span>&lt;/</span><span>StrictMode</span><span>&gt;</span>
<span>)</span><span>;</span>

</pre> <p>Notice how the active connection count in the console doesn‚Äôt keep growing anymore.</p> <p>Without Strict Mode, it was easy to miss that your Effect needed cleanup. By running <em>setup ‚Üí cleanup ‚Üí setup</em> instead of <em>setup</em> for your Effect in development, Strict Mode made the missing cleanup logic more noticeable.</p> <p><a href="../../learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development">Read more about implementing Effect cleanup.</a></p> <hr> <h3 id="fixing-bugs-found-by-re-running-ref-callbacks-in-development">Fixing bugs found by re-running ref callbacks in development <a href="#fixing-bugs-found-by-re-running-ref-callbacks-in-development" aria-label="Link for Fixing bugs found by re-running ref callbacks in development " title="Link for Fixing bugs found by re-running ref callbacks in development "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Strict Mode can also help find bugs in <a href="../../learn/manipulating-the-dom-with-refs">callbacks refs.</a></p> <p>Every callback <code dir="ltr">ref</code> has some setup code and may have some cleanup code. Normally, React calls setup when the element is <em>created</em> (is added to the DOM) and calls cleanup when the element is <em>removed</em> (is removed from the DOM).</p> <p>When Strict Mode is on, React will also run <strong>one extra setup+cleanup cycle in development for every callback <code dir="ltr">ref</code>.</strong> This may feel surprising, but it helps reveal subtle bugs that are hard to catch manually.</p> <p>Consider this example, which allows you to select an animal and then scroll to one of them. Notice when you switch from ‚ÄúCats‚Äù to ‚ÄúDogs‚Äù, the console logs show that the number of animals in the list keeps growing, and the ‚ÄúScroll to‚Äù buttons stop working:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useRef</span><span>,</span> <span>useState</span> <span>}</span> <span>from</span> <span>"react"</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>CatFriends</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>itemsRef</span> = <span>useRef</span><span>(</span><span>[</span><span>]</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>catList</span><span>,</span> <span>setCatList</span><span>]</span> = <span>useState</span><span>(</span><span>setupCatList</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>cat</span><span>,</span> <span>setCat</span><span>]</span> = <span>useState</span><span>(</span><span>'neo'</span><span>)</span><span>;</span>

  <span>function</span> <span>scrollToCat</span><span>(</span><span>index</span><span>)</span> <span>{</span>
    <span>const</span> <span>list</span> = <span>itemsRef</span>.<span>current</span><span>;</span>
    <span>const</span> <span>{</span><span>node</span><span>}</span> = <span>list</span><span>[</span><span>index</span><span>]</span><span>;</span>
    <span>node</span>.<span>scrollIntoView</span><span>(</span><span>{</span>
      <span>behavior</span><span>:</span> <span>"smooth"</span><span>,</span>
      <span>block</span><span>:</span> <span>"nearest"</span><span>,</span>
      <span>inline</span><span>:</span> <span>"center"</span><span>,</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>const</span> <span>cats</span> = <span>catList</span>.<span>filter</span><span>(</span><span>c</span> <span>=&gt;</span> <span>c</span>.<span>type</span> === <span>cat</span><span>)</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>nav</span><span>&gt;</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setCat</span><span>(</span><span>'neo'</span><span>)</span><span>}</span><span>&gt;</span>Neo<span>&lt;/</span><span>button</span><span>&gt;</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setCat</span><span>(</span><span>'millie'</span><span>)</span><span>}</span><span>&gt;</span>Millie<span>&lt;/</span><span>button</span><span>&gt;</span>
      <span>&lt;/</span><span>nav</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>&lt;</span><span>nav</span><span>&gt;</span>
        <span>&lt;</span><span>span</span><span>&gt;</span>Scroll to:<span>&lt;/</span><span>span</span><span>&gt;</span><span>{</span><span>cats</span>.<span>map</span><span>(</span><span>(</span><span>cat</span><span>,</span> <span>index</span><span>)</span> <span>=&gt;</span> <span>(</span>
          <span>&lt;</span><span>button</span> <span>key</span>=<span>{</span><span>cat</span>.<span>src</span><span>}</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>scrollToCat</span><span>(</span><span>index</span><span>)</span><span>}</span><span>&gt;</span>
            <span>{</span><span>index</span><span>}</span>
          <span>&lt;/</span><span>button</span><span>&gt;</span>
        <span>)</span><span>)</span><span>}</span>
      <span>&lt;/</span><span>nav</span><span>&gt;</span>
      <span>&lt;</span><span>div</span><span>&gt;</span>
        <span>&lt;</span><span>ul</span><span>&gt;</span>
          <span>{</span><span>cats</span>.<span>map</span><span>(</span><span>(</span><span>cat</span><span>)</span> <span>=&gt;</span> <span>(</span>
            <span>&lt;</span><span>li</span>
              <span>key</span>=<span>{</span><span>cat</span>.<span>src</span><span>}</span>
              <span>ref</span>=<span>{</span><span>(</span><span>node</span><span>)</span> <span>=&gt;</span> <span>{</span>
                <span>const</span> <span>list</span> = <span>itemsRef</span>.<span>current</span><span>;</span>
                <span>const</span> <span>item</span> = <span>{</span><span>cat</span><span>:</span> <span>cat</span><span>,</span> <span>node</span><span>}</span><span>;</span>
                <span>list</span>.<span>push</span><span>(</span><span>item</span><span>)</span><span>;</span>
                <span>console</span>.<span>log</span><span>(</span><span>`‚úÖ Adding cat to the map. Total cats: </span><span>${</span><span>list</span>.<span>length</span><span>}</span><span>`</span><span>)</span><span>;</span>
                <span>if</span> <span>(</span><span>list</span>.<span>length</span> &gt; <span>10</span><span>)</span> <span>{</span>
                  <span>console</span>.<span>log</span><span>(</span><span>'‚ùå Too many cats in the list!'</span><span>)</span><span>;</span>
                <span>}</span>
                <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
                  <span>// üö© No cleanup, this is a bug!</span>
                <span>}</span>
              <span>}</span><span>}</span>
            <span>&gt;</span>
              <span>&lt;</span><span>img</span> <span>src</span>=<span>{</span><span>cat</span>.<span>src</span><span>}</span> <span>/&gt;</span>
            <span>&lt;/</span><span>li</span><span>&gt;</span>
          <span>)</span><span>)</span><span>}</span>
        <span>&lt;/</span><span>ul</span><span>&gt;</span>
      <span>&lt;/</span><span>div</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>setupCatList</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>catList</span> = <span>[</span><span>]</span><span>;</span>
  <span>for</span> <span>(</span><span>let</span> <span>i</span> = <span>0</span><span>;</span> <span>i</span> &lt; <span>10</span><span>;</span> <span>i</span>++<span>)</span> <span>{</span>
    <span>catList</span>.<span>push</span><span>(</span><span>{</span><span>type</span><span>:</span> <span>'neo'</span><span>,</span> <span>src</span><span>:</span> <span>"https://placecats.com/neo/320/240?"</span> + <span>i</span><span>}</span><span>)</span><span>;</span>
  <span>}</span>
  <span>for</span> <span>(</span><span>let</span> <span>i</span> = <span>0</span><span>;</span> <span>i</span> &lt; <span>10</span><span>;</span> <span>i</span>++<span>)</span> <span>{</span>
    <span>catList</span>.<span>push</span><span>(</span><span>{</span><span>type</span><span>:</span> <span>'millie'</span><span>,</span> <span>src</span><span>:</span> <span>"https://placecats.com/millie/320/240?"</span> + <span>i</span><span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>catList</span><span>;</span>
<span>}</span>

</pre> <p><strong>This is a production bug!</strong> Since the ref callback doesn‚Äôt remove animals from the list in the cleanup, the list of animals keeps growing. This is a memory leak that can cause performance problems in a real app, and breaks the behavior of the app.</p> <p>The issue is the ref callback doesn‚Äôt cleanup after itself:</p> <pre data-language="jsx"><code><span>&lt;</span><span>li</span>
  <span>ref</span>=<span>{</span><span>node</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>list</span> = <span>itemsRef</span>.<span>current</span><span>;</span>
    <span>const</span> <span>item</span> = <span>{</span><span>animal</span><span>,</span> <span>node</span><span>}</span><span>;</span>
    <span>list</span>.<span>push</span><span>(</span><span>item</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>// üö© No cleanup, this is a bug!</span>
    <span>}</span>
  <span>}</span><span>}</span>
&lt;<span>/li&gt;</span></code></pre> <p>Now let‚Äôs wrap the original (buggy) code in <code dir="ltr">&lt;StrictMode&gt;</code>:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useRef</span><span>,</span> <span>useState</span> <span>}</span> <span>from</span> <span>"react"</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>CatFriends</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>itemsRef</span> = <span>useRef</span><span>(</span><span>[</span><span>]</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>catList</span><span>,</span> <span>setCatList</span><span>]</span> = <span>useState</span><span>(</span><span>setupCatList</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>cat</span><span>,</span> <span>setCat</span><span>]</span> = <span>useState</span><span>(</span><span>'neo'</span><span>)</span><span>;</span>

  <span>function</span> <span>scrollToCat</span><span>(</span><span>index</span><span>)</span> <span>{</span>
    <span>const</span> <span>list</span> = <span>itemsRef</span>.<span>current</span><span>;</span>
    <span>const</span> <span>{</span><span>node</span><span>}</span> = <span>list</span><span>[</span><span>index</span><span>]</span><span>;</span>
    <span>node</span>.<span>scrollIntoView</span><span>(</span><span>{</span>
      <span>behavior</span><span>:</span> <span>"smooth"</span><span>,</span>
      <span>block</span><span>:</span> <span>"nearest"</span><span>,</span>
      <span>inline</span><span>:</span> <span>"center"</span><span>,</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>const</span> <span>cats</span> = <span>catList</span>.<span>filter</span><span>(</span><span>c</span> <span>=&gt;</span> <span>c</span>.<span>type</span> === <span>cat</span><span>)</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>nav</span><span>&gt;</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setCat</span><span>(</span><span>'neo'</span><span>)</span><span>}</span><span>&gt;</span>Neo<span>&lt;/</span><span>button</span><span>&gt;</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setCat</span><span>(</span><span>'millie'</span><span>)</span><span>}</span><span>&gt;</span>Millie<span>&lt;/</span><span>button</span><span>&gt;</span>
      <span>&lt;/</span><span>nav</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>&lt;</span><span>nav</span><span>&gt;</span>
        <span>&lt;</span><span>span</span><span>&gt;</span>Scroll to:<span>&lt;/</span><span>span</span><span>&gt;</span><span>{</span><span>cats</span>.<span>map</span><span>(</span><span>(</span><span>cat</span><span>,</span> <span>index</span><span>)</span> <span>=&gt;</span> <span>(</span>
          <span>&lt;</span><span>button</span> <span>key</span>=<span>{</span><span>cat</span>.<span>src</span><span>}</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>scrollToCat</span><span>(</span><span>index</span><span>)</span><span>}</span><span>&gt;</span>
            <span>{</span><span>index</span><span>}</span>
          <span>&lt;/</span><span>button</span><span>&gt;</span>
        <span>)</span><span>)</span><span>}</span>
      <span>&lt;/</span><span>nav</span><span>&gt;</span>
      <span>&lt;</span><span>div</span><span>&gt;</span>
        <span>&lt;</span><span>ul</span><span>&gt;</span>
          <span>{</span><span>cats</span>.<span>map</span><span>(</span><span>(</span><span>cat</span><span>)</span> <span>=&gt;</span> <span>(</span>
            <span>&lt;</span><span>li</span>
              <span>key</span>=<span>{</span><span>cat</span>.<span>src</span><span>}</span>
              <span>ref</span>=<span>{</span><span>(</span><span>node</span><span>)</span> <span>=&gt;</span> <span>{</span>
                <span>const</span> <span>list</span> = <span>itemsRef</span>.<span>current</span><span>;</span>
                <span>const</span> <span>item</span> = <span>{</span><span>cat</span><span>:</span> <span>cat</span><span>,</span> <span>node</span><span>}</span><span>;</span>
                <span>list</span>.<span>push</span><span>(</span><span>item</span><span>)</span><span>;</span>
                <span>console</span>.<span>log</span><span>(</span><span>`‚úÖ Adding cat to the map. Total cats: </span><span>${</span><span>list</span>.<span>length</span><span>}</span><span>`</span><span>)</span><span>;</span>
                <span>if</span> <span>(</span><span>list</span>.<span>length</span> &gt; <span>10</span><span>)</span> <span>{</span>
                  <span>console</span>.<span>log</span><span>(</span><span>'‚ùå Too many cats in the list!'</span><span>)</span><span>;</span>
                <span>}</span>
                <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
                  <span>// üö© No cleanup, this is a bug!</span>
                <span>}</span>
              <span>}</span><span>}</span>
            <span>&gt;</span>
              <span>&lt;</span><span>img</span> <span>src</span>=<span>{</span><span>cat</span>.<span>src</span><span>}</span> <span>/&gt;</span>
            <span>&lt;/</span><span>li</span><span>&gt;</span>
          <span>)</span><span>)</span><span>}</span>
        <span>&lt;/</span><span>ul</span><span>&gt;</span>
      <span>&lt;/</span><span>div</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>setupCatList</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>catList</span> = <span>[</span><span>]</span><span>;</span>
  <span>for</span> <span>(</span><span>let</span> <span>i</span> = <span>0</span><span>;</span> <span>i</span> &lt; <span>10</span><span>;</span> <span>i</span>++<span>)</span> <span>{</span>
    <span>catList</span>.<span>push</span><span>(</span><span>{</span><span>type</span><span>:</span> <span>'neo'</span><span>,</span> <span>src</span><span>:</span> <span>"https://placecats.com/neo/320/240?"</span> + <span>i</span><span>}</span><span>)</span><span>;</span>
  <span>}</span>
  <span>for</span> <span>(</span><span>let</span> <span>i</span> = <span>0</span><span>;</span> <span>i</span> &lt; <span>10</span><span>;</span> <span>i</span>++<span>)</span> <span>{</span>
    <span>catList</span>.<span>push</span><span>(</span><span>{</span><span>type</span><span>:</span> <span>'millie'</span><span>,</span> <span>src</span><span>:</span> <span>"https://placecats.com/millie/320/240?"</span> + <span>i</span><span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>catList</span><span>;</span>
<span>}</span>

</pre> <p><strong>With Strict Mode, you immediately see that there is a problem</strong>. Strict Mode runs an extra setup+cleanup cycle for every callback ref. This callback ref has no cleanup logic, so it adds refs but doesn‚Äôt remove them. This is a hint that you‚Äôre missing a cleanup function.</p> <p>Strict Mode lets you eagerly find mistakes in callback refs. When you fix your callback by adding a cleanup function in Strict Mode, you <em>also</em> fix many possible future production bugs like the ‚ÄúScroll to‚Äù bug from before:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useRef</span><span>,</span> <span>useState</span> <span>}</span> <span>from</span> <span>"react"</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>CatFriends</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>itemsRef</span> = <span>useRef</span><span>(</span><span>[</span><span>]</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>catList</span><span>,</span> <span>setCatList</span><span>]</span> = <span>useState</span><span>(</span><span>setupCatList</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>cat</span><span>,</span> <span>setCat</span><span>]</span> = <span>useState</span><span>(</span><span>'neo'</span><span>)</span><span>;</span>

  <span>function</span> <span>scrollToCat</span><span>(</span><span>index</span><span>)</span> <span>{</span>
    <span>const</span> <span>list</span> = <span>itemsRef</span>.<span>current</span><span>;</span>
    <span>const</span> <span>{</span><span>node</span><span>}</span> = <span>list</span><span>[</span><span>index</span><span>]</span><span>;</span>
    <span>node</span>.<span>scrollIntoView</span><span>(</span><span>{</span>
      <span>behavior</span><span>:</span> <span>"smooth"</span><span>,</span>
      <span>block</span><span>:</span> <span>"nearest"</span><span>,</span>
      <span>inline</span><span>:</span> <span>"center"</span><span>,</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>const</span> <span>cats</span> = <span>catList</span>.<span>filter</span><span>(</span><span>c</span> <span>=&gt;</span> <span>c</span>.<span>type</span> === <span>cat</span><span>)</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>nav</span><span>&gt;</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setCat</span><span>(</span><span>'neo'</span><span>)</span><span>}</span><span>&gt;</span>Neo<span>&lt;/</span><span>button</span><span>&gt;</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setCat</span><span>(</span><span>'millie'</span><span>)</span><span>}</span><span>&gt;</span>Millie<span>&lt;/</span><span>button</span><span>&gt;</span>
      <span>&lt;/</span><span>nav</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>&lt;</span><span>nav</span><span>&gt;</span>
        <span>&lt;</span><span>span</span><span>&gt;</span>Scroll to:<span>&lt;/</span><span>span</span><span>&gt;</span><span>{</span><span>cats</span>.<span>map</span><span>(</span><span>(</span><span>cat</span><span>,</span> <span>index</span><span>)</span> <span>=&gt;</span> <span>(</span>
          <span>&lt;</span><span>button</span> <span>key</span>=<span>{</span><span>cat</span>.<span>src</span><span>}</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>scrollToCat</span><span>(</span><span>index</span><span>)</span><span>}</span><span>&gt;</span>
            <span>{</span><span>index</span><span>}</span>
          <span>&lt;/</span><span>button</span><span>&gt;</span>
        <span>)</span><span>)</span><span>}</span>
      <span>&lt;/</span><span>nav</span><span>&gt;</span>
      <span>&lt;</span><span>div</span><span>&gt;</span>
        <span>&lt;</span><span>ul</span><span>&gt;</span>
          <span>{</span><span>cats</span>.<span>map</span><span>(</span><span>(</span><span>cat</span><span>)</span> <span>=&gt;</span> <span>(</span>
            <span>&lt;</span><span>li</span>
              <span>key</span>=<span>{</span><span>cat</span>.<span>src</span><span>}</span>
              <span>ref</span>=<span>{</span><span>(</span><span>node</span><span>)</span> <span>=&gt;</span> <span>{</span>
                <span>const</span> <span>list</span> = <span>itemsRef</span>.<span>current</span><span>;</span>
                <span>const</span> <span>item</span> = <span>{</span><span>cat</span><span>:</span> <span>cat</span><span>,</span> <span>node</span><span>}</span><span>;</span>
                <span>list</span>.<span>push</span><span>(</span><span>item</span><span>)</span><span>;</span>
                <span>console</span>.<span>log</span><span>(</span><span>`‚úÖ Adding cat to the map. Total cats: </span><span>${</span><span>list</span>.<span>length</span><span>}</span><span>`</span><span>)</span><span>;</span>
                <span>if</span> <span>(</span><span>list</span>.<span>length</span> &gt; <span>10</span><span>)</span> <span>{</span>
                  <span>console</span>.<span>log</span><span>(</span><span>'‚ùå Too many cats in the list!'</span><span>)</span><span>;</span>
                <span>}</span>
                <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
                  <span>list</span>.<span>splice</span><span>(</span><span>list</span>.<span>indexOf</span><span>(</span><span>item</span><span>)</span><span>)</span><span>;</span>
                  <span>console</span>.<span>log</span><span>(</span><span>`‚ùå Removing cat from the map. Total cats: </span><span>${</span><span>itemsRef</span>.<span>current</span>.<span>length</span><span>}</span><span>`</span><span>)</span><span>;</span>
                <span>}</span>
              <span>}</span><span>}</span>
            <span>&gt;</span>
              <span>&lt;</span><span>img</span> <span>src</span>=<span>{</span><span>cat</span>.<span>src</span><span>}</span> <span>/&gt;</span>
            <span>&lt;/</span><span>li</span><span>&gt;</span>
          <span>)</span><span>)</span><span>}</span>
        <span>&lt;/</span><span>ul</span><span>&gt;</span>
      <span>&lt;/</span><span>div</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>setupCatList</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>catList</span> = <span>[</span><span>]</span><span>;</span>
  <span>for</span> <span>(</span><span>let</span> <span>i</span> = <span>0</span><span>;</span> <span>i</span> &lt; <span>10</span><span>;</span> <span>i</span>++<span>)</span> <span>{</span>
    <span>catList</span>.<span>push</span><span>(</span><span>{</span><span>type</span><span>:</span> <span>'neo'</span><span>,</span> <span>src</span><span>:</span> <span>"https://placecats.com/neo/320/240?"</span> + <span>i</span><span>}</span><span>)</span><span>;</span>
  <span>}</span>
  <span>for</span> <span>(</span><span>let</span> <span>i</span> = <span>0</span><span>;</span> <span>i</span> &lt; <span>10</span><span>;</span> <span>i</span>++<span>)</span> <span>{</span>
    <span>catList</span>.<span>push</span><span>(</span><span>{</span><span>type</span><span>:</span> <span>'millie'</span><span>,</span> <span>src</span><span>:</span> <span>"https://placecats.com/millie/320/240?"</span> + <span>i</span><span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>catList</span><span>;</span>
<span>}</span>

</pre> <p>Now on inital mount in StrictMode, the ref callbacks are all setup, cleaned up, and setup again:</p> <pre data-language="jsx"><code><span>...</span>
<span>‚úÖ </span><span>Adding </span><span>animal </span><span>to </span><span>the </span><span>map</span>. <span>Total</span> animals<span>:</span> <span>10</span>
...
<span>‚ùå</span> <span>Removing </span><span>animal </span><span>from </span><span>the </span><span>map</span>. <span>Total</span> animals<span>:</span> <span>0</span>
...
<span>‚úÖ</span> <span>Adding </span><span>animal </span><span>to </span><span>the </span><span>map</span>. <span>Total</span> animals<span>:</span> <span>10</span></code></pre> <p><strong>This is expected.</strong> Strict Mode confirms that the ref callbacks are cleaned up correctly, so the size never grows above the expected amount. After the fix, there are no memory leaks, and all the features work as expected.</p> <p>Without Strict Mode, it was easy to miss the bug until you clicked around to app to notice broken features. Strict Mode made the bugs appear right away, before you push them to production.</p> <hr> <h3 id="fixing-deprecation-warnings-enabled-by-strict-mode">Fixing deprecation warnings enabled by Strict Mode <a href="#fixing-deprecation-warnings-enabled-by-strict-mode" aria-label="Link for Fixing deprecation warnings enabled by Strict Mode " title="Link for Fixing deprecation warnings enabled by Strict Mode "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>React warns if some component anywhere inside a <code dir="ltr">&lt;StrictMode&gt;</code> tree uses one of these deprecated APIs:</p> <ul> <li>
<code dir="ltr">UNSAFE_</code> class lifecycle methods like <a href="component#unsafe_componentwillmount"><code dir="ltr">UNSAFE_componentWillMount</code></a>. <a href="https://reactjs.org/blog/2018/03/27/update-on-async-rendering.html#migrating-from-legacy-lifecycles" target="_blank" rel="nofollow noopener noreferrer">See alternatives.</a>
</li> </ul> <p>These APIs are primarily used in older <a href="component">class components</a> so they rarely appear in modern apps.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2013&ndash;present Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://react.dev/reference/react/StrictMode" class="_attribution-link">https://react.dev/reference/react/StrictMode</a>
  </p>
</div>
