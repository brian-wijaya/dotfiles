<h1>Directives<a href="#undefined" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h1>
<div><p>React Compiler directives are special string literals that control whether specific functions are compiled.</p></div> <pre data-language="jsx"><code><span>function</span> <span>MyComponent</span><span>(</span><span>)</span> <span>{</span>
  <span>"use memo"</span><span>;</span> <span>// Opt this component into compilation</span>
  <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span><span>{</span><span>/* ... */</span>}<span>&lt;/</span><span>div</span><span>&gt;</span><span>;</span>
<span>}</span></code></pre> <ul>
<li>
<a href="#overview">Overview </a><ul>
<li><a href="#available-directives">Available directives </a></li>
<li><a href="#quick-comparison">Quick comparison </a></li>
</ul>
</li>
<li>
<a href="#usage">Usage </a><ul>
<li><a href="#function-level">Function-level directives </a></li>
<li><a href="#module-level">Module-level directives </a></li>
<li><a href="#compilation-modes">Compilation modes interaction </a></li>
</ul>
</li>
<li>
<a href="#best-practices">Best practices </a><ul>
<li><a href="#use-sparingly">Use directives sparingly </a></li>
<li><a href="#document-usage">Document directive usage </a></li>
<li><a href="#plan-removal">Plan for removal </a></li>
</ul>
</li>
<li>
<a href="#common-patterns">Common patterns </a><ul><li><a href="#gradual-adoption">Gradual adoption </a></li></ul>
</li>
<li>
<a href="#troubleshooting">Troubleshooting </a><ul><li><a href="#common-issues">Common issues </a></li></ul>
</li>
<li><a href="#see-also">See also </a></li>
</ul> <hr> <h2 id="overview">Overview <a href="#overview" aria-label="Link for Overview " title="Link for Overview "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>React Compiler directives provide fine-grained control over which functions are optimized by the compiler. They are string literals placed at the beginning of a function body or at the top of a module.</p> <h3 id="available-directives">Available directives <a href="#available-directives" aria-label="Link for Available directives " title="Link for Available directives "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <ul> <li>
<strong><a href="directives/use-memo"><code dir="ltr">"use memo"</code></a></strong> - Opts a function into compilation</li> <li>
<strong><a href="directives/use-no-memo"><code dir="ltr">"use no memo"</code></a></strong> - Opts a function out of compilation</li> </ul> <h3 id="quick-comparison">Quick comparison <a href="#quick-comparison" aria-label="Link for Quick comparison " title="Link for Quick comparison "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <table>
<thead><tr>
<th>Directive</th>
<th>Purpose</th>
<th>When to use</th>
</tr></thead>
<tbody>
<tr>
<td><a href="directives/use-memo"><code dir="ltr">"use memo"</code></a></td>
<td>Force compilation</td>
<td>When using <code dir="ltr">annotation</code> mode or to override <code dir="ltr">infer</code> mode heuristics</td>
</tr>
<tr>
<td><a href="directives/use-no-memo"><code dir="ltr">"use no memo"</code></a></td>
<td>Prevent compilation</td>
<td>Debugging issues or working with incompatible code</td>
</tr>
</tbody>
</table> <hr> <h2 id="usage">Usage <a href="#usage" aria-label="Link for Usage " title="Link for Usage "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="function-level">Function-level directives <a href="#function-level" aria-label="Link for Function-level directives " title="Link for Function-level directives "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Place directives at the beginning of a function to control its compilation:</p> <pre data-language="jsx"><code><span>// Opt into compilation</span>
<span>function</span> <span>OptimizedComponent</span><span>(</span><span>)</span> <span>{</span>
  <span>"use memo"</span><span>;</span>
  <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span>This will be optimized<span>&lt;/</span><span>div</span><span>&gt;</span><span>;</span>
<span>}</span>

<span>// Opt out of compilation</span>
<span>function</span> <span>UnoptimizedComponent</span><span>(</span><span>)</span> <span>{</span>
  <span>"use no memo"</span><span>;</span>
  <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span>This won't be optimized<span>&lt;/</span><span>div</span><span>&gt;</span><span>;</span>
<span>}</span></code></pre> <h3 id="module-level">Module-level directives <a href="#module-level" aria-label="Link for Module-level directives " title="Link for Module-level directives "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Place directives at the top of a file to affect all functions in that module:</p> <pre data-language="jsx"><code><span>// At the very top of the file</span>
<span>"use memo"</span><span>;</span>

<span>// All functions in this file will be compiled</span>
<span>function</span> <span>Component1</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span>Compiled<span>&lt;/</span><span>div</span><span>&gt;</span><span>;</span>
<span>}</span>

<span>function</span> <span>Component2</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span>Also compiled<span>&lt;/</span><span>div</span><span>&gt;</span><span>;</span>
<span>}</span>

<span>// Can be overridden at function level</span>
<span>function</span> <span>Component3</span><span>(</span><span>)</span> <span>{</span>
  <span>"use no memo"</span><span>;</span> <span>// This overrides the module directive</span>
  <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span>Not compiled<span>&lt;/</span><span>div</span><span>&gt;</span><span>;</span>
<span>}</span></code></pre> <h3 id="compilation-modes">Compilation modes interaction <a href="#compilation-modes" aria-label="Link for Compilation modes interaction " title="Link for Compilation modes interaction "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Directives behave differently depending on your <a href="compilationmode"><code dir="ltr">compilationMode</code></a>:</p> <ul> <li>
<strong><code dir="ltr">annotation</code> mode</strong>: Only functions with <code dir="ltr">"use memo"</code> are compiled</li> <li>
<strong><code dir="ltr">infer</code> mode</strong>: Compiler decides what to compile, directives override decisions</li> <li>
<strong><code dir="ltr">all</code> mode</strong>: Everything is compiled, <code dir="ltr">"use no memo"</code> can exclude specific functions</li> </ul> <hr> <h2 id="best-practices">Best practices <a href="#best-practices" aria-label="Link for Best practices " title="Link for Best practices "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="use-sparingly">Use directives sparingly <a href="#use-sparingly" aria-label="Link for Use directives sparingly " title="Link for Use directives sparingly "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Directives are escape hatches. Prefer configuring the compiler at the project level:</p> <pre data-language="jsx"><code><span>// ✅ Good - project-wide configuration</span>
<span>{</span>
  plugins<span>:</span> <span>[</span>
    <span>[</span><span>'babel-plugin-react-compiler'</span><span>,</span> <span>{</span>
      <span>compilationMode</span><span>:</span> <span>'infer'</span>
    <span>}</span><span>]</span>
  <span>]</span>
<span>}</span>

<span>// ⚠️ Use directives only when needed</span>
<span>function</span> <span>SpecialCase</span><span>(</span><span>)</span> <span>{</span>
  <span>"use no memo"</span><span>;</span> <span>// Document why this is needed</span>
  <span>// ...</span>
<span>}</span></code></pre> <h3 id="document-usage">Document directive usage <a href="#document-usage" aria-label="Link for Document directive usage " title="Link for Document directive usage "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Always explain why a directive is used:</p> <pre data-language="jsx"><code><span>// ✅ Good - clear explanation</span>
<span>function</span> <span>DataGrid</span><span>(</span><span>)</span> <span>{</span>
  <span>"use no memo"</span><span>;</span> <span>// TODO: Remove after fixing issue with dynamic row heights (JIRA-123)</span>
  <span>// Complex grid implementation</span>
<span>}</span>

<span>// ❌ Bad - no explanation</span>
<span>function</span> <span>Mystery</span><span>(</span><span>)</span> <span>{</span>
  <span>"use no memo"</span><span>;</span>
  <span>// ...</span>
<span>}</span></code></pre> <h3 id="plan-removal">Plan for removal <a href="#plan-removal" aria-label="Link for Plan for removal " title="Link for Plan for removal "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Opt-out directives should be temporary:</p> <ol> <li>Add the directive with a TODO comment</li> <li>Create a tracking issue</li> <li>Fix the underlying problem</li> <li>Remove the directive</li> </ol> <pre data-language="jsx"><code><span>function</span> <span>TemporaryWorkaround</span><span>(</span><span>)</span> <span>{</span>
  <span>"use no memo"</span><span>;</span> <span>// TODO: Remove after upgrading ThirdPartyLib to v2.0</span>
  <span>return</span> <span>&lt;</span><span>ThirdPartyComponent</span> <span>/&gt;</span><span>;</span>
<span>}</span></code></pre> <hr> <h2 id="common-patterns">Common patterns <a href="#common-patterns" aria-label="Link for Common patterns " title="Link for Common patterns "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="gradual-adoption">Gradual adoption <a href="#gradual-adoption" aria-label="Link for Gradual adoption " title="Link for Gradual adoption "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>When adopting the React Compiler in a large codebase:</p> <pre data-language="jsx"><code><span>// Start with annotation mode</span>
<span>{</span>
  compilationMode<span>:</span> <span>'annotation'</span>
<span>}</span>

<span>// Opt in stable components</span>
<span>function</span> <span>StableComponent</span><span>(</span><span>)</span> <span>{</span>
  <span>"use memo"</span><span>;</span>
  <span>// Well-tested component</span>
<span>}</span>

<span>// Later, switch to infer mode and opt out problematic ones</span>
<span>function</span> <span>ProblematicComponent</span><span>(</span><span>)</span> <span>{</span>
  <span>"use no memo"</span><span>;</span> <span>// Fix issues before removing</span>
  <span>// ...</span>
<span>}</span></code></pre> <hr> <h2 id="troubleshooting">Troubleshooting <a href="#troubleshooting" aria-label="Link for Troubleshooting " title="Link for Troubleshooting "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>For specific issues with directives, see the troubleshooting sections in:</p> <ul> <li><a href="directives/use-memo#troubleshooting"><code dir="ltr">"use memo"</code> troubleshooting</a></li> <li><a href="directives/use-no-memo#troubleshooting"><code dir="ltr">"use no memo"</code> troubleshooting</a></li> </ul> <h3 id="common-issues">Common issues <a href="#common-issues" aria-label="Link for Common issues " title="Link for Common issues "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <ol> <li>
<strong>Directive ignored</strong>: Check placement (must be first) and spelling</li> <li>
<strong>Compilation still happens</strong>: Check <code dir="ltr">ignoreUseNoForget</code> setting</li> <li>
<strong>Module directive not working</strong>: Ensure it’s before all imports</li> </ol> <hr> <h2 id="see-also">See also <a href="#see-also" aria-label="Link for See also " title="Link for See also "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <ul> <li>
<a href="compilationmode"><code dir="ltr">compilationMode</code></a> - Configure how the compiler chooses what to optimize</li> <li>
<a href="configuration"><code dir="ltr">Configuration</code></a> - Full compiler configuration options</li> <li>
<a href="../../learn/react-compiler" target="_blank" rel="nofollow noopener noreferrer">React Compiler documentation</a> - Getting started guide</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2013&ndash;present Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://react.dev/reference/react-compiler/directives" class="_attribution-link">https://react.dev/reference/react-compiler/directives</a>
  </p>
</div>
