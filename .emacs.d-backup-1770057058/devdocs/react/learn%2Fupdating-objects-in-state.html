<h1>Updating Objects in State<a href="#undefined" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h1>
<div><p>State can hold any kind of JavaScript value, including objects. But you shouldn’t change objects that you hold in the React state directly. Instead, when you want to update an object, you need to create a new one (or make a copy of an existing one), and then set the state to use that copy.</p></div> <div class="note">
<h4>You will learn</h4>
<ul> <li>How to correctly update an object in React state</li> <li>How to update a nested object without mutating it</li> <li>What immutability is, and how not to break it</li> <li>How to make object copying less repetitive with Immer</li> </ul>
</div> <h2 id="whats-a-mutation">What’s a mutation? <a href="#whats-a-mutation" aria-label="Link for What’s a mutation? " title="Link for What’s a mutation? "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>You can store any kind of JavaScript value in state.</p> <pre data-language="jsx"><code><span>const</span> <span>[</span><span>x</span><span>,</span> <span>setX</span><span>]</span> = <span>useState</span><span>(</span><span>0</span><span>)</span><span>;</span></code></pre> <p>So far you’ve been working with numbers, strings, and booleans. These kinds of JavaScript values are “immutable”, meaning unchangeable or “read-only”. You can trigger a re-render to <em>replace</em> a value:</p> <pre data-language="jsx"><code><span>setX</span><span>(</span><span>5</span><span>)</span><span>;</span></code></pre> <p>The <code dir="ltr">x</code> state changed from <code dir="ltr">0</code> to <code dir="ltr">5</code>, but the <em>number <code dir="ltr">0</code> itself</em> did not change. It’s not possible to make any changes to the built-in primitive values like numbers, strings, and booleans in JavaScript.</p> <p>Now consider an object in state:</p> <pre data-language="jsx"><code><span>const</span> <span>[</span><span>position</span><span>,</span> <span>setPosition</span><span>]</span> = <span>useState</span><span>(</span><span>{</span> <span>x</span><span>:</span> <span>0</span><span>,</span> <span>y</span><span>:</span> <span>0</span> <span>}</span><span>)</span><span>;</span></code></pre> <p>Technically, it is possible to change the contents of <em>the object itself</em>. <strong>This is called a mutation:</strong></p> <pre data-language="jsx"><code><span>position</span>.<span>x</span> = <span>5</span><span>;</span></code></pre> <p>However, although objects in React state are technically mutable, you should treat them <strong>as if</strong> they were immutable—like numbers, booleans, and strings. Instead of mutating them, you should always replace them.</p> <h2 id="treat-state-as-read-only">Treat state as read-only <a href="#treat-state-as-read-only" aria-label="Link for Treat state as read-only " title="Link for Treat state as read-only "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>In other words, you should <strong>treat any JavaScript object that you put into state as read-only.</strong></p> <p>This example holds an object in state to represent the current pointer position. The red dot is supposed to move when you touch or move the cursor over the preview area. But the dot stays in the initial position:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>MovingDot</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>position</span><span>,</span> <span>setPosition</span><span>]</span> = <span>useState</span><span>(</span><span>{</span>
    <span>x</span><span>:</span> <span>0</span><span>,</span>
    <span>y</span><span>:</span> <span>0</span>
  <span>}</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>div</span>
      <span>onPointerMove</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>{</span>
        <span>position</span>.<span>x</span> = <span>e</span>.<span>clientX</span><span>;</span>
        <span>position</span>.<span>y</span> = <span>e</span>.<span>clientY</span><span>;</span>
      <span>}</span><span>}</span>
      <span>style</span>=<span>{</span><span>{</span>
        <span>position</span><span>:</span> <span>'relative'</span><span>,</span>
        <span>width</span><span>:</span> <span>'100vw'</span><span>,</span>
        <span>height</span><span>:</span> <span>'100vh'</span><span>,</span>
      <span>}</span><span>}</span><span>&gt;</span>
      <span>&lt;</span><span>div</span> <span>style</span>=<span>{</span><span>{</span>
        <span>position</span><span>:</span> <span>'absolute'</span><span>,</span>
        <span>backgroundColor</span><span>:</span> <span>'red'</span><span>,</span>
        <span>borderRadius</span><span>:</span> <span>'50%'</span><span>,</span>
        <span>transform</span><span>:</span> <span>`translate(</span><span>${</span><span>position</span>.<span>x</span><span>}</span><span>px, </span><span>${</span><span>position</span>.<span>y</span><span>}</span><span>px)`</span><span>,</span>
        <span>left</span><span>:</span> -<span>10</span><span>,</span>
        <span>top</span><span>:</span> -<span>10</span><span>,</span>
        <span>width</span><span>:</span> <span>20</span><span>,</span>
        <span>height</span><span>:</span> <span>20</span><span>,</span>
      <span>}</span><span>}</span> <span>/&gt;</span>
    <span>&lt;/</span><span>div</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>The problem is with this bit of code.</p> <pre data-language="jsx"><code><span>onPointerMove</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>{</span>
  <span>position</span>.<span>x</span> = <span>e</span>.<span>clientX</span><span>;</span>
  <span>position</span>.<span>y</span> = <span>e</span>.<span>clientY</span><span>;</span>
<span>}</span><span>}</span></code></pre> <p>This code modifies the object assigned to <code dir="ltr">position</code> from <a href="state-as-a-snapshot#rendering-takes-a-snapshot-in-time">the previous render.</a> But without using the state setting function, React has no idea that object has changed. So React does not do anything in response. It’s like trying to change the order after you’ve already eaten the meal. While mutating state can work in some cases, we don’t recommend it. You should treat the state value you have access to in a render as read-only.</p> <p>To actually <a href="state-as-a-snapshot#setting-state-triggers-renders">trigger a re-render</a> in this case, <strong>create a <em>new</em> object and pass it to the state setting function:</strong></p> <pre data-language="jsx"><code><span>onPointerMove</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>{</span>
  <span>setPosition</span><span>(</span><span>{</span>
    <span>x</span><span>:</span> <span>e</span>.clientX<span>,</span>
    <span>y</span><span>:</span> <span>e</span>.clientY
  <span>}</span><span>)</span><span>;</span>
<span>}</span><span>}</span></code></pre> <p>With <code dir="ltr">setPosition</code>, you’re telling React:</p> <ul> <li>Replace <code dir="ltr">position</code> with this new object</li> <li>And render this component again</li> </ul> <p>Notice how the red dot now follows your pointer when you touch or hover over the preview area:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>MovingDot</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>position</span><span>,</span> <span>setPosition</span><span>]</span> = <span>useState</span><span>(</span><span>{</span>
    <span>x</span><span>:</span> <span>0</span><span>,</span>
    <span>y</span><span>:</span> <span>0</span>
  <span>}</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>div</span>
      <span>onPointerMove</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>{</span>
        <span>setPosition</span><span>(</span><span>{</span>
          <span>x</span><span>:</span> <span>e</span>.<span>clientX</span><span>,</span>
          <span>y</span><span>:</span> <span>e</span>.<span>clientY</span>
        <span>}</span><span>)</span><span>;</span>
      <span>}</span><span>}</span>
      <span>style</span>=<span>{</span><span>{</span>
        <span>position</span><span>:</span> <span>'relative'</span><span>,</span>
        <span>width</span><span>:</span> <span>'100vw'</span><span>,</span>
        <span>height</span><span>:</span> <span>'100vh'</span><span>,</span>
      <span>}</span><span>}</span><span>&gt;</span>
      <span>&lt;</span><span>div</span> <span>style</span>=<span>{</span><span>{</span>
        <span>position</span><span>:</span> <span>'absolute'</span><span>,</span>
        <span>backgroundColor</span><span>:</span> <span>'red'</span><span>,</span>
        <span>borderRadius</span><span>:</span> <span>'50%'</span><span>,</span>
        <span>transform</span><span>:</span> <span>`translate(</span><span>${</span><span>position</span>.<span>x</span><span>}</span><span>px, </span><span>${</span><span>position</span>.<span>y</span><span>}</span><span>px)`</span><span>,</span>
        <span>left</span><span>:</span> -<span>10</span><span>,</span>
        <span>top</span><span>:</span> -<span>10</span><span>,</span>
        <span>width</span><span>:</span> <span>20</span><span>,</span>
        <span>height</span><span>:</span> <span>20</span><span>,</span>
      <span>}</span><span>}</span> <span>/&gt;</span>
    <span>&lt;/</span><span>div</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <details class="note note-blue"><summary tabindex="-1"><h5>
<svg width="1.5em" height="1.5em" viewbox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M34.7409 59.7228L32.9567 58.9094C27.2672 56.3157 20.7328 56.3157 15.0433 58.9094C12.6018 60.0224 9.39163 59.0275 8.44602 56.0621C7.45647 52.9589 5.99975 46.5898 6 35.9997C6.00029 23.5648 8.00803 18.3599 9.11099 16.4196C9.67795 15.4222 10.5255 14.8455 11.2254 14.5264L12.0179 14.1651C19.6351 10.6926 28.4011 10.6738 36 14.1733C43.5989 10.6738 52.3649 10.6926 59.9821 14.1651L60.7746 14.5264C61.4745 14.8455 62.3221 15.4222 62.889 16.4196C63.992 18.3599 65.9997 23.5648 66 35.9997C66.0002 46.5898 64.5435 52.9589 63.554 56.0621C62.6084 59.0275 59.3982 60.0224 56.9567 58.9094C51.2672 56.3157 44.7328 56.3157 39.0433 58.9094L37.2591 59.7228C37.1986 59.7508 37.1373 59.7767 37.0753 59.8004C36.4484 60.0411 35.7556 60.0653 35.1102 59.8648C34.9847 59.8258 34.8613 59.7784 34.7409 59.7228ZM14.5068 19.6246C20.3733 16.9501 27.0874 16.8775 33 19.4067V52.473C26.7613 50.32 19.9378 50.471 13.7811 52.9261C13.0005 49.9843 11.9998 44.547 12 35.9998C12.0002 25.5786 13.4879 21.1893 14.1179 19.8018L14.5068 19.6246ZM39 52.473C45.2387 50.32 52.0622 50.471 58.2189 52.9261C58.9995 49.9843 60.0002 44.547 60 35.9998C59.9998 25.5786 58.5121 21.1893 57.8821 19.8018L57.4932 19.6246C51.6267 16.9501 44.9126 16.8775 39 19.4067V52.473Z" fill="currentColor"></path></svg>Deep Dive</h5>
<h4 id="local-mutation-is-fine">Local mutation is fine <a href="#local-mutation-is-fine" aria-label="Link for Local mutation is fine " title="Link for Local mutation is fine "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4></summary><div>
<p>Code like this is a problem because it modifies an <em>existing</em> object in state:</p>
<pre data-language="jsx"><code><span>position</span>.<span>x</span> = <span>e</span>.<span>clientX</span><span>;</span>
<span>position</span>.<span>y</span> = <span>e</span>.<span>clientY</span><span>;</span></code></pre>
<p>But code like this is <strong>absolutely fine</strong> because you’re mutating a fresh object you have <em>just created</em>:</p>
<pre data-language="jsx"><code><span>const</span> <span>nextPosition</span> = <span>{</span><span>}</span><span>;</span>
<span>nextPosition</span>.<span>x</span> = <span>e</span>.<span>clientX</span><span>;</span>
<span>nextPosition</span>.<span>y</span> = <span>e</span>.<span>clientY</span><span>;</span>
<span>setPosition</span><span>(</span><span>nextPosition</span><span>)</span><span>;</span></code></pre>
<p>In fact, it is completely equivalent to writing this:</p>
<pre data-language="jsx"><code><span>setPosition</span><span>(</span><span>{</span>
  <span>x</span><span>:</span> <span>e</span>.<span>clientX</span><span>,</span>
  <span>y</span><span>:</span> <span>e</span>.<span>clientY</span>
<span>}</span><span>)</span><span>;</span></code></pre>
<p>Mutation is only a problem when you change <em>existing</em> objects that are already in state. Mutating an object you’ve just created is okay because <em>no other code references it yet.</em> Changing it isn’t going to accidentally impact something that depends on it. This is called a “local mutation”. You can even do local mutation <a href="keeping-components-pure#local-mutation-your-components-little-secret">while rendering.</a> Very convenient and completely okay!</p>
</div></details> <h2 id="copying-objects-with-the-spread-syntax">Copying objects with the spread syntax <a href="#copying-objects-with-the-spread-syntax" aria-label="Link for Copying objects with the spread syntax " title="Link for Copying objects with the spread syntax "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>In the previous example, the <code dir="ltr">position</code> object is always created fresh from the current cursor position. But often, you will want to include <em>existing</em> data as a part of the new object you’re creating. For example, you may want to update <em>only one</em> field in a form, but keep the previous values for all other fields.</p> <p>These input fields don’t work because the <code dir="ltr">onChange</code> handlers mutate the state:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>Form</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>person</span><span>,</span> <span>setPerson</span><span>]</span> = <span>useState</span><span>(</span><span>{</span>
    <span>firstName</span><span>:</span> <span>'Barbara'</span><span>,</span>
    <span>lastName</span><span>:</span> <span>'Hepworth'</span><span>,</span>
    <span>email</span><span>:</span> <span>'bhepworth@sculpture.com'</span>
  <span>}</span><span>)</span><span>;</span>

  <span>function</span> <span>handleFirstNameChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>person</span>.<span>firstName</span> = <span>e</span>.<span>target</span>.<span>value</span><span>;</span>
  <span>}</span>

  <span>function</span> <span>handleLastNameChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>person</span>.<span>lastName</span> = <span>e</span>.<span>target</span>.<span>value</span><span>;</span>
  <span>}</span>

  <span>function</span> <span>handleEmailChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>person</span>.<span>email</span> = <span>e</span>.<span>target</span>.<span>value</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        First name:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>firstName</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleFirstNameChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Last name:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>lastName</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleLastNameChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Email:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>email</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleEmailChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>p</span><span>&gt;</span>
        <span>{</span><span>person</span>.<span>firstName</span><span>}</span><span>{</span><span>' '</span><span>}</span>
        <span>{</span><span>person</span>.<span>lastName</span><span>}</span><span>{</span><span>' '</span><span>}</span>
        (<span>{</span><span>person</span>.<span>email</span><span>}</span>)
      <span>&lt;/</span><span>p</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>For example, this line mutates the state from a past render:</p> <pre data-language="jsx"><code><span>person</span>.<span>firstName</span> = <span>e</span>.<span>target</span>.<span>value</span><span>;</span></code></pre> <p>The reliable way to get the behavior you’re looking for is to create a new object and pass it to <code dir="ltr">setPerson</code>. But here, you want to also <strong>copy the existing data into it</strong> because only one of the fields has changed:</p> <pre data-language="jsx"><code><span>setPerson</span><span>(</span><span>{</span>
  <span>firstName</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span><span>,</span> <span>// New first name from the input</span>
  <span>lastName</span><span>:</span> <span>person</span>.<span>lastName</span><span>,</span>
  <span>email</span><span>:</span> <span>person</span>.<span>email</span>
<span>}</span><span>)</span><span>;</span></code></pre> <p>You can use the <code dir="ltr">...</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax#spread_in_object_literals" target="_blank" rel="nofollow noopener noreferrer">object spread</a> syntax so that you don’t need to copy every property separately.</p> <pre data-language="jsx"><code><span>setPerson</span><span>(</span><span>{</span>
  <span>...</span><span>person</span><span>,</span> <span>// Copy the old fields</span>
  <span>firstName</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span> <span>// But override this one</span>
<span>}</span><span>)</span><span>;</span></code></pre> <p>Now the form works!</p> <p>Notice how you didn’t declare a separate state variable for each input field. For large forms, keeping all data grouped in an object is very convenient—as long as you update it correctly!</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>Form</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>person</span><span>,</span> <span>setPerson</span><span>]</span> = <span>useState</span><span>(</span><span>{</span>
    <span>firstName</span><span>:</span> <span>'Barbara'</span><span>,</span>
    <span>lastName</span><span>:</span> <span>'Hepworth'</span><span>,</span>
    <span>email</span><span>:</span> <span>'bhepworth@sculpture.com'</span>
  <span>}</span><span>)</span><span>;</span>

  <span>function</span> <span>handleFirstNameChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setPerson</span><span>(</span><span>{</span>
      <span>...</span><span>person</span><span>,</span>
      <span>firstName</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>function</span> <span>handleLastNameChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setPerson</span><span>(</span><span>{</span>
      <span>...</span><span>person</span><span>,</span>
      <span>lastName</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>function</span> <span>handleEmailChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setPerson</span><span>(</span><span>{</span>
      <span>...</span><span>person</span><span>,</span>
      <span>email</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        First name:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>firstName</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleFirstNameChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Last name:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>lastName</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleLastNameChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Email:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>email</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleEmailChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>p</span><span>&gt;</span>
        <span>{</span><span>person</span>.<span>firstName</span><span>}</span><span>{</span><span>' '</span><span>}</span>
        <span>{</span><span>person</span>.<span>lastName</span><span>}</span><span>{</span><span>' '</span><span>}</span>
        (<span>{</span><span>person</span>.<span>email</span><span>}</span>)
      <span>&lt;/</span><span>p</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Note that the <code dir="ltr">...</code> spread syntax is “shallow”—it only copies things one level deep. This makes it fast, but it also means that if you want to update a nested property, you’ll have to use it more than once.</p> <details class="note note-blue"><summary tabindex="-1"><h5>
<svg width="1.5em" height="1.5em" viewbox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M34.7409 59.7228L32.9567 58.9094C27.2672 56.3157 20.7328 56.3157 15.0433 58.9094C12.6018 60.0224 9.39163 59.0275 8.44602 56.0621C7.45647 52.9589 5.99975 46.5898 6 35.9997C6.00029 23.5648 8.00803 18.3599 9.11099 16.4196C9.67795 15.4222 10.5255 14.8455 11.2254 14.5264L12.0179 14.1651C19.6351 10.6926 28.4011 10.6738 36 14.1733C43.5989 10.6738 52.3649 10.6926 59.9821 14.1651L60.7746 14.5264C61.4745 14.8455 62.3221 15.4222 62.889 16.4196C63.992 18.3599 65.9997 23.5648 66 35.9997C66.0002 46.5898 64.5435 52.9589 63.554 56.0621C62.6084 59.0275 59.3982 60.0224 56.9567 58.9094C51.2672 56.3157 44.7328 56.3157 39.0433 58.9094L37.2591 59.7228C37.1986 59.7508 37.1373 59.7767 37.0753 59.8004C36.4484 60.0411 35.7556 60.0653 35.1102 59.8648C34.9847 59.8258 34.8613 59.7784 34.7409 59.7228ZM14.5068 19.6246C20.3733 16.9501 27.0874 16.8775 33 19.4067V52.473C26.7613 50.32 19.9378 50.471 13.7811 52.9261C13.0005 49.9843 11.9998 44.547 12 35.9998C12.0002 25.5786 13.4879 21.1893 14.1179 19.8018L14.5068 19.6246ZM39 52.473C45.2387 50.32 52.0622 50.471 58.2189 52.9261C58.9995 49.9843 60.0002 44.547 60 35.9998C59.9998 25.5786 58.5121 21.1893 57.8821 19.8018L57.4932 19.6246C51.6267 16.9501 44.9126 16.8775 39 19.4067V52.473Z" fill="currentColor"></path></svg>Deep Dive</h5>
<h4 id="using-a-single-event-handler-for-multiple-fields">Using a single event handler for multiple fields <a href="#using-a-single-event-handler-for-multiple-fields" aria-label="Link for Using a single event handler for multiple fields " title="Link for Using a single event handler for multiple fields "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4></summary><div>
<p>You can also use the <code dir="ltr">[</code> and <code dir="ltr">]</code> braces inside your object definition to specify a property with a dynamic name. Here is the same example, but with a single event handler instead of three different ones:</p>

<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>Form</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>person</span><span>,</span> <span>setPerson</span><span>]</span> = <span>useState</span><span>(</span><span>{</span>
    <span>firstName</span><span>:</span> <span>'Barbara'</span><span>,</span>
    <span>lastName</span><span>:</span> <span>'Hepworth'</span><span>,</span>
    <span>email</span><span>:</span> <span>'bhepworth@sculpture.com'</span>
  <span>}</span><span>)</span><span>;</span>

  <span>function</span> <span>handleChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setPerson</span><span>(</span><span>{</span>
      <span>...</span><span>person</span><span>,</span>
      <span>[</span><span>e</span>.<span>target</span>.<span>name</span><span>]</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        First name:
        <span>&lt;</span><span>input</span>
          <span>name</span>=<span>"firstName"</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>firstName</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Last name:
        <span>&lt;</span><span>input</span>
          <span>name</span>=<span>"lastName"</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>lastName</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Email:
        <span>&lt;</span><span>input</span>
          <span>name</span>=<span>"email"</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>email</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>p</span><span>&gt;</span>
        <span>{</span><span>person</span>.<span>firstName</span><span>}</span><span>{</span><span>' '</span><span>}</span>
        <span>{</span><span>person</span>.<span>lastName</span><span>}</span><span>{</span><span>' '</span><span>}</span>
        (<span>{</span><span>person</span>.<span>email</span><span>}</span>)
      <span>&lt;/</span><span>p</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre>
<p>Here, <code dir="ltr">e.target.name</code> refers to the <code dir="ltr">name</code> property given to the <code dir="ltr">&lt;input&gt;</code> DOM element.</p>
</div></details> <h2 id="updating-a-nested-object">Updating a nested object <a href="#updating-a-nested-object" aria-label="Link for Updating a nested object " title="Link for Updating a nested object "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>Consider a nested object structure like this:</p> <pre data-language="jsx"><code><span>const</span> <span>[</span><span>person</span><span>,</span> <span>setPerson</span><span>]</span> = <span>useState</span><span>(</span><span>{</span>
  <span>name</span><span>:</span> <span>'Niki de Saint Phalle'</span><span>,</span>
  <span>artwork</span><span>:</span> <span>{</span>
    <span>title</span><span>:</span> <span>'Blue Nana'</span><span>,</span>
    <span>city</span><span>:</span> <span>'Hamburg'</span><span>,</span>
    <span>image</span><span>:</span> <span>'https://i.imgur.com/Sd1AgUOm.jpg'</span><span>,</span>
  <span>}</span>
<span>}</span><span>)</span><span>;</span></code></pre> <p>If you wanted to update <code dir="ltr">person.artwork.city</code>, it’s clear how to do it with mutation:</p> <pre data-language="jsx"><code><span>person</span>.<span>artwork</span>.<span>city</span> = <span>'New Delhi'</span><span>;</span></code></pre> <p>But in React, you treat state as immutable! In order to change <code dir="ltr">city</code>, you would first need to produce the new <code dir="ltr">artwork</code> object (pre-populated with data from the previous one), and then produce the new <code dir="ltr">person</code> object which points at the new <code dir="ltr">artwork</code>:</p> <pre data-language="jsx"><code><span>const</span> <span>nextArtwork</span> = <span>{</span> <span>...</span><span>person</span>.<span>artwork</span><span>,</span> <span>city</span><span>:</span> <span>'New Delhi'</span> <span>}</span><span>;</span>
<span>const</span> <span>nextPerson</span> = <span>{</span> <span>...</span><span>person</span><span>,</span> <span>artwork</span><span>:</span> <span>nextArtwork</span> <span>}</span><span>;</span>
<span>setPerson</span><span>(</span><span>nextPerson</span><span>)</span><span>;</span></code></pre> <p>Or, written as a single function call:</p> <pre data-language="jsx"><code><span>setPerson</span><span>(</span><span>{</span>
  <span>...</span><span>person</span><span>,</span> <span>// Copy other fields</span>
  <span>artwork</span><span>:</span> <span>{</span> <span>// but replace the artwork</span>
    <span>...</span><span>person</span>.<span>artwork</span><span>,</span> <span>// with the same one</span>
    <span>city</span><span>:</span> <span>'New Delhi'</span> <span>// but in New Delhi!</span>
  <span>}</span>
<span>}</span><span>)</span><span>;</span></code></pre> <p>This gets a bit wordy, but it works fine for many cases:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>Form</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>person</span><span>,</span> <span>setPerson</span><span>]</span> = <span>useState</span><span>(</span><span>{</span>
    <span>name</span><span>:</span> <span>'Niki de Saint Phalle'</span><span>,</span>
    <span>artwork</span><span>:</span> <span>{</span>
      <span>title</span><span>:</span> <span>'Blue Nana'</span><span>,</span>
      <span>city</span><span>:</span> <span>'Hamburg'</span><span>,</span>
      <span>image</span><span>:</span> <span>'https://i.imgur.com/Sd1AgUOm.jpg'</span><span>,</span>
    <span>}</span>
  <span>}</span><span>)</span><span>;</span>

  <span>function</span> <span>handleNameChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setPerson</span><span>(</span><span>{</span>
      <span>...</span><span>person</span><span>,</span>
      <span>name</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>function</span> <span>handleTitleChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setPerson</span><span>(</span><span>{</span>
      <span>...</span><span>person</span><span>,</span>
      <span>artwork</span><span>:</span> <span>{</span>
        <span>...</span><span>person</span>.<span>artwork</span><span>,</span>
        <span>title</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span>
      <span>}</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>function</span> <span>handleCityChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setPerson</span><span>(</span><span>{</span>
      <span>...</span><span>person</span><span>,</span>
      <span>artwork</span><span>:</span> <span>{</span>
        <span>...</span><span>person</span>.<span>artwork</span><span>,</span>
        <span>city</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span>
      <span>}</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>function</span> <span>handleImageChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setPerson</span><span>(</span><span>{</span>
      <span>...</span><span>person</span><span>,</span>
      <span>artwork</span><span>:</span> <span>{</span>
        <span>...</span><span>person</span>.<span>artwork</span><span>,</span>
        <span>image</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span>
      <span>}</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Name:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>name</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleNameChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Title:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>artwork</span>.<span>title</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleTitleChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        City:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>artwork</span>.<span>city</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleCityChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Image:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>person</span>.<span>artwork</span>.<span>image</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleImageChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>p</span><span>&gt;</span>
        <span>&lt;</span><span>i</span><span>&gt;</span><span>{</span><span>person</span>.<span>artwork</span>.<span>title</span><span>}</span><span>&lt;/</span><span>i</span><span>&gt;</span>
        <span>{</span><span>' by '</span><span>}</span>
        <span>{</span><span>person</span>.<span>name</span><span>}</span>
        <span>&lt;</span><span>br</span> <span>/&gt;</span>
        (located in <span>{</span><span>person</span>.<span>artwork</span>.<span>city</span><span>}</span>)
      <span>&lt;/</span><span>p</span><span>&gt;</span>
      <span>&lt;</span><span>img</span> 
        <span>src</span>=<span>{</span><span>person</span>.<span>artwork</span>.<span>image</span><span>}</span> 
        <span>alt</span>=<span>{</span><span>person</span>.<span>artwork</span>.<span>title</span><span>}</span>
      <span>/&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <details class="note note-blue"><summary tabindex="-1"><h5>
<svg width="1.5em" height="1.5em" viewbox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M34.7409 59.7228L32.9567 58.9094C27.2672 56.3157 20.7328 56.3157 15.0433 58.9094C12.6018 60.0224 9.39163 59.0275 8.44602 56.0621C7.45647 52.9589 5.99975 46.5898 6 35.9997C6.00029 23.5648 8.00803 18.3599 9.11099 16.4196C9.67795 15.4222 10.5255 14.8455 11.2254 14.5264L12.0179 14.1651C19.6351 10.6926 28.4011 10.6738 36 14.1733C43.5989 10.6738 52.3649 10.6926 59.9821 14.1651L60.7746 14.5264C61.4745 14.8455 62.3221 15.4222 62.889 16.4196C63.992 18.3599 65.9997 23.5648 66 35.9997C66.0002 46.5898 64.5435 52.9589 63.554 56.0621C62.6084 59.0275 59.3982 60.0224 56.9567 58.9094C51.2672 56.3157 44.7328 56.3157 39.0433 58.9094L37.2591 59.7228C37.1986 59.7508 37.1373 59.7767 37.0753 59.8004C36.4484 60.0411 35.7556 60.0653 35.1102 59.8648C34.9847 59.8258 34.8613 59.7784 34.7409 59.7228ZM14.5068 19.6246C20.3733 16.9501 27.0874 16.8775 33 19.4067V52.473C26.7613 50.32 19.9378 50.471 13.7811 52.9261C13.0005 49.9843 11.9998 44.547 12 35.9998C12.0002 25.5786 13.4879 21.1893 14.1179 19.8018L14.5068 19.6246ZM39 52.473C45.2387 50.32 52.0622 50.471 58.2189 52.9261C58.9995 49.9843 60.0002 44.547 60 35.9998C59.9998 25.5786 58.5121 21.1893 57.8821 19.8018L57.4932 19.6246C51.6267 16.9501 44.9126 16.8775 39 19.4067V52.473Z" fill="currentColor"></path></svg>Deep Dive</h5>
<h4 id="objects-are-not-really-nested">Objects are not really nested <a href="#objects-are-not-really-nested" aria-label="Link for Objects are not really nested " title="Link for Objects are not really nested "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4></summary><div>
<p>An object like this appears “nested” in code:</p>
<pre data-language="jsx"><code><span>let</span> <span>obj</span> = <span>{</span>
  <span>name</span><span>:</span> <span>'Niki de Saint Phalle'</span><span>,</span>
  <span>artwork</span><span>:</span> <span>{</span>
    <span>title</span><span>:</span> <span>'Blue Nana'</span><span>,</span>
    <span>city</span><span>:</span> <span>'Hamburg'</span><span>,</span>
    <span>image</span><span>:</span> <span>'https://i.imgur.com/Sd1AgUOm.jpg'</span><span>,</span>
  <span>}</span>
<span>}</span><span>;</span></code></pre>
<p>However, “nesting” is an inaccurate way to think about how objects behave. When the code executes, there is no such thing as a “nested” object. You are really looking at two different objects:</p>
<pre data-language="jsx"><code><span>let</span> <span>obj1</span> = <span>{</span>
  <span>title</span><span>:</span> <span>'Blue Nana'</span><span>,</span>
  <span>city</span><span>:</span> <span>'Hamburg'</span><span>,</span>
  <span>image</span><span>:</span> <span>'https://i.imgur.com/Sd1AgUOm.jpg'</span><span>,</span>
<span>}</span><span>;</span>

<span>let</span> <span>obj2</span> = <span>{</span>
  <span>name</span><span>:</span> <span>'Niki de Saint Phalle'</span><span>,</span>
  <span>artwork</span><span>:</span> <span>obj1</span>
<span>}</span><span>;</span></code></pre>
<p>The <code dir="ltr">obj1</code> object is not “inside” <code dir="ltr">obj2</code>. For example, <code dir="ltr">obj3</code> could “point” at <code dir="ltr">obj1</code> too:</p>
<pre data-language="jsx"><code><span>let</span> <span>obj1</span> = <span>{</span>
  <span>title</span><span>:</span> <span>'Blue Nana'</span><span>,</span>
  <span>city</span><span>:</span> <span>'Hamburg'</span><span>,</span>
  <span>image</span><span>:</span> <span>'https://i.imgur.com/Sd1AgUOm.jpg'</span><span>,</span>
<span>}</span><span>;</span>

<span>let</span> <span>obj2</span> = <span>{</span>
  <span>name</span><span>:</span> <span>'Niki de Saint Phalle'</span><span>,</span>
  <span>artwork</span><span>:</span> <span>obj1</span>
<span>}</span><span>;</span>

<span>let</span> <span>obj3</span> = <span>{</span>
  <span>name</span><span>:</span> <span>'Copycat'</span><span>,</span>
  <span>artwork</span><span>:</span> <span>obj1</span>
<span>}</span><span>;</span></code></pre>
<p>If you were to mutate <code dir="ltr">obj3.artwork.city</code>, it would affect both <code dir="ltr">obj2.artwork.city</code> and <code dir="ltr">obj1.city</code>. This is because <code dir="ltr">obj3.artwork</code>, <code dir="ltr">obj2.artwork</code>, and <code dir="ltr">obj1</code> are the same object. This is difficult to see when you think of objects as “nested”. Instead, they are separate objects “pointing” at each other with properties.</p>
</div></details> <h3 id="write-concise-update-logic-with-immer">Write concise update logic with Immer <a href="#write-concise-update-logic-with-immer" aria-label="Link for Write concise update logic with Immer " title="Link for Write concise update logic with Immer "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>If your state is deeply nested, you might want to consider <a href="choosing-the-state-structure#avoid-deeply-nested-state">flattening it.</a> But, if you don’t want to change your state structure, you might prefer a shortcut to nested spreads. <a href="https://github.com/immerjs/use-immer" target="_blank" rel="nofollow noopener noreferrer">Immer</a> is a popular library that lets you write using the convenient but mutating syntax and takes care of producing the copies for you. With Immer, the code you write looks like you are “breaking the rules” and mutating an object:</p> <pre data-language="jsx"><code><span>updatePerson</span><span>(</span><span>draft</span> <span>=&gt;</span> <span>{</span>
  <span>draft</span>.<span>artwork</span>.<span>city</span> = <span>'Lagos'</span><span>;</span>
<span>}</span><span>)</span><span>;</span></code></pre> <p>But unlike a regular mutation, it doesn’t overwrite the past state!</p> <details class="note note-blue"><summary tabindex="-1"><h5>
<svg width="1.5em" height="1.5em" viewbox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M34.7409 59.7228L32.9567 58.9094C27.2672 56.3157 20.7328 56.3157 15.0433 58.9094C12.6018 60.0224 9.39163 59.0275 8.44602 56.0621C7.45647 52.9589 5.99975 46.5898 6 35.9997C6.00029 23.5648 8.00803 18.3599 9.11099 16.4196C9.67795 15.4222 10.5255 14.8455 11.2254 14.5264L12.0179 14.1651C19.6351 10.6926 28.4011 10.6738 36 14.1733C43.5989 10.6738 52.3649 10.6926 59.9821 14.1651L60.7746 14.5264C61.4745 14.8455 62.3221 15.4222 62.889 16.4196C63.992 18.3599 65.9997 23.5648 66 35.9997C66.0002 46.5898 64.5435 52.9589 63.554 56.0621C62.6084 59.0275 59.3982 60.0224 56.9567 58.9094C51.2672 56.3157 44.7328 56.3157 39.0433 58.9094L37.2591 59.7228C37.1986 59.7508 37.1373 59.7767 37.0753 59.8004C36.4484 60.0411 35.7556 60.0653 35.1102 59.8648C34.9847 59.8258 34.8613 59.7784 34.7409 59.7228ZM14.5068 19.6246C20.3733 16.9501 27.0874 16.8775 33 19.4067V52.473C26.7613 50.32 19.9378 50.471 13.7811 52.9261C13.0005 49.9843 11.9998 44.547 12 35.9998C12.0002 25.5786 13.4879 21.1893 14.1179 19.8018L14.5068 19.6246ZM39 52.473C45.2387 50.32 52.0622 50.471 58.2189 52.9261C58.9995 49.9843 60.0002 44.547 60 35.9998C59.9998 25.5786 58.5121 21.1893 57.8821 19.8018L57.4932 19.6246C51.6267 16.9501 44.9126 16.8775 39 19.4067V52.473Z" fill="currentColor"></path></svg>Deep Dive</h5>
<h4 id="how-does-immer-work">How does Immer work? <a href="#how-does-immer-work" aria-label="Link for How does Immer work? " title="Link for How does Immer work? "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4></summary><div><p>The <code dir="ltr">draft</code> provided by Immer is a special type of object, called a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="nofollow noopener noreferrer">Proxy</a>, that “records” what you do with it. This is why you can mutate it freely as much as you like! Under the hood, Immer figures out which parts of the <code dir="ltr">draft</code> have been changed, and produces a completely new object that contains your edits.</p></div></details> <p>To try Immer:</p> <ol> <li>Run <code dir="ltr">npm install use-immer</code> to add Immer as a dependency</li> <li>Then replace <code dir="ltr">import { useState } from 'react'</code> with <code dir="ltr">import { useImmer } from 'use-immer'</code>
</li> </ol> <p>Here is the above example converted to Immer:</p> 
<pre data-language="jsx"><span>{</span>
  <span>"dependencies"</span><span>:</span> <span>{</span>
    <span>"immer"</span><span>:</span> <span>"1.7.3"</span><span>,</span>
    <span>"react"</span><span>:</span> <span>"latest"</span><span>,</span>
    <span>"react-dom"</span><span>:</span> <span>"latest"</span><span>,</span>
    <span>"react-scripts"</span><span>:</span> <span>"latest"</span><span>,</span>
    <span>"use-immer"</span><span>:</span> <span>"0.5.1"</span>
  <span>}</span><span>,</span>
  <span>"scripts"</span><span>:</span> <span>{</span>
    <span>"start"</span><span>:</span> <span>"react-scripts start"</span><span>,</span>
    <span>"build"</span><span>:</span> <span>"react-scripts build"</span><span>,</span>
    <span>"test"</span><span>:</span> <span>"react-scripts test --env=jsdom"</span><span>,</span>
    <span>"eject"</span><span>:</span> <span>"react-scripts eject"</span>
  <span>}</span><span>,</span>
  <span>"devDependencies"</span><span>:</span> <span>{</span><span>}</span>
<span>}</span></pre> <p>Notice how much more concise the event handlers have become. You can mix and match <code dir="ltr">useState</code> and <code dir="ltr">useImmer</code> in a single component as much as you like. Immer is a great way to keep the update handlers concise, especially if there’s nesting in your state, and copying objects leads to repetitive code.</p> <details class="note note-blue"><summary tabindex="-1"><h5>
<svg width="1.5em" height="1.5em" viewbox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M34.7409 59.7228L32.9567 58.9094C27.2672 56.3157 20.7328 56.3157 15.0433 58.9094C12.6018 60.0224 9.39163 59.0275 8.44602 56.0621C7.45647 52.9589 5.99975 46.5898 6 35.9997C6.00029 23.5648 8.00803 18.3599 9.11099 16.4196C9.67795 15.4222 10.5255 14.8455 11.2254 14.5264L12.0179 14.1651C19.6351 10.6926 28.4011 10.6738 36 14.1733C43.5989 10.6738 52.3649 10.6926 59.9821 14.1651L60.7746 14.5264C61.4745 14.8455 62.3221 15.4222 62.889 16.4196C63.992 18.3599 65.9997 23.5648 66 35.9997C66.0002 46.5898 64.5435 52.9589 63.554 56.0621C62.6084 59.0275 59.3982 60.0224 56.9567 58.9094C51.2672 56.3157 44.7328 56.3157 39.0433 58.9094L37.2591 59.7228C37.1986 59.7508 37.1373 59.7767 37.0753 59.8004C36.4484 60.0411 35.7556 60.0653 35.1102 59.8648C34.9847 59.8258 34.8613 59.7784 34.7409 59.7228ZM14.5068 19.6246C20.3733 16.9501 27.0874 16.8775 33 19.4067V52.473C26.7613 50.32 19.9378 50.471 13.7811 52.9261C13.0005 49.9843 11.9998 44.547 12 35.9998C12.0002 25.5786 13.4879 21.1893 14.1179 19.8018L14.5068 19.6246ZM39 52.473C45.2387 50.32 52.0622 50.471 58.2189 52.9261C58.9995 49.9843 60.0002 44.547 60 35.9998C59.9998 25.5786 58.5121 21.1893 57.8821 19.8018L57.4932 19.6246C51.6267 16.9501 44.9126 16.8775 39 19.4067V52.473Z" fill="currentColor"></path></svg>Deep Dive</h5>
<h4 id="why-is-mutating-state-not-recommended-in-react">Why is mutating state not recommended in React? <a href="#why-is-mutating-state-not-recommended-in-react" aria-label="Link for Why is mutating state not recommended in React? " title="Link for Why is mutating state not recommended in React? "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4></summary><div>
<p>There are a few reasons:</p>
<ul> <li>
<strong>Debugging:</strong> If you use <code dir="ltr">console.log</code> and don’t mutate state, your past logs won’t get clobbered by the more recent state changes. So you can clearly see how state has changed between renders.</li> <li>
<strong>Optimizations:</strong> Common React <a href="../reference/react/memo">optimization strategies</a> rely on skipping work if previous props or state are the same as the next ones. If you never mutate state, it is very fast to check whether there were any changes. If <code dir="ltr">prevObj === obj</code>, you can be sure that nothing could have changed inside of it.</li> <li>
<strong>New Features:</strong> The new React features we’re building rely on state being <a href="state-as-a-snapshot">treated like a snapshot.</a> If you’re mutating past versions of state, that may prevent you from using the new features.</li> <li>
<strong>Requirement Changes:</strong> Some application features, like implementing Undo/Redo, showing a history of changes, or letting the user reset a form to earlier values, are easier to do when nothing is mutated. This is because you can keep past copies of state in memory, and reuse them when appropriate. If you start with a mutative approach, features like this can be difficult to add later on.</li> <li>
<strong>Simpler Implementation:</strong> Because React does not rely on mutation, it does not need to do anything special with your objects. It does not need to hijack their properties, always wrap them into Proxies, or do other work at initialization as many “reactive” solutions do. This is also why React lets you put any object into state—no matter how large—without additional performance or correctness pitfalls.</li> </ul>
<p>In practice, you can often “get away” with mutating state in React, but we strongly advise you not to do that so that you can use new React features developed with this approach in mind. Future contributors and perhaps even your future self will thank you!</p>
</div></details> <section><h2 id="recap">Recap<a href="#recap" aria-label="Link for Recap" title="Link for Recap"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2>
<ul> <li>Treat all state in React as immutable.</li> <li>When you store objects in state, mutating them will not trigger renders and will change the state in previous render “snapshots”.</li> <li>Instead of mutating an object, create a <em>new</em> version of it, and trigger a re-render by setting state to it.</li> <li>You can use the <code dir="ltr">{...obj, something: 'newValue'}</code> object spread syntax to create copies of objects.</li> <li>Spread syntax is shallow: it only copies one level deep.</li> <li>To update a nested object, you need to create copies all the way up from the place you’re updating.</li> <li>To reduce repetitive copying code, use Immer.</li> </ul></section> <div class="note">
<h4>Try out some challenges</h4>

<div>
<h4 id="fix-incorrect-state-updates">
<div>Challenge 1 of 3<span>: </span>
</div>Fix incorrect state updates <a href="#fix-incorrect-state-updates" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4>
<p>This form has a few bugs. Click the button that increases the score a few times. Notice that it does not increase. Then edit the first name, and notice that the score has suddenly “caught up” with your changes. Finally, edit the last name, and notice that the score has disappeared completely.</p>
<p>Your task is to fix all of these bugs. As you fix them, explain why each of them happens.</p>

<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>Scoreboard</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>player</span><span>,</span> <span>setPlayer</span><span>]</span> = <span>useState</span><span>(</span><span>{</span>
    <span>firstName</span><span>:</span> <span>'Ranjani'</span><span>,</span>
    <span>lastName</span><span>:</span> <span>'Shettar'</span><span>,</span>
    <span>score</span><span>:</span> <span>10</span><span>,</span>
  <span>}</span><span>)</span><span>;</span>

  <span>function</span> <span>handlePlusClick</span><span>(</span><span>)</span> <span>{</span>
    <span>player</span>.<span>score</span>++<span>;</span>
  <span>}</span>

  <span>function</span> <span>handleFirstNameChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setPlayer</span><span>(</span><span>{</span>
      <span>...</span><span>player</span><span>,</span>
      <span>firstName</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span><span>,</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>function</span> <span>handleLastNameChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setPlayer</span><span>(</span><span>{</span>
      <span>lastName</span><span>:</span> <span>e</span>.<span>target</span>.<span>value</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Score: <span>&lt;</span><span>b</span><span>&gt;</span><span>{</span><span>player</span>.<span>score</span><span>}</span><span>&lt;/</span><span>b</span><span>&gt;</span>
        <span>{</span><span>' '</span><span>}</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>handlePlusClick</span><span>}</span><span>&gt;</span>
          +1
        <span>&lt;/</span><span>button</span><span>&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        First name:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>player</span>.<span>firstName</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleFirstNameChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Last name:
        <span>&lt;</span><span>input</span>
          <span>value</span>=<span>{</span><span>player</span>.<span>lastName</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>handleLastNameChange</span><span>}</span>
        <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre>
</div>

</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2013&ndash;present Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://react.dev/learn/updating-objects-in-state" class="_attribution-link">https://react.dev/learn/updating-objects-in-state</a>
  </p>
</div>
