<h1>Separating Events from Effects<a href="#undefined" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h1>
<div><p>Event handlers only re-run when you perform the same interaction again. Unlike event handlers, Effects re-synchronize if some value they read, like a prop or a state variable, is different from what it was during the last render. Sometimes, you also want a mix of both behaviors: an Effect that re-runs in response to some values but not others. This page will teach you how to do that.</p></div> <div class="note">
<h4>You will learn</h4>
<ul> <li>How to choose between an event handler and an Effect</li> <li>Why Effects are reactive, and event handlers are not</li> <li>What to do when you want a part of your Effect‚Äôs code to not be reactive</li> <li>What Effect Events are, and how to extract them from your Effects</li> <li>How to read the latest props and state from Effects using Effect Events</li> </ul>
</div> <h2 id="choosing-between-event-handlers-and-effects">Choosing between event handlers and Effects <a href="#choosing-between-event-handlers-and-effects" aria-label="Link for Choosing between event handlers and Effects " title="Link for Choosing between event handlers and Effects "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>First, let‚Äôs recap the difference between event handlers and Effects.</p> <p>Imagine you‚Äôre implementing a chat room component. Your requirements look like this:</p> <ol> <li>Your component should automatically connect to the selected chat room.</li> <li>When you click the ‚ÄúSend‚Äù button, it should send a message to the chat.</li> </ol> <p>Let‚Äôs say you‚Äôve already implemented the code for them, but you‚Äôre not sure where to put it. Should you use event handlers or Effects? Every time you need to answer this question, consider <a href="synchronizing-with-effects#what-are-effects-and-how-are-they-different-from-events"><em>why</em> the code needs to run.</a></p> <h3 id="event-handlers-run-in-response-to-specific-interactions">Event handlers run in response to specific interactions <a href="#event-handlers-run-in-response-to-specific-interactions" aria-label="Link for Event handlers run in response to specific interactions " title="Link for Event handlers run in response to specific interactions "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>From the user‚Äôs perspective, sending a message should happen <em>because</em> the particular ‚ÄúSend‚Äù button was clicked. The user will get rather upset if you send their message at any other time or for any other reason. This is why sending a message should be an event handler. Event handlers let you handle specific interactions:</p> <pre data-language="jsx"><code><span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>message</span><span>,</span> <span>setMessage</span><span>]</span> = <span>useState</span><span>(</span><span>''</span><span>)</span><span>;</span>
  <span>// ...</span>
  <span>function</span> <span>handleSendClick</span><span>(</span><span>)</span> <span>{</span>
    <span>sendMessage</span><span>(</span><span>message</span><span>)</span><span>;</span>
  <span>}</span>
  <span>// ...</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>input</span> <span>value</span>=<span>{</span><span>message</span><span>}</span> <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setMessage</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>}</span> <span>/&gt;</span>
      <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>handleSendClick</span><span>}</span><span>&gt;</span>Send<span>&lt;/</span><span>button</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span></code></pre> <p>With an event handler, you can be sure that <code dir="ltr">sendMessage(message)</code> will <em>only</em> run if the user presses the button.</p> <h3 id="effects-run-whenever-synchronization-is-needed">Effects run whenever synchronization is needed <a href="#effects-run-whenever-synchronization-is-needed" aria-label="Link for Effects run whenever synchronization is needed " title="Link for Effects run whenever synchronization is needed "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Recall that you also need to keep the component connected to the chat room. Where does that code go?</p> <p>The <em>reason</em> to run this code is not some particular interaction. It doesn‚Äôt matter why or how the user navigated to the chat room screen. Now that they‚Äôre looking at it and could interact with it, the component needs to stay connected to the selected chat server. Even if the chat room component was the initial screen of your app, and the user has not performed any interactions at all, you would <em>still</em> need to connect. This is why it‚Äôs an Effect:</p> <pre data-language="jsx"><code><span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>// ...</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>]</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span></code></pre> <p>With this code, you can be sure that there is always an active connection to the currently selected chat server, <em>regardless</em> of the specific interactions performed by the user. Whether the user has only opened your app, selected a different room, or navigated to another screen and back, your Effect ensures that the component will <em>remain synchronized</em> with the currently selected room, and will <a href="lifecycle-of-reactive-effects#why-synchronization-may-need-to-happen-more-than-once">re-connect whenever it‚Äôs necessary.</a></p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>createConnection</span><span>,</span> <span>sendMessage</span> <span>}</span> <span>from</span> <span>'./chat.js'</span><span>;</span>

<span>const</span> <span>serverUrl</span> = <span>'https://localhost:1234'</span><span>;</span>

<span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>message</span><span>,</span> <span>setMessage</span><span>]</span> = <span>useState</span><span>(</span><span>''</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>]</span><span>)</span><span>;</span>

  <span>function</span> <span>handleSendClick</span><span>(</span><span>)</span> <span>{</span>
    <span>sendMessage</span><span>(</span><span>message</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>h1</span><span>&gt;</span>Welcome to the <span>{</span><span>roomId</span><span>}</span> room!<span>&lt;/</span><span>h1</span><span>&gt;</span>
      <span>&lt;</span><span>input</span> <span>value</span>=<span>{</span><span>message</span><span>}</span> <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setMessage</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>}</span> <span>/&gt;</span>
      <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>handleSendClick</span><span>}</span><span>&gt;</span>Send<span>&lt;/</span><span>button</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>roomId</span><span>,</span> <span>setRoomId</span><span>]</span> = <span>useState</span><span>(</span><span>'general'</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>show</span><span>,</span> <span>setShow</span><span>]</span> = <span>useState</span><span>(</span><span>false</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Choose the chat room:<span>{</span><span>' '</span><span>}</span>
        <span>&lt;</span><span>select</span>
          <span>value</span>=<span>{</span><span>roomId</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setRoomId</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>}</span>
        <span>&gt;</span>
          <span>&lt;</span><span>option</span> <span>value</span>=<span>"general"</span><span>&gt;</span>general<span>&lt;/</span><span>option</span><span>&gt;</span>
          <span>&lt;</span><span>option</span> <span>value</span>=<span>"travel"</span><span>&gt;</span>travel<span>&lt;/</span><span>option</span><span>&gt;</span>
          <span>&lt;</span><span>option</span> <span>value</span>=<span>"music"</span><span>&gt;</span>music<span>&lt;/</span><span>option</span><span>&gt;</span>
        <span>&lt;/</span><span>select</span><span>&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setShow</span><span>(</span>!<span>show</span><span>)</span><span>}</span><span>&gt;</span>
        <span>{</span><span>show</span> ? <span>'Close chat'</span> : <span>'Open chat'</span><span>}</span>
      <span>&lt;/</span><span>button</span><span>&gt;</span>
      <span>{</span><span>show</span> &amp;&amp; <span>&lt;</span><span>hr</span> <span>/&gt;</span><span>}</span>
      <span>{</span><span>show</span> &amp;&amp; <span>&lt;</span><span>ChatRoom</span> <span>roomId</span>=<span>{</span><span>roomId</span><span>}</span> <span>/&gt;</span><span>}</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <h2 id="reactive-values-and-reactive-logic">Reactive values and reactive logic <a href="#reactive-values-and-reactive-logic" aria-label="Link for Reactive values and reactive logic " title="Link for Reactive values and reactive logic "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>Intuitively, you could say that event handlers are always triggered ‚Äúmanually‚Äù, for example by clicking a button. Effects, on the other hand, are ‚Äúautomatic‚Äù: they run and re-run as often as it‚Äôs needed to stay synchronized.</p> <p>There is a more precise way to think about this.</p> <p>Props, state, and variables declared inside your component‚Äôs body are called <span data-step="2">reactive values</span>. In this example, <code dir="ltr">serverUrl</code> is not a reactive value, but <code dir="ltr">roomId</code> and <code dir="ltr">message</code> are. They participate in the rendering data flow:</p> <pre data-language="jsx"><code><span>const</span> <span>serverUrl</span> = <span>'https://localhost:1234'</span><span>;</span>

<span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>message</span><span>,</span> <span>setMessage</span><span>]</span> = <span>useState</span><span>(</span><span>''</span><span>)</span><span>;</span>

  <span>// ...</span>
<span>}</span></code></pre> <p>Reactive values like these can change due to a re-render. For example, the user may edit the <code dir="ltr">message</code> or choose a different <code dir="ltr">roomId</code> in a dropdown. Event handlers and Effects respond to changes differently:</p> <ul> <li>
<strong>Logic inside event handlers is <em>not reactive.</em></strong> It will not run again unless the user performs the same interaction (e.g. a click) again. Event handlers can read reactive values without ‚Äúreacting‚Äù to their changes.</li> <li>
<strong>Logic inside Effects is <em>reactive.</em></strong> If your Effect reads a reactive value, <a href="lifecycle-of-reactive-effects#effects-react-to-reactive-values">you have to specify it as a dependency.</a> Then, if a re-render causes that value to change, React will re-run your Effect‚Äôs logic with the new value.</li> </ul> <p>Let‚Äôs revisit the previous example to illustrate this difference.</p> <h3 id="logic-inside-event-handlers-is-not-reactive">Logic inside event handlers is not reactive <a href="#logic-inside-event-handlers-is-not-reactive" aria-label="Link for Logic inside event handlers is not reactive " title="Link for Logic inside event handlers is not reactive "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Take a look at this line of code. Should this logic be reactive or not?</p> <pre data-language="jsx"><code>    <span>// ...</span>
    <span>sendMessage</span><span>(</span><span>message</span><span>)</span><span>;</span>
    <span>// ...</span></code></pre> <p>From the user‚Äôs perspective, <strong>a change to the <code dir="ltr">message</code> does <em>not</em> mean that they want to send a message.</strong> It only means that the user is typing. In other words, the logic that sends a message should not be reactive. It should not run again only because the <span data-step="2">reactive value</span> has changed. That‚Äôs why it belongs in the event handler:</p> <pre data-language="jsx"><code>  <span>function</span> <span>handleSendClick</span><span>(</span><span>)</span> <span>{</span>
    <span>sendMessage</span><span>(</span><span>message</span><span>)</span><span>;</span>
  <span>}</span></code></pre> <p>Event handlers aren‚Äôt reactive, so <code dir="ltr">sendMessage(message)</code> will only run when the user clicks the Send button.</p> <h3 id="logic-inside-effects-is-reactive">Logic inside Effects is reactive <a href="#logic-inside-effects-is-reactive" aria-label="Link for Logic inside Effects is reactive " title="Link for Logic inside Effects is reactive "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Now let‚Äôs return to these lines:</p> <pre data-language="jsx"><code>    <span>// ...</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>// ...</span></code></pre> <p>From the user‚Äôs perspective, <strong>a change to the <code dir="ltr">roomId</code> <em>does</em> mean that they want to connect to a different room.</strong> In other words, the logic for connecting to the room should be reactive. You <em>want</em> these lines of code to ‚Äúkeep up‚Äù with the <span data-step="2">reactive value</span>, and to run again if that value is different. That‚Äôs why it belongs in an Effect:</p> <pre data-language="jsx"><code>  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>]</span><span>)</span><span>;</span></code></pre> <p>Effects are reactive, so <code dir="ltr">createConnection(serverUrl, roomId)</code> and <code dir="ltr">connection.connect()</code> will run for every distinct value of <code dir="ltr">roomId</code>. Your Effect keeps the chat connection synchronized to the currently selected room.</p> <h2 id="extracting-non-reactive-logic-out-of-effects">Extracting non-reactive logic out of Effects <a href="#extracting-non-reactive-logic-out-of-effects" aria-label="Link for Extracting non-reactive logic out of Effects " title="Link for Extracting non-reactive logic out of Effects "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>Things get more tricky when you want to mix reactive logic with non-reactive logic.</p> <p>For example, imagine that you want to show a notification when the user connects to the chat. You read the current theme (dark or light) from the props so that you can show the notification in the correct color:</p> <pre data-language="jsx"><code><span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span><span>,</span> <span>theme</span> <span>}</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>)</span><span>;</span>
    <span>connection</span>.<span>on</span><span>(</span><span>'connected'</span><span>,</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>showNotification</span><span>(</span><span>'Connected!'</span><span>,</span> <span>theme</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>// ...</span></code></pre> <p>However, <code dir="ltr">theme</code> is a reactive value (it can change as a result of re-rendering), and <a href="lifecycle-of-reactive-effects#react-verifies-that-you-specified-every-reactive-value-as-a-dependency">every reactive value read by an Effect must be declared as its dependency.</a> Now you have to specify <code dir="ltr">theme</code> as a dependency of your Effect:</p> <pre data-language="jsx"><code><span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span><span>,</span> <span>theme</span> <span>}</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>)</span><span>;</span>
    <span>connection</span>.<span>on</span><span>(</span><span>'connected'</span><span>,</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>showNotification</span><span>(</span><span>'Connected!'</span><span>,</span> <span>theme</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>,</span> <span>theme</span><span>]</span><span>)</span><span>;</span> <span>// ‚úÖ All dependencies declared</span>
  <span>// ...</span></code></pre> <p>Play with this example and see if you can spot the problem with this user experience:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>createConnection</span><span>,</span> <span>sendMessage</span> <span>}</span> <span>from</span> <span>'./chat.js'</span><span>;</span>
<span>import</span> <span>{</span> <span>showNotification</span> <span>}</span> <span>from</span> <span>'./notifications.js'</span><span>;</span>

<span>const</span> <span>serverUrl</span> = <span>'https://localhost:1234'</span><span>;</span>

<span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span><span>,</span> <span>theme</span> <span>}</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>)</span><span>;</span>
    <span>connection</span>.<span>on</span><span>(</span><span>'connected'</span><span>,</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>showNotification</span><span>(</span><span>'Connected!'</span><span>,</span> <span>theme</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>,</span> <span>theme</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>&lt;</span><span>h1</span><span>&gt;</span>Welcome to the <span>{</span><span>roomId</span><span>}</span> room!<span>&lt;/</span><span>h1</span><span>&gt;</span>
<span>}</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>roomId</span><span>,</span> <span>setRoomId</span><span>]</span> = <span>useState</span><span>(</span><span>'general'</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>isDark</span><span>,</span> <span>setIsDark</span><span>]</span> = <span>useState</span><span>(</span><span>false</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Choose the chat room:<span>{</span><span>' '</span><span>}</span>
        <span>&lt;</span><span>select</span>
          <span>value</span>=<span>{</span><span>roomId</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setRoomId</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>}</span>
        <span>&gt;</span>
          <span>&lt;</span><span>option</span> <span>value</span>=<span>"general"</span><span>&gt;</span>general<span>&lt;/</span><span>option</span><span>&gt;</span>
          <span>&lt;</span><span>option</span> <span>value</span>=<span>"travel"</span><span>&gt;</span>travel<span>&lt;/</span><span>option</span><span>&gt;</span>
          <span>&lt;</span><span>option</span> <span>value</span>=<span>"music"</span><span>&gt;</span>music<span>&lt;/</span><span>option</span><span>&gt;</span>
        <span>&lt;/</span><span>select</span><span>&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        <span>&lt;</span><span>input</span>
          <span>type</span>=<span>"checkbox"</span>
          <span>checked</span>=<span>{</span><span>isDark</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setIsDark</span><span>(</span><span>e</span>.<span>target</span>.<span>checked</span><span>)</span><span>}</span>
        <span>/&gt;</span>
        Use dark theme
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>&lt;</span><span>ChatRoom</span>
        <span>roomId</span>=<span>{</span><span>roomId</span><span>}</span>
        <span>theme</span>=<span>{</span><span>isDark</span> ? <span>'dark'</span> : <span>'light'</span><span>}</span>
      <span>/&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>When the <code dir="ltr">roomId</code> changes, the chat re-connects as you would expect. But since <code dir="ltr">theme</code> is also a dependency, the chat <em>also</em> re-connects every time you switch between the dark and the light theme. That‚Äôs not great!</p> <p>In other words, you <em>don‚Äôt</em> want this line to be reactive, even though it is inside an Effect (which is reactive):</p> <pre data-language="jsx"><code>      <span>// ...</span>
      <span>showNotification</span><span>(</span><span>'Connected!'</span><span>,</span> <span>theme</span><span>)</span><span>;</span>
      <span>// ...</span></code></pre> <p>You need a way to separate this non-reactive logic from the reactive Effect around it.</p> <h3 id="declaring-an-effect-event">Declaring an Effect Event <a href="#declaring-an-effect-event" aria-label="Link for Declaring an Effect Event " title="Link for Declaring an Effect Event "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Use a special Hook called <a href="../reference/react/useeffectevent"><code dir="ltr">useEffectEvent</code></a> to extract this non-reactive logic out of your Effect:</p> <pre data-language="jsx"><code><span>import</span> <span>{</span> <span>useEffect</span><span>,</span> <span>useEffectEvent</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span><span>,</span> <span>theme</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>onConnected</span> = <span>useEffectEvent</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>showNotification</span><span>(</span><span>'Connected!'</span><span>,</span> <span>theme</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>
  <span>// ...</span></code></pre> <p>Here, <code dir="ltr">onConnected</code> is called an <em>Effect Event.</em> It‚Äôs a part of your Effect logic, but it behaves a lot more like an event handler. The logic inside it is not reactive, and it always ‚Äúsees‚Äù the latest values of your props and state.</p> <p>Now you can call the <code dir="ltr">onConnected</code> Effect Event from inside your Effect:</p> <pre data-language="jsx"><code><span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span><span>,</span> <span>theme</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>onConnected</span> = <span>useEffectEvent</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>showNotification</span><span>(</span><span>'Connected!'</span><span>,</span> <span>theme</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>)</span><span>;</span>
    <span>connection</span>.<span>on</span><span>(</span><span>'connected'</span><span>,</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>onConnected</span><span>(</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>]</span><span>)</span><span>;</span> <span>// ‚úÖ All dependencies declared</span>
  <span>// ...</span></code></pre> <p>This solves the problem. Note that you had to <em>remove</em> <code dir="ltr">theme</code> from the list of your Effect‚Äôs dependencies, because it‚Äôs no longer used in the Effect. You also don‚Äôt need to <em>add</em> <code dir="ltr">onConnected</code> to it, because <strong>Effect Events are not reactive and must be omitted from dependencies.</strong></p> <p>Verify that the new behavior works as you would expect:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>useEffectEvent</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>createConnection</span><span>,</span> <span>sendMessage</span> <span>}</span> <span>from</span> <span>'./chat.js'</span><span>;</span>
<span>import</span> <span>{</span> <span>showNotification</span> <span>}</span> <span>from</span> <span>'./notifications.js'</span><span>;</span>

<span>const</span> <span>serverUrl</span> = <span>'https://localhost:1234'</span><span>;</span>

<span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span><span>,</span> <span>theme</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>onConnected</span> = <span>useEffectEvent</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>showNotification</span><span>(</span><span>'Connected!'</span><span>,</span> <span>theme</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>)</span><span>;</span>
    <span>connection</span>.<span>on</span><span>(</span><span>'connected'</span><span>,</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>onConnected</span><span>(</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>&lt;</span><span>h1</span><span>&gt;</span>Welcome to the <span>{</span><span>roomId</span><span>}</span> room!<span>&lt;/</span><span>h1</span><span>&gt;</span>
<span>}</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>roomId</span><span>,</span> <span>setRoomId</span><span>]</span> = <span>useState</span><span>(</span><span>'general'</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>isDark</span><span>,</span> <span>setIsDark</span><span>]</span> = <span>useState</span><span>(</span><span>false</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Choose the chat room:<span>{</span><span>' '</span><span>}</span>
        <span>&lt;</span><span>select</span>
          <span>value</span>=<span>{</span><span>roomId</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setRoomId</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>}</span>
        <span>&gt;</span>
          <span>&lt;</span><span>option</span> <span>value</span>=<span>"general"</span><span>&gt;</span>general<span>&lt;/</span><span>option</span><span>&gt;</span>
          <span>&lt;</span><span>option</span> <span>value</span>=<span>"travel"</span><span>&gt;</span>travel<span>&lt;/</span><span>option</span><span>&gt;</span>
          <span>&lt;</span><span>option</span> <span>value</span>=<span>"music"</span><span>&gt;</span>music<span>&lt;/</span><span>option</span><span>&gt;</span>
        <span>&lt;/</span><span>select</span><span>&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        <span>&lt;</span><span>input</span>
          <span>type</span>=<span>"checkbox"</span>
          <span>checked</span>=<span>{</span><span>isDark</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setIsDark</span><span>(</span><span>e</span>.<span>target</span>.<span>checked</span><span>)</span><span>}</span>
        <span>/&gt;</span>
        Use dark theme
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>&lt;</span><span>ChatRoom</span>
        <span>roomId</span>=<span>{</span><span>roomId</span><span>}</span>
        <span>theme</span>=<span>{</span><span>isDark</span> ? <span>'dark'</span> : <span>'light'</span><span>}</span>
      <span>/&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>You can think of Effect Events as being very similar to event handlers. The main difference is that event handlers run in response to a user interactions, whereas Effect Events are triggered by you from Effects. Effect Events let you ‚Äúbreak the chain‚Äù between the reactivity of Effects and code that should not be reactive.</p> <h3 id="reading-latest-props-and-state-with-effect-events">Reading latest props and state with Effect Events <a href="#reading-latest-props-and-state-with-effect-events" aria-label="Link for Reading latest props and state with Effect Events " title="Link for Reading latest props and state with Effect Events "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Effect Events let you fix many patterns where you might be tempted to suppress the dependency linter.</p> <p>For example, say you have an Effect to log the page visits:</p> <pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>logVisit</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span></code></pre> <p>Later, you add multiple routes to your site. Now your <code dir="ltr">Page</code> component receives a <code dir="ltr">url</code> prop with the current path. You want to pass the <code dir="ltr">url</code> as a part of your <code dir="ltr">logVisit</code> call, but the dependency linter complains:</p> <pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>{</span> <span>url</span> <span>}</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>logVisit</span><span>(</span><span>url</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span> <span>// üî¥ React Hook useEffect has a missing dependency: 'url'</span>
  <span>// ...</span>
<span>}</span></code></pre> <p>Think about what you want the code to do. You <em>want</em> to log a separate visit for different URLs since each URL represents a different page. In other words, this <code dir="ltr">logVisit</code> call <em>should</em> be reactive with respect to the <code dir="ltr">url</code>. This is why, in this case, it makes sense to follow the dependency linter, and add <code dir="ltr">url</code> as a dependency:</p> <pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>{</span> <span>url</span> <span>}</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>logVisit</span><span>(</span><span>url</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>url</span><span>]</span><span>)</span><span>;</span> <span>// ‚úÖ All dependencies declared</span>
  <span>// ...</span>
<span>}</span></code></pre> <p>Now let‚Äôs say you want to include the number of items in the shopping cart together with every page visit:</p> <pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>{</span> <span>url</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>{</span> <span>items</span> <span>}</span> = <span>useContext</span><span>(</span><span>ShoppingCartContext</span><span>)</span><span>;</span>
  <span>const</span> <span>numberOfItems</span> = <span>items</span>.<span>length</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>logVisit</span><span>(</span><span>url</span><span>,</span> <span>numberOfItems</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>url</span><span>]</span><span>)</span><span>;</span> <span>// üî¥ React Hook useEffect has a missing dependency: 'numberOfItems'</span>
  <span>// ...</span>
<span>}</span></code></pre> <p>You used <code dir="ltr">numberOfItems</code> inside the Effect, so the linter asks you to add it as a dependency. However, you <em>don‚Äôt</em> want the <code dir="ltr">logVisit</code> call to be reactive with respect to <code dir="ltr">numberOfItems</code>. If the user puts something into the shopping cart, and the <code dir="ltr">numberOfItems</code> changes, this <em>does not mean</em> that the user visited the page again. In other words, <em>visiting the page</em> is, in some sense, an ‚Äúevent‚Äù. It happens at a precise moment in time.</p> <p>Split the code in two parts:</p> <pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>{</span> <span>url</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>{</span> <span>items</span> <span>}</span> = <span>useContext</span><span>(</span><span>ShoppingCartContext</span><span>)</span><span>;</span>
  <span>const</span> <span>numberOfItems</span> = <span>items</span>.<span>length</span><span>;</span>

  <span>const</span> <span>onVisit</span> = <span>useEffectEvent</span><span>(</span><span>visitedUrl</span> <span>=&gt;</span> <span>{</span>
    <span>logVisit</span><span>(</span><span>visitedUrl</span><span>,</span> <span>numberOfItems</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>onVisit</span><span>(</span><span>url</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>url</span><span>]</span><span>)</span><span>;</span> <span>// ‚úÖ All dependencies declared</span>
  <span>// ...</span>
<span>}</span></code></pre> <p>Here, <code dir="ltr">onVisit</code> is an Effect Event. The code inside it isn‚Äôt reactive. This is why you can use <code dir="ltr">numberOfItems</code> (or any other reactive value!) without worrying that it will cause the surrounding code to re-execute on changes.</p> <p>On the other hand, the Effect itself remains reactive. Code inside the Effect uses the <code dir="ltr">url</code> prop, so the Effect will re-run after every re-render with a different <code dir="ltr">url</code>. This, in turn, will call the <code dir="ltr">onVisit</code> Effect Event.</p> <p>As a result, you will call <code dir="ltr">logVisit</code> for every change to the <code dir="ltr">url</code>, and always read the latest <code dir="ltr">numberOfItems</code>. However, if <code dir="ltr">numberOfItems</code> changes on its own, this will not cause any of the code to re-run.</p> <div class="note note-green">
<h4>Note</h4>
<div>
<p>You might be wondering if you could call <code dir="ltr">onVisit()</code> with no arguments, and read the <code dir="ltr">url</code> inside it:</p>
<pre data-language="jsx"><code>  <span>const</span> <span>onVisit</span> = <span>useEffectEvent</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>logVisit</span><span>(</span><span>url</span><span>,</span> <span>numberOfItems</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>onVisit</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>url</span><span>]</span><span>)</span><span>;</span></code></pre>
<p>This would work, but it‚Äôs better to pass this <code dir="ltr">url</code> to the Effect Event explicitly. <strong>By passing <code dir="ltr">url</code> as an argument to your Effect Event, you are saying that visiting a page with a different <code dir="ltr">url</code> constitutes a separate ‚Äúevent‚Äù from the user‚Äôs perspective.</strong> The <code dir="ltr">visitedUrl</code> is a <em>part</em> of the ‚Äúevent‚Äù that happened:</p>
<pre data-language="jsx"><code>  <span>const</span> <span>onVisit</span> = <span>useEffectEvent</span><span>(</span><span>visitedUrl</span> <span>=&gt;</span> <span>{</span>
    <span>logVisit</span><span>(</span><span>visitedUrl</span><span>,</span> <span>numberOfItems</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>onVisit</span><span>(</span><span>url</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>url</span><span>]</span><span>)</span><span>;</span></code></pre>
<p>Since your Effect Event explicitly ‚Äúasks‚Äù for the <code dir="ltr">visitedUrl</code>, now you can‚Äôt accidentally remove <code dir="ltr">url</code> from the Effect‚Äôs dependencies. If you remove the <code dir="ltr">url</code> dependency (causing distinct page visits to be counted as one), the linter will warn you about it. You want <code dir="ltr">onVisit</code> to be reactive with regards to the <code dir="ltr">url</code>, so instead of reading the <code dir="ltr">url</code> inside (where it wouldn‚Äôt be reactive), you pass it <em>from</em> your Effect.</p>
<p>This becomes especially important if there is some asynchronous logic inside the Effect:</p>
<pre data-language="jsx"><code>  <span>const</span> <span>onVisit</span> = <span>useEffectEvent</span><span>(</span><span>visitedUrl</span> <span>=&gt;</span> <span>{</span>
    <span>logVisit</span><span>(</span><span>visitedUrl</span><span>,</span> <span>numberOfItems</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>setTimeout</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>onVisit</span><span>(</span><span>url</span><span>)</span><span>;</span>
    <span>}</span><span>,</span> <span>5000</span><span>)</span><span>;</span> <span>// Delay logging visits</span>
  <span>}</span><span>,</span> <span>[</span><span>url</span><span>]</span><span>)</span><span>;</span></code></pre>
<p>Here, <code dir="ltr">url</code> inside <code dir="ltr">onVisit</code> corresponds to the <em>latest</em> <code dir="ltr">url</code> (which could have already changed), but <code dir="ltr">visitedUrl</code> corresponds to the <code dir="ltr">url</code> that originally caused this Effect (and this <code dir="ltr">onVisit</code> call) to run.</p>
</div>
</div> <details class="note note-blue"><summary tabindex="-1"><h5>
<svg width="1.5em" height="1.5em" viewbox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M34.7409 59.7228L32.9567 58.9094C27.2672 56.3157 20.7328 56.3157 15.0433 58.9094C12.6018 60.0224 9.39163 59.0275 8.44602 56.0621C7.45647 52.9589 5.99975 46.5898 6 35.9997C6.00029 23.5648 8.00803 18.3599 9.11099 16.4196C9.67795 15.4222 10.5255 14.8455 11.2254 14.5264L12.0179 14.1651C19.6351 10.6926 28.4011 10.6738 36 14.1733C43.5989 10.6738 52.3649 10.6926 59.9821 14.1651L60.7746 14.5264C61.4745 14.8455 62.3221 15.4222 62.889 16.4196C63.992 18.3599 65.9997 23.5648 66 35.9997C66.0002 46.5898 64.5435 52.9589 63.554 56.0621C62.6084 59.0275 59.3982 60.0224 56.9567 58.9094C51.2672 56.3157 44.7328 56.3157 39.0433 58.9094L37.2591 59.7228C37.1986 59.7508 37.1373 59.7767 37.0753 59.8004C36.4484 60.0411 35.7556 60.0653 35.1102 59.8648C34.9847 59.8258 34.8613 59.7784 34.7409 59.7228ZM14.5068 19.6246C20.3733 16.9501 27.0874 16.8775 33 19.4067V52.473C26.7613 50.32 19.9378 50.471 13.7811 52.9261C13.0005 49.9843 11.9998 44.547 12 35.9998C12.0002 25.5786 13.4879 21.1893 14.1179 19.8018L14.5068 19.6246ZM39 52.473C45.2387 50.32 52.0622 50.471 58.2189 52.9261C58.9995 49.9843 60.0002 44.547 60 35.9998C59.9998 25.5786 58.5121 21.1893 57.8821 19.8018L57.4932 19.6246C51.6267 16.9501 44.9126 16.8775 39 19.4067V52.473Z" fill="currentColor"></path></svg>Deep Dive</h5>
<h4 id="is-it-okay-to-suppress-the-dependency-linter-instead">Is it okay to suppress the dependency linter instead? <a href="#is-it-okay-to-suppress-the-dependency-linter-instead" aria-label="Link for Is it okay to suppress the dependency linter instead? " title="Link for Is it okay to suppress the dependency linter instead? "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4></summary><div>
<p>In the existing codebases, you may sometimes see the lint rule suppressed like this:</p>
<pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>{</span> <span>url</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>{</span> <span>items</span> <span>}</span> = <span>useContext</span><span>(</span><span>ShoppingCartContext</span><span>)</span><span>;</span>
  <span>const</span> <span>numberOfItems</span> = <span>items</span>.<span>length</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>logVisit</span><span>(</span><span>url</span><span>,</span> <span>numberOfItems</span><span>)</span><span>;</span>
    <span>// üî¥ Avoid suppressing the linter like this:</span>
    <span>// eslint-disable-next-line react-hooks/exhaustive-deps</span>
  <span>}</span><span>,</span> <span>[</span><span>url</span><span>]</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span></code></pre>
<p>We recommend <strong>never suppressing the linter</strong>.</p>
<p>The first downside of suppressing the rule is that React will no longer warn you when your Effect needs to ‚Äúreact‚Äù to a new reactive dependency you‚Äôve introduced to your code. In the earlier example, you added <code dir="ltr">url</code> to the dependencies <em>because</em> React reminded you to do it. You will no longer get such reminders for any future edits to that Effect if you disable the linter. This leads to bugs.</p>
<p>Here is an example of a confusing bug caused by suppressing the linter. In this example, the <code dir="ltr">handleMove</code> function is supposed to read the current <code dir="ltr">canMove</code> state variable value in order to decide whether the dot should follow the cursor. However, <code dir="ltr">canMove</code> is always <code dir="ltr">true</code> inside <code dir="ltr">handleMove</code>.</p>
<p>Can you see why?</p>

<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>position</span><span>,</span> <span>setPosition</span><span>]</span> = <span>useState</span><span>(</span><span>{</span> <span>x</span><span>:</span> <span>0</span><span>,</span> <span>y</span><span>:</span> <span>0</span> <span>}</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>canMove</span><span>,</span> <span>setCanMove</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>

  <span>function</span> <span>handleMove</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>if</span> <span>(</span><span>canMove</span><span>)</span> <span>{</span>
      <span>setPosition</span><span>(</span><span>{</span> <span>x</span><span>:</span> <span>e</span>.<span>clientX</span><span>,</span> <span>y</span><span>:</span> <span>e</span>.<span>clientY</span> <span>}</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'pointermove'</span><span>,</span> <span>handleMove</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>window</span>.<span>removeEventListener</span><span>(</span><span>'pointermove'</span><span>,</span> <span>handleMove</span><span>)</span><span>;</span>
    <span>// eslint-disable-next-line react-hooks/exhaustive-deps</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        <span>&lt;</span><span>input</span> <span>type</span>=<span>"checkbox"</span>
          <span>checked</span>=<span>{</span><span>canMove</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setCanMove</span><span>(</span><span>e</span>.<span>target</span>.<span>checked</span><span>)</span><span>}</span>
        <span>/&gt;</span>
        The dot is allowed to move
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>&lt;</span><span>div</span> <span>style</span>=<span>{</span><span>{</span>
        <span>position</span><span>:</span> <span>'absolute'</span><span>,</span>
        <span>backgroundColor</span><span>:</span> <span>'pink'</span><span>,</span>
        <span>borderRadius</span><span>:</span> <span>'50%'</span><span>,</span>
        <span>opacity</span><span>:</span> <span>0.6</span><span>,</span>
        <span>transform</span><span>:</span> <span>`translate(</span><span>${</span><span>position</span>.<span>x</span><span>}</span><span>px, </span><span>${</span><span>position</span>.<span>y</span><span>}</span><span>px)`</span><span>,</span>
        <span>pointerEvents</span><span>:</span> <span>'none'</span><span>,</span>
        <span>left</span><span>:</span> -<span>20</span><span>,</span>
        <span>top</span><span>:</span> -<span>20</span><span>,</span>
        <span>width</span><span>:</span> <span>40</span><span>,</span>
        <span>height</span><span>:</span> <span>40</span><span>,</span>
      <span>}</span><span>}</span> <span>/&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre>
<p>The problem with this code is in suppressing the dependency linter. If you remove the suppression, you‚Äôll see that this Effect should depend on the <code dir="ltr">handleMove</code> function. This makes sense: <code dir="ltr">handleMove</code> is declared inside the component body, which makes it a reactive value. Every reactive value must be specified as a dependency, or it can potentially get stale over time!</p>
<p>The author of the original code has ‚Äúlied‚Äù to React by saying that the Effect does not depend (<code dir="ltr">[]</code>) on any reactive values. This is why React did not re-synchronize the Effect after <code dir="ltr">canMove</code> has changed (and <code dir="ltr">handleMove</code> with it). Because React did not re-synchronize the Effect, the <code dir="ltr">handleMove</code> attached as a listener is the <code dir="ltr">handleMove</code> function created during the initial render. During the initial render, <code dir="ltr">canMove</code> was <code dir="ltr">true</code>, which is why <code dir="ltr">handleMove</code> from the initial render will forever see that value.</p>
<p><strong>If you never suppress the linter, you will never see problems with stale values.</strong></p>
<p>With <code dir="ltr">useEffectEvent</code>, there is no need to ‚Äúlie‚Äù to the linter, and the code works as you would expect:</p>

<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>useEffectEvent</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>position</span><span>,</span> <span>setPosition</span><span>]</span> = <span>useState</span><span>(</span><span>{</span> <span>x</span><span>:</span> <span>0</span><span>,</span> <span>y</span><span>:</span> <span>0</span> <span>}</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>canMove</span><span>,</span> <span>setCanMove</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>

  <span>const</span> <span>onMove</span> = <span>useEffectEvent</span><span>(</span><span>e</span> <span>=&gt;</span> <span>{</span>
    <span>if</span> <span>(</span><span>canMove</span><span>)</span> <span>{</span>
      <span>setPosition</span><span>(</span><span>{</span> <span>x</span><span>:</span> <span>e</span>.<span>clientX</span><span>,</span> <span>y</span><span>:</span> <span>e</span>.<span>clientY</span> <span>}</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'pointermove'</span><span>,</span> <span>onMove</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>window</span>.<span>removeEventListener</span><span>(</span><span>'pointermove'</span><span>,</span> <span>onMove</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        <span>&lt;</span><span>input</span> <span>type</span>=<span>"checkbox"</span>
          <span>checked</span>=<span>{</span><span>canMove</span><span>}</span>
          <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setCanMove</span><span>(</span><span>e</span>.<span>target</span>.<span>checked</span><span>)</span><span>}</span>
        <span>/&gt;</span>
        The dot is allowed to move
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>&lt;</span><span>div</span> <span>style</span>=<span>{</span><span>{</span>
        <span>position</span><span>:</span> <span>'absolute'</span><span>,</span>
        <span>backgroundColor</span><span>:</span> <span>'pink'</span><span>,</span>
        <span>borderRadius</span><span>:</span> <span>'50%'</span><span>,</span>
        <span>opacity</span><span>:</span> <span>0.6</span><span>,</span>
        <span>transform</span><span>:</span> <span>`translate(</span><span>${</span><span>position</span>.<span>x</span><span>}</span><span>px, </span><span>${</span><span>position</span>.<span>y</span><span>}</span><span>px)`</span><span>,</span>
        <span>pointerEvents</span><span>:</span> <span>'none'</span><span>,</span>
        <span>left</span><span>:</span> -<span>20</span><span>,</span>
        <span>top</span><span>:</span> -<span>20</span><span>,</span>
        <span>width</span><span>:</span> <span>40</span><span>,</span>
        <span>height</span><span>:</span> <span>40</span><span>,</span>
      <span>}</span><span>}</span> <span>/&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre>
<p>This doesn‚Äôt mean that <code dir="ltr">useEffectEvent</code> is <em>always</em> the correct solution. You should only apply it to the lines of code that you don‚Äôt want to be reactive. In the above sandbox, you didn‚Äôt want the Effect‚Äôs code to be reactive with regards to <code dir="ltr">canMove</code>. That‚Äôs why it made sense to extract an Effect Event.</p>
<p>Read <a href="removing-effect-dependencies">Removing Effect Dependencies</a> for other correct alternatives to suppressing the linter.</p>
</div></details> <h3 id="limitations-of-effect-events">Limitations of Effect Events <a href="#limitations-of-effect-events" aria-label="Link for Limitations of Effect Events " title="Link for Limitations of Effect Events "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Effect Events are very limited in how you can use them:</p> <ul> <li><strong>Only call them from inside Effects.</strong></li> <li><strong>Never pass them to other components or Hooks.</strong></li> </ul> <p>For example, don‚Äôt declare and pass an Effect Event like this:</p> <pre data-language="jsx"><code><span>function</span> <span>Timer</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>count</span><span>,</span> <span>setCount</span><span>]</span> = <span>useState</span><span>(</span><span>0</span><span>)</span><span>;</span>

  <span>const</span> <span>onTick</span> = <span>useEffectEvent</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>setCount</span><span>(</span><span>count</span> + <span>1</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>

  <span>useTimer</span><span>(</span><span>onTick</span><span>,</span> <span>1000</span><span>)</span><span>;</span> <span>// üî¥ Avoid: Passing Effect Events</span>

  <span>return</span> <span>&lt;</span><span>h1</span><span>&gt;</span><span>{</span><span>count</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span>
<span>}</span>

<span>function</span> <span>useTimer</span><span>(</span><span>callback</span><span>,</span> <span>delay</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>id</span> = <span>setInterval</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>callback</span><span>(</span><span>)</span><span>;</span>
    <span>}</span><span>,</span> <span>delay</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>clearInterval</span><span>(</span><span>id</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>delay</span><span>,</span> <span>callback</span><span>]</span><span>)</span><span>;</span> <span>// Need to specify "callback" in dependencies</span>
<span>}</span></code></pre> <p>Instead, always declare Effect Events directly next to the Effects that use them:</p> <pre data-language="jsx"><code><span>function</span> <span>Timer</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>count</span><span>,</span> <span>setCount</span><span>]</span> = <span>useState</span><span>(</span><span>0</span><span>)</span><span>;</span>
  <span>useTimer</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>setCount</span><span>(</span><span>count</span> + <span>1</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>1000</span><span>)</span><span>;</span>
  <span>return</span> <span>&lt;</span><span>h1</span><span>&gt;</span><span>{</span><span>count</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span>
<span>}</span>

<span>function</span> <span>useTimer</span><span>(</span><span>callback</span><span>,</span> <span>delay</span><span>)</span> <span>{</span>
  <span>const</span> <span>onTick</span> = <span>useEffectEvent</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>callback</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>id</span> = <span>setInterval</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>onTick</span><span>(</span><span>)</span><span>;</span> <span>// ‚úÖ Good: Only called locally inside an Effect</span>
    <span>}</span><span>,</span> <span>delay</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>clearInterval</span><span>(</span><span>id</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>delay</span><span>]</span><span>)</span><span>;</span> <span>// No need to specify "onTick" (an Effect Event) as a dependency</span>
<span>}</span></code></pre> <p>Effect Events are non-reactive ‚Äúpieces‚Äù of your Effect code. They should be next to the Effect using them.</p> <section><h2 id="recap">Recap<a href="#recap" aria-label="Link for Recap" title="Link for Recap"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2>
<ul> <li>Event handlers run in response to specific interactions.</li> <li>Effects run whenever synchronization is needed.</li> <li>Logic inside event handlers is not reactive.</li> <li>Logic inside Effects is reactive.</li> <li>You can move non-reactive logic from Effects into Effect Events.</li> <li>Only call Effect Events from inside Effects.</li> <li>Don‚Äôt pass Effect Events to other components or Hooks.</li> </ul></section> <div class="note">
<h4>Try out some challenges</h4>

<div>
<h4 id="fix-a-variable-that-doesnt-update">
<div>Challenge 1 of 4<span>: </span>
</div>Fix a variable that doesn‚Äôt update <a href="#fix-a-variable-that-doesnt-update" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4>
<p>This <code dir="ltr">Timer</code> component keeps a <code dir="ltr">count</code> state variable which increases every second. The value by which it‚Äôs increasing is stored in the <code dir="ltr">increment</code> state variable. You can control the <code dir="ltr">increment</code> variable with the plus and minus buttons.</p>
<p>However, no matter how many times you click the plus button, the counter is still incremented by one every second. What‚Äôs wrong with this code? Why is <code dir="ltr">increment</code> always equal to <code dir="ltr">1</code> inside the Effect‚Äôs code? Find the mistake and fix it.</p>

<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>Timer</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>count</span><span>,</span> <span>setCount</span><span>]</span> = <span>useState</span><span>(</span><span>0</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>increment</span><span>,</span> <span>setIncrement</span><span>]</span> = <span>useState</span><span>(</span><span>1</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>id</span> = <span>setInterval</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>setCount</span><span>(</span><span>c</span> <span>=&gt;</span> <span>c</span> + <span>increment</span><span>)</span><span>;</span>
    <span>}</span><span>,</span> <span>1000</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>clearInterval</span><span>(</span><span>id</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>
    <span>// eslint-disable-next-line react-hooks/exhaustive-deps</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>h1</span><span>&gt;</span>
        Counter: <span>{</span><span>count</span><span>}</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setCount</span><span>(</span><span>0</span><span>)</span><span>}</span><span>&gt;</span>Reset<span>&lt;/</span><span>button</span><span>&gt;</span>
      <span>&lt;/</span><span>h1</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>&lt;</span><span>p</span><span>&gt;</span>
        Every second, increment by:
        <span>&lt;</span><span>button</span> <span>disabled</span>=<span>{</span><span>increment</span> === <span>0</span><span>}</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
          <span>setIncrement</span><span>(</span><span>i</span> <span>=&gt;</span> <span>i</span> - <span>1</span><span>)</span><span>;</span>
        <span>}</span><span>}</span><span>&gt;</span>‚Äì<span>&lt;/</span><span>button</span><span>&gt;</span>
        <span>&lt;</span><span>b</span><span>&gt;</span><span>{</span><span>increment</span><span>}</span><span>&lt;/</span><span>b</span><span>&gt;</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
          <span>setIncrement</span><span>(</span><span>i</span> <span>=&gt;</span> <span>i</span> + <span>1</span><span>)</span><span>;</span>
        <span>}</span><span>}</span><span>&gt;</span>+<span>&lt;/</span><span>button</span><span>&gt;</span>
      <span>&lt;/</span><span>p</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre>
</div>

</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2013&ndash;present Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://react.dev/learn/separating-events-from-effects" class="_attribution-link">https://react.dev/learn/separating-events-from-effects</a>
  </p>
</div>
