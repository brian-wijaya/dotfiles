<h1>Reusing Logic with Custom Hooks<a href="#undefined" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h1>
<div><p>React comes with several built-in Hooks like <code dir="ltr">useState</code>, <code dir="ltr">useContext</code>, and <code dir="ltr">useEffect</code>. Sometimes, you‚Äôll wish that there was a Hook for some more specific purpose: for example, to fetch data, to keep track of whether the user is online, or to connect to a chat room. You might not find these Hooks in React, but you can create your own Hooks for your application‚Äôs needs.</p></div> <div class="note">
<h4>You will learn</h4>
<ul> <li>What custom Hooks are, and how to write your own</li> <li>How to reuse logic between components</li> <li>How to name and structure your custom Hooks</li> <li>When and why to extract custom Hooks</li> </ul>
</div> <h2 id="custom-hooks-sharing-logic-between-components">Custom Hooks: Sharing logic between components <a href="#custom-hooks-sharing-logic-between-components" aria-label="Link for Custom Hooks: Sharing logic between components " title="Link for Custom Hooks: Sharing logic between components "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>Imagine you‚Äôre developing an app that heavily relies on the network (as most apps do). You want to warn the user if their network connection has accidentally gone off while they were using your app. How would you go about it? It seems like you‚Äôll need two things in your component:</p> <ol> <li>A piece of state that tracks whether the network is online.</li> <li>An Effect that subscribes to the global <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/online_event" target="_blank" rel="nofollow noopener noreferrer"><code dir="ltr">online</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/offline_event" target="_blank" rel="nofollow noopener noreferrer"><code dir="ltr">offline</code></a> events, and updates that state.</li> </ol> <p>This will keep your component <a href="synchronizing-with-effects">synchronized</a> with the network status. You might start with something like this:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>StatusBar</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isOnline</span><span>,</span> <span>setIsOnline</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>function</span> <span>handleOnline</span><span>(</span><span>)</span> <span>{</span>
      <span>setIsOnline</span><span>(</span><span>true</span><span>)</span><span>;</span>
    <span>}</span>
    <span>function</span> <span>handleOffline</span><span>(</span><span>)</span> <span>{</span>
      <span>setIsOnline</span><span>(</span><span>false</span><span>)</span><span>;</span>
    <span>}</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'online'</span><span>,</span> <span>handleOnline</span><span>)</span><span>;</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'offline'</span><span>,</span> <span>handleOffline</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>window</span>.<span>removeEventListener</span><span>(</span><span>'online'</span><span>,</span> <span>handleOnline</span><span>)</span><span>;</span>
      <span>window</span>.<span>removeEventListener</span><span>(</span><span>'offline'</span><span>,</span> <span>handleOffline</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>&lt;</span><span>h1</span><span>&gt;</span><span>{</span><span>isOnline</span> ? <span>'‚úÖ Online'</span> : <span>'‚ùå Disconnected'</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span><span>;</span>
<span>}</span>

</pre> <p>Try turning your network on and off, and notice how this <code dir="ltr">StatusBar</code> updates in response to your actions.</p> <p>Now imagine you <em>also</em> want to use the same logic in a different component. You want to implement a Save button that will become disabled and show ‚ÄúReconnecting‚Ä¶‚Äù instead of ‚ÄúSave‚Äù while the network is off.</p> <p>To start, you can copy and paste the <code dir="ltr">isOnline</code> state and the Effect into <code dir="ltr">SaveButton</code>:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>SaveButton</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isOnline</span><span>,</span> <span>setIsOnline</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>function</span> <span>handleOnline</span><span>(</span><span>)</span> <span>{</span>
      <span>setIsOnline</span><span>(</span><span>true</span><span>)</span><span>;</span>
    <span>}</span>
    <span>function</span> <span>handleOffline</span><span>(</span><span>)</span> <span>{</span>
      <span>setIsOnline</span><span>(</span><span>false</span><span>)</span><span>;</span>
    <span>}</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'online'</span><span>,</span> <span>handleOnline</span><span>)</span><span>;</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'offline'</span><span>,</span> <span>handleOffline</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>window</span>.<span>removeEventListener</span><span>(</span><span>'online'</span><span>,</span> <span>handleOnline</span><span>)</span><span>;</span>
      <span>window</span>.<span>removeEventListener</span><span>(</span><span>'offline'</span><span>,</span> <span>handleOffline</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>

  <span>function</span> <span>handleSaveClick</span><span>(</span><span>)</span> <span>{</span>
    <span>console</span>.<span>log</span><span>(</span><span>'‚úÖ Progress saved'</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>button</span> <span>disabled</span>=<span>{</span>!<span>isOnline</span><span>}</span> <span>onClick</span>=<span>{</span><span>handleSaveClick</span><span>}</span><span>&gt;</span>
      <span>{</span><span>isOnline</span> ? <span>'Save progress'</span> : <span>'Reconnecting...'</span><span>}</span>
    <span>&lt;/</span><span>button</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Verify that, if you turn off the network, the button will change its appearance.</p> <p>These two components work fine, but the duplication in logic between them is unfortunate. It seems like even though they have different <em>visual appearance,</em> you want to reuse the logic between them.</p> <h3 id="extracting-your-own-custom-hook-from-a-component">Extracting your own custom Hook from a component <a href="#extracting-your-own-custom-hook-from-a-component" aria-label="Link for Extracting your own custom Hook from a component " title="Link for Extracting your own custom Hook from a component "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Imagine for a moment that, similar to <a href="../reference/react/usestate"><code dir="ltr">useState</code></a> and <a href="../reference/react/useeffect"><code dir="ltr">useEffect</code></a>, there was a built-in <code dir="ltr">useOnlineStatus</code> Hook. Then both of these components could be simplified and you could remove the duplication between them:</p> <pre data-language="jsx"><code><span>function</span> <span>StatusBar</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>isOnline</span> = <span>useOnlineStatus</span><span>(</span><span>)</span><span>;</span>
  <span>return</span> <span>&lt;</span><span>h1</span><span>&gt;</span><span>{</span><span>isOnline</span> ? <span>'‚úÖ Online'</span> : <span>'‚ùå Disconnected'</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span><span>;</span>
<span>}</span>

<span>function</span> <span>SaveButton</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>isOnline</span> = <span>useOnlineStatus</span><span>(</span><span>)</span><span>;</span>

  <span>function</span> <span>handleSaveClick</span><span>(</span><span>)</span> <span>{</span>
    <span>console</span>.<span>log</span><span>(</span><span>'‚úÖ Progress saved'</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>button</span> <span>disabled</span>=<span>{</span>!<span>isOnline</span><span>}</span> <span>onClick</span>=<span>{</span><span>handleSaveClick</span><span>}</span><span>&gt;</span>
      <span>{</span><span>isOnline</span> ? <span>'Save progress'</span> : <span>'Reconnecting...'</span><span>}</span>
    <span>&lt;/</span><span>button</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span></code></pre> <p>Although there is no such built-in Hook, you can write it yourself. Declare a function called <code dir="ltr">useOnlineStatus</code> and move all the duplicated code into it from the components you wrote earlier:</p> <pre data-language="jsx"><code><span>function</span> <span>useOnlineStatus</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isOnline</span><span>,</span> <span>setIsOnline</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>function</span> <span>handleOnline</span><span>(</span><span>)</span> <span>{</span>
      <span>setIsOnline</span><span>(</span><span>true</span><span>)</span><span>;</span>
    <span>}</span>
    <span>function</span> <span>handleOffline</span><span>(</span><span>)</span> <span>{</span>
      <span>setIsOnline</span><span>(</span><span>false</span><span>)</span><span>;</span>
    <span>}</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'online'</span><span>,</span> <span>handleOnline</span><span>)</span><span>;</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'offline'</span><span>,</span> <span>handleOffline</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>window</span>.<span>removeEventListener</span><span>(</span><span>'online'</span><span>,</span> <span>handleOnline</span><span>)</span><span>;</span>
      <span>window</span>.<span>removeEventListener</span><span>(</span><span>'offline'</span><span>,</span> <span>handleOffline</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>
  <span>return</span> <span>isOnline</span><span>;</span>
<span>}</span></code></pre> <p>At the end of the function, return <code dir="ltr">isOnline</code>. This lets your components read that value:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useOnlineStatus</span> <span>}</span> <span>from</span> <span>'./useOnlineStatus.js'</span><span>;</span>

<span>function</span> <span>StatusBar</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>isOnline</span> = <span>useOnlineStatus</span><span>(</span><span>)</span><span>;</span>
  <span>return</span> <span>&lt;</span><span>h1</span><span>&gt;</span><span>{</span><span>isOnline</span> ? <span>'‚úÖ Online'</span> : <span>'‚ùå Disconnected'</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span><span>;</span>
<span>}</span>

<span>function</span> <span>SaveButton</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>isOnline</span> = <span>useOnlineStatus</span><span>(</span><span>)</span><span>;</span>

  <span>function</span> <span>handleSaveClick</span><span>(</span><span>)</span> <span>{</span>
    <span>console</span>.<span>log</span><span>(</span><span>'‚úÖ Progress saved'</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>button</span> <span>disabled</span>=<span>{</span>!<span>isOnline</span><span>}</span> <span>onClick</span>=<span>{</span><span>handleSaveClick</span><span>}</span><span>&gt;</span>
      <span>{</span><span>isOnline</span> ? <span>'Save progress'</span> : <span>'Reconnecting...'</span><span>}</span>
    <span>&lt;/</span><span>button</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>SaveButton</span> <span>/&gt;</span>
      <span>&lt;</span><span>StatusBar</span> <span>/&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Verify that switching the network on and off updates both components.</p> <p>Now your components don‚Äôt have as much repetitive logic. <strong>More importantly, the code inside them describes <em>what they want to do</em> (use the online status!) rather than <em>how to do it</em> (by subscribing to the browser events).</strong></p> <p>When you extract logic into custom Hooks, you can hide the gnarly details of how you deal with some external system or a browser API. The code of your components expresses your intent, not the implementation.</p> <h3 id="hook-names-always-start-with-use">Hook names always start with <code dir="ltr">use</code> <a href="#hook-names-always-start-with-use" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>React applications are built from components. Components are built from Hooks, whether built-in or custom. You‚Äôll likely often use custom Hooks created by others, but occasionally you might write one yourself!</p> <p>You must follow these naming conventions:</p> <ol> <li>
<strong>React component names must start with a capital letter,</strong> like <code dir="ltr">StatusBar</code> and <code dir="ltr">SaveButton</code>. React components also need to return something that React knows how to display, like a piece of JSX.</li> <li>
<strong>Hook names must start with <code dir="ltr">use</code> followed by a capital letter,</strong> like <a href="../reference/react/usestate"><code dir="ltr">useState</code></a> (built-in) or <code dir="ltr">useOnlineStatus</code> (custom, like earlier on the page). Hooks may return arbitrary values.</li> </ol> <p>This convention guarantees that you can always look at a component and know where its state, Effects, and other React features might ‚Äúhide‚Äù. For example, if you see a <code dir="ltr">getColor()</code> function call inside your component, you can be sure that it can‚Äôt possibly contain React state inside because its name doesn‚Äôt start with <code dir="ltr">use</code>. However, a function call like <code dir="ltr">useOnlineStatus()</code> will most likely contain calls to other Hooks inside!</p> <div class="note note-green">
<h4>Note</h4>
<div><p>If your linter is <a href="editor-setup#linting">configured for React,</a> it will enforce this naming convention. Scroll up to the sandbox above and rename <code dir="ltr">useOnlineStatus</code> to <code dir="ltr">getOnlineStatus</code>. Notice that the linter won‚Äôt allow you to call <code dir="ltr">useState</code> or <code dir="ltr">useEffect</code> inside of it anymore. Only Hooks and components can call other Hooks!</p></div>
</div> <details class="note note-blue"><summary tabindex="-1"><h5>
<svg width="1.5em" height="1.5em" viewbox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M34.7409 59.7228L32.9567 58.9094C27.2672 56.3157 20.7328 56.3157 15.0433 58.9094C12.6018 60.0224 9.39163 59.0275 8.44602 56.0621C7.45647 52.9589 5.99975 46.5898 6 35.9997C6.00029 23.5648 8.00803 18.3599 9.11099 16.4196C9.67795 15.4222 10.5255 14.8455 11.2254 14.5264L12.0179 14.1651C19.6351 10.6926 28.4011 10.6738 36 14.1733C43.5989 10.6738 52.3649 10.6926 59.9821 14.1651L60.7746 14.5264C61.4745 14.8455 62.3221 15.4222 62.889 16.4196C63.992 18.3599 65.9997 23.5648 66 35.9997C66.0002 46.5898 64.5435 52.9589 63.554 56.0621C62.6084 59.0275 59.3982 60.0224 56.9567 58.9094C51.2672 56.3157 44.7328 56.3157 39.0433 58.9094L37.2591 59.7228C37.1986 59.7508 37.1373 59.7767 37.0753 59.8004C36.4484 60.0411 35.7556 60.0653 35.1102 59.8648C34.9847 59.8258 34.8613 59.7784 34.7409 59.7228ZM14.5068 19.6246C20.3733 16.9501 27.0874 16.8775 33 19.4067V52.473C26.7613 50.32 19.9378 50.471 13.7811 52.9261C13.0005 49.9843 11.9998 44.547 12 35.9998C12.0002 25.5786 13.4879 21.1893 14.1179 19.8018L14.5068 19.6246ZM39 52.473C45.2387 50.32 52.0622 50.471 58.2189 52.9261C58.9995 49.9843 60.0002 44.547 60 35.9998C59.9998 25.5786 58.5121 21.1893 57.8821 19.8018L57.4932 19.6246C51.6267 16.9501 44.9126 16.8775 39 19.4067V52.473Z" fill="currentColor"></path></svg>Deep Dive</h5>
<h4 id="should-all-functions-called-during-rendering-start-with-the-use-prefix">Should all functions called during rendering start with the use prefix? <a href="#should-all-functions-called-during-rendering-start-with-the-use-prefix" aria-label="Link for Should all functions called during rendering start with the use prefix? " title="Link for Should all functions called during rendering start with the use prefix? "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4></summary><div>
<p>No. Functions that don‚Äôt <em>call</em> Hooks don‚Äôt need to <em>be</em> Hooks.</p>
<p>If your function doesn‚Äôt call any Hooks, avoid the <code dir="ltr">use</code> prefix. Instead, write it as a regular function <em>without</em> the <code dir="ltr">use</code> prefix. For example, <code dir="ltr">useSorted</code> below doesn‚Äôt call Hooks, so call it <code dir="ltr">getSorted</code> instead:</p>
<pre data-language="jsx"><code><span>// üî¥ Avoid: A Hook that doesn't use Hooks</span>
<span>function</span> <span>useSorted</span><span>(</span><span>items</span><span>)</span> <span>{</span>
  <span>return</span> <span>items</span>.<span>slice</span><span>(</span><span>)</span>.<span>sort</span><span>(</span><span>)</span><span>;</span>
<span>}</span>

<span>// ‚úÖ Good: A regular function that doesn't use Hooks</span>
<span>function</span> <span>getSorted</span><span>(</span><span>items</span><span>)</span> <span>{</span>
  <span>return</span> <span>items</span>.<span>slice</span><span>(</span><span>)</span>.<span>sort</span><span>(</span><span>)</span><span>;</span>
<span>}</span></code></pre>
<p>This ensures that your code can call this regular function anywhere, including conditions:</p>
<pre data-language="jsx"><code><span>function</span> <span>List</span><span>(</span><span>{</span> <span>items</span><span>,</span> <span>shouldSort</span> <span>}</span><span>)</span> <span>{</span>
  <span>let</span> <span>displayedItems</span> = <span>items</span><span>;</span>
  <span>if</span> <span>(</span><span>shouldSort</span><span>)</span> <span>{</span>
    <span>// ‚úÖ It's ok to call getSorted() conditionally because it's not a Hook</span>
    <span>displayedItems</span> = <span>getSorted</span><span>(</span><span>items</span><span>)</span><span>;</span>
  <span>}</span>
  <span>// ...</span>
<span>}</span></code></pre>
<p>You should give <code dir="ltr">use</code> prefix to a function (and thus make it a Hook) if it uses at least one Hook inside of it:</p>
<pre data-language="jsx"><code><span>// ‚úÖ Good: A Hook that uses other Hooks</span>
<span>function</span> <span>useAuth</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>useContext</span><span>(</span><span>Auth</span><span>)</span><span>;</span>
<span>}</span></code></pre>
<p>Technically, this isn‚Äôt enforced by React. In principle, you could make a Hook that doesn‚Äôt call other Hooks. This is often confusing and limiting so it‚Äôs best to avoid that pattern. However, there may be rare cases where it is helpful. For example, maybe your function doesn‚Äôt use any Hooks right now, but you plan to add some Hook calls to it in the future. Then it makes sense to name it with the <code dir="ltr">use</code> prefix:</p>
<pre data-language="jsx"><code><span>// ‚úÖ Good: A Hook that will likely use some other Hooks later</span>
<span>function</span> <span>useAuth</span><span>(</span><span>)</span> <span>{</span>
  <span>// TODO: Replace with this line when authentication is implemented:</span>
  <span>// return useContext(Auth);</span>
  <span>return</span> <span>TEST_USER</span><span>;</span>
<span>}</span></code></pre>
<p>Then components won‚Äôt be able to call it conditionally. This will become important when you actually add Hook calls inside. If you don‚Äôt plan to use Hooks inside it (now or later), don‚Äôt make it a Hook.</p>
</div></details> <h3 id="custom-hooks-let-you-share-stateful-logic-not-state-itself">Custom Hooks let you share stateful logic, not state itself <a href="#custom-hooks-let-you-share-stateful-logic-not-state-itself" aria-label="Link for Custom Hooks let you share stateful logic, not state itself " title="Link for Custom Hooks let you share stateful logic, not state itself "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>In the earlier example, when you turned the network on and off, both components updated together. However, it‚Äôs wrong to think that a single <code dir="ltr">isOnline</code> state variable is shared between them. Look at this code:</p> <pre data-language="jsx"><code><span>function</span> <span>StatusBar</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>isOnline</span> = <span>useOnlineStatus</span><span>(</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span>

<span>function</span> <span>SaveButton</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>isOnline</span> = <span>useOnlineStatus</span><span>(</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span></code></pre> <p>It works the same way as before you extracted the duplication:</p> <pre data-language="jsx"><code><span>function</span> <span>StatusBar</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isOnline</span><span>,</span> <span>setIsOnline</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>// ...</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span>

<span>function</span> <span>SaveButton</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isOnline</span><span>,</span> <span>setIsOnline</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>// ...</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span></code></pre> <p>These are two completely independent state variables and Effects! They happened to have the same value at the same time because you synchronized them with the same external value (whether the network is on).</p> <p>To better illustrate this, we‚Äôll need a different example. Consider this <code dir="ltr">Form</code> component:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>Form</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>firstName</span><span>,</span> <span>setFirstName</span><span>]</span> = <span>useState</span><span>(</span><span>'Mary'</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>lastName</span><span>,</span> <span>setLastName</span><span>]</span> = <span>useState</span><span>(</span><span>'Poppins'</span><span>)</span><span>;</span>

  <span>function</span> <span>handleFirstNameChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setFirstName</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>;</span>
  <span>}</span>

  <span>function</span> <span>handleLastNameChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setLastName</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        First name:
        <span>&lt;</span><span>input</span> <span>value</span>=<span>{</span><span>firstName</span><span>}</span> <span>onChange</span>=<span>{</span><span>handleFirstNameChange</span><span>}</span> <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Last name:
        <span>&lt;</span><span>input</span> <span>value</span>=<span>{</span><span>lastName</span><span>}</span> <span>onChange</span>=<span>{</span><span>handleLastNameChange</span><span>}</span> <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>p</span><span>&gt;</span><span>&lt;</span><span>b</span><span>&gt;</span>Good morning, <span>{</span><span>firstName</span><span>}</span> <span>{</span><span>lastName</span><span>}</span>.<span>&lt;/</span><span>b</span><span>&gt;</span><span>&lt;/</span><span>p</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>There‚Äôs some repetitive logic for each form field:</p> <ol> <li>There‚Äôs a piece of state (<code dir="ltr">firstName</code> and <code dir="ltr">lastName</code>).</li> <li>There‚Äôs a change handler (<code dir="ltr">handleFirstNameChange</code> and <code dir="ltr">handleLastNameChange</code>).</li> <li>There‚Äôs a piece of JSX that specifies the <code dir="ltr">value</code> and <code dir="ltr">onChange</code> attributes for that input.</li> </ol> <p>You can extract the repetitive logic into this <code dir="ltr">useFormInput</code> custom Hook:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>function</span> <span>useFormInput</span><span>(</span><span>initialValue</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>value</span><span>,</span> <span>setValue</span><span>]</span> = <span>useState</span><span>(</span><span>initialValue</span><span>)</span><span>;</span>

  <span>function</span> <span>handleChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
    <span>setValue</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>;</span>
  <span>}</span>

  <span>const</span> <span>inputProps</span> = <span>{</span>
    <span>value</span><span>:</span> <span>value</span><span>,</span>
    <span>onChange</span><span>:</span> <span>handleChange</span>
  <span>}</span><span>;</span>

  <span>return</span> <span>inputProps</span><span>;</span>
<span>}</span>

</pre> <p>Notice that it only declares <em>one</em> state variable called <code dir="ltr">value</code>.</p> <p>However, the <code dir="ltr">Form</code> component calls <code dir="ltr">useFormInput</code> <em>two times:</em></p> <pre data-language="jsx"><code><span>function</span> <span>Form</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>firstNameProps</span> = <span>useFormInput</span><span>(</span><span>'Mary'</span><span>)</span><span>;</span>
  <span>const</span> <span>lastNameProps</span> = <span>useFormInput</span><span>(</span><span>'Poppins'</span><span>)</span><span>;</span>
  <span>// ...</span></code></pre> <p>This is why it works like declaring two separate state variables!</p> <p><strong>Custom Hooks let you share <em>stateful logic</em> but not <em>state itself.</em> Each call to a Hook is completely independent from every other call to the same Hook.</strong> This is why the two sandboxes above are completely equivalent. If you‚Äôd like, scroll back up and compare them. The behavior before and after extracting a custom Hook is identical.</p> <p>When you need to share the state itself between multiple components, <a href="sharing-state-between-components">lift it up and pass it down</a> instead.</p> <h2 id="passing-reactive-values-between-hooks">Passing reactive values between Hooks <a href="#passing-reactive-values-between-hooks" aria-label="Link for Passing reactive values between Hooks " title="Link for Passing reactive values between Hooks "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>The code inside your custom Hooks will re-run during every re-render of your component. This is why, like components, custom Hooks <a href="keeping-components-pure">need to be pure.</a> Think of custom Hooks‚Äô code as part of your component‚Äôs body!</p> <p>Because custom Hooks re-render together with your component, they always receive the latest props and state. To see what this means, consider this chat room example. Change the server URL or the chat room:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>createConnection</span> <span>}</span> <span>from</span> <span>'./chat.js'</span><span>;</span>
<span>import</span> <span>{</span> <span>showNotification</span> <span>}</span> <span>from</span> <span>'./notifications.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>serverUrl</span><span>,</span> <span>setServerUrl</span><span>]</span> = <span>useState</span><span>(</span><span>'https://localhost:1234'</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>options</span> = <span>{</span>
      <span>serverUrl</span><span>:</span> <span>serverUrl</span><span>,</span>
      <span>roomId</span><span>:</span> <span>roomId</span>
    <span>}</span><span>;</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>options</span><span>)</span><span>;</span>
    <span>connection</span>.<span>on</span><span>(</span><span>'message'</span><span>,</span> <span>(</span><span>msg</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>showNotification</span><span>(</span><span>'New message: '</span> + <span>msg</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>,</span> <span>serverUrl</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Server URL:
        <span>&lt;</span><span>input</span> <span>value</span>=<span>{</span><span>serverUrl</span><span>}</span> <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setServerUrl</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>}</span> <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>h1</span><span>&gt;</span>Welcome to the <span>{</span><span>roomId</span><span>}</span> room!<span>&lt;/</span><span>h1</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>When you change <code dir="ltr">serverUrl</code> or <code dir="ltr">roomId</code>, the Effect <a href="lifecycle-of-reactive-effects#effects-react-to-reactive-values">‚Äúreacts‚Äù to your changes</a> and re-synchronizes. You can tell by the console messages that the chat re-connects every time that you change your Effect‚Äôs dependencies.</p> <p>Now move the Effect‚Äôs code into a custom Hook:</p> <pre data-language="jsx"><code><span>export</span> <span>function</span> <span>useChatRoom</span><span>(</span><span>{</span> <span>serverUrl</span><span>,</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>options</span> = <span>{</span>
      <span>serverUrl</span><span>:</span> <span>serverUrl</span><span>,</span>
      <span>roomId</span><span>:</span> <span>roomId</span>
    <span>}</span><span>;</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>options</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>connection</span>.<span>on</span><span>(</span><span>'message'</span><span>,</span> <span>(</span><span>msg</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>showNotification</span><span>(</span><span>'New message: '</span> + <span>msg</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>,</span> <span>serverUrl</span><span>]</span><span>)</span><span>;</span>
<span>}</span></code></pre> <p>This lets your <code dir="ltr">ChatRoom</code> component call your custom Hook without worrying about how it works inside:</p> <pre data-language="jsx"><code><span>export</span> <span>default</span> <span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>serverUrl</span><span>,</span> <span>setServerUrl</span><span>]</span> = <span>useState</span><span>(</span><span>'https://localhost:1234'</span><span>)</span><span>;</span>

  <span>useChatRoom</span><span>(</span><span>{</span>
    <span>roomId</span><span>:</span> <span>roomId</span><span>,</span>
    <span>serverUrl</span><span>:</span> <span>serverUrl</span>
  <span>}</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Server URL:
        <span>&lt;</span><span>input</span> <span>value</span>=<span>{</span><span>serverUrl</span><span>}</span> <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setServerUrl</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>}</span> <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>h1</span><span>&gt;</span>Welcome to the <span>{</span><span>roomId</span><span>}</span> room!<span>&lt;/</span><span>h1</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span></code></pre> <p>This looks much simpler! (But it does the same thing.)</p> <p>Notice that the logic <em>still responds</em> to prop and state changes. Try editing the server URL or the selected room:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>useChatRoom</span> <span>}</span> <span>from</span> <span>'./useChatRoom.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>serverUrl</span><span>,</span> <span>setServerUrl</span><span>]</span> = <span>useState</span><span>(</span><span>'https://localhost:1234'</span><span>)</span><span>;</span>

  <span>useChatRoom</span><span>(</span><span>{</span>
    <span>roomId</span><span>:</span> <span>roomId</span><span>,</span>
    <span>serverUrl</span><span>:</span> <span>serverUrl</span>
  <span>}</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Server URL:
        <span>&lt;</span><span>input</span> <span>value</span>=<span>{</span><span>serverUrl</span><span>}</span> <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setServerUrl</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>}</span> <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>h1</span><span>&gt;</span>Welcome to the <span>{</span><span>roomId</span><span>}</span> room!<span>&lt;/</span><span>h1</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Notice how you‚Äôre taking the return value of one Hook:</p> <pre data-language="jsx"><code><span>export</span> <span>default</span> <span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>serverUrl</span><span>,</span> <span>setServerUrl</span><span>]</span> = <span>useState</span><span>(</span><span>'https://localhost:1234'</span><span>)</span><span>;</span>

  <span>useChatRoom</span><span>(</span><span>{</span>
    <span>roomId</span><span>:</span> <span>roomId</span><span>,</span>
    <span>serverUrl</span><span>:</span> <span>serverUrl</span>
  <span>}</span><span>)</span><span>;</span>
  <span>// ...</span></code></pre> <p>and passing it as an input to another Hook:</p> <pre data-language="jsx"><code><span>export</span> <span>default</span> <span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>serverUrl</span><span>,</span> <span>setServerUrl</span><span>]</span> = <span>useState</span><span>(</span><span>'https://localhost:1234'</span><span>)</span><span>;</span>

  <span>useChatRoom</span><span>(</span><span>{</span>
    <span>roomId</span><span>:</span> <span>roomId</span><span>,</span>
    <span>serverUrl</span><span>:</span> <span>serverUrl</span>
  <span>}</span><span>)</span><span>;</span>
  <span>// ...</span></code></pre> <p>Every time your <code dir="ltr">ChatRoom</code> component re-renders, it passes the latest <code dir="ltr">roomId</code> and <code dir="ltr">serverUrl</code> to your Hook. This is why your Effect re-connects to the chat whenever their values are different after a re-render. (If you ever worked with audio or video processing software, chaining Hooks like this might remind you of chaining visual or audio effects. It‚Äôs as if the output of <code dir="ltr">useState</code> ‚Äúfeeds into‚Äù the input of the <code dir="ltr">useChatRoom</code>.)</p> <h3 id="passing-event-handlers-to-custom-hooks">Passing event handlers to custom Hooks <a href="#passing-event-handlers-to-custom-hooks" aria-label="Link for Passing event handlers to custom Hooks " title="Link for Passing event handlers to custom Hooks "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>As you start using <code dir="ltr">useChatRoom</code> in more components, you might want to let components customize its behavior. For example, currently, the logic for what to do when a message arrives is hardcoded inside the Hook:</p> <pre data-language="jsx"><code><span>export</span> <span>function</span> <span>useChatRoom</span><span>(</span><span>{</span> <span>serverUrl</span><span>,</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>options</span> = <span>{</span>
      <span>serverUrl</span><span>:</span> <span>serverUrl</span><span>,</span>
      <span>roomId</span><span>:</span> <span>roomId</span>
    <span>}</span><span>;</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>options</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>connection</span>.<span>on</span><span>(</span><span>'message'</span><span>,</span> <span>(</span><span>msg</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>showNotification</span><span>(</span><span>'New message: '</span> + <span>msg</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>,</span> <span>serverUrl</span><span>]</span><span>)</span><span>;</span>
<span>}</span></code></pre> <p>Let‚Äôs say you want to move this logic back to your component:</p> <pre data-language="jsx"><code><span>export</span> <span>default</span> <span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>serverUrl</span><span>,</span> <span>setServerUrl</span><span>]</span> = <span>useState</span><span>(</span><span>'https://localhost:1234'</span><span>)</span><span>;</span>

  <span>useChatRoom</span><span>(</span><span>{</span>
    <span>roomId</span><span>:</span> <span>roomId</span><span>,</span>
    <span>serverUrl</span><span>:</span> <span>serverUrl</span><span>,</span>
    <span>onReceiveMessage</span><span>(</span><span>msg</span><span>)</span> <span>{</span>
      <span>showNotification</span><span>(</span><span>'New message: '</span> + <span>msg</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span><span>)</span><span>;</span>
  <span>// ...</span></code></pre> <p>To make this work, change your custom Hook to take <code dir="ltr">onReceiveMessage</code> as one of its named options:</p> <pre data-language="jsx"><code><span>export</span> <span>function</span> <span>useChatRoom</span><span>(</span><span>{</span> <span>serverUrl</span><span>,</span> <span>roomId</span><span>,</span> <span>onReceiveMessage</span> <span>}</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>options</span> = <span>{</span>
      <span>serverUrl</span><span>:</span> <span>serverUrl</span><span>,</span>
      <span>roomId</span><span>:</span> <span>roomId</span>
    <span>}</span><span>;</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>options</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>connection</span>.<span>on</span><span>(</span><span>'message'</span><span>,</span> <span>(</span><span>msg</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>onReceiveMessage</span><span>(</span><span>msg</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>,</span> <span>serverUrl</span><span>,</span> <span>onReceiveMessage</span><span>]</span><span>)</span><span>;</span> <span>// ‚úÖ All dependencies declared</span>
<span>}</span></code></pre> <p>This will work, but there‚Äôs one more improvement you can do when your custom Hook accepts event handlers.</p> <p>Adding a dependency on <code dir="ltr">onReceiveMessage</code> is not ideal because it will cause the chat to re-connect every time the component re-renders. <a href="removing-effect-dependencies#wrapping-an-event-handler-from-the-props">Wrap this event handler into an Effect Event to remove it from the dependencies:</a></p> <pre data-language="jsx"><code><span>import</span> <span>{</span> <span>useEffect</span><span>,</span> <span>useEffectEvent</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>// ...</span>

<span>export</span> <span>function</span> <span>useChatRoom</span><span>(</span><span>{</span> <span>serverUrl</span><span>,</span> <span>roomId</span><span>,</span> <span>onReceiveMessage</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>onMessage</span> = <span>useEffectEvent</span><span>(</span><span>onReceiveMessage</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>options</span> = <span>{</span>
      <span>serverUrl</span><span>:</span> <span>serverUrl</span><span>,</span>
      <span>roomId</span><span>:</span> <span>roomId</span>
    <span>}</span><span>;</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>options</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>connection</span>.<span>on</span><span>(</span><span>'message'</span><span>,</span> <span>(</span><span>msg</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>onMessage</span><span>(</span><span>msg</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>,</span> <span>serverUrl</span><span>]</span><span>)</span><span>;</span> <span>// ‚úÖ All dependencies declared</span>
<span>}</span></code></pre> <p>Now the chat won‚Äôt re-connect every time that the <code dir="ltr">ChatRoom</code> component re-renders. Here is a fully working demo of passing an event handler to a custom Hook that you can play with:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>useChatRoom</span> <span>}</span> <span>from</span> <span>'./useChatRoom.js'</span><span>;</span>
<span>import</span> <span>{</span> <span>showNotification</span> <span>}</span> <span>from</span> <span>'./notifications.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>serverUrl</span><span>,</span> <span>setServerUrl</span><span>]</span> = <span>useState</span><span>(</span><span>'https://localhost:1234'</span><span>)</span><span>;</span>

  <span>useChatRoom</span><span>(</span><span>{</span>
    <span>roomId</span><span>:</span> <span>roomId</span><span>,</span>
    <span>serverUrl</span><span>:</span> <span>serverUrl</span><span>,</span>
    <span>onReceiveMessage</span><span>(</span><span>msg</span><span>)</span> <span>{</span>
      <span>showNotification</span><span>(</span><span>'New message: '</span> + <span>msg</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>label</span><span>&gt;</span>
        Server URL:
        <span>&lt;</span><span>input</span> <span>value</span>=<span>{</span><span>serverUrl</span><span>}</span> <span>onChange</span>=<span>{</span><span>e</span> <span>=&gt;</span> <span>setServerUrl</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>}</span> <span>/&gt;</span>
      <span>&lt;/</span><span>label</span><span>&gt;</span>
      <span>&lt;</span><span>h1</span><span>&gt;</span>Welcome to the <span>{</span><span>roomId</span><span>}</span> room!<span>&lt;/</span><span>h1</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Notice how you no longer need to know <em>how</em> <code dir="ltr">useChatRoom</code> works in order to use it. You could add it to any other component, pass any other options, and it would work the same way. That‚Äôs the power of custom Hooks.</p> <h2 id="when-to-use-custom-hooks">When to use custom Hooks <a href="#when-to-use-custom-hooks" aria-label="Link for When to use custom Hooks " title="Link for When to use custom Hooks "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>You don‚Äôt need to extract a custom Hook for every little duplicated bit of code. Some duplication is fine. For example, extracting a <code dir="ltr">useFormInput</code> Hook to wrap a single <code dir="ltr">useState</code> call like earlier is probably unnecessary.</p> <p>However, whenever you write an Effect, consider whether it would be clearer to also wrap it in a custom Hook. <a href="you-might-not-need-an-effect">You shouldn‚Äôt need Effects very often,</a> so if you‚Äôre writing one, it means that you need to ‚Äústep outside React‚Äù to synchronize with some external system or to do something that React doesn‚Äôt have a built-in API for. Wrapping it into a custom Hook lets you precisely communicate your intent and how the data flows through it.</p> <p>For example, consider a <code dir="ltr">ShippingForm</code> component that displays two dropdowns: one shows the list of cities, and another shows the list of areas in the selected city. You might start with some code that looks like this:</p> <pre data-language="jsx"><code><span>function</span> <span>ShippingForm</span><span>(</span><span>{</span> <span>country</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>cities</span><span>,</span> <span>setCities</span><span>]</span> = <span>useState</span><span>(</span><span>null</span><span>)</span><span>;</span>
  <span>// This Effect fetches cities for a country</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>let</span> <span>ignore</span> = <span>false</span><span>;</span>
    <span>fetch</span><span>(</span><span>`/api/cities?country=</span><span>${</span><span>country</span><span>}</span><span>`</span><span>)</span>
      .<span>then</span><span>(</span><span>response</span> <span>=&gt;</span> <span>response</span>.<span>json</span><span>(</span><span>)</span><span>)</span>
      .<span>then</span><span>(</span><span>json</span> <span>=&gt;</span> <span>{</span>
        <span>if</span> <span>(</span>!<span>ignore</span><span>)</span> <span>{</span>
          <span>setCities</span><span>(</span><span>json</span><span>)</span><span>;</span>
        <span>}</span>
      <span>}</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>ignore</span> = <span>true</span><span>;</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>country</span><span>]</span><span>)</span><span>;</span>

  <span>const</span> <span>[</span><span>city</span><span>,</span> <span>setCity</span><span>]</span> = <span>useState</span><span>(</span><span>null</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>areas</span><span>,</span> <span>setAreas</span><span>]</span> = <span>useState</span><span>(</span><span>null</span><span>)</span><span>;</span>
  <span>// This Effect fetches areas for the selected city</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>if</span> <span>(</span><span>city</span><span>)</span> <span>{</span>
      <span>let</span> <span>ignore</span> = <span>false</span><span>;</span>
      <span>fetch</span><span>(</span><span>`/api/areas?city=</span><span>${</span><span>city</span><span>}</span><span>`</span><span>)</span>
        .<span>then</span><span>(</span><span>response</span> <span>=&gt;</span> <span>response</span>.<span>json</span><span>(</span><span>)</span><span>)</span>
        .<span>then</span><span>(</span><span>json</span> <span>=&gt;</span> <span>{</span>
          <span>if</span> <span>(</span>!<span>ignore</span><span>)</span> <span>{</span>
            <span>setAreas</span><span>(</span><span>json</span><span>)</span><span>;</span>
          <span>}</span>
        <span>}</span><span>)</span><span>;</span>
      <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
        <span>ignore</span> = <span>true</span><span>;</span>
      <span>}</span><span>;</span>
    <span>}</span>
  <span>}</span><span>,</span> <span>[</span><span>city</span><span>]</span><span>)</span><span>;</span>

  <span>// ...</span></code></pre> <p>Although this code is quite repetitive, <a href="removing-effect-dependencies#is-your-effect-doing-several-unrelated-things">it‚Äôs correct to keep these Effects separate from each other.</a> They synchronize two different things, so you shouldn‚Äôt merge them into one Effect. Instead, you can simplify the <code dir="ltr">ShippingForm</code> component above by extracting the common logic between them into your own <code dir="ltr">useData</code> Hook:</p> <pre data-language="jsx"><code><span>function</span> <span>useData</span><span>(</span><span>url</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>data</span><span>,</span> <span>setData</span><span>]</span> = <span>useState</span><span>(</span><span>null</span><span>)</span><span>;</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>if</span> <span>(</span><span>url</span><span>)</span> <span>{</span>
      <span>let</span> <span>ignore</span> = <span>false</span><span>;</span>
      <span>fetch</span><span>(</span><span>url</span><span>)</span>
        .<span>then</span><span>(</span><span>response</span> <span>=&gt;</span> <span>response</span>.<span>json</span><span>(</span><span>)</span><span>)</span>
        .<span>then</span><span>(</span><span>json</span> <span>=&gt;</span> <span>{</span>
          <span>if</span> <span>(</span>!<span>ignore</span><span>)</span> <span>{</span>
            <span>setData</span><span>(</span><span>json</span><span>)</span><span>;</span>
          <span>}</span>
        <span>}</span><span>)</span><span>;</span>
      <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
        <span>ignore</span> = <span>true</span><span>;</span>
      <span>}</span><span>;</span>
    <span>}</span>
  <span>}</span><span>,</span> <span>[</span><span>url</span><span>]</span><span>)</span><span>;</span>
  <span>return</span> <span>data</span><span>;</span>
<span>}</span></code></pre> <p>Now you can replace both Effects in the <code dir="ltr">ShippingForm</code> components with calls to <code dir="ltr">useData</code>:</p> <pre data-language="jsx"><code><span>function</span> <span>ShippingForm</span><span>(</span><span>{</span> <span>country</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>cities</span> = <span>useData</span><span>(</span><span>`/api/cities?country=</span><span>${</span><span>country</span><span>}</span><span>`</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>city</span><span>,</span> <span>setCity</span><span>]</span> = <span>useState</span><span>(</span><span>null</span><span>)</span><span>;</span>
  <span>const</span> <span>areas</span> = <span>useData</span><span>(</span><span>city</span> ? <span>`/api/areas?city=</span><span>${</span><span>city</span><span>}</span><span>`</span> : <span>null</span><span>)</span><span>;</span>
  <span>// ...</span></code></pre> <p>Extracting a custom Hook makes the data flow explicit. You feed the <code dir="ltr">url</code> in and you get the <code dir="ltr">data</code> out. By ‚Äúhiding‚Äù your Effect inside <code dir="ltr">useData</code>, you also prevent someone working on the <code dir="ltr">ShippingForm</code> component from adding <a href="removing-effect-dependencies">unnecessary dependencies</a> to it. With time, most of your app‚Äôs Effects will be in custom Hooks.</p> <details class="note note-blue"><summary tabindex="-1"><h5>
<svg width="1.5em" height="1.5em" viewbox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M34.7409 59.7228L32.9567 58.9094C27.2672 56.3157 20.7328 56.3157 15.0433 58.9094C12.6018 60.0224 9.39163 59.0275 8.44602 56.0621C7.45647 52.9589 5.99975 46.5898 6 35.9997C6.00029 23.5648 8.00803 18.3599 9.11099 16.4196C9.67795 15.4222 10.5255 14.8455 11.2254 14.5264L12.0179 14.1651C19.6351 10.6926 28.4011 10.6738 36 14.1733C43.5989 10.6738 52.3649 10.6926 59.9821 14.1651L60.7746 14.5264C61.4745 14.8455 62.3221 15.4222 62.889 16.4196C63.992 18.3599 65.9997 23.5648 66 35.9997C66.0002 46.5898 64.5435 52.9589 63.554 56.0621C62.6084 59.0275 59.3982 60.0224 56.9567 58.9094C51.2672 56.3157 44.7328 56.3157 39.0433 58.9094L37.2591 59.7228C37.1986 59.7508 37.1373 59.7767 37.0753 59.8004C36.4484 60.0411 35.7556 60.0653 35.1102 59.8648C34.9847 59.8258 34.8613 59.7784 34.7409 59.7228ZM14.5068 19.6246C20.3733 16.9501 27.0874 16.8775 33 19.4067V52.473C26.7613 50.32 19.9378 50.471 13.7811 52.9261C13.0005 49.9843 11.9998 44.547 12 35.9998C12.0002 25.5786 13.4879 21.1893 14.1179 19.8018L14.5068 19.6246ZM39 52.473C45.2387 50.32 52.0622 50.471 58.2189 52.9261C58.9995 49.9843 60.0002 44.547 60 35.9998C59.9998 25.5786 58.5121 21.1893 57.8821 19.8018L57.4932 19.6246C51.6267 16.9501 44.9126 16.8775 39 19.4067V52.473Z" fill="currentColor"></path></svg>Deep Dive</h5>
<h4 id="keep-your-custom-hooks-focused-on-concrete-high-level-use-cases">Keep your custom Hooks focused on concrete high-level use cases <a href="#keep-your-custom-hooks-focused-on-concrete-high-level-use-cases" aria-label="Link for Keep your custom Hooks focused on concrete high-level use cases " title="Link for Keep your custom Hooks focused on concrete high-level use cases "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4></summary><div>
<p>Start by choosing your custom Hook‚Äôs name. If you struggle to pick a clear name, it might mean that your Effect is too coupled to the rest of your component‚Äôs logic, and is not yet ready to be extracted.</p>
<p>Ideally, your custom Hook‚Äôs name should be clear enough that even a person who doesn‚Äôt write code often could have a good guess about what your custom Hook does, what it takes, and what it returns:</p>
<ul> <li>‚úÖ <code dir="ltr">useData(url)</code>
</li> <li>‚úÖ <code dir="ltr">useImpressionLog(eventName, extraData)</code>
</li> <li>‚úÖ <code dir="ltr">useChatRoom(options)</code>
</li> </ul>
<p>When you synchronize with an external system, your custom Hook name may be more technical and use jargon specific to that system. It‚Äôs good as long as it would be clear to a person familiar with that system:</p>
<ul> <li>‚úÖ <code dir="ltr">useMediaQuery(query)</code>
</li> <li>‚úÖ <code dir="ltr">useSocket(url)</code>
</li> <li>‚úÖ <code dir="ltr">useIntersectionObserver(ref, options)</code>
</li> </ul>
<p><strong>Keep custom Hooks focused on concrete high-level use cases.</strong> Avoid creating and using custom ‚Äúlifecycle‚Äù Hooks that act as alternatives and convenience wrappers for the <code dir="ltr">useEffect</code> API itself:</p>
<ul> <li>üî¥ <code dir="ltr">useMount(fn)</code>
</li> <li>üî¥ <code dir="ltr">useEffectOnce(fn)</code>
</li> <li>üî¥ <code dir="ltr">useUpdateEffect(fn)</code>
</li> </ul>
<p>For example, this <code dir="ltr">useMount</code> Hook tries to ensure some code only runs ‚Äúon mount‚Äù:</p>
<pre data-language="jsx"><code><span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>serverUrl</span><span>,</span> <span>setServerUrl</span><span>]</span> = <span>useState</span><span>(</span><span>'https://localhost:1234'</span><span>)</span><span>;</span>

  <span>// üî¥ Avoid: using custom "lifecycle" Hooks</span>
  <span>useMount</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>{</span> <span>roomId</span><span>,</span> <span>serverUrl</span> <span>}</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>

    <span>post</span><span>(</span><span>'/analytics/event'</span><span>,</span> <span>{</span> <span>eventName</span><span>:</span> <span>'visit_chat'</span> <span>}</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span>

<span>// üî¥ Avoid: creating custom "lifecycle" Hooks</span>
<span>function</span> <span>useMount</span><span>(</span><span>fn</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>fn</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span> <span>// üî¥ React Hook useEffect has a missing dependency: 'fn'</span>
<span>}</span></code></pre>
<p><strong>Custom ‚Äúlifecycle‚Äù Hooks like <code dir="ltr">useMount</code> don‚Äôt fit well into the React paradigm.</strong> For example, this code example has a mistake (it doesn‚Äôt ‚Äúreact‚Äù to <code dir="ltr">roomId</code> or <code dir="ltr">serverUrl</code> changes), but the linter won‚Äôt warn you about it because the linter only checks direct <code dir="ltr">useEffect</code> calls. It won‚Äôt know about your Hook.</p>
<p>If you‚Äôre writing an Effect, start by using the React API directly:</p>
<pre data-language="jsx"><code><span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>serverUrl</span><span>,</span> <span>setServerUrl</span><span>]</span> = <span>useState</span><span>(</span><span>'https://localhost:1234'</span><span>)</span><span>;</span>

  <span>// ‚úÖ Good: two raw Effects separated by purpose</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>connection</span> = <span>createConnection</span><span>(</span><span>{</span> <span>serverUrl</span><span>,</span> <span>roomId</span> <span>}</span><span>)</span><span>;</span>
    <span>connection</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>connection</span>.<span>disconnect</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>serverUrl</span><span>,</span> <span>roomId</span><span>]</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>post</span><span>(</span><span>'/analytics/event'</span><span>,</span> <span>{</span> <span>eventName</span><span>:</span> <span>'visit_chat'</span><span>,</span> <span>roomId</span> <span>}</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>roomId</span><span>]</span><span>)</span><span>;</span>

  <span>// ...</span>
<span>}</span></code></pre>
<p>Then, you can (but don‚Äôt have to) extract custom Hooks for different high-level use cases:</p>
<pre data-language="jsx"><code><span>function</span> <span>ChatRoom</span><span>(</span><span>{</span> <span>roomId</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>serverUrl</span><span>,</span> <span>setServerUrl</span><span>]</span> = <span>useState</span><span>(</span><span>'https://localhost:1234'</span><span>)</span><span>;</span>

  <span>// ‚úÖ Great: custom Hooks named after their purpose</span>
  <span>useChatRoom</span><span>(</span><span>{</span> <span>serverUrl</span><span>,</span> <span>roomId</span> <span>}</span><span>)</span><span>;</span>
  <span>useImpressionLog</span><span>(</span><span>'visit_chat'</span><span>,</span> <span>{</span> <span>roomId</span> <span>}</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span></code></pre>
<p><strong>A good custom Hook makes the calling code more declarative by constraining what it does.</strong> For example, <code dir="ltr">useChatRoom(options)</code> can only connect to the chat room, while <code dir="ltr">useImpressionLog(eventName, extraData)</code> can only send an impression log to the analytics. If your custom Hook API doesn‚Äôt constrain the use cases and is very abstract, in the long run it‚Äôs likely to introduce more problems than it solves.</p>
</div></details> <h3 id="custom-hooks-help-you-migrate-to-better-patterns">Custom Hooks help you migrate to better patterns <a href="#custom-hooks-help-you-migrate-to-better-patterns" aria-label="Link for Custom Hooks help you migrate to better patterns " title="Link for Custom Hooks help you migrate to better patterns "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Effects are an <a href="escape-hatches">‚Äúescape hatch‚Äù</a>: you use them when you need to ‚Äústep outside React‚Äù and when there is no better built-in solution for your use case. With time, the React team‚Äôs goal is to reduce the number of the Effects in your app to the minimum by providing more specific solutions to more specific problems. Wrapping your Effects in custom Hooks makes it easier to upgrade your code when these solutions become available.</p> <p>Let‚Äôs return to this example:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>function</span> <span>useOnlineStatus</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isOnline</span><span>,</span> <span>setIsOnline</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>function</span> <span>handleOnline</span><span>(</span><span>)</span> <span>{</span>
      <span>setIsOnline</span><span>(</span><span>true</span><span>)</span><span>;</span>
    <span>}</span>
    <span>function</span> <span>handleOffline</span><span>(</span><span>)</span> <span>{</span>
      <span>setIsOnline</span><span>(</span><span>false</span><span>)</span><span>;</span>
    <span>}</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'online'</span><span>,</span> <span>handleOnline</span><span>)</span><span>;</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'offline'</span><span>,</span> <span>handleOffline</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>window</span>.<span>removeEventListener</span><span>(</span><span>'online'</span><span>,</span> <span>handleOnline</span><span>)</span><span>;</span>
      <span>window</span>.<span>removeEventListener</span><span>(</span><span>'offline'</span><span>,</span> <span>handleOffline</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>
  <span>return</span> <span>isOnline</span><span>;</span>
<span>}</span>

</pre> <p>In the above example, <code dir="ltr">useOnlineStatus</code> is implemented with a pair of <a href="../reference/react/usestate"><code dir="ltr">useState</code></a> and <a href="../reference/react/useeffect"><code dir="ltr">useEffect</code>.</a> However, this isn‚Äôt the best possible solution. There is a number of edge cases it doesn‚Äôt consider. For example, it assumes that when the component mounts, <code dir="ltr">isOnline</code> is already <code dir="ltr">true</code>, but this may be wrong if the network already went offline. You can use the browser <a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/onLine" target="_blank" rel="nofollow noopener noreferrer"><code dir="ltr">navigator.onLine</code></a> API to check for that, but using it directly would not work on the server for generating the initial HTML. In short, this code could be improved.</p> <p>React includes a dedicated API called <a href="../reference/react/usesyncexternalstore"><code dir="ltr">useSyncExternalStore</code></a> which takes care of all of these problems for you. Here is your <code dir="ltr">useOnlineStatus</code> Hook, rewritten to take advantage of this new API:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useSyncExternalStore</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>function</span> <span>subscribe</span><span>(</span><span>callback</span><span>)</span> <span>{</span>
  <span>window</span>.<span>addEventListener</span><span>(</span><span>'online'</span><span>,</span> <span>callback</span><span>)</span><span>;</span>
  <span>window</span>.<span>addEventListener</span><span>(</span><span>'offline'</span><span>,</span> <span>callback</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>window</span>.<span>removeEventListener</span><span>(</span><span>'online'</span><span>,</span> <span>callback</span><span>)</span><span>;</span>
    <span>window</span>.<span>removeEventListener</span><span>(</span><span>'offline'</span><span>,</span> <span>callback</span><span>)</span><span>;</span>
  <span>}</span><span>;</span>
<span>}</span>

<span>export</span> <span>function</span> <span>useOnlineStatus</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>useSyncExternalStore</span><span>(</span>
    <span>subscribe</span><span>,</span>
    <span>(</span><span>)</span> <span>=&gt;</span> <span>navigator</span>.<span>onLine</span><span>,</span> <span>// How to get the value on the client</span>
    <span>(</span><span>)</span> <span>=&gt;</span> <span>true</span> <span>// How to get the value on the server</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Notice how <strong>you didn‚Äôt need to change any of the components</strong> to make this migration:</p> <pre data-language="jsx"><code><span>function</span> <span>StatusBar</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>isOnline</span> = <span>useOnlineStatus</span><span>(</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span>

<span>function</span> <span>SaveButton</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>isOnline</span> = <span>useOnlineStatus</span><span>(</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span></code></pre> <p>This is another reason for why wrapping Effects in custom Hooks is often beneficial:</p> <ol> <li>You make the data flow to and from your Effects very explicit.</li> <li>You let your components focus on the intent rather than on the exact implementation of your Effects.</li> <li>When React adds new features, you can remove those Effects without changing any of your components.</li> </ol> <p>Similar to a <a href="https://uxdesign.cc/everything-you-need-to-know-about-design-systems-54b109851969" target="_blank" rel="nofollow noopener noreferrer">design system,</a> you might find it helpful to start extracting common idioms from your app‚Äôs components into custom Hooks. This will keep your components‚Äô code focused on the intent, and let you avoid writing raw Effects very often. Many excellent custom Hooks are maintained by the React community.</p> <details class="note note-blue"><summary tabindex="-1"><h5>
<svg width="1.5em" height="1.5em" viewbox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M34.7409 59.7228L32.9567 58.9094C27.2672 56.3157 20.7328 56.3157 15.0433 58.9094C12.6018 60.0224 9.39163 59.0275 8.44602 56.0621C7.45647 52.9589 5.99975 46.5898 6 35.9997C6.00029 23.5648 8.00803 18.3599 9.11099 16.4196C9.67795 15.4222 10.5255 14.8455 11.2254 14.5264L12.0179 14.1651C19.6351 10.6926 28.4011 10.6738 36 14.1733C43.5989 10.6738 52.3649 10.6926 59.9821 14.1651L60.7746 14.5264C61.4745 14.8455 62.3221 15.4222 62.889 16.4196C63.992 18.3599 65.9997 23.5648 66 35.9997C66.0002 46.5898 64.5435 52.9589 63.554 56.0621C62.6084 59.0275 59.3982 60.0224 56.9567 58.9094C51.2672 56.3157 44.7328 56.3157 39.0433 58.9094L37.2591 59.7228C37.1986 59.7508 37.1373 59.7767 37.0753 59.8004C36.4484 60.0411 35.7556 60.0653 35.1102 59.8648C34.9847 59.8258 34.8613 59.7784 34.7409 59.7228ZM14.5068 19.6246C20.3733 16.9501 27.0874 16.8775 33 19.4067V52.473C26.7613 50.32 19.9378 50.471 13.7811 52.9261C13.0005 49.9843 11.9998 44.547 12 35.9998C12.0002 25.5786 13.4879 21.1893 14.1179 19.8018L14.5068 19.6246ZM39 52.473C45.2387 50.32 52.0622 50.471 58.2189 52.9261C58.9995 49.9843 60.0002 44.547 60 35.9998C59.9998 25.5786 58.5121 21.1893 57.8821 19.8018L57.4932 19.6246C51.6267 16.9501 44.9126 16.8775 39 19.4067V52.473Z" fill="currentColor"></path></svg>Deep Dive</h5>
<h4 id="will-react-provide-any-built-in-solution-for-data-fetching">Will React provide any built-in solution for data fetching? <a href="#will-react-provide-any-built-in-solution-for-data-fetching" aria-label="Link for Will React provide any built-in solution for data fetching? " title="Link for Will React provide any built-in solution for data fetching? "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4></summary><div>
<p>Today, with the <a href="../reference/react/use#streaming-data-from-server-to-client"><code dir="ltr">use</code></a> API, data can be read in render by passing a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="nofollow noopener noreferrer">Promise</a> to <code dir="ltr">use</code>:</p>
<pre data-language="jsx"><code><span>import</span> <span>{</span> <span>use</span><span>,</span> <span>Suspense</span> <span>}</span> <span>from</span> <span>"react"</span><span>;</span>

<span>function</span> <span>Message</span><span>(</span><span>{</span> <span>messagePromise</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>messageContent</span> = <span>use</span><span>(</span><span>messagePromise</span><span>)</span><span>;</span>
  <span>return</span> <span>&lt;</span><span>p</span><span>&gt;</span>Here is the message: <span>{</span><span>messageContent</span><span>}</span><span>&lt;/</span><span>p</span><span>&gt;</span><span>;</span>
<span>}</span>

<span>export</span> <span>function</span> <span>MessageContainer</span><span>(</span><span>{</span> <span>messagePromise</span> <span>}</span><span>)</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>Suspense</span> <span>fallback</span>=<span>{</span><span>&lt;</span><span>p</span><span>&gt;</span>‚åõDownloading message...<span>&lt;/</span><span>p</span><span>&gt;</span><span>}</span><span>&gt;</span>
      <span>&lt;</span><span>Message</span> <span>messagePromise</span>=<span>{</span><span>messagePromise</span><span>}</span> <span>/&gt;</span>
    <span>&lt;/</span><span>Suspense</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span></code></pre>
<p>We‚Äôre still working out the details, but we expect that in the future, you‚Äôll write data fetching like this:</p>
<pre data-language="jsx"><code><span>import</span> <span>{</span> <span>use</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>function</span> <span>ShippingForm</span><span>(</span><span>{</span> <span>country</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>cities</span> = <span>use</span><span>(</span><span>fetch</span><span>(</span><span>`/api/cities?country=</span><span>${</span><span>country</span><span>}</span><span>`</span><span>)</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>city</span><span>,</span> <span>setCity</span><span>]</span> = <span>useState</span><span>(</span><span>null</span><span>)</span><span>;</span>
  <span>const</span> <span>areas</span> = <span>city</span> ? <span>use</span><span>(</span><span>fetch</span><span>(</span><span>`/api/areas?city=</span><span>${</span><span>city</span><span>}</span><span>`</span><span>)</span><span>)</span> : <span>null</span><span>;</span>
  <span>// ...</span></code></pre>
<p>If you use custom Hooks like <code dir="ltr">useData</code> above in your app, it will require fewer changes to migrate to the eventually recommended approach than if you write raw Effects in every component manually. However, the old approach will still work fine, so if you feel happy writing raw Effects, you can continue to do that.</p>
</div></details> <h3 id="there-is-more-than-one-way-to-do-it">There is more than one way to do it <a href="#there-is-more-than-one-way-to-do-it" aria-label="Link for There is more than one way to do it " title="Link for There is more than one way to do it "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Let‚Äôs say you want to implement a fade-in animation <em>from scratch</em> using the browser <a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame" target="_blank" rel="nofollow noopener noreferrer"><code dir="ltr">requestAnimationFrame</code></a> API. You might start with an Effect that sets up an animation loop. During each frame of the animation, you could change the opacity of the DOM node you <a href="manipulating-the-dom-with-refs">hold in a ref</a> until it reaches <code dir="ltr">1</code>. Your code might start like this:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span><span>,</span> <span>useRef</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>function</span> <span>Welcome</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>ref</span> = <span>useRef</span><span>(</span><span>null</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>duration</span> = <span>1000</span><span>;</span>
    <span>const</span> <span>node</span> = <span>ref</span>.<span>current</span><span>;</span>

    <span>let</span> <span>startTime</span> = <span>performance</span>.<span>now</span><span>(</span><span>)</span><span>;</span>
    <span>let</span> <span>frameId</span> = <span>null</span><span>;</span>

    <span>function</span> <span>onFrame</span><span>(</span><span>now</span><span>)</span> <span>{</span>
      <span>const</span> <span>timePassed</span> = <span>now</span> - <span>startTime</span><span>;</span>
      <span>const</span> <span>progress</span> = <span>Math</span>.<span>min</span><span>(</span><span>timePassed</span> / <span>duration</span><span>,</span> <span>1</span><span>)</span><span>;</span>
      <span>onProgress</span><span>(</span><span>progress</span><span>)</span><span>;</span>
      <span>if</span> <span>(</span><span>progress</span> &lt; <span>1</span><span>)</span> <span>{</span>
        <span>// We still have more frames to paint</span>
        <span>frameId</span> = <span>requestAnimationFrame</span><span>(</span><span>onFrame</span><span>)</span><span>;</span>
      <span>}</span>
    <span>}</span>

    <span>function</span> <span>onProgress</span><span>(</span><span>progress</span><span>)</span> <span>{</span>
      <span>node</span>.<span>style</span>.<span>opacity</span> = <span>progress</span><span>;</span>
    <span>}</span>

    <span>function</span> <span>start</span><span>(</span><span>)</span> <span>{</span>
      <span>onProgress</span><span>(</span><span>0</span><span>)</span><span>;</span>
      <span>startTime</span> = <span>performance</span>.<span>now</span><span>(</span><span>)</span><span>;</span>
      <span>frameId</span> = <span>requestAnimationFrame</span><span>(</span><span>onFrame</span><span>)</span><span>;</span>
    <span>}</span>

    <span>function</span> <span>stop</span><span>(</span><span>)</span> <span>{</span>
      <span>cancelAnimationFrame</span><span>(</span><span>frameId</span><span>)</span><span>;</span>
      <span>startTime</span> = <span>null</span><span>;</span>
      <span>frameId</span> = <span>null</span><span>;</span>
    <span>}</span>

    <span>start</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>stop</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>h1</span> <span>className</span>=<span>"welcome"</span> <span>ref</span>=<span>{</span><span>ref</span><span>}</span><span>&gt;</span>
      Welcome
    <span>&lt;/</span><span>h1</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>show</span><span>,</span> <span>setShow</span><span>]</span> = <span>useState</span><span>(</span><span>false</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setShow</span><span>(</span>!<span>show</span><span>)</span><span>}</span><span>&gt;</span>
        <span>{</span><span>show</span> ? <span>'Remove'</span> : <span>'Show'</span><span>}</span>
      <span>&lt;/</span><span>button</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>{</span><span>show</span> &amp;&amp; <span>&lt;</span><span>Welcome</span> <span>/&gt;</span><span>}</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>To make the component more readable, you might extract the logic into a <code dir="ltr">useFadeIn</code> custom Hook:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span><span>,</span> <span>useRef</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>useFadeIn</span> <span>}</span> <span>from</span> <span>'./useFadeIn.js'</span><span>;</span>

<span>function</span> <span>Welcome</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>ref</span> = <span>useRef</span><span>(</span><span>null</span><span>)</span><span>;</span>

  <span>useFadeIn</span><span>(</span><span>ref</span><span>,</span> <span>1000</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>h1</span> <span>className</span>=<span>"welcome"</span> <span>ref</span>=<span>{</span><span>ref</span><span>}</span><span>&gt;</span>
      Welcome
    <span>&lt;/</span><span>h1</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>show</span><span>,</span> <span>setShow</span><span>]</span> = <span>useState</span><span>(</span><span>false</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setShow</span><span>(</span>!<span>show</span><span>)</span><span>}</span><span>&gt;</span>
        <span>{</span><span>show</span> ? <span>'Remove'</span> : <span>'Show'</span><span>}</span>
      <span>&lt;/</span><span>button</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>{</span><span>show</span> &amp;&amp; <span>&lt;</span><span>Welcome</span> <span>/&gt;</span><span>}</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>You could keep the <code dir="ltr">useFadeIn</code> code as is, but you could also refactor it more. For example, you could extract the logic for setting up the animation loop out of <code dir="ltr">useFadeIn</code> into a custom <code dir="ltr">useAnimationLoop</code> Hook:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>useEffectEvent</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>function</span> <span>useFadeIn</span><span>(</span><span>ref</span><span>,</span> <span>duration</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isRunning</span><span>,</span> <span>setIsRunning</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>

  <span>useAnimationLoop</span><span>(</span><span>isRunning</span><span>,</span> <span>(</span><span>timePassed</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>progress</span> = <span>Math</span>.<span>min</span><span>(</span><span>timePassed</span> / <span>duration</span><span>,</span> <span>1</span><span>)</span><span>;</span>
    <span>ref</span>.<span>current</span>.<span>style</span>.<span>opacity</span> = <span>progress</span><span>;</span>
    <span>if</span> <span>(</span><span>progress</span> === <span>1</span><span>)</span> <span>{</span>
      <span>setIsRunning</span><span>(</span><span>false</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span><span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>useAnimationLoop</span><span>(</span><span>isRunning</span><span>,</span> <span>drawFrame</span><span>)</span> <span>{</span>
  <span>const</span> <span>onFrame</span> = <span>useEffectEvent</span><span>(</span><span>drawFrame</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>if</span> <span>(</span>!<span>isRunning</span><span>)</span> <span>{</span>
      <span>return</span><span>;</span>
    <span>}</span>

    <span>const</span> <span>startTime</span> = <span>performance</span>.<span>now</span><span>(</span><span>)</span><span>;</span>
    <span>let</span> <span>frameId</span> = <span>null</span><span>;</span>

    <span>function</span> <span>tick</span><span>(</span><span>now</span><span>)</span> <span>{</span>
      <span>const</span> <span>timePassed</span> = <span>now</span> - <span>startTime</span><span>;</span>
      <span>onFrame</span><span>(</span><span>timePassed</span><span>)</span><span>;</span>
      <span>frameId</span> = <span>requestAnimationFrame</span><span>(</span><span>tick</span><span>)</span><span>;</span>
    <span>}</span>

    <span>tick</span><span>(</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>cancelAnimationFrame</span><span>(</span><span>frameId</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>isRunning</span><span>]</span><span>)</span><span>;</span>
<span>}</span>

</pre> <p>However, you didn‚Äôt <em>have to</em> do that. As with regular functions, ultimately you decide where to draw the boundaries between different parts of your code. You could also take a very different approach. Instead of keeping the logic in the Effect, you could move most of the imperative logic inside a JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes" target="_blank" rel="nofollow noopener noreferrer">class:</a></p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>FadeInAnimation</span> <span>}</span> <span>from</span> <span>'./animation.js'</span><span>;</span>

<span>export</span> <span>function</span> <span>useFadeIn</span><span>(</span><span>ref</span><span>,</span> <span>duration</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>animation</span> = <span>new</span> <span>FadeInAnimation</span><span>(</span><span>ref</span>.<span>current</span><span>)</span><span>;</span>
    <span>animation</span>.<span>start</span><span>(</span><span>duration</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>animation</span>.<span>stop</span><span>(</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>ref</span><span>,</span> <span>duration</span><span>]</span><span>)</span><span>;</span>
<span>}</span>

</pre> <p>Effects let you connect React to external systems. The more coordination between Effects is needed (for example, to chain multiple animations), the more it makes sense to extract that logic out of Effects and Hooks <em>completely</em> like in the sandbox above. Then, the code you extracted <em>becomes</em> the ‚Äúexternal system‚Äù. This lets your Effects stay simple because they only need to send messages to the system you‚Äôve moved outside React.</p> <p>The examples above assume that the fade-in logic needs to be written in JavaScript. However, this particular fade-in animation is both simpler and much more efficient to implement with a plain <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Animations/Using_CSS_animations" target="_blank" rel="nofollow noopener noreferrer">CSS Animation:</a></p> 
<pre data-language="jsx">.welcome <span>{</span>
  <span>color</span><span>:</span> <span>white</span><span>;</span>
  <span>padding</span><span>:</span> <span>50</span><span>px</span><span>;</span>
  <span>text-align</span><span>:</span> <span>center</span><span>;</span>
  <span>font-size</span><span>:</span> <span>50</span><span>px</span><span>;</span>
  <span>background-image</span><span>:</span> <span>radial-gradient</span><span>(</span><span>circle</span><span>,</span> <span>rgba</span><span>(</span><span>63</span><span>,</span><span>94</span><span>,</span><span>251</span><span>,</span><span>1</span><span>)</span> <span>0</span><span>%</span><span>,</span> <span>rgba</span><span>(</span><span>252</span><span>,</span><span>70</span><span>,</span><span>107</span><span>,</span><span>1</span><span>)</span> <span>100</span><span>%</span><span>)</span><span>;</span>

  <span>animation</span><span>:</span> <span>fadeIn</span> <span>1000</span><span>ms</span><span>;</span>
<span>}</span>

<span>@keyframes</span> fadeIn <span>{</span>
  <span>0</span><span>%</span> <span>{</span> <span>opacity</span><span>:</span> <span>0</span><span>;</span> <span>}</span>
  <span>100</span><span>%</span> <span>{</span> <span>opacity</span><span>:</span> <span>1</span><span>;</span> <span>}</span>
<span>}</span>

</pre> <p>Sometimes, you don‚Äôt even need a Hook!</p> <section><h2 id="recap">Recap<a href="#recap" aria-label="Link for Recap" title="Link for Recap"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2>
<ul> <li>Custom Hooks let you share logic between components.</li> <li>Custom Hooks must be named starting with <code dir="ltr">use</code> followed by a capital letter.</li> <li>Custom Hooks only share stateful logic, not state itself.</li> <li>You can pass reactive values from one Hook to another, and they stay up-to-date.</li> <li>All Hooks re-run every time your component re-renders.</li> <li>The code of your custom Hooks should be pure, like your component‚Äôs code.</li> <li>Wrap event handlers received by custom Hooks into Effect Events.</li> <li>Don‚Äôt create custom Hooks like <code dir="ltr">useMount</code>. Keep their purpose specific.</li> <li>It‚Äôs up to you how and where to choose the boundaries of your code.</li> </ul></section> <div class="note">
<h4>Try out some challenges</h4>

<div>
<h4 id="extract-a-usecounter-hook">
<div>Challenge 1 of 5<span>: </span>
</div>Extract a <code dir="ltr">useCounter</code> Hook <a href="#extract-a-usecounter-hook" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4>
<p>This component uses a state variable and an Effect to display a number that increments every second. Extract this logic into a custom Hook called <code dir="ltr">useCounter</code>. Your goal is to make the <code dir="ltr">Counter</code> component implementation look exactly like this:</p>
<pre data-language="jsx"><code><span>export</span> <span>default</span> <span>function</span> <span>Counter</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>count</span> = <span>useCounter</span><span>(</span><span>)</span><span>;</span>
  <span>return</span> <span>&lt;</span><span>h1</span><span>&gt;</span>Seconds passed: <span>{</span><span>count</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span><span>;</span>
<span>}</span></code></pre>
<p>You‚Äôll need to write your custom Hook in <code dir="ltr">useCounter.js</code> and import it into the <code dir="ltr">App.js</code> file.</p>

<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>Counter</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>count</span><span>,</span> <span>setCount</span><span>]</span> = <span>useState</span><span>(</span><span>0</span><span>)</span><span>;</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>id</span> = <span>setInterval</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>setCount</span><span>(</span><span>c</span> <span>=&gt;</span> <span>c</span> + <span>1</span><span>)</span><span>;</span>
    <span>}</span><span>,</span> <span>1000</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>clearInterval</span><span>(</span><span>id</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>
  <span>return</span> <span>&lt;</span><span>h1</span><span>&gt;</span>Seconds passed: <span>{</span><span>count</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span><span>;</span>
<span>}</span>

</pre>
</div>

</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2013&ndash;present Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://react.dev/learn/reusing-logic-with-custom-hooks" class="_attribution-link">https://react.dev/learn/reusing-logic-with-custom-hooks</a>
  </p>
</div>
