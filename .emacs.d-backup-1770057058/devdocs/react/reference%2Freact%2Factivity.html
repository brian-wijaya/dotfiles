<h1>&lt;Activity&gt;<a href="#undefined" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h1>
<div>
<p><code dir="ltr">&lt;Activity&gt;</code> lets you hide and restore the UI and internal state of its children.</p>
<pre data-language="jsx"><code><span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>visibility</span><span>}</span><span>&gt;</span>
  <span>&lt;</span><span>Sidebar</span> <span>/&gt;</span>
<span>&lt;/</span><span>Activity</span><span>&gt;</span></code></pre>
</div> <ul>
<li>
<a href="#reference">Reference </a><ul><li><a href="#activity"><code dir="ltr">&lt;Activity&gt;</code> </a></li></ul>
</li>
<li>
<a href="#usage">Usage </a><ul>
<li><a href="#restoring-the-state-of-hidden-components">Restoring the state of hidden components </a></li>
<li><a href="#restoring-the-dom-of-hidden-components">Restoring the DOM of hidden components </a></li>
<li><a href="#pre-rendering-content-thats-likely-to-become-visible">Pre-rendering content that‚Äôs likely to become visible </a></li>
<li><a href="#speeding-up-interactions-during-page-load">Speeding up interactions during page load </a></li>
</ul>
</li>
<li>
<a href="#troubleshooting">Troubleshooting </a><ul>
<li><a href="#my-hidden-components-have-unwanted-side-effects">My hidden components have unwanted side effects </a></li>
<li><a href="#my-hidden-components-have-effects-that-arent-running">My hidden components have Effects that aren‚Äôt running </a></li>
</ul>
</li>
</ul> <hr> <h2 id="reference">Reference <a href="#reference" aria-label="Link for Reference " title="Link for Reference "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="activity">
<code dir="ltr">&lt;Activity&gt;</code> <a href="#activity" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>You can use Activity to hide part of your application:</p> <pre data-language="jsx"><code><span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>isShowingSidebar</span> ? <span>"visible"</span> : <span>"hidden"</span><span>}</span><span>&gt;</span>
  <span>&lt;Sidebar /&gt;</span>
<span>&lt;/</span><span>Activity</span><span>&gt;</span></code></pre> <p>When an Activity boundary is <span data-step="1">hidden</span>, React will visually hide <span data-step="2">its children</span> using the <code dir="ltr">display: "none"</code> CSS property. It will also destroy their Effects, cleaning up any active subscriptions.</p> <p>While hidden, children still re-render in response to new props, albeit at a lower priority than the rest of the content.</p> <p>When the boundary becomes <span data-step="3">visible</span> again, React will reveal the children with their previous state restored, and re-create their Effects.</p> <p>In this way, Activity can be thought of as a mechanism for rendering ‚Äúbackground activity‚Äù. Rather than completely discarding content that‚Äôs likely to become visible again, you can use Activity to maintain and restore that content‚Äôs UI and internal state, while ensuring that your hidden content has no unwanted side effects.</p> <p><a href="#usage">See more examples below.</a></p> <h4 id="props">Props <a href="#props" aria-label="Link for Props " title="Link for Props "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4> <ul> <li>
<code dir="ltr">children</code>: The UI you intend to show and hide.</li> <li>
<code dir="ltr">mode</code>: A string value of either <code dir="ltr">'visible'</code> or <code dir="ltr">'hidden'</code>. If omitted, defaults to <code dir="ltr">'visible'</code>.</li> </ul> <h4 id="caveats">Caveats <a href="#caveats" aria-label="Link for Caveats " title="Link for Caveats "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4> <ul> <li>If an Activity is rendered inside of a <a href="viewtransition">ViewTransition</a>, and it becomes visible as a result of an update caused by <a href="starttransition">startTransition</a>, it will activate the ViewTransition‚Äôs <code dir="ltr">enter</code> animation. If it becomes hidden, it will activate its <code dir="ltr">exit</code> animation.</li> <li>An Activity that just renders text will not render anything rather than rendering hidden text, because there‚Äôs no corresponding DOM element to apply visibility changes to. For example, <code dir="ltr">&lt;Activity mode="hidden"&gt;&lt;ComponentThatJustReturnsText /&gt;&lt;/Activity&gt;</code> will not produce any output in the DOM for <code dir="ltr">const ComponentThatJustReturnsText = () =&gt; "Hello, World!"</code>.</li> </ul> <hr> <h2 id="usage">Usage <a href="#usage" aria-label="Link for Usage " title="Link for Usage "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="restoring-the-state-of-hidden-components">Restoring the state of hidden components <a href="#restoring-the-state-of-hidden-components" aria-label="Link for Restoring the state of hidden components " title="Link for Restoring the state of hidden components "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>In React, when you want to conditionally show or hide a component, you typically mount or unmount it based on that condition:</p> <pre data-language="jsx"><code><span>{</span><span>isShowingSidebar</span> &amp;&amp; <span>(</span>
  <span>&lt;</span><span>Sidebar</span> <span>/&gt;</span>
<span>)</span><span>}</span></code></pre> <p>But unmounting a component destroys its internal state, which is not always what you want.</p> <p>When you hide a component using an Activity boundary instead, React will ‚Äúsave‚Äù its state for later:</p> <pre data-language="jsx"><code><span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>isShowingSidebar</span> ? <span>"visible"</span> : <span>"hidden"</span><span>}</span><span>&gt;</span>
  <span>&lt;</span><span>Sidebar</span> <span>/&gt;</span>
<span>&lt;/</span><span>Activity</span><span>&gt;</span></code></pre> <p>This makes it possible to hide and then later restore components in the state they were previously in.</p> <p>The following example has a sidebar with an expandable section. You can press ‚ÄúOverview‚Äù to reveal the three subitems below it. The main app area also has a button that hides and shows the sidebar.</p> <p>Try expanding the Overview section, and then toggling the sidebar closed then open:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>Sidebar</span> <span>from</span> <span>'./Sidebar.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isShowingSidebar</span><span>,</span> <span>setIsShowingSidebar</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>{</span><span>isShowingSidebar</span> &amp;&amp; <span>(</span>
        <span>&lt;</span><span>Sidebar</span> <span>/&gt;</span>
      <span>)</span><span>}</span>

      <span>&lt;</span><span>main</span><span>&gt;</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setIsShowingSidebar</span><span>(</span>!<span>isShowingSidebar</span><span>)</span><span>}</span><span>&gt;</span>
          Toggle sidebar
        <span>&lt;/</span><span>button</span><span>&gt;</span>
        <span>&lt;</span><span>h1</span><span>&gt;</span>Main content<span>&lt;/</span><span>h1</span><span>&gt;</span>
      <span>&lt;/</span><span>main</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>The Overview section always starts out collapsed. Because we unmount the sidebar when <code dir="ltr">isShowingSidebar</code> flips to <code dir="ltr">false</code>, all its internal state is lost.</p> <p>This is a perfect use case for Activity. We can preserve the internal state of our sidebar, even when visually hiding it.</p> <p>Let‚Äôs replace the conditional rendering of our sidebar with an Activity boundary:</p> <pre data-language="jsx"><code><span>// Before</span>
<span>{</span><span>isShowingSidebar</span> &amp;&amp; <span>(</span>
  <span>&lt;</span><span>Sidebar</span> <span>/&gt;</span>
<span>)</span><span>}</span>

<span>// After</span>
<span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>isShowingSidebar</span> ? <span>'visible'</span> : <span>'hidden'</span><span>}</span><span>&gt;</span>
  <span>&lt;</span><span>Sidebar</span> <span>/&gt;</span>
<span>&lt;/</span><span>Activity</span><span>&gt;</span></code></pre> <p>and check out the new behavior:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span> <span>import</span> <span>{</span> <span>unstable_Activity</span><span>,</span> <span>Activity</span> <span>as</span> <span>ActivityStable</span><span>}</span> <span>from</span> <span>'react'</span><span>;</span> <span>let</span> <span>Activity</span> = <span>ActivityStable</span> ?? <span>unstable_Activity</span><span>;</span>

<span>import</span> <span>Sidebar</span> <span>from</span> <span>'./Sidebar.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isShowingSidebar</span><span>,</span> <span>setIsShowingSidebar</span><span>]</span> = <span>useState</span><span>(</span><span>true</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>isShowingSidebar</span> ? <span>'visible'</span> : <span>'hidden'</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Sidebar</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Activity</span><span>&gt;</span>

      <span>&lt;</span><span>main</span><span>&gt;</span>
        <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setIsShowingSidebar</span><span>(</span>!<span>isShowingSidebar</span><span>)</span><span>}</span><span>&gt;</span>
          Toggle sidebar
        <span>&lt;/</span><span>button</span><span>&gt;</span>
        <span>&lt;</span><span>h1</span><span>&gt;</span>Main content<span>&lt;/</span><span>h1</span><span>&gt;</span>
      <span>&lt;/</span><span>main</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Our sidebar‚Äôs internal state is now restored, without any changes to its implementation.</p> <hr> <h3 id="restoring-the-dom-of-hidden-components">Restoring the DOM of hidden components <a href="#restoring-the-dom-of-hidden-components" aria-label="Link for Restoring the DOM of hidden components " title="Link for Restoring the DOM of hidden components "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Since Activity boundaries hide their children using <code dir="ltr">display: none</code>, their children‚Äôs DOM is also preserved when hidden. This makes them great for maintaining ephemeral state in parts of the UI that the user is likely to interact with again.</p> <p>In this example, the Contact tab has a <code dir="ltr">&lt;textarea&gt;</code> where the user can enter a message. If you enter some text, change to the Home tab, then change back to the Contact tab, the draft message is lost:</p> 
<pre data-language="jsx"><span>export</span> <span>default</span> <span>function</span> <span>Contact</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>div</span><span>&gt;</span>
      <span>&lt;</span><span>p</span><span>&gt;</span>Send me a message!<span>&lt;/</span><span>p</span><span>&gt;</span>

      <span>&lt;</span><span>textarea</span> <span>/&gt;</span>

      <span>&lt;</span><span>p</span><span>&gt;</span>You can find me online here:<span>&lt;/</span><span>p</span><span>&gt;</span>
      <span>&lt;</span><span>ul</span><span>&gt;</span>
        <span>&lt;</span><span>li</span><span>&gt;</span>admin@mysite.com<span>&lt;/</span><span>li</span><span>&gt;</span>
        <span>&lt;</span><span>li</span><span>&gt;</span>+123456789<span>&lt;/</span><span>li</span><span>&gt;</span>
      <span>&lt;/</span><span>ul</span><span>&gt;</span>
    <span>&lt;/</span><span>div</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>This is because we‚Äôre fully unmounting <code dir="ltr">Contact</code> in <code dir="ltr">App</code>. When the Contact tab unmounts, the <code dir="ltr">&lt;textarea&gt;</code> element‚Äôs internal DOM state is lost.</p> <p>If we switch to using an Activity boundary to show and hide the active tab, we can preserve the state of each tab‚Äôs DOM. Try entering text and switching tabs again, and you‚Äôll see the draft message is no longer reset:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span> <span>import</span> <span>{</span> <span>unstable_Activity</span><span>,</span> <span>Activity</span> <span>as</span> <span>ActivityStable</span><span>}</span> <span>from</span> <span>'react'</span><span>;</span> <span>let</span> <span>Activity</span> = <span>ActivityStable</span> ?? <span>unstable_Activity</span><span>;</span>
<span>import</span> <span>TabButton</span> <span>from</span> <span>'./TabButton.js'</span><span>;</span>
<span>import</span> <span>Home</span> <span>from</span> <span>'./Home.js'</span><span>;</span>
<span>import</span> <span>Contact</span> <span>from</span> <span>'./Contact.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>activeTab</span><span>,</span> <span>setActiveTab</span><span>]</span> = <span>useState</span><span>(</span><span>'contact'</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'home'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'home'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Home
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'contact'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'contact'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Contact
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>

      <span>&lt;</span><span>hr</span> <span>/&gt;</span>

      <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>activeTab</span> === <span>'home'</span> ? <span>'visible'</span> : <span>'hidden'</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Home</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Activity</span><span>&gt;</span>
      <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>activeTab</span> === <span>'contact'</span> ? <span>'visible'</span> : <span>'hidden'</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Contact</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Activity</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Again, the Activity boundary let us preserve the Contact tab‚Äôs internal state without changing its implementation.</p> <hr> <h3 id="pre-rendering-content-thats-likely-to-become-visible">Pre-rendering content that‚Äôs likely to become visible <a href="#pre-rendering-content-thats-likely-to-become-visible" aria-label="Link for Pre-rendering content that‚Äôs likely to become visible " title="Link for Pre-rendering content that‚Äôs likely to become visible "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>So far, we‚Äôve seen how Activity can hide some content that the user has interacted with, without discarding that content‚Äôs ephemeral state.</p> <p>But Activity boundaries can also be used to <em>prepare</em> content that the user has yet to see for the first time:</p> <pre data-language="jsx"><code><span>&lt;</span><span>Activity</span> <span>mode</span>=<span>"hidden"</span><span>&gt;</span>
  <span>&lt;</span><span>SlowComponent</span> <span>/&gt;</span>
<span>&lt;/</span><span>Activity</span><span>&gt;</span></code></pre> <p>When an Activity boundary is <span data-step="1">hidden</span> during its initial render, its children won‚Äôt be visible on the page ‚Äî but they will <em>still be rendered</em>, albeit at a lower priority than the visible content, and without mounting their Effects.</p> <p>This <em>pre-rendering</em> allows the children to load any code or data they need ahead of time, so that later, when the Activity boundary becomes visible, the children can appear faster with reduced loading times.</p> <p>Let‚Äôs look at an example.</p> <p>In this demo, the Posts tab loads some data. If you press it, you‚Äôll see a Suspense fallback displayed while the data is being fetched:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>Suspense</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>TabButton</span> <span>from</span> <span>'./TabButton.js'</span><span>;</span>
<span>import</span> <span>Home</span> <span>from</span> <span>'./Home.js'</span><span>;</span>
<span>import</span> <span>Posts</span> <span>from</span> <span>'./Posts.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>activeTab</span><span>,</span> <span>setActiveTab</span><span>]</span> = <span>useState</span><span>(</span><span>'home'</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'home'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'home'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Home
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'posts'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'posts'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Posts
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>

      <span>&lt;</span><span>hr</span> <span>/&gt;</span>

      <span>&lt;</span><span>Suspense</span> <span>fallback</span>=<span>{</span><span>&lt;</span><span>h1</span><span>&gt;</span>üåÄ Loading...<span>&lt;/</span><span>h1</span><span>&gt;</span><span>}</span><span>&gt;</span>
        <span>{</span><span>activeTab</span> === <span>'home'</span> &amp;&amp; <span>&lt;</span><span>Home</span> <span>/&gt;</span><span>}</span>
        <span>{</span><span>activeTab</span> === <span>'posts'</span> &amp;&amp; <span>&lt;</span><span>Posts</span> <span>/&gt;</span><span>}</span>
      <span>&lt;/</span><span>Suspense</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>This is because <code dir="ltr">App</code> doesn‚Äôt mount <code dir="ltr">Posts</code> until its tab is active.</p> <p>If we update <code dir="ltr">App</code> to use an Activity boundary to show and hide the active tab, <code dir="ltr">Posts</code> will be pre-rendered when the app first loads, allowing it to fetch its data before it becomes visible.</p> <p>Try clicking the Posts tab now:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>Suspense</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>  <span>import</span> <span>{</span> <span>unstable_Activity</span><span>,</span> <span>Activity</span> <span>as</span> <span>ActivityStable</span><span>}</span> <span>from</span> <span>'react'</span><span>;</span> <span>let</span> <span>Activity</span> = <span>ActivityStable</span> ?? <span>unstable_Activity</span><span>;</span>
<span>import</span> <span>TabButton</span> <span>from</span> <span>'./TabButton.js'</span><span>;</span>
<span>import</span> <span>Home</span> <span>from</span> <span>'./Home.js'</span><span>;</span>
<span>import</span> <span>Posts</span> <span>from</span> <span>'./Posts.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>activeTab</span><span>,</span> <span>setActiveTab</span><span>]</span> = <span>useState</span><span>(</span><span>'home'</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'home'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'home'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Home
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'posts'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'posts'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Posts
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>

      <span>&lt;</span><span>hr</span> <span>/&gt;</span>

      <span>&lt;</span><span>Suspense</span> <span>fallback</span>=<span>{</span><span>&lt;</span><span>h1</span><span>&gt;</span>üåÄ Loading...<span>&lt;/</span><span>h1</span><span>&gt;</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>activeTab</span> === <span>'home'</span> ? <span>'visible'</span> : <span>'hidden'</span><span>}</span><span>&gt;</span>
          <span>&lt;</span><span>Home</span> <span>/&gt;</span>
        <span>&lt;/</span><span>Activity</span><span>&gt;</span>
        <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>activeTab</span> === <span>'posts'</span> ? <span>'visible'</span> : <span>'hidden'</span><span>}</span><span>&gt;</span>
          <span>&lt;</span><span>Posts</span> <span>/&gt;</span>
        <span>&lt;/</span><span>Activity</span><span>&gt;</span>
      <span>&lt;/</span><span>Suspense</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p><code dir="ltr">Posts</code> was able to prepare itself for a faster render, thanks to the hidden Activity boundary.</p> <hr> <p>Pre-rendering components with hidden Activity boundaries is a powerful way to reduce loading times for parts of the UI that the user is likely to interact with next.</p> <div class="note note-green">
<h4>Note</h4>
<div>
<p><strong>Only Suspense-enabled data sources will be fetched during pre-rendering.</strong> They include:</p>
<ul> <li>Data fetching with Suspense-enabled frameworks like <a href="https://relay.dev/docs/guided-tour/rendering/loading-states/" target="_blank" rel="nofollow noopener noreferrer">Relay</a> and <a href="https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming#streaming-with-suspense" target="_blank" rel="nofollow noopener noreferrer">Next.js</a>
</li> <li>Lazy-loading component code with <a href="lazy"><code dir="ltr">lazy</code></a>
</li> <li>Reading the value of a cached Promise with <a href="use"><code dir="ltr">use</code></a>
</li> </ul>
<p>Activity <strong>does not</strong> detect data that is fetched inside an Effect.</p>
<p>The exact way you would load data in the <code dir="ltr">Posts</code> component above depends on your framework. If you use a Suspense-enabled framework, you‚Äôll find the details in its data fetching documentation.</p>
<p>Suspense-enabled data fetching without the use of an opinionated framework is not yet supported. The requirements for implementing a Suspense-enabled data source are unstable and undocumented. An official API for integrating data sources with Suspense will be released in a future version of React.</p>
</div>
</div> <hr> <h3 id="speeding-up-interactions-during-page-load">Speeding up interactions during page load <a href="#speeding-up-interactions-during-page-load" aria-label="Link for Speeding up interactions during page load " title="Link for Speeding up interactions during page load "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>React includes an under-the-hood performance optimization called Selective Hydration. It works by hydrating your app‚Äôs initial HTML <em>in chunks</em>, enabling some components to become interactive even if other components on the page haven‚Äôt loaded their code or data yet.</p> <p>Suspense boundaries participate in Selective Hydration, because they naturally divide your component tree into units that are independent from one another:</p> <pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>MessageComposer</span> <span>/&gt;</span>

      <span>&lt;</span><span>Suspense</span> <span>fallback</span>=<span>"Loading chats..."</span><span>&gt;</span>
        <span>&lt;</span><span>Chats</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Suspense</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span>
<span>}</span></code></pre> <p>Here, <code dir="ltr">MessageComposer</code> can be fully hydrated during the initial render of the page, even before <code dir="ltr">Chats</code> is mounted and starts to fetch its data.</p> <p>So by breaking up your component tree into discrete units, Suspense allows React to hydrate your app‚Äôs server-rendered HTML in chunks, enabling parts of your app to become interactive as fast as possible.</p> <p>But what about pages that don‚Äôt use Suspense?</p> <p>Take this tabs example:</p> <pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>activeTab</span><span>,</span> <span>setActiveTab</span><span>]</span> = <span>useState</span><span>(</span><span>'home'</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'home'</span><span>)</span><span>}</span><span>&gt;</span>
        Home
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'video'</span><span>)</span><span>}</span><span>&gt;</span>
        Video
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>

      <span>{</span><span>activeTab</span> === <span>'home'</span> &amp;&amp; <span>(</span>
        <span>&lt;</span><span>Home</span> <span>/&gt;</span>
      <span>)</span><span>}</span>
      <span>{</span><span>activeTab</span> === <span>'video'</span> &amp;&amp; <span>(</span>
        <span>&lt;</span><span>Video</span> <span>/&gt;</span>
      <span>)</span><span>}</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span>
<span>}</span></code></pre> <p>Here, React must hydrate the entire page all at once. If <code dir="ltr">Home</code> or <code dir="ltr">Video</code> are slower to render, they could make the tab buttons feel unresponsive during hydration.</p> <p>Adding Suspense around the active tab would solve this:</p> <pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>activeTab</span><span>,</span> <span>setActiveTab</span><span>]</span> = <span>useState</span><span>(</span><span>'home'</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'home'</span><span>)</span><span>}</span><span>&gt;</span>
        Home
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'video'</span><span>)</span><span>}</span><span>&gt;</span>
        Video
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>

      <span>&lt;</span><span>Suspense</span> <span>fallback</span>=<span>{</span><span>&lt;</span><span>Placeholder</span> <span>/&gt;</span><span>}</span><span>&gt;</span>
        <span>{</span><span>activeTab</span> === <span>'home'</span> &amp;&amp; <span>(</span>
          <span>&lt;</span><span>Home</span> <span>/&gt;</span>
        <span>)</span><span>}</span>
        <span>{</span><span>activeTab</span> === <span>'video'</span> &amp;&amp; <span>(</span>
          <span>&lt;</span><span>Video</span> <span>/&gt;</span>
        <span>)</span><span>}</span>
      <span>&lt;/</span><span>Suspense</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span>
<span>}</span></code></pre> <p>‚Ä¶but it would also change the UI, since the <code dir="ltr">Placeholder</code> fallback would be displayed on the initial render.</p> <p>Instead, we can use Activity. Since Activity boundaries show and hide their children, they already naturally divide the component tree into independent units. And just like Suspense, this feature allows them to participate in Selective Hydration.</p> <p>Let‚Äôs update our example to use Activity boundaries around the active tab:</p> <pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>activeTab</span><span>,</span> <span>setActiveTab</span><span>]</span> = <span>useState</span><span>(</span><span>'home'</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'home'</span><span>)</span><span>}</span><span>&gt;</span>
        Home
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'video'</span><span>)</span><span>}</span><span>&gt;</span>
        Video
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>

      <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>activeTab</span> === <span>"home"</span> ? <span>"visible"</span> : <span>"hidden"</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Home</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Activity</span><span>&gt;</span>
      <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>activeTab</span> === <span>"video"</span> ? <span>"visible"</span> : <span>"hidden"</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Video</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Activity</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span>
<span>}</span></code></pre> <p>Now our initial server-rendered HTML looks the same as it did in the original version, but thanks to Activity, React can hydrate the tab buttons first, before it even mounts <code dir="ltr">Home</code> or <code dir="ltr">Video</code>.</p> <hr> <p>Thus, in addition to hiding and showing content, Activity boundaries help improve your app‚Äôs performance during hydration by letting React know which parts of your page can become interactive in isolation.</p> <p>And even if your page doesn‚Äôt ever hide part of its content, you can still add always-visible Activity boundaries to improve hydration performance:</p> <pre data-language="jsx"><code><span>function</span> <span>Page</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>Post</span> <span>/&gt;</span>

      <span>&lt;</span><span>Activity</span><span>&gt;</span>
        <span>&lt;</span><span>Comments</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Activity</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span></code></pre> <hr> <h2 id="troubleshooting">Troubleshooting <a href="#troubleshooting" aria-label="Link for Troubleshooting " title="Link for Troubleshooting "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="my-hidden-components-have-unwanted-side-effects">My hidden components have unwanted side effects <a href="#my-hidden-components-have-unwanted-side-effects" aria-label="Link for My hidden components have unwanted side effects " title="Link for My hidden components have unwanted side effects "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>An Activity boundary hides its content by setting <code dir="ltr">display: none</code> on its children and cleaning up any of their Effects. So, most well-behaved React components that properly clean up their side effects will already be robust to being hidden by Activity.</p> <p>But there <em>are</em> some situations where a hidden component behaves differently than an unmounted one. Most notably, since a hidden component‚Äôs DOM is not destroyed, any side effects from that DOM will persist, even after the component is hidden.</p> <p>As an example, consider a <code dir="ltr">&lt;video&gt;</code> tag. Typically it doesn‚Äôt require any cleanup, because even if you‚Äôre playing a video, unmounting the tag stops the video and audio from playing in the browser. Try playing the video and then pressing Home in this demo:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>TabButton</span> <span>from</span> <span>'./TabButton.js'</span><span>;</span>
<span>import</span> <span>Home</span> <span>from</span> <span>'./Home.js'</span><span>;</span>
<span>import</span> <span>Video</span> <span>from</span> <span>'./Video.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>activeTab</span><span>,</span> <span>setActiveTab</span><span>]</span> = <span>useState</span><span>(</span><span>'video'</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'home'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'home'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Home
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'video'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'video'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Video
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>

      <span>&lt;</span><span>hr</span> <span>/&gt;</span>

      <span>{</span><span>activeTab</span> === <span>'home'</span> &amp;&amp; <span>&lt;</span><span>Home</span> <span>/&gt;</span><span>}</span>
      <span>{</span><span>activeTab</span> === <span>'video'</span> &amp;&amp; <span>&lt;</span><span>Video</span> <span>/&gt;</span><span>}</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>The video stops playing as expected.</p> <p>Now, let‚Äôs say we wanted to preserve the timecode where the user last watched, so that when they tab back to the video, it doesn‚Äôt start over from the beginning again.</p> <p>This is a great use case for Activity!</p> <p>Let‚Äôs update <code dir="ltr">App</code> to hide the inactive tab with a hidden Activity boundary instead of unmounting it, and see how the demo behaves this time:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span> <span>import</span> <span>{</span> <span>unstable_Activity</span><span>,</span> <span>Activity</span> <span>as</span> <span>ActivityStable</span><span>}</span> <span>from</span> <span>'react'</span><span>;</span> <span>let</span> <span>Activity</span> = <span>ActivityStable</span> ?? <span>unstable_Activity</span><span>;</span>
<span>import</span> <span>TabButton</span> <span>from</span> <span>'./TabButton.js'</span><span>;</span>
<span>import</span> <span>Home</span> <span>from</span> <span>'./Home.js'</span><span>;</span>
<span>import</span> <span>Video</span> <span>from</span> <span>'./Video.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>activeTab</span><span>,</span> <span>setActiveTab</span><span>]</span> = <span>useState</span><span>(</span><span>'video'</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'home'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'home'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Home
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'video'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'video'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Video
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>

      <span>&lt;</span><span>hr</span> <span>/&gt;</span>

      <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>activeTab</span> === <span>'home'</span> ? <span>'visible'</span> : <span>'hidden'</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Home</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Activity</span><span>&gt;</span>
      <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>activeTab</span> === <span>'video'</span> ? <span>'visible'</span> : <span>'hidden'</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Video</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Activity</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Whoops! The video and audio continue to play even after it‚Äôs been hidden, because the tab‚Äôs <code dir="ltr">&lt;video&gt;</code> element is still in the DOM.</p> <p>To fix this, we can add an Effect with a cleanup function that pauses the video:</p> <pre data-language="jsx"><code><span>export</span> <span>default</span> <span>function</span> <span>VideoTab</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>ref</span> = <span>useRef</span><span>(</span><span>)</span><span>;</span>

  <span>useLayoutEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>videoRef</span> = <span>ref</span>.<span>current</span><span>;</span>

    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>videoRef</span>.<span>pause</span><span>(</span><span>)</span>
    <span>}</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>video</span>
      <span>ref</span>=<span>{</span><span>ref</span><span>}</span>
      <span>controls</span>
      <span>playsInline</span>
      <span>src</span>=<span>"..."</span>
    <span>/&gt;</span>

  <span>)</span><span>;</span>
<span>}</span></code></pre> <p>We call <code dir="ltr">useLayoutEffect</code> instead of <code dir="ltr">useEffect</code> because conceptually the clean-up code is tied to the component‚Äôs UI being visually hidden. If we used a regular effect, the code could be delayed by (say) a re-suspending Suspense boundary or a View Transition.</p> <p>Let‚Äôs see the new behavior. Try playing the video, switching to the Home tab, then back to the Video tab:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>  <span>import</span> <span>{</span> <span>unstable_Activity</span><span>,</span> <span>Activity</span> <span>as</span> <span>ActivityStable</span><span>}</span> <span>from</span> <span>'react'</span><span>;</span> <span>let</span> <span>Activity</span> = <span>ActivityStable</span> ?? <span>unstable_Activity</span><span>;</span>
<span>import</span> <span>TabButton</span> <span>from</span> <span>'./TabButton.js'</span><span>;</span>
<span>import</span> <span>Home</span> <span>from</span> <span>'./Home.js'</span><span>;</span>
<span>import</span> <span>Video</span> <span>from</span> <span>'./Video.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>activeTab</span><span>,</span> <span>setActiveTab</span><span>]</span> = <span>useState</span><span>(</span><span>'video'</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'home'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'home'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Home
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>activeTab</span> === <span>'video'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setActiveTab</span><span>(</span><span>'video'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Video
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>

      <span>&lt;</span><span>hr</span> <span>/&gt;</span>

      <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>activeTab</span> === <span>'home'</span> ? <span>'visible'</span> : <span>'hidden'</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Home</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Activity</span><span>&gt;</span>
      <span>&lt;</span><span>Activity</span> <span>mode</span>=<span>{</span><span>activeTab</span> === <span>'video'</span> ? <span>'visible'</span> : <span>'hidden'</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Video</span> <span>/&gt;</span>
      <span>&lt;/</span><span>Activity</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>It works great! Our cleanup function ensures that the video stops playing if it‚Äôs ever hidden by an Activity boundary, and even better, because the <code dir="ltr">&lt;video&gt;</code> tag is never destroyed, the timecode is preserved, and the video itself doesn‚Äôt need to be initialized or downloaded again when the user switches back to keep watching it.</p> <p>This is a great example of using Activity to preserve ephemeral DOM state for parts of the UI that become hidden, but the user is likely to interact with again soon.</p> <hr> <p>Our example illustrates that for certain tags like <code dir="ltr">&lt;video&gt;</code>, unmounting and hiding have different behavior. If a component renders DOM that has a side effect, and you want to prevent that side effect when an Activity boundary hides it, add an Effect with a return function to clean it up.</p> <p>The most common cases of this will be from the following tags:</p> <ul> <li><code dir="ltr">&lt;video&gt;</code></li> <li><code dir="ltr">&lt;audio&gt;</code></li> <li><code dir="ltr">&lt;iframe&gt;</code></li> </ul> <p>Typically, though, most of your React components should already be robust to being hidden by an Activity boundary. And conceptually, you should think of ‚Äúhidden‚Äù Activities as being unmounted.</p> <p>To eagerly discover other Effects that don‚Äôt have proper cleanup, which is important not only for Activity boundaries but for many other behaviors in React, we recommend using <a href="strictmode"><code dir="ltr">&lt;StrictMode&gt;</code></a>.</p> <hr> <h3 id="my-hidden-components-have-effects-that-arent-running">My hidden components have Effects that aren‚Äôt running <a href="#my-hidden-components-have-effects-that-arent-running" aria-label="Link for My hidden components have Effects that aren‚Äôt running " title="Link for My hidden components have Effects that aren‚Äôt running "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>When an <code dir="ltr">&lt;Activity&gt;</code> is ‚Äúhidden‚Äù, all its children‚Äôs Effects are cleaned up. Conceptually, the children are unmounted, but React saves their state for later. This is a feature of Activity because it means subscriptions won‚Äôt be active for hidden parts of the UI, reducing the amount of work needed for hidden content.</p> <p>If you‚Äôre relying on an Effect mounting to clean up a component‚Äôs side effects, refactor the Effect to do the work in the returned cleanup function instead.</p> <p>To eagerly find problematic Effects, we recommend adding <a href="strictmode"><code dir="ltr">&lt;StrictMode&gt;</code></a> which will eagerly perform Activity unmounts and mounts to catch any unexpected side-effects.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2013&ndash;present Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://react.dev/reference/react/Activity" class="_attribution-link">https://react.dev/reference/react/Activity</a>
  </p>
</div>
