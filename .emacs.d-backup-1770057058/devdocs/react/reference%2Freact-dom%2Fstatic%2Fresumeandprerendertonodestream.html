<h1>resumeAndPrerenderToNodeStream<a href="#undefined" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h1>
<div>
<p><code dir="ltr">resumeAndPrerenderToNodeStream</code> continues a prerendered React tree to a static HTML string using a a <a href="https://nodejs.org/api/stream.html" target="_blank" rel="nofollow noopener noreferrer">Node.js Stream.</a>.</p>
<pre data-language="jsx"><code><span>const</span> <span>{</span><span>prelude</span><span>,</span> <span>postponed</span><span>}</span> = <span>await</span> <span>resumeAndPrerenderToNodeStream</span><span>(</span><span>reactNode</span><span>,</span> <span>postponedState</span><span>,</span> <span>options</span>?<span>)</span></code></pre>
</div> <ul>
<li>
<a href="#reference">Reference </a><ul><li><a href="#resumeandprerendertolnodestream"><code dir="ltr">resumeAndPrerenderToNodeStream(reactNode, postponedState, options?)</code> </a></li></ul>
</li>
<li>
<a href="#usage">Usage </a><ul><li><a href="#further-reading">Further reading </a></li></ul>
</li>
</ul> <div class="note note-green">
<h4>Note</h4>
<div><p>This API is specific to Node.js. Environments with <a href="https://developer.mozilla.org/en-US/docs/Web/API/Streams_API" target="_blank" rel="nofollow noopener noreferrer">Web Streams,</a> like Deno and modern edge runtimes, should use <a href="prerender"><code dir="ltr">prerender</code></a> instead.</p></div>
</div> <hr> <h2 id="reference">Reference <a href="#reference" aria-label="Link for Reference " title="Link for Reference "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="resumeandprerendertolnodestream">
<code dir="ltr">resumeAndPrerenderToNodeStream(reactNode, postponedState, options?)</code> <a href="#resumeandprerendertolnodestream" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Call <code dir="ltr">resumeAndPrerenderToNodeStream</code> to continue a prerendered React tree to a static HTML string.</p> <pre data-language="jsx"><code><span>import</span> <span>{</span> <span>resumeAndPrerenderToNodeStream</span> <span>}</span> <span>from</span> <span>'react-dom/static'</span><span>;</span>
<span>import</span> <span>{</span> <span>getPostponedState</span> <span>}</span> <span>from</span> <span>'storage'</span><span>;</span>

<span>async</span> <span>function</span> <span>handler</span><span>(</span><span>request</span><span>,</span> <span>writable</span><span>)</span> <span>{</span>
  <span>const</span> <span>postponedState</span> = <span>getPostponedState</span><span>(</span><span>request</span><span>)</span><span>;</span>
  <span>const</span> <span>{</span> <span>prelude</span> <span>}</span> = <span>await</span> <span>resumeAndPrerenderToNodeStream</span><span>(</span><span>&lt;</span><span>App</span> <span>/&gt;</span><span>,</span> <span>JSON</span>.<span>parse</span><span>(</span><span>postponedState</span><span>)</span><span>)</span><span>;</span>
  <span>prelude</span>.<span>pipe</span><span>(</span><span>writable</span><span>)</span><span>;</span>
<span>}</span></code></pre> <p>On the client, call <a href="../client/hydrateroot"><code dir="ltr">hydrateRoot</code></a> to make the server-generated HTML interactive.</p> <p><a href="#usage">See more examples below.</a></p> <h4 id="parameters">Parameters <a href="#parameters" aria-label="Link for Parameters " title="Link for Parameters "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4> <ul> <li>
<code dir="ltr">reactNode</code>: The React node you called <code dir="ltr">prerender</code> (or a previous <code dir="ltr">resumeAndPrerenderToNodeStream</code>) with. For example, a JSX element like <code dir="ltr">&lt;App /&gt;</code>. It is expected to represent the entire document, so the <code dir="ltr">App</code> component should render the <code dir="ltr">&lt;html&gt;</code> tag.</li> <li>
<code dir="ltr">postponedState</code>: The opaque <code dir="ltr">postpone</code> object returned from a <a href="index">prerender API</a>, loaded from wherever you stored it (e.g. redis, a file, or S3).</li> <li>
<strong>optional</strong> <code dir="ltr">options</code>: An object with streaming options. <ul> <li>
<strong>optional</strong> <code dir="ltr">signal</code>: An <a href="https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal" target="_blank" rel="nofollow noopener noreferrer">abort signal</a> that lets you <a href="#aborting-server-rendering">abort server rendering</a> and render the rest on the client.</li> <li>
<strong>optional</strong> <code dir="ltr">onError</code>: A callback that fires whenever there is a server error, whether <a href="#recovering-from-errors-outside-the-shell">recoverable</a> or <a href="#recovering-from-errors-inside-the-shell">not.</a> By default, this only calls <code dir="ltr">console.error</code>. If you override it to <a href="#logging-crashes-on-the-server">log crash reports,</a> make sure that you still call <code dir="ltr">console.error</code>.</li> </ul> </li> </ul> <h4 id="returns">Returns <a href="#returns" aria-label="Link for Returns " title="Link for Returns "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4> <p><code dir="ltr">resumeAndPrerenderToNodeStream</code> returns a Promise:</p> <ul> <li>If rendering the is successful, the Promise will resolve to an object containing: <ul> <li>
<code dir="ltr">prelude</code>: a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Streams_API" target="_blank" rel="nofollow noopener noreferrer">Web Stream</a> of HTML. You can use this stream to send a response in chunks, or you can read the entire stream into a string.</li> <li>
<code dir="ltr">postponed</code>: an JSON-serializeable, opaque object that can be passed to <a href="../server/resume"><code dir="ltr">resumeToNodeStream</code></a> or <a href="resumeandprerendertonodestream"><code dir="ltr">resumeAndPrerenderToNodeStream</code></a> if <code dir="ltr">resumeAndPrerenderToNodeStream</code> is aborted.</li> </ul> </li> <li>If rendering fails, the Promise will be rejected. <a href="../server/rendertoreadablestream#recovering-from-errors-inside-the-shell">Use this to output a fallback shell.</a>
</li> </ul> <h4 id="caveats">Caveats <a href="#caveats" aria-label="Link for Caveats " title="Link for Caveats "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4> <p><code dir="ltr">nonce</code> is not an available option when prerendering. Nonces must be unique per request and if you use nonces to secure your application with <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP" target="_blank" rel="nofollow noopener noreferrer">CSP</a> it would be inappropriate and insecure to include the nonce value in the prerender itself.</p> <div class="note note-green">
<h4>Note</h4>
<div>
<h4>When should I use resumeAndPrerenderToNodeStream? </h4>
<p>The static <code dir="ltr">resumeAndPrerenderToNodeStream</code> API is used for static server-side generation (SSG). Unlike <code dir="ltr">renderToString</code>, <code dir="ltr">resumeAndPrerenderToNodeStream</code> waits for all data to load before resolving. This makes it suitable for generating static HTML for a full page, including data that needs to be fetched using Suspense. To stream content as it loads, use a streaming server-side render (SSR) API like <a href="../server/rendertoreadablestream">renderToReadableStream</a>.</p>
<p><code dir="ltr">resumeAndPrerenderToNodeStream</code> can be aborted and later either continued with another <code dir="ltr">resumeAndPrerenderToNodeStream</code> or resumed with <code dir="ltr">resume</code> to support partial pre-rendering.</p>
</div>
</div> <hr> <h2 id="usage">Usage <a href="#usage" aria-label="Link for Usage " title="Link for Usage "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="further-reading">Further reading <a href="#further-reading" aria-label="Link for Further reading " title="Link for Further reading "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p><code dir="ltr">resumeAndPrerenderToNodeStream</code> behaves similarly to <a href="prerender"><code dir="ltr">prerender</code></a> but can be used to continue a previously started prerendering process that was aborted. For more information about resuming a prerendered tree, see the <a href="../server/resume#resuming-a-prerender">resume documentation</a>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2013&ndash;present Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://react.dev/reference/react-dom/static/resumeAndPrerenderToNodeStream" class="_attribution-link">https://react.dev/reference/react-dom/static/resumeAndPrerenderToNodeStream</a>
  </p>
</div>
