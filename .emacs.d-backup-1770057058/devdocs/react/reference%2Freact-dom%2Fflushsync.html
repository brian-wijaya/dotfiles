<h1>flushSync<a href="#undefined" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h1>
<div class="note note-orange">
<h4>Pitfall</h4>
<div><p>Using <code dir="ltr">flushSync</code> is uncommon and can hurt the performance of your app.</p></div>
</div> <div>
<p><code dir="ltr">flushSync</code> lets you force React to flush any updates inside the provided callback synchronously. This ensures that the DOM is updated immediately.</p>
<pre data-language="jsx"><code><span>flushSync</span><span>(</span><span>callback</span><span>)</span></code></pre>
</div> <ul>
<li>
<a href="#reference">Reference </a><ul><li><a href="#flushsync"><code dir="ltr">flushSync(callback)</code> </a></li></ul>
</li>
<li>
<a href="#usage">Usage </a><ul><li><a href="#flushing-updates-for-third-party-integrations">Flushing updates for third-party integrations </a></li></ul>
</li>
<li>
<a href="#troubleshooting">Troubleshooting </a><ul><li><a href="#im-getting-an-error-flushsync-was-called-from-inside-a-lifecycle-method">I‚Äôm getting an error: ‚ÄúflushSync was called from inside a lifecycle method‚Äù </a></li></ul>
</li>
</ul> <hr> <h2 id="reference">Reference <a href="#reference" aria-label="Link for Reference " title="Link for Reference "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="flushsync">
<code dir="ltr">flushSync(callback)</code> <a href="#flushsync" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Call <code dir="ltr">flushSync</code> to force React to flush any pending work and update the DOM synchronously.</p> <pre data-language="jsx"><code><span>import</span> <span>{</span> <span>flushSync</span> <span>}</span> <span>from</span> <span>'react-dom'</span><span>;</span>

<span>flushSync</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>setSomething</span><span>(</span><span>123</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>;</span></code></pre> <p>Most of the time, <code dir="ltr">flushSync</code> can be avoided. Use <code dir="ltr">flushSync</code> as last resort.</p> <p><a href="#usage">See more examples below.</a></p> <h4 id="parameters">Parameters <a href="#parameters" aria-label="Link for Parameters " title="Link for Parameters "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4> <ul> <li>
<code dir="ltr">callback</code>: A function. React will immediately call this callback and flush any updates it contains synchronously. It may also flush any pending updates, or Effects, or updates inside of Effects. If an update suspends as a result of this <code dir="ltr">flushSync</code> call, the fallbacks may be re-shown.</li> </ul> <h4 id="returns">Returns <a href="#returns" aria-label="Link for Returns " title="Link for Returns "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4> <p><code dir="ltr">flushSync</code> returns <code dir="ltr">undefined</code>.</p> <h4 id="caveats">Caveats <a href="#caveats" aria-label="Link for Caveats " title="Link for Caveats "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h4> <ul> <li>
<code dir="ltr">flushSync</code> can significantly hurt performance. Use sparingly.</li> <li>
<code dir="ltr">flushSync</code> may force pending Suspense boundaries to show their <code dir="ltr">fallback</code> state.</li> <li>
<code dir="ltr">flushSync</code> may run pending Effects and synchronously apply any updates they contain before returning.</li> <li>
<code dir="ltr">flushSync</code> may flush updates outside the callback when necessary to flush the updates inside the callback. For example, if there are pending updates from a click, React may flush those before flushing the updates inside the callback.</li> </ul> <hr> <h2 id="usage">Usage <a href="#usage" aria-label="Link for Usage " title="Link for Usage "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="flushing-updates-for-third-party-integrations">Flushing updates for third-party integrations <a href="#flushing-updates-for-third-party-integrations" aria-label="Link for Flushing updates for third-party integrations " title="Link for Flushing updates for third-party integrations "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>When integrating with third-party code such as browser APIs or UI libraries, it may be necessary to force React to flush updates. Use <code dir="ltr">flushSync</code> to force React to flush any <span data-step="1">state updates</span> inside the callback synchronously:</p> <pre data-language="jsx"><code><span>flushSync</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>setSomething(123)</span><span>;</span>
<span>}</span><span>)</span><span>;</span>
<span>// By this line, the DOM is updated.</span></code></pre> <p>This ensures that, by the time the next line of code runs, React has already updated the DOM.</p> <p><strong>Using <code dir="ltr">flushSync</code> is uncommon, and using it often can significantly hurt the performance of your app.</strong> If your app only uses React APIs, and does not integrate with third-party libraries, <code dir="ltr">flushSync</code> should be unnecessary.</p> <p>However, it can be helpful for integrating with third-party code like browser APIs.</p> <p>Some browser APIs expect results inside of callbacks to be written to the DOM synchronously, by the end of the callback, so the browser can do something with the rendered DOM. In most cases, React handles this for you automatically. But in some cases it may be necessary to force a synchronous update.</p> <p>For example, the browser <code dir="ltr">onbeforeprint</code> API allows you to change the page immediately before the print dialog opens. This is useful for applying custom print styles that allow the document to display better for printing. In the example below, you use <code dir="ltr">flushSync</code> inside of the <code dir="ltr">onbeforeprint</code> callback to immediately ‚Äúflush‚Äù the React state to the DOM. Then, by the time the print dialog opens, <code dir="ltr">isPrinting</code> displays ‚Äúyes‚Äù:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>flushSync</span> <span>}</span> <span>from</span> <span>'react-dom'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>PrintApp</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPrinting</span><span>,</span> <span>setIsPrinting</span><span>]</span> = <span>useState</span><span>(</span><span>false</span><span>)</span><span>;</span>

  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>function</span> <span>handleBeforePrint</span><span>(</span><span>)</span> <span>{</span>
      <span>flushSync</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
        <span>setIsPrinting</span><span>(</span><span>true</span><span>)</span><span>;</span>
      <span>}</span><span>)</span>
    <span>}</span>

    <span>function</span> <span>handleAfterPrint</span><span>(</span><span>)</span> <span>{</span>
      <span>setIsPrinting</span><span>(</span><span>false</span><span>)</span><span>;</span>
    <span>}</span>

    <span>window</span>.<span>addEventListener</span><span>(</span><span>'beforeprint'</span><span>,</span> <span>handleBeforePrint</span><span>)</span><span>;</span>
    <span>window</span>.<span>addEventListener</span><span>(</span><span>'afterprint'</span><span>,</span> <span>handleAfterPrint</span><span>)</span><span>;</span>
    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>window</span>.<span>removeEventListener</span><span>(</span><span>'beforeprint'</span><span>,</span> <span>handleBeforePrint</span><span>)</span><span>;</span>
      <span>window</span>.<span>removeEventListener</span><span>(</span><span>'afterprint'</span><span>,</span> <span>handleAfterPrint</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>h1</span><span>&gt;</span>isPrinting: <span>{</span><span>isPrinting</span> ? <span>'yes'</span> : <span>'no'</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span>
      <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>window</span>.<span>print</span><span>(</span><span>)</span><span>}</span><span>&gt;</span>
        Print
      <span>&lt;/</span><span>button</span><span>&gt;</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Without <code dir="ltr">flushSync</code>, the print dialog will display <code dir="ltr">isPrinting</code> as ‚Äúno‚Äù. This is because React batches the updates asynchronously and the print dialog is displayed before the state is updated.</p> <div class="note note-orange">
<h4>Pitfall</h4>
<div>
<p><code dir="ltr">flushSync</code> can significantly hurt performance, and may unexpectedly force pending Suspense boundaries to show their fallback state.</p>
<p>Most of the time, <code dir="ltr">flushSync</code> can be avoided, so use <code dir="ltr">flushSync</code> as a last resort.</p>
</div>
</div> <hr> <h2 id="troubleshooting">Troubleshooting <a href="#troubleshooting" aria-label="Link for Troubleshooting " title="Link for Troubleshooting "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="im-getting-an-error-flushsync-was-called-from-inside-a-lifecycle-method">I‚Äôm getting an error: ‚ÄúflushSync was called from inside a lifecycle method‚Äù <a href="#im-getting-an-error-flushsync-was-called-from-inside-a-lifecycle-method" aria-label="Link for I‚Äôm getting an error: ‚ÄúflushSync was called from inside a lifecycle method‚Äù " title="Link for I‚Äôm getting an error: ‚ÄúflushSync was called from inside a lifecycle method‚Äù "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>React cannot <code dir="ltr">flushSync</code> in the middle of a render. If you do, it will noop and warn:</p> 
<div>Console</div>



<svg width="1.33em" height="1.33em" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.22705 5.95996L14.2798 14.0127" stroke="white"></path><path d="M14.2798 5.95996L6.22705 14.0127" stroke="white"></path></svg>Warning: flushSync was called from inside a lifecycle method. React cannot flush when React is already rendering. Consider moving this call to a scheduler task or micro task. <p>This includes calling <code dir="ltr">flushSync</code> inside:</p> <ul> <li>rendering a component.</li> <li>
<code dir="ltr">useLayoutEffect</code> or <code dir="ltr">useEffect</code> hooks.</li> <li>Class component lifecycle methods.</li> </ul> <p>For example, calling <code dir="ltr">flushSync</code> in an Effect will noop and warn:</p> <pre data-language="jsx"><code><span>import</span> <span>{</span> <span>useEffect</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>{</span> <span>flushSync</span> <span>}</span> <span>from</span> <span>'react-dom'</span><span>;</span>

<span>function</span> <span>MyComponent</span><span>(</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>// üö© Wrong: calling flushSync inside an effect</span>
    <span>flushSync</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>setSomething</span><span>(</span><span>newValue</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>

  <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span><span>{</span><span>/* ... */</span>}<span>&lt;/</span><span>div</span><span>&gt;</span><span>;</span>
<span>}</span></code></pre> <p>To fix this, you usually want to move the <code dir="ltr">flushSync</code> call to an event:</p> <pre data-language="jsx"><code><span>function</span> <span>handleClick</span><span>(</span><span>)</span> <span>{</span>
  <span>// ‚úÖ Correct: flushSync in event handlers is safe</span>
  <span>flushSync</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>setSomething</span><span>(</span><span>newValue</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>
<span>}</span></code></pre> <p>If it‚Äôs difficult to move to an event, you can defer <code dir="ltr">flushSync</code> in a microtask:</p> <pre data-language="jsx"><code><span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>// ‚úÖ Correct: defer flushSync to a microtask</span>
  <span>queueMicrotask</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>flushSync</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>setSomething</span><span>(</span><span>newValue</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>
<span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span></code></pre> <p>This will allow the current render to finish and schedule another syncronous render to flush the updates.</p> <div class="note note-orange">
<h4>Pitfall</h4>
<div><p><code dir="ltr">flushSync</code> can significantly hurt performance, but this particular pattern is even worse for performance. Exhaust all other options before calling <code dir="ltr">flushSync</code> in a microtask as an escape hatch.</p></div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2013&ndash;present Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://react.dev/reference/react-dom/flushSync" class="_attribution-link">https://react.dev/reference/react-dom/flushSync</a>
  </p>
</div>
