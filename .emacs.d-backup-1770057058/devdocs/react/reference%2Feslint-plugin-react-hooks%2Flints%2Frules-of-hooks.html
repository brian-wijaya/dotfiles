<h1>rules-of-hooks<a href="#undefined" aria-label="Link for this heading" title="Link for this heading"><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h1>
<div><p>Validates that components and hooks follow the <a href="../../rules/rules-of-hooks">Rules of Hooks</a>.</p></div> <h2 id="rule-details">Rule Details <a href="#rule-details" aria-label="Link for Rule Details " title="Link for Rule Details "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>React relies on the order in which hooks are called to correctly preserve state between renders. Each time your component renders, React expects the exact same hooks to be called in the exact same order. When hooks are called conditionally or in loops, React loses track of which state corresponds to which hook call, leading to bugs like state mismatches and “Rendered fewer/more hooks than expected” errors.</p> <h2 id="common-violations">Common Violations <a href="#common-violations" aria-label="Link for Common Violations " title="Link for Common Violations "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>These patterns violate the Rules of Hooks:</p> <ul> <li>
<strong>Hooks in conditions</strong> (<code dir="ltr">if</code>/<code dir="ltr">else</code>, ternary, <code dir="ltr">&amp;&amp;</code>/<code dir="ltr">||</code>)</li> <li>
<strong>Hooks in loops</strong> (<code dir="ltr">for</code>, <code dir="ltr">while</code>, <code dir="ltr">do-while</code>)</li> <li><strong>Hooks after early returns</strong></li> <li><strong>Hooks in callbacks/event handlers</strong></li> <li><strong>Hooks in async functions</strong></li> <li><strong>Hooks in class methods</strong></li> <li><strong>Hooks at module level</strong></li> </ul> <div class="note note-green">
<h4>Note</h4>
<div>
<h4>use hook </h4>
<p>The <code dir="ltr">use</code> hook is different from other React hooks. You can call it conditionally and in loops:</p>
<pre data-language="jsx"><code><span>// ✅ `use` can be conditional</span>
<span>if</span> <span>(</span><span>shouldFetch</span><span>)</span> <span>{</span>
  <span>const</span> <span>data</span> = <span>use</span><span>(</span><span>fetchPromise</span><span>)</span><span>;</span>
<span>}</span>

<span>// ✅ `use` can be in loops</span>
<span>for</span> <span>(</span><span>const</span> <span>promise</span> <span>of</span> <span>promises</span><span>)</span> <span>{</span>
  <span>results</span>.<span>push</span><span>(</span><span>use</span><span>(</span><span>promise</span><span>)</span><span>)</span><span>;</span>
<span>}</span></code></pre>
<p>However, <code dir="ltr">use</code> still has restrictions:</p>
<ul> <li>Can’t be wrapped in try/catch</li> <li>Must be called inside a component or hook</li> </ul>
<p>Learn more: <a href="../../react/use"><code dir="ltr">use</code> API Reference</a></p>
</div>
</div> <h3 id="invalid">Invalid <a href="#invalid" aria-label="Link for Invalid " title="Link for Invalid "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Examples of incorrect code for this rule:</p> <pre data-language="jsx"><code><span>// ❌ Hook in condition</span>
<span>if</span> <span>(</span><span>isLoggedIn</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>user</span><span>,</span> <span>setUser</span><span>]</span> = <span>useState</span><span>(</span><span>null</span><span>)</span><span>;</span>
<span>}</span>

<span>// ❌ Hook after early return</span>
<span>if</span> <span>(</span>!<span>data</span><span>)</span> <span>return</span> <span>&lt;</span><span>Loading</span> <span>/&gt;</span><span>;</span>
<span>const</span> <span>[</span><span>processed</span><span>,</span> <span>setProcessed</span><span>]</span> = <span>useState</span><span>(</span><span>data</span><span>)</span><span>;</span>

<span>// ❌ Hook in callback</span>
<span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>const</span> <span>[</span><span>clicked</span><span>,</span> <span>setClicked</span><span>]</span> = <span>useState</span><span>(</span><span>false</span><span>)</span><span>;</span>
<span>}</span><span>}</span><span>/&gt;</span>

<span>// ❌ `use` in try/catch</span>
<span>try</span> <span>{</span>
  <span>const</span> <span>data</span> = <span>use</span><span>(</span><span>promise</span><span>)</span><span>;</span>
<span>}</span> <span>catch</span> <span>(</span><span>e</span><span>)</span> <span>{</span>
  <span>// error handling</span>
<span>}</span>

<span>// ❌ Hook at module level</span>
<span>const</span> <span>globalState</span> = <span>useState</span><span>(</span><span>0</span><span>)</span><span>;</span> <span>// Outside component</span></code></pre> <h3 id="valid">Valid <a href="#valid" aria-label="Link for Valid " title="Link for Valid "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>Examples of correct code for this rule:</p> <pre data-language="jsx"><code><span>function</span> <span>Component</span><span>(</span><span>{</span> <span>isSpecial</span><span>,</span> <span>shouldFetch</span><span>,</span> <span>fetchPromise</span> <span>}</span><span>)</span> <span>{</span>
  <span>// ✅ Hooks at top level</span>
  <span>const</span> <span>[</span><span>count</span><span>,</span> <span>setCount</span><span>]</span> = <span>useState</span><span>(</span><span>0</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>name</span><span>,</span> <span>setName</span><span>]</span> = <span>useState</span><span>(</span><span>''</span><span>)</span><span>;</span>

  <span>if</span> <span>(</span>!<span>isSpecial</span><span>)</span> <span>{</span>
    <span>return</span> <span>null</span><span>;</span>
  <span>}</span>

  <span>if</span> <span>(</span><span>shouldFetch</span><span>)</span> <span>{</span>
    <span>// ✅ `use` can be conditional</span>
    <span>const</span> <span>data</span> = <span>use</span><span>(</span><span>fetchPromise</span><span>)</span><span>;</span>
    <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span><span>{</span><span>data</span><span>}</span><span>&lt;/</span><span>div</span><span>&gt;</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span><span>{</span><span>name</span><span>}</span>: <span>{</span><span>count</span><span>}</span><span>&lt;/</span><span>div</span><span>&gt;</span><span>;</span>
<span>}</span></code></pre> <h2 id="troubleshooting">Troubleshooting <a href="#troubleshooting" aria-label="Link for Troubleshooting " title="Link for Troubleshooting "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <h3 id="conditional-data-fetching">I want to fetch data based on some condition <a href="#conditional-data-fetching" aria-label="Link for I want to fetch data based on some condition " title="Link for I want to fetch data based on some condition "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>You’re trying to conditionally call useEffect:</p> <pre data-language="jsx"><code><span>// ❌ Conditional hook</span>
<span>if</span> <span>(</span><span>isLoggedIn</span><span>)</span> <span>{</span>
  <span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>fetchUserData</span><span>(</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>[</span><span>]</span><span>)</span><span>;</span>
<span>}</span></code></pre> <p>Call the hook unconditionally, check condition inside:</p> <pre data-language="jsx"><code><span>// ✅ Condition inside hook</span>
<span>useEffect</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>if</span> <span>(</span><span>isLoggedIn</span><span>)</span> <span>{</span>
    <span>fetchUserData</span><span>(</span><span>)</span><span>;</span>
  <span>}</span>
<span>}</span><span>,</span> <span>[</span><span>isLoggedIn</span><span>]</span><span>)</span><span>;</span></code></pre> <div class="note note-green">
<h4>Note</h4>
<div>
<p>There are better ways to fetch data rather than in a useEffect. Consider using React Query, useSWR, or React Router 6.4+ for data fetching. These solutions handle deduplicating requests, caching responses, and avoiding network waterfalls.</p>
<p>Learn more: <a href="../../../learn/synchronizing-with-effects#fetching-data">Fetching Data</a></p>
</div>
</div> <h3 id="conditional-state-initialization">I need different state for different scenarios <a href="#conditional-state-initialization" aria-label="Link for I need different state for different scenarios " title="Link for I need different state for different scenarios "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h3> <p>You’re trying to conditionally initialize state:</p> <pre data-language="jsx"><code><span>// ❌ Conditional state</span>
<span>if</span> <span>(</span><span>userType</span> === <span>'admin'</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>permissions</span><span>,</span> <span>setPermissions</span><span>]</span> = <span>useState</span><span>(</span><span>adminPerms</span><span>)</span><span>;</span>
<span>}</span> <span>else</span> <span>{</span>
  <span>const</span> <span>[</span><span>permissions</span><span>,</span> <span>setPermissions</span><span>]</span> = <span>useState</span><span>(</span><span>userPerms</span><span>)</span><span>;</span>
<span>}</span></code></pre> <p>Always call useState, conditionally set the initial value:</p> <pre data-language="jsx"><code><span>// ✅ Conditional initial value</span>
<span>const</span> <span>[</span><span>permissions</span><span>,</span> <span>setPermissions</span><span>]</span> = <span>useState</span><span>(</span>
  <span>userType</span> === <span>'admin'</span> ? <span>adminPerms</span> : <span>userPerms</span>
<span>)</span><span>;</span></code></pre> <h2 id="options">Options <a href="#options" aria-label="Link for Options " title="Link for Options "><svg width="1em" height="1em" viewbox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a>
</h2> <p>You can configure custom effect hooks using shared ESLint settings (available in <code dir="ltr">eslint-plugin-react-hooks</code> 6.1.1 and later):</p> <pre data-language="jsx"><code><span>{</span>
  <span>"settings"</span><span>:</span> <span>{</span>
    <span>"react-hooks"</span><span>:</span> <span>{</span>
      <span>"additionalEffectHooks"</span><span>:</span> <span>"(useMyEffect|useCustomEffect)"</span>
    <span>}</span>
  <span>}</span>
<span>}</span></code></pre> <ul> <li>
<code dir="ltr">additionalEffectHooks</code>: Regex pattern matching custom hooks that should be treated as effects. This allows <code dir="ltr">useEffectEvent</code> and similar event functions to be called from your custom effect hooks.</li> </ul> <p>This shared configuration is used by both <code dir="ltr">rules-of-hooks</code> and <code dir="ltr">exhaustive-deps</code> rules, ensuring consistent behavior across all hook-related linting.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2013&ndash;present Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://react.dev/reference/eslint-plugin-react-hooks/lints/rules-of-hooks" class="_attribution-link">https://react.dev/reference/eslint-plugin-react-hooks/lints/rules-of-hooks</a>
  </p>
</div>
