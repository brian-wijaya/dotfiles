<h1>git-update-ref</h1>  <h2 id="_name">Name</h2> <div class="sectionbody">  <p>git-update-ref - Update the object name stored in a ref safely</p>  </div>   <h2 id="_synopsis">Synopsis</h2> <div class="sectionbody"> <div class="verseblock"> <pre class="content" data-language="shell">git update-ref [-m &lt;reason&gt;] [--no-deref] -d &lt;ref&gt; [&lt;old-oid&gt;]
git update-ref [-m &lt;reason&gt;] [--no-deref] [--create-reflog] &lt;ref&gt; &lt;new-oid&gt; [&lt;old-oid&gt;]
git update-ref [-m &lt;reason&gt;] [--no-deref] --stdin [-z] [--batch-updates]</pre> </div> </div>   <h2 id="_description">Description</h2> <div class="sectionbody">  <p>Given two arguments, stores the &lt;new-oid&gt; in the <span class="hover-term" data-term="ref">&lt;ref&gt;</span>, possibly dereferencing the symbolic refs. E.g. <span class="synopsis"><code>git</code> <code>update-ref</code> <code>HEAD</code> <em>&lt;new-oid&gt;</em></span> updates the current branch head to the new object.</p>   <p>Given three arguments, stores the &lt;new-oid&gt; in the <span class="hover-term" data-term="ref">&lt;ref&gt;</span>, possibly dereferencing the symbolic refs, after verifying that the current value of the <span class="hover-term" data-term="ref">&lt;ref&gt;</span> matches &lt;old-oid&gt;. E.g. <span class="synopsis"><code>git</code> <code>update-ref</code> <code>refs/heads/master</code> <em>&lt;new-oid&gt;</em> <em>&lt;old-oid&gt;</em></span> updates the master branch head to &lt;new-oid&gt; only if its current value is &lt;old-oid&gt;. You can specify 40 "0" or an empty string as &lt;old-oid&gt; to make sure that the ref you are creating does not exist.</p>   <p>The final arguments are object names; this command without any options does not support updating a symbolic ref to point to another ref (see <a href="git-symbolic-ref">git-symbolic-ref[1]</a>). But <span class="synopsis"><code>git</code> <code>update-ref</code> <code>--stdin</code></span> does have the <span class="synopsis"><code>symref-*</code></span> commands so that regular refs and symbolic refs can be committed in the same transaction.</p>   <p>If --no-deref is given, <span class="hover-term" data-term="ref">&lt;ref&gt;</span> itself is overwritten, rather than the result of following the symbolic pointers.</p>   <p>With <span class="synopsis"><code>-d</code></span>, it deletes the named <span class="hover-term" data-term="ref">&lt;ref&gt;</span> after verifying that it still contains &lt;old-oid&gt;.</p>   <p>With <span class="synopsis"><code>--stdin</code></span>, update-ref reads instructions from standard input and performs all modifications together. Specify commands of the form:</p>  <div class="literalblock"> <div class="content"> <pre>update SP &lt;ref&gt; SP &lt;new-oid&gt; [SP &lt;old-oid&gt;] LF
create SP &lt;ref&gt; SP &lt;new-oid&gt; LF
delete SP &lt;ref&gt; [SP &lt;old-oid&gt;] LF
verify SP &lt;ref&gt; [SP &lt;old-oid&gt;] LF
symref-update SP &lt;ref&gt; SP &lt;new-target&gt; [SP (ref SP &lt;old-target&gt; | oid SP &lt;old-oid&gt;)] LF
symref-create SP &lt;ref&gt; SP &lt;new-target&gt; LF
symref-delete SP &lt;ref&gt; [SP &lt;old-target&gt;] LF
symref-verify SP &lt;ref&gt; [SP &lt;old-target&gt;] LF
option SP &lt;opt&gt; LF
start LF
prepare LF
commit LF
abort LF</pre> </div> </div>  <p>With <span class="synopsis"><code>--create-reflog</code></span>, update-ref will create a reflog for each ref even if one would not ordinarily be created.</p>   <p>With <span class="synopsis"><code>--batch-updates</code></span>, update-ref executes the updates in a batch but allows individual updates to fail due to invalid or incorrect user input, applying only the successful updates. However, system-related errors—such as I/O failures or memory issues—will result in a full failure of all batched updates. Any failed updates will be reported in the following format:</p>  <div class="literalblock"> <div class="content"> <pre>rejected SP (&lt;old-oid&gt; | &lt;old-target&gt;) SP (&lt;new-oid&gt; | &lt;new-target&gt;) SP &lt;rejection-reason&gt; LF</pre> </div> </div>  <p>Quote fields containing whitespace as if they were strings in C source code; i.e., surrounded by double-quotes and with backslash escapes. Use 40 "0" characters or the empty string to specify a zero value. To specify a missing value, omit the value and its preceding SP entirely.</p>   <p>Alternatively, use <span class="synopsis"><code>-z</code></span> to specify in NUL-terminated format, without quoting:</p>  <div class="literalblock"> <div class="content"> <pre>update SP &lt;ref&gt; NUL &lt;new-oid&gt; NUL [&lt;old-oid&gt;] NUL
create SP &lt;ref&gt; NUL &lt;new-oid&gt; NUL
delete SP &lt;ref&gt; NUL [&lt;old-oid&gt;] NUL
verify SP &lt;ref&gt; NUL [&lt;old-oid&gt;] NUL
symref-update SP &lt;ref&gt; NUL &lt;new-target&gt; [NUL (ref NUL &lt;old-target&gt; | oid NUL &lt;old-oid&gt;)] NUL
symref-create SP &lt;ref&gt; NUL &lt;new-target&gt; NUL
symref-delete SP &lt;ref&gt; [NUL &lt;old-target&gt;] NUL
symref-verify SP &lt;ref&gt; [NUL &lt;old-target&gt;] NUL
option SP &lt;opt&gt; NUL
start NUL
prepare NUL
commit NUL
abort NUL</pre> </div> </div>  <p>In this format, use 40 "0" to specify a zero value, and use the empty string to specify a missing value.</p>   <p>In either format, values can be specified in any form that Git recognizes as an object name. Commands in any other format or a repeated <span class="hover-term" data-term="ref">&lt;ref&gt;</span> produce an error. Command meanings are:</p>  <div class="dlist"> <dl> <dt class="hdlist1" id="Documentation/git-update-ref.txt-update">
update </dt> <dd> <p>Set <span class="hover-term" data-term="ref">&lt;ref&gt;</span> to &lt;new-oid&gt; after verifying &lt;old-oid&gt;, if given. Specify a zero &lt;new-oid&gt; to ensure the ref does not exist after the update and/or a zero &lt;old-oid&gt; to make sure the ref does not exist before the update.</p> </dd> <dt class="hdlist1" id="Documentation/git-update-ref.txt-create">
create </dt> <dd> <p>Create <span class="hover-term" data-term="ref">&lt;ref&gt;</span> with &lt;new-oid&gt; after verifying that it does not exist. The given &lt;new-oid&gt; may not be zero.</p> </dd> <dt class="hdlist1" id="Documentation/git-update-ref.txt-delete">
delete </dt> <dd> <p>Delete <span class="hover-term" data-term="ref">&lt;ref&gt;</span> after verifying that it exists with &lt;old-oid&gt;, if given. If given, &lt;old-oid&gt; may not be zero.</p> </dd> <dt class="hdlist1" id="Documentation/git-update-ref.txt-symref-update">
symref-update </dt> <dd> <p>Set <span class="hover-term" data-term="ref">&lt;ref&gt;</span> to &lt;new-target&gt; after verifying &lt;old-target&gt; or &lt;old-oid&gt;, if given. Specify a zero &lt;old-oid&gt; to ensure that the ref does not exist before the update.</p> </dd> <dt class="hdlist1" id="Documentation/git-update-ref.txt-verify">
verify </dt> <dd> <p>Verify <span class="hover-term" data-term="ref">&lt;ref&gt;</span> against &lt;old-oid&gt; but do not change it. If &lt;old-oid&gt; is zero or missing, the ref must not exist.</p> </dd> </dl> </div>  <p>symref-create: Create symbolic ref <span class="hover-term" data-term="ref">&lt;ref&gt;</span> with &lt;new-target&gt; after verifying that it does not exist.</p>  <div class="dlist"> <dl> <dt class="hdlist1" id="Documentation/git-update-ref.txt-symref-delete">
symref-delete </dt> <dd> <p>Delete <span class="hover-term" data-term="ref">&lt;ref&gt;</span> after verifying that it exists with &lt;old-target&gt;, if given.</p> </dd> <dt class="hdlist1" id="Documentation/git-update-ref.txt-symref-verify">
symref-verify </dt> <dd> <p>Verify symbolic <span class="hover-term" data-term="ref">&lt;ref&gt;</span> against &lt;old-target&gt; but do not change it. If &lt;old-target&gt; is missing, the ref must not exist. Can only be used in <span class="synopsis"><code>no-deref</code></span> mode.</p> </dd> <dt class="hdlist1" id="Documentation/git-update-ref.txt-option">
option </dt> <dd> <p>Modify the behavior of the next command naming a <span class="hover-term" data-term="ref">&lt;ref&gt;</span>. The only valid option is <span class="synopsis"><code>no-deref</code></span> to avoid dereferencing a symbolic ref.</p> </dd> <dt class="hdlist1" id="Documentation/git-update-ref.txt-start">
start </dt> <dd> <p>Start a transaction. In contrast to a non-transactional session, a transaction will automatically abort if the session ends without an explicit commit. This command may create a new empty transaction when the current one has been committed or aborted already.</p> </dd> <dt class="hdlist1" id="Documentation/git-update-ref.txt-prepare">
prepare </dt> <dd> <p>Prepare to commit the transaction. This will create lock files for all queued reference updates. If one reference could not be locked, the transaction will be aborted.</p> </dd> <dt class="hdlist1" id="Documentation/git-update-ref.txt-commit">
commit </dt> <dd> <p>Commit all reference updates queued for the transaction, ending the transaction.</p> </dd> <dt class="hdlist1" id="Documentation/git-update-ref.txt-abort">
abort </dt> <dd> <p>Abort the transaction, releasing all locks if the transaction is in prepared state.</p> </dd> </dl> </div>  <p>If all <span class="hover-term" data-term="ref">&lt;ref&gt;</span>s can be locked with matching &lt;old-oid&gt;s simultaneously, all modifications are performed. Otherwise, no modifications are performed. Note that while each individual <span class="hover-term" data-term="ref">&lt;ref&gt;</span> is updated or deleted atomically, a concurrent reader may still see a subset of the modifications.</p>  </div>   <h2 id="_logging_updates">Logging updates</h2> <div class="sectionbody">  <p>If config parameter "core.logAllRefUpdates" is true and the ref is one under "refs/heads/", "refs/remotes/", "refs/notes/", or a pseudoref like HEAD or ORIG_HEAD; or the file "$GIT_DIR/logs/<span class="hover-term" data-term="ref">&lt;ref&gt;</span>" exists then <span class="synopsis"><code>git</code> <code>update-ref</code></span> will append a line to the log file "$GIT_DIR/logs/<span class="hover-term" data-term="ref">&lt;ref&gt;</span>" (dereferencing all symbolic refs before creating the log name) describing the change in ref value. Log lines are formatted as:</p>  <div class="literalblock"> <div class="content"> <pre>oldsha1 SP newsha1 SP committer LF</pre> </div> </div>  <p>Where "oldsha1" is the 40 character hexadecimal value previously stored in <span class="hover-term" data-term="ref">&lt;ref&gt;</span>, "newsha1" is the 40 character hexadecimal value of &lt;new-oid&gt; and "committer" is the committer’s name, email address and date in the standard Git committer ident format.</p>   <p>Optionally with -m:</p>  <div class="literalblock"> <div class="content"> <pre>oldsha1 SP newsha1 SP committer TAB message LF</pre> </div> </div>  <p>Where all fields are as described above and "message" is the value supplied to the -m option.</p>   <p>An update will fail (without changing <span class="hover-term" data-term="ref">&lt;ref&gt;</span>) if the current user is unable to create a new log file, append to the existing log file or does not have committer information available.</p>  </div>   <h2 id="_notes">Notes</h2> <div class="sectionbody">  <p>Symbolic refs were initially implemented using symbolic links. This is now deprecated since not all filesystems support symbolic links.</p>   <p>This command follows <strong>real</strong> symlinks only if they start with "refs/": otherwise it will just try to read them and update them as a regular file (i.e. it will allow the filesystem to follow them, but will overwrite such a symlink to somewhere else with a regular filename).</p>  </div>   <h2 id="_see_also">See also</h2> <div class="sectionbody">  <p><a href="git-symbolic-ref">git-symbolic-ref[1]</a></p>  </div>      <h3 hidden="true" data-pagefind-weight="7">update-ref</h3><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2025 Linus Torvalds and others<br>Licensed under the GNU General Public License version 2.<br>
    <a href="https://git-scm.com/docs/git-update-ref" class="_attribution-link">https://git-scm.com/docs/git-update-ref</a>
  </p>
</div>
