<h1 id="homebrew-bundle-brew-bundle-and-brewfile">Homebrew Bundle, <code class="language-plaintext highlighter-rouge">brew bundle</code> and <code class="language-plaintext highlighter-rouge">Brewfile</code>
</h1> <p>Homebrew Bundle is run with the <code class="language-plaintext highlighter-rouge">brew bundle</code> command.</p> <p>It uses <code class="language-plaintext highlighter-rouge">Brewfile</code>s to provide a declarative interface for installing/upgrading packages with Homebrew and starting services with <code class="language-plaintext highlighter-rouge">brew services</code>.</p> <p>Rather than specifying the <code class="language-plaintext highlighter-rouge">brew</code> commands you wish to run, you can specify the state you wish to reach.</p> <p>See also the <a href="manpage#bundle-subcommand"><code class="language-plaintext highlighter-rouge">brew bundle</code> section of <code class="language-plaintext highlighter-rouge">man brew</code></a> or <code class="language-plaintext highlighter-rouge">brew bundle --help</code>.</p> <h2 id="basic-usage">Basic Usage</h2> <h3 id="brew-bundle"><code class="language-plaintext highlighter-rouge">brew bundle</code></h3> <p>A simple <code class="language-plaintext highlighter-rouge">Brewfile</code> might contain a formula:</p> <pre data-language="ruby">brew "ruby"</pre> <p>When you run <code class="language-plaintext highlighter-rouge">brew bundle install</code> (or: just <code class="language-plaintext highlighter-rouge">brew bundle</code> for short), this will take instructions from the <code class="language-plaintext highlighter-rouge">Brewfile</code> to run <code class="language-plaintext highlighter-rouge">brew install ruby</code> and install Ruby if needed.</p> <pre data-language="console">$ brew bundle
Installing ruby
`brew bundle` complete! 1 Brewfile dependency now installed.</pre> <p>If it’s outdated, this will run <code class="language-plaintext highlighter-rouge">brew upgrade ruby</code>. If it’s already installed, this will be a no-op.</p> <pre data-language="console">$ brew bundle install
Using ruby
`brew bundle` complete! 1 Brewfile dependency now installed.</pre> <h3 id="brew-bundle-check"><code class="language-plaintext highlighter-rouge">brew bundle check</code></h3> <p>You can check if a <code class="language-plaintext highlighter-rouge">brew bundle install</code> will do anything by running:</p> <pre data-language="console">$ brew bundle check
The Brewfile's dependencies are satisfied.</pre> <p>You can use this behaviour in scripts like so:</p> <pre data-language="bash">brew bundle check || brew bundle install</pre> <h3 id="types">Types</h3> <p>As well as supporting formulae (<code class="language-plaintext highlighter-rouge">brew "..."</code>), you can also use <code class="language-plaintext highlighter-rouge">brew bundle</code> with casks, taps, Mac App Store apps, VSCode extensions and to start background services with <code class="language-plaintext highlighter-rouge">brew services</code>.</p> <pre data-language="ruby">tap "apple/apple"
brew "apple/apple/game-porting-toolkit"
brew "postgresql@16", restart_service: true
cask "firefox"
mas "Refined GitHub", id: 1519867270
vscode "editorconfig.editorconfig"</pre> <p>Run <code class="language-plaintext highlighter-rouge">brew bundle</code> again and this outputs:</p> <pre data-language="console">$ brew bundle
Using apple/apple
Using apple/apple/game-porting-toolkit
Using postgresql@16
Using firefox
Using Refined GitHub
Using editorconfig.editorconfig
`brew bundle` complete! 6 Brewfile dependencies now installed.</pre> <h3 id="projects">Projects</h3> <p>Adding a <code class="language-plaintext highlighter-rouge">Brewfile</code> to a project’s repository (like you might a <code class="language-plaintext highlighter-rouge">package.json</code>, <code class="language-plaintext highlighter-rouge">Gemfile</code> or <code class="language-plaintext highlighter-rouge">requirements.txt</code>) is a nicer way of encoding project dependencies for developer environments.</p> <p>It allows you to tell users to run a single command to install all dependencies for a project and start any services.</p> <p>As Homebrew supports both macOS, Linux and WSL: you can have this single command setup project dependencies on three operating systems and in continuous integration services like GitHub Actions (where it’s installed by default on macOS and easily on Linux with <a href="https://github.com/Homebrew/actions/tree/HEAD/setup-homebrew"><code class="language-plaintext highlighter-rouge">Homebrew/actions/setup-homebrew</code></a>).</p> <p>See <a href="https://github.com/github/scripts-to-rule-them-all/blob/HEAD/script/bootstrap">GitHub’s “Scripts To Rule Them All” <code class="language-plaintext highlighter-rouge">script/bootstrap</code> example</a> for how you might use a <code class="language-plaintext highlighter-rouge">Brewfile</code> and <code class="language-plaintext highlighter-rouge">brew bundle</code> to install project dependencies with Homebrew.</p> <h3 id="brew-bundle-dump"><code class="language-plaintext highlighter-rouge">brew bundle dump</code></h3> <p><code class="language-plaintext highlighter-rouge">Brewfile</code>s can also be used as a way of saving all supported packages into a single file.</p> <p>You can do this with <code class="language-plaintext highlighter-rouge">brew bundle dump --global --force</code> to write to e.g. <code class="language-plaintext highlighter-rouge">~/.Brewfile</code> (check <code class="language-plaintext highlighter-rouge">man brew</code> for the exact path used in your configuration):</p> <pre data-language="console">brew bundle dump --global --force</pre> <p>If you also pass <code class="language-plaintext highlighter-rouge">--describe</code>, you can also get the <code class="language-plaintext highlighter-rouge">Brewfile</code> to contain descriptions of each of the packages:</p> <pre data-language="console">brew bundle dump --global --force --describe</pre> <p>might add something like the following:</p> <pre data-language="ruby"># Powerful, clean, object-oriented scripting language
brew "ruby"</pre> <p>You can then reinstall (and, by default, upgrade) all of these with:</p> <pre data-language="console">brew bundle --global</pre> <h2 id="advanced-usage">Advanced Usage</h2> <h3 id="brew-bundle-cleanup"><code class="language-plaintext highlighter-rouge">brew bundle cleanup</code></h3> <p>If you’ve used <code class="language-plaintext highlighter-rouge">brew bundle dump</code> to store all the software you use, you can quickly cleanup anything else with:</p> <pre data-language="console">$ brew bundle cleanup --global --force
Uninstalling gcc... (1,914 files, 459.8MB)
Uninstalled 1 formula</pre> <h3 id="brew-bundle-list"><code class="language-plaintext highlighter-rouge">brew bundle list</code></h3> <p>If you want to get a list of all the formulae in your <code class="language-plaintext highlighter-rouge">Brewfile</code>, you can use:</p> <pre data-language="console">$ brew bundle list
apple/apple/game-porting-toolkit
postgresql@16</pre> <p>You can get other types with e.g.:</p> <pre data-language="console">$ brew bundle list --cask
firefox</pre> <h3 id="brew-bundle-edit"><code class="language-plaintext highlighter-rouge">brew bundle edit</code></h3> <p>To open your <code class="language-plaintext highlighter-rouge">Brewfile</code> in your text editor, run:</p> <pre data-language="console">$ brew bundle edit
Editing /some/project/Brewfile</pre> <h3 id="brew-bundle-add-and-brew-bundle-remove">
<code class="language-plaintext highlighter-rouge">brew bundle add</code> and <code class="language-plaintext highlighter-rouge">brew bundle remove</code>
</h3> <p>You can add and remove entries to your <code class="language-plaintext highlighter-rouge">Brewfile</code> by running <code class="language-plaintext highlighter-rouge">brew bundle add</code> or <code class="language-plaintext highlighter-rouge">brew bundle remove</code>:</p> <pre data-language="console">brew bundle add wget
brew bundle remove wget</pre> <h3 id="brew-bundle-exec"><code class="language-plaintext highlighter-rouge">brew bundle exec</code></h3> <p><code class="language-plaintext highlighter-rouge">brew bundle exec</code> allows you to run a command in an environment customised by your <code class="language-plaintext highlighter-rouge">Brewfile</code>.</p> <p>For example, with a <code class="language-plaintext highlighter-rouge">Brewfile</code> like:</p> <pre data-language="ruby">brew "node"</pre> <p>This will ensure you are always running the correct <code class="language-plaintext highlighter-rouge">node</code>:</p> <pre data-language="console">$ brew bundle exec which node
/opt/homebrew/opt/node/bin/node</pre> <p>This can be particularly useful when building software that depends on other software in your <code class="language-plaintext highlighter-rouge">Brewfile</code>. <code class="language-plaintext highlighter-rouge">brew bundle exec</code> will ensure that all the necessary paths are setup to find everything in your <code class="language-plaintext highlighter-rouge">Brewfile</code>, linked or unlinked, keg-only or not. This avoids dealing with issues around individual user or machine <code class="language-plaintext highlighter-rouge">PATH</code> configuration.</p> <p>If you want to avoid explicitly having to run <code class="language-plaintext highlighter-rouge">brew bundle check</code> or <code class="language-plaintext highlighter-rouge">brew bundle install</code> before <code class="language-plaintext highlighter-rouge">brew bundle exec</code>, you can use:</p> <pre data-language="console">brew bundle exec --check
brew bundle exec --install</pre> <p>If you want to start all the services in your <code class="language-plaintext highlighter-rouge">Brewfile</code> just during the execution of <code class="language-plaintext highlighter-rouge">brew bundle exec</code>, use:</p> <pre data-language="console">brew bundle exec --services</pre> <h3 id="brew-bundle-sh"><code class="language-plaintext highlighter-rouge">brew bundle sh</code></h3> <p><code class="language-plaintext highlighter-rouge">brew bundle sh</code> is like <code class="language-plaintext highlighter-rouge">brew bundle exec</code> but it runs your interactive shell of choice, like <code class="language-plaintext highlighter-rouge">brew sh</code>:</p> <pre data-language="console">$ brew bundle sh
brew bundle $ which node
/opt/homebrew/opt/node/bin/node</pre> <p>It’s got the same backbone as <code class="language-plaintext highlighter-rouge">brew bundle exec</code> so the same arguments (e.g. <code class="language-plaintext highlighter-rouge">--check</code>, <code class="language-plaintext highlighter-rouge">--install</code>, <code class="language-plaintext highlighter-rouge">--services</code>) apply.</p> <h3 id="brew-bundle-env"><code class="language-plaintext highlighter-rouge">brew bundle env</code></h3> <p><code class="language-plaintext highlighter-rouge">brew bundle env</code> dumps out all the environment variables in a form suitable for adding to a shell.</p> <pre data-language="console">$ brew bundle env | grep node
export PATH="/opt/homebrew/opt/node/bin:${PATH:-}"</pre> <p>You can use this with <code class="language-plaintext highlighter-rouge">eval</code> to turn your current shell environment into a <code class="language-plaintext highlighter-rouge">brew bundle exec</code> or <code class="language-plaintext highlighter-rouge">brew bundle sh</code> one:</p> <pre data-language="console">$ eval "$(brew bundle env)"
$ echo "${PATH}" | grep node
/opt/homebrew/opt/node/bin:/opt/homebrew/bin:/usr/bin:/bin</pre> <p>It’s also got the same backbone as <code class="language-plaintext highlighter-rouge">brew bundle exec</code> so the same arguments (e.g. <code class="language-plaintext highlighter-rouge">--check</code>, <code class="language-plaintext highlighter-rouge">--install</code>) apply.</p> <h3 id="brew-bundle-upgrade-and-homebrew_bundle_no_upgrade1">
<code class="language-plaintext highlighter-rouge">brew bundle upgrade</code> and <code class="language-plaintext highlighter-rouge">HOMEBREW_BUNDLE_NO_UPGRADE=1</code>
</h3> <p>By default, <code class="language-plaintext highlighter-rouge">brew bundle</code> will attempt to upgrade all software. You can disable this behaviour by passing <code class="language-plaintext highlighter-rouge">--no-upgrade</code> or with <code class="language-plaintext highlighter-rouge">export HOMEBREW_BUNDLE_NO_UPGRADE=1</code> in your environment.</p> <p>If you do this, you can upgrade everything with:</p> <pre data-language="console">brew bundle upgrade</pre> <p>or selective formulae with e.g.:</p> <pre data-language="console">brew bundle --upgrade-formulae ruby</pre> <h2 id="advanced-brewfiles">Advanced Brewfiles</h2> <p><code class="language-plaintext highlighter-rouge">Brewfile</code>s support many other small bits of functionality.</p> <p><code class="language-plaintext highlighter-rouge">Brewfile</code>s are evaluated as Ruby so you can use Ruby logic in them.</p> <p>Note that some logic may result in different output or behaviour per-machine, though.</p> <p>Rather than all <code class="language-plaintext highlighter-rouge">Brewfile</code> functionality one-by-one: here’s a commented example of some useful cases:</p> <pre data-language="ruby"># Run `brew tap` with a custom URL
tap "user/tap-repo", "https://user@bitbucket.org/user/homebrew-tap-repo.git"

# Set arguments passed to all `brew install --cask` commands for `cask "..."`
# In this example, pass `--appdir=~/Applications` and `--require_sha`
cask_args appdir: "~/Applications", require_sha: true

# Pass options to non-Homebrew/core formulae e.g. `brew install denji/nginx/nginx-full --with-rmtp`
# This also runs `brew link --overwrite nginx-full` and `brew services restart nginx-full` afterwards.
brew "denji/nginx/nginx-full", link: :overwrite, args: ["with-rmtp"], restart_service: :always

# Runs `brew install mysql@5.6`, `brew services restart mysql@5.6` only if it was was installed or upgraded,
# `brew link mysql@5.6` and `brew unlink mysql` (if `mysql` is installed)
brew "mysql@5.6", restart_service: :changed, link: true, conflicts_with: ["mysql"]

# Runs `brew install postgresql@16` and then runs a postinstall command if `postgresql@16` was installed or upgraded.
brew "postgresql@16",
     postinstall: "${HOMEBREW_PREFIX}/opt/postgresql@16/bin/postgres -D ${HOMEBREW_PREFIX}/var/postgresql@16"

# Runs `brew install ruby` and, afterwards, writes the installed version to the '.ruby-version` file.
brew "ruby", version_file: ".ruby-version"

# Runs `brew install gnupg` or `brew install glibc` only on the specified OS.
# Note: `brew bundle list` will not output `gnupg` on Linux or `glibc` on macOS` in this case:
# the Ruby logic means they are "hidden" on other platforms.
brew "gnupg" if OS.mac?
brew "glibc" if OS.linux?

# Runs `brew install --cask --appdir=~/my-apps/Applications`
cask "firefox", args: { appdir: "~/my-apps/Applications" }

# Runs `brew upgrade opera` to upgrade an auto-updated or unversioned Opera cask
# to the latest version even if already installed.
# This is used to force an upgrade in software that would typically update itself.
cask "opera", greedy: true

# Runs `brew install --cask java` only if '/usr/libexec/java_home --failfast` fails (i.e there is no Java)
# Note: `brew bundle list` will not output `java` if this `system` command succeeds and
# this `system` command will be run even on `brew bundle check`, not just `brew bundle install`.
cask "java" unless system "/usr/libexec/java_home", "--failfast"

# Runs `brew install --cask` and runs the command if the Google Cloud cask was installed or upgraded.
cask "google-cloud-sdk", postinstall: "${HOMEBREW_PREFIX}/bin/gcloud components update"

# Sets an environment variable to be used e.g. inside `brew bundle exec` or `system` commands in the `Brewfile`.
# Note: HOMEBREW_PREFIX/bin is _not_ in the `PATH` by default so you can set it this way.
ENV["SOME_ENV_VAR"] = "some_value"</pre> <h2 id="versions">Versions</h2> <p>Homebrew is a <a href="https://en.wikipedia.org/wiki/Rolling_release">rolling release</a> package manager so it does not support installing arbitrary older versions of software.</p> <p><code class="language-plaintext highlighter-rouge">brew bundle</code> does not have a concept of a “<code class="language-plaintext highlighter-rouge">Brewfile</code> lock file” that can be used to pin versions like e.g. <code class="language-plaintext highlighter-rouge">package-lock.json</code> or <code class="language-plaintext highlighter-rouge">Gemfile.lock</code>.</p> <p>This must be done with solutions outside or built on top of <code class="language-plaintext highlighter-rouge">brew bundle</code> instead.</p> <h2 id="adding-new-packages-support">Adding New Packages Support</h2> <p><code class="language-plaintext highlighter-rouge">brew bundle</code> currently supports Homebrew, Homebrew Cask, Mac App Store and Visual Studio Code (and forks/variants).</p> <p>We are interested in contributions for other packages’ installers/checkers/dumpers but they must:</p> <ul> <li>be able to install software without user interaction</li> <li>be able to check if software is installed</li> <li>be able to dump the installed software to a format that can be stored in a <code class="language-plaintext highlighter-rouge">Brewfile</code>
</li> <li>not require <code class="language-plaintext highlighter-rouge">sudo</code> to install (casks are an exception here)</li> <li>be extremely widely used</li> </ul> <p>Note: based on these criteria, we would not accept e.g. Whalebrew today.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2009&ndash;present Homebrew contributors<br>Licensed under the BSD 2-Clause License.<br>
    <a href="https://docs.brew.sh/Brew-Bundle-and-Brewfile" class="_attribution-link">https://docs.brew.sh/Brew-Bundle-and-Brewfile</a>
  </p>
</div>
