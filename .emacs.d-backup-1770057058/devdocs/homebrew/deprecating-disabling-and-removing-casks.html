<h1 id="deprecating-disabling-and-removing-casks">Deprecating, Disabling and Removing Casks</h1> <p>There are many reasons why casks may be deprecated, disabled or removed. This document explains the differences between each method as well as explaining when one method should be used over another.</p> <h2 id="overview">Overview</h2> <p>These general rules of thumb can be followed:</p> <ol> <li>
<code class="language-plaintext highlighter-rouge">deprecate!</code> should be used for casks that <em>should</em> no longer be used.</li> <li>
<code class="language-plaintext highlighter-rouge">disable!</code> should be used for casks that <em>cannot</em> be used.</li> <li>Casks that are no longer acceptable in <code class="language-plaintext highlighter-rouge">homebrew/cask</code> or have been disabled for over a year <em>should</em> be removed.</li> </ol> <h2 id="deprecation">Deprecation</h2> <p>If a user attempts to install a deprecated cask, they will be shown a warning message but the install will proceed.</p> <p>A cask should be deprecated to indicate to users that the cask should not be used and will be disabled in the future. Deprecated casks should continue to be maintained by the Homebrew maintainers if they continue to be installable. If this is not possible, they should be immediately disabled.</p> <p>The most common reasons for deprecation are when the upstream project is deprecated, unmaintained or archived, or the software does not pass macOS Gatekeeper checks.</p> <p>Casks should only be deprecated if at least one of the following are true:</p> <ul> <li>the software installed by the cask fails macOS Gatekeeper checks for supported OS versions</li> <li>the software installed by the cask cannot be run on any supported OS versions</li> <li>the software installed by the cask has outstanding CVEs</li> <li>the software installed by the cask has been discontinued or abandoned upstream</li> <li>the cask has <a href="https://formulae.brew.sh/analytics/cask-install/90d/">zero installs in the last 90 days</a>
</li> </ul> <p>To deprecate a cask, add a <code class="language-plaintext highlighter-rouge">deprecate!</code> call. This call should include a deprecation date in the ISO 8601 format and a deprecation reason:</p> <pre data-language="ruby">deprecate! date: "YYYY-MM-DD", because: :reason</pre> <p>The <code class="language-plaintext highlighter-rouge">date</code> parameter should be set to the date that the deprecation period should begin, which is usually today’s date. If the <code class="language-plaintext highlighter-rouge">date</code> parameter is set to a date in the future, the cask will not become deprecated until that date. This can be useful if the upstream developers have indicated a date when the project or version will stop being supported. Do not backdate the <code class="language-plaintext highlighter-rouge">date</code> parameter as it causes confusion for users and maintainers.</p> <p>The <code class="language-plaintext highlighter-rouge">because</code> parameter can be a preset reason (using a symbol) or a custom reason. See the <a href="#deprecate-and-disable-reasons">Deprecate and Disable Reasons</a> section below for more details about the <code class="language-plaintext highlighter-rouge">because</code> parameter.</p> <p>An optional <code class="language-plaintext highlighter-rouge">replacement_formula</code> or <code class="language-plaintext highlighter-rouge">replacement_cask</code> parameter may also be specified to suggest a replacement formula or cask to the user. The value for the parameter is a string.</p> <pre data-language="ruby">deprecate! date: "YYYY-MM-DD", because: :reason, replacement_formula: "foo"</pre> <h2 id="disabling">Disabling</h2> <p>If a user attempts to install a disabled cask, they will be shown an error message and the install will fail.</p> <p>A cask should be disabled to indicate to users that the cask cannot be used and will be removed in the future. Disabled casks are those that can no longer be successfully installed.</p> <p>The most common reasons for disabling a cask are:</p> <ul> <li>it cannot be installed on any supported OS versions</li> <li>it has been deprecated for a long time</li> <li>the upstream URL has been removed</li> </ul> <p>Popular casks (e.g. have more than 300 <a href="https://formulae.brew.sh/analytics/cask-install/90d/">analytics installs in the last 90 days</a>) should not be disabled without a deprecation period of at least six months unless they cannot be installed on any supported OS versions and the issue is unfixable (e.g. download URL no longer works and a mirror cannot be sourced).</p> <p>Unpopular casks (e.g. have fewer than 300 <a href="https://formulae.brew.sh/analytics/cask-install/90d/">analytics installs in the last 90 days</a>) can be disabled immediately for any of the reasons above, e.g. the upstream URL has been removed. They can be manually removed three months after their disable date.</p> <p>To disable a cask, add a <code class="language-plaintext highlighter-rouge">disable!</code> call. This call should include a deprecation date in the ISO 8601 format and a deprecation reason:</p> <pre data-language="ruby">disable! date: "YYYY-MM-DD", because: :reason</pre> <p>The <code class="language-plaintext highlighter-rouge">date</code> parameter should be set to the date that the reason for disabling came into effect. If there is no clear date but the cask needs to be disabled, use today’s date. If the <code class="language-plaintext highlighter-rouge">date</code> parameter is set to a date in the future, the cask will be deprecated until that date (upon which the cask will become disabled).</p> <p>The <code class="language-plaintext highlighter-rouge">because</code> parameter can be a preset reason (using a symbol) or a custom reason. See the <a href="#deprecate-and-disable-reasons">Deprecate and Disable Reasons</a> section below for more details about the <code class="language-plaintext highlighter-rouge">because</code> parameter.</p> <p>Similar to deprecated casks, an optional <code class="language-plaintext highlighter-rouge">replacement_formula</code> or <code class="language-plaintext highlighter-rouge">replacement_cask</code> parameter may also be specified for disabled casks to suggest a replacement formula or cask to the user. The value for the parameter is a string.</p> <pre data-language="ruby">disable! date: "YYYY-MM-DD", because: :reason, replacement_cask: "foo"</pre> <h2 id="removal">Removal</h2> <p>A cask should be removed if it does not meet our criteria for <a href="acceptable-casks">acceptable casks</a> or has been disabled for over a year.</p> <p><strong>Note: disabled casks in <code class="language-plaintext highlighter-rouge">homebrew/cask</code> will be automatically removed one year after their disable date.</strong></p> <h2 id="deprecate-and-disable-reasons">Deprecate and Disable Reasons</h2> <p>When a cask is deprecated or disabled, a reason explaining the action must be provided.</p> <p>There are two ways to indicate the reason. The preferred way is to use a pre-existing symbol to indicate the reason. The available symbols are listed below and can be found in the <a href="https://rubydoc.brew.sh/DeprecateDisable.html"><code class="language-plaintext highlighter-rouge">DeprecateDisable</code> module</a>:</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">:discontinued</code>: the cask is discontinued upstream</li> <li>
<code class="language-plaintext highlighter-rouge">:moved_to_mas</code>: the cask is now exclusively distributed on the Mac App Store</li> <li>
<code class="language-plaintext highlighter-rouge">:no_longer_available</code>: the cask is no longer available upstream</li> <li>
<code class="language-plaintext highlighter-rouge">:no_longer_meets_criteria</code>: the cask no longer meets the criteria for acceptable casks</li> <li>
<code class="language-plaintext highlighter-rouge">:unmaintained</code>: the cask is not maintained upstream</li> <li>
<code class="language-plaintext highlighter-rouge">:fails_gatekeeper_check</code>: the cask fails macOS Gatekeeper checks</li> </ul> <p>These reasons can be specified by their symbols (the comments show the message that will be displayed to users):</p> <pre data-language="ruby"># Warning: &lt;cask&gt; has been deprecated because it is discontinued upstream!
deprecate! date: "2020-01-01", because: :discontinued</pre> <p>If these pre-existing reasons do not fit, a custom reason can be specified. Such reasons should be written to fit into the sentence <code class="language-plaintext highlighter-rouge">&lt;cask&gt; has been deprecated/disabled because it &lt;reason&gt;!</code>.</p> <p>A well-worded example of a custom reason would be:</p> <pre data-language="ruby"># Warning: &lt;cask&gt; has been deprecated because it has unresolved CVEs!
deprecate! date: "2020-01-01", because: "has unresolved CVEs"</pre> <p>A poorly-worded example of a custom reason would be:</p> <pre data-language="ruby"># Error: &lt;cask&gt; has been disabled because it broken!
disable! date: "2020-01-01", because: "broken"</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2009&ndash;present Homebrew contributors<br>Licensed under the BSD 2-Clause License.<br>
    <a href="https://docs.brew.sh/Deprecating-Disabling-and-Removing-Casks" class="_attribution-link">https://docs.brew.sh/Deprecating-Disabling-and-Removing-Casks</a>
  </p>
</div>
