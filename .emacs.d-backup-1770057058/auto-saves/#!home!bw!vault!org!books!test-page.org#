#+TITLE: Mastering Emacs
#+AUTHOR: Mickey Petersen

* Introduction
“I’m using Linux. A library that emacs uses to communicate with Intel hardware.”

– Erwin,#emacs, Freenode. 

** COMMENT Thank You

Thank you for purchasingMastering Emacs. This book has been a long time coming. When I started my blog, Mastering Emacs, in 2010, it was at the recommendation of a good friend, Lee, who suggested that I s hare my thoughts on Emacs and work flow in Emacs. At the time I had accrued in an org mode file titledblogideas.orga large but random assortment of ideas and concepts that I’d learned about and wished someone had taught me. The end result of that file is the blog and now this book.

Special Thanks

I would like to thank the following people for their encouragement, advice, suggestions and critiques:

Akira Kitada, Alvaro Ramirez, Arialdo Martini, Bob Koss, Catherine Mongrain, Chandan Rajendra, Christopher Lee, Daniel Hannaske, Edwin Ong, Evan Misshula, Friedrich Paetzke, Gabriela Hajduk, Gabriele Lana, Greg Sieranski, Holger Pirk, John Mastro, John Kitchin, Jonas Enlund, Konstantin Nazarenko, Lee Cullip, Luis Gerhorst, Lukas Pukenis, Manuel Uberti, Marcin Borkowski, Mark Kocera, Matt Wilbur, Matthew Daly, Michael Reid, Nanci Bonfim, Oliver Martell, Patrick Mosby, Patrick Martin, Sebastian Garcia Anderman, Stephen Nelson-Smith, Steve Mayer, Tariq Master, Travis Jefferson, Travis Hartwell.

Like a lot of people, I was thrust into the world of Emacs without knowing anything about it; in my case it was in my first year of University where the local computer society was made up primarily of Vim users. It was explained to me, in no uncertain terms, that “you use Vim — that’s it.” Not wanting to be told what to do, I picked the polar opposite of Vim and went with Emacs.

Emacs proved to be a stable and reliable editor in all those years, but it was a tough one to get to know. Despite the extensive user documentation, it never helped me to learn and understand Emacs.

** 2024 Edition Update
Emacs 29 continues the long-running trend of keeping up with advances in technology. That is commendable. Emacs is an old piece of software, and yet it is continuously improving.

One of the hardest things to get right in a text editor is syntax highlighting (font lockingin Emacs parlance) and writing a robust indentation engine. You see, when Emacs – and many other editors, old and new – syntax highlight your source code, they do so usingregular expressions, a terse method for matching text using pattern matching. Regular expressions are great; they’re a succinct way of matching and extracting important information from text. They are the backbone of syntax highlighters nearly everywhere, but they also have a flaw: they can be imprecise, and can impede performance if they are poorly written.

A regular expression also cannot contextualize what it is matching: just that it did (or did not) match something. For a wide range of granular tasks, it is simply not possible to rely on regular expressions. That is a problem as you want as much precision as you can get. Yet it’s often impossible to tell some things apart with a regular expression, such as whether a series of characters is a variable or a function call. The same series of characters may have one meaning in one context, and an altogether different one in another. Regular expressions are rarely powerful enough to capture that nuance. And so most text editors build their syntax highlighting and indentation engines with a medley of regular expressions and hand-tuned, imperative code to try to work around the limitations of the former.

Good news, then, as Emacs 29 adds optional support fortree-sitter1, a parser library with an exacting eye for source code parsing that constructs aConcrete Syntax Treefrom any text for which it has a valid grammar. Such a tree is the perfect medium for a computer (or willing user) to query. It makes correct syntax highlighting possible with little more than a few dozen lines of code. It also adds the tantalizing promise ofstructured editing and movement, a sprawling concept that reuses the tree-like structure tree-sitter yields to offer unparalleled editing and movement in your code base.

Tree-sitter’s not the only game in town. What itdoesbring to the table, and what has eluded most other attempts (in Emacs and beyond), is that is has the largest repository of parsers for both common and uncommon languages and structured text files. Tree-sitter is thus capableandpopular. It helps that it is quite straightforward to write your own parser using tree-sitter’s tooling. The cherry on top is a query language to quickly find and match segments of the parsedtreethat it emits. That is perhaps its ace in the hole: being able to ask it to show you (for example) all the functions that contain one or more variables with a given name is a powerful feature indeed. Modeled on LISP’s S-expressions, the query language also feels right at home in an Emacs ecosystem.

Presently, the feature is optional, as you must compile Emacs with tree-sitter support. So it is unlikely to replace, wholesale, the existing major modes and the old way of doing things. But it’s a large step forward for Emacs, as it makes writing syntax highlighting and indentation code downright easy2. Its adoption into Emacs core is a positive development, and a repudiation against the entrenched belief that Emacs can never fundamentally change.Font lockingin Emacs was first introduced around 35 years ago, and now there is a new way – and often much better way – than the old regular expressions. Its successful integration into Emacs is also reflected in the wider Emacs community where it has proven to be a popular feature, despite the fact that tree-sitter is, being new to Emacs, cumbersome to set up and use.

The other major inclusion is Eglot, a client that understands the language server protocol (LSP). Eglot adds IDE-like features to any buffer for which there is a language server available. It’s designed to work with nothing more than base Emacs and the requisite language server. Provided you’ve got your language server set up, all you need to type is~M-x eglot~(or select~Tools -> Language Server Support~) to get started. Eglot’s been around for a long time on ELPA, an Emacs package repository. Now it’s built into Emacs.

Both capabilities are capstones in an otherwise packed release full of exciting improvements and fixes. If you’re not using Emacs 29 already, you should definitely upgrade.

** Intended Audience
It’s a bit weird talking about the intended audience when you’ve already bought the book on the subject. But it bears mentioning anyway so no matter your Emacs skill level you will get something out of this book.

The first and (most obvious) audience are people new to Emacs. If you’ve never used Emacs before in your life, you will hopefully find this book illuminating. However, if you’re new to Emacsandnon-technical, then you’re going to have a harder time. Emacs, despite being suitable for much more than just programming, is squarely aimed at computer-savvy people. Although it’s perfectly possible to use Emacs anyway, this book will assume that you’re technically inclined, but not necessarily a programmer.

If you’ve tried Emacs before but given up, then I hope this book is what convinces you to stick with it. But it’s fine if you don’t; some languages or environments don’t (contrary to what a lot of Emacs users would claim) work well with Emacs. If you’re primarily a Microsoft Windows developer working with Visual Studio, using Emacs is going to be a case of two steps forward, one step back: you gain unprecedented text editing and tool integration but lose some of the benefits a unified IDE would give you.

If you’re a Vim refugee, then welcome to the dark side! If your primary objective is to use Emacs’s Vim emulation layers, then some of this book is redundant; it concerns itself with the default Emacs bindings and it teaches “the Emacs way” of doing things. But not to worry: a lot of the tips and advice herein are still applicable, and who knows — maybe you’ll switch away from Evil mode in time.

And finally, if you’re an existing Emacs user but struggling to take it to the next level, or maybe you just need a refresher course “from the ground up,” then this book is also for you.

** What You’ll Learn
Coveringallof Emacs in just one book would be a Sisyphean task. Instead, I aim to teach you what you need to be productive in Emacs, which is just a small subset of what Emacs can do. Hopefully, by the end of this book, and with practice, you will know enough about Emacs to seek out and answer questions you have about the editor.

To be more specific, I will teach you, in broad terms, six things:

What Emacs is about

A thorough explanation of important terminology and conventions that Emacs uses which in many cases differs greatly from other editors. You will also learn what the philosophy of Emacs is, and why a text editor evenhasa philosophy. I will also talk about Vim briefly and theEditor Warsand what the deal is with all those different keys.

Getting started with Emacs

